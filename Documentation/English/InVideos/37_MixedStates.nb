(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     34187,        900]
NotebookOptionsPosition[     25116,        687]
NotebookOutlinePosition[     27249,        757]
CellTagsIndexPosition[     27206,        754]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Mixed States (Density Operators)", "Title",
 CellChangeTimes->{{3.885174860925022*^9, 3.885174865353307*^9}, {
   3.885304668157981*^9, 3.885304669261899*^9}, {3.885305898486268*^9, 
   3.885305908539831*^9}, {3.885356494420639*^9, 3.885356499263852*^9}, {
   3.88540045215331*^9, 3.885400458538446*^9}, {3.885531793130577*^9, 
   3.885531799884221*^9}, {3.8855392916050386`*^9, 3.885539291735082*^9}, {
   3.885586256088341*^9, 3.885586261003409*^9}, {3.8899409870666533`*^9, 
   3.889940990699774*^9}, {3.8906953178089933`*^9, 3.890695323082312*^9}, {
   3.891396083274109*^9, 3.891396087632805*^9}, {3.89171680818376*^9, 
   3.8917168104334717`*^9}, {3.892075279704197*^9, 3.892075279827215*^9}, {
   3.892275142364615*^9, 3.892275144726169*^9}, {3.892502822715954*^9, 
   3.892502827194459*^9}, {3.8938107264530153`*^9, 3.893810731943302*^9}, 
   3.893810762152753*^9, {3.8938149913307734`*^9, 3.8938150009806137`*^9}, {
   3.902724739769683*^9, 3.902724742213041*^9}, {3.914545933607117*^9, 
   3.914545943257899*^9}, {3.914967282930787*^9, 3.914967284753682*^9}, {
   3.914974679820767*^9, 3.914974683684768*^9}},
 CellID->1462643787,ExpressionUUID->"e9c48138-d1bc-4785-bcfd-b73c69f38250"],

Cell["Episode 37. Mixed States", "Text",
 CellChangeTimes->{{3.89924916799488*^9, 3.899249207303158*^9}, {
  3.899249293468512*^9, 3.899249330506671*^9}, {3.914543168710368*^9, 
  3.914543174755287*^9}, {3.91496560652989*^9, 3.914965620662586*^9}, {
  3.914987936480585*^9, 3.914987942082397*^9}},
 FontWeight->"Bold",
 CellID->1422026746,ExpressionUUID->"6d71ec00-54e3-4f76-b5b5-c039f32115c7"],

Cell["Episode 38. Partial Trace and Purification", "Text",
 CellChangeTimes->{{3.89924916799488*^9, 3.899249207303158*^9}, {
  3.899249293468512*^9, 3.899249330506671*^9}, {3.914543168710368*^9, 
  3.914543174755287*^9}, {3.91496560652989*^9, 3.914965620662586*^9}, {
  3.914987946592383*^9, 3.914987955694113*^9}},
 CellID->1262776816,ExpressionUUID->"8782bda7-ba11-422a-a25b-210604206eef"],

Cell[CellGroupData[{

Cell["Statistical Ensemble vs Density Operator", "Section",
 CellChangeTimes->{{3.904003607164847*^9, 3.9040036172317343`*^9}, {
  3.904003775105001*^9, 3.904003777364917*^9}},
 CellID->2027283748,ExpressionUUID->"f85990be-23b7-42f7-9630-d454e7c877f9"],

Cell[CellGroupData[{

Cell["Statistical ensemble", "Subsection",
 CellChangeTimes->{{3.904003648519084*^9, 3.904003653851273*^9}},
 CellID->858700978,ExpressionUUID->"9429d087-577d-4cf6-901f-94834a053c20"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     TemplateBox[{
       SubscriptBox["\[Psi]", "1"]},
      "Ket"], "\[RightArrow]", 
     SubscriptBox["p", "1"]}], ",", 
    RowBox[{
     TemplateBox[{
       SubscriptBox["\[Psi]", "2"]},
      "Ket"], "\[RightArrow]", 
     SubscriptBox["p", "2"]}], ",", "\[Ellipsis]"}], "}"}], 
  TraditionalForm]],ExpressionUUID->"33258e15-89ff-42ab-b0fb-1028cf057ee3"]], \
"Text",
 CellChangeTimes->{{3.904003671896714*^9, 3.90400370303875*^9}, {
  3.914983300812228*^9, 3.914983326898185*^9}},
 CellID->1805640155,ExpressionUUID->"650ea6a8-db8e-4e05-9e06-25c224f64f4b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Density operator (matrix)", "Subsection",
 CellChangeTimes->{{3.904003659331195*^9, 3.904003661315302*^9}, {
  3.904003766821764*^9, 3.904003772763702*^9}},
 CellID->1394980842,ExpressionUUID->"670dfec3-9c29-4fb3-8734-727e6cb2d3e1"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"\[Rho]", "=", 
   RowBox[{
    RowBox[{
     TemplateBox[{
       SubscriptBox["\[Psi]", "1"]},
      "Ket"], 
     SubscriptBox["p", "1"], 
     TemplateBox[{
       SubscriptBox["\[Psi]", "1"]},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{
       SubscriptBox["\[Psi]", "2"]},
      "Ket"], 
     SubscriptBox["p", "2"], 
     TemplateBox[{
       SubscriptBox["\[Psi]", "2"]},
      "Bra"]}], "+", "\[Ellipsis]"}]}], 
  TraditionalForm]],ExpressionUUID->"a66b44ef-c2ee-4124-894b-c95afd2646bc"]], \
"Text",
 CellChangeTimes->{{3.904003671896714*^9, 3.904003747788875*^9}},
 CellID->1626536874,ExpressionUUID->"6f74afdb-1e9a-4898-bf7c-ec0196bf9b73"]
}, Closed]],

Cell[CellGroupData[{

Cell["Example", "Subsection",
 CellChangeTimes->{{3.91498263983615*^9, 3.9149826419841633`*^9}},
 CellID->1990080337,ExpressionUUID->"89ae78d9-f6d3-42b0-9114-49a1b54857fa"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellChangeTimes->{{3.914982301493259*^9, 3.914982303791609*^9}},
 CellLabel->"In[107]:=",
 CellID->49915569,ExpressionUUID->"e1843983-e409-4cb8-8e98-4a80b56d02bd"],

Cell[BoxData[
 RowBox[{"ens", "=", 
  RowBox[{"Association", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"S", "->", "0"}], "]"}], "->", "0.2"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Ket", "[", 
         RowBox[{"S", "->", "0"}], "]"}], "+", 
        RowBox[{"Ket", "[", 
         RowBox[{"S", "->", "1"}], "]"}]}], ")"}], "/", 
      RowBox[{"Sqrt", "[", "2", "]"}]}], "->", "0.5"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Ket", "[", 
         RowBox[{"S", "->", "0"}], "]"}], "-", 
        RowBox[{"I", "*", 
         RowBox[{"Ket", "[", 
          RowBox[{"S", "->", "1"}], "]"}]}]}], ")"}], "/", 
      RowBox[{"Sqrt", "[", "2", "]"}]}], "->", "0.3"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.914982283620915*^9, 3.914982463419202*^9}},
 CellLabel->"In[108]:=",
 CellID->904619457,ExpressionUUID->"5488a128-4aa6-4918-afcc-2a1b0a60e38c"],

Cell[BoxData[
 RowBox[{"rho", "=", 
  RowBox[{"Garner", "@", 
   RowBox[{"Total", "@", 
    RowBox[{"KeyValueMap", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#1", "**", 
         RowBox[{"Dagger", "[", "#1", "]"}]}], "*", "#2"}], "&"}], ",", 
      "ens"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.91498247958323*^9, 3.9149825761543493`*^9}, {
  3.914982840959469*^9, 3.914982851610927*^9}},
 CellLabel->"In[109]:=",
 CellID->1060631821,ExpressionUUID->"3ced82d2-d270-476b-9cc2-9d8a477e1c91"],

Cell[BoxData[
 RowBox[{"rho", "=", 
  RowBox[{"Garner", "@", 
   RowBox[{"Total", "@", 
    RowBox[{"KeyValueMap", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Dyad", "[", 
         RowBox[{"#1", ",", "#1", ",", "S"}], "]"}], "*", "#2"}], "&"}], ",", 
      "ens"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.91498247958323*^9, 3.9149825761543493`*^9}, {
  3.914982829877078*^9, 3.91498283404344*^9}},
 CellLabel->"In[110]:=",
 CellID->2048688451,ExpressionUUID->"88dbb49d-a9db-4528-8f14-20eba1008582"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{
    RowBox[{"Matrix", "[", "rho", "]"}], "//", "Chop"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.9149825796576014`*^9, 3.914982590815239*^9}, {
  3.914983146202754*^9, 3.9149831468998947`*^9}},
 CellLabel->"In[111]:=",
 CellID->1630007386,ExpressionUUID->"7536553d-d407-4a94-8e80-25e12ff4293b"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Basic Properties", "Section",
 CellChangeTimes->{{3.904003756878665*^9, 3.9040037652032843`*^9}, {
  3.914982900032669*^9, 3.914982905167328*^9}},
 CellID->105470271,ExpressionUUID->"182020f1-1c0b-4540-a3e1-d37128cd5d93"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"Tr", "\[VeryThinSpace]", "\[Rho]"}], "=", "1"}], 
  TraditionalForm]],ExpressionUUID->"22bb7eb0-80a2-4db3-b9bc-02da4c0a00bb"]], \
"ItemNumbered",
 CellChangeTimes->{{3.904003785786018*^9, 3.904003793334063*^9}, {
   3.904003833564128*^9, 3.904003833566885*^9}, 3.904033089961162*^9, 
   3.904033389238043*^9},
 CellID->1804958737,ExpressionUUID->"01f65b9c-a6e9-410b-a4f2-e5a3b7e1030b"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SuperscriptBox["\[Rho]", "\[Dagger]"], "=", "\[Rho]"}], 
  TraditionalForm]],ExpressionUUID->"07e5aac6-60ca-42c0-99fb-c5023785665c"]], \
"ItemNumbered",
 CellChangeTimes->{{3.904003785786018*^9, 3.904003793334063*^9}, {
  3.904003835591181*^9, 3.904003845514758*^9}},
 CellID->1482161502,ExpressionUUID->"60cc52cb-2c6d-4e30-90a6-71d2b52ea228"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"\[Rho]", "\[GreaterEqual]", "0"}], 
  TraditionalForm]],ExpressionUUID->"01c6eb8f-850f-4e18-9cfd-a60793aeec8e"]], \
"ItemNumbered",
 CellChangeTimes->{{3.904003785786018*^9, 3.904003793334063*^9}, {
  3.904003835591181*^9, 3.90400386636233*^9}, {3.904004020897795*^9, 
  3.904004020899732*^9}},
 CellID->630679243,ExpressionUUID->"cde9090d-8bd3-4509-bba6-c25198b6c268"],

Cell[TextData[{
 StyleBox["(diagonal elements)",
  FontWeight->"Bold"],
 " For a mixed state ",
 Cell[BoxData[
  FormBox["\[Rho]", TraditionalForm]],ExpressionUUID->
  "039b924b-2f20-4d93-a255-1034fd71b274"],
 ", the diagonal elements in a fixed basis are the probability to find the \
system in the corresponding basis states."
}], "ItemNumbered",
 CellChangeTimes->{{3.904003785786018*^9, 3.904003793334063*^9}, {
  3.904003835591181*^9, 3.90400386636233*^9}, {3.90400402168296*^9, 
  3.904004092540093*^9}},
 CellID->920896551,ExpressionUUID->"cf6595c5-5f67-43e5-a73b-9d95bc23de5b"],

Cell[TextData[{
 StyleBox["(off-diagonal elements)",
  FontWeight->"Bold"],
 " For a mixed state ",
 Cell[BoxData[
  FormBox["\[Rho]", TraditionalForm]],ExpressionUUID->
  "57849bc0-4db8-4db9-a84f-8a0366ff654b"],
 ", the off-diagonal elements in a fixed basis are responsible for the \
coherence in the given basis."
}], "ItemNumbered",
 CellChangeTimes->{{3.904003785786018*^9, 3.904003793334063*^9}, {
  3.904003835591181*^9, 3.90400386636233*^9}, {3.90400402168296*^9, 
  3.904004141845137*^9}},
 CellID->1287773214,ExpressionUUID->"92c64c8d-0bd4-4ffb-951f-038caf2975e1"],

Cell[TextData[{
 StyleBox["(purity test)",
  FontWeight->"Bold"],
 " ",
 Cell[BoxData[
  FormBox["\[Rho]", TraditionalForm]],ExpressionUUID->
  "543c4497-1527-4ef5-8f5a-da1b3238f89f"],
 " is a pure state if and only if ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Tr", "\[VeryThinSpace]", 
     SuperscriptBox["\[Rho]", "2"]}], "=", "1"}], TraditionalForm]],
  ExpressionUUID->"e45ac09c-5ee1-40a4-a576-e0513ac8d9b7"],
 "."
}], "ItemNumbered",
 CellChangeTimes->{{3.904003785786018*^9, 3.904003793334063*^9}, {
  3.904003835591181*^9, 3.904003907586937*^9}, {3.904003938483474*^9, 
  3.90400393848561*^9}},
 CellID->777463822,ExpressionUUID->"9f038c0d-c6f4-4222-9843-db3786395c11"],

Cell[TextData[{
 StyleBox["(unitary freedom)",
  FontWeight->"Bold"],
 " Two statistical ensembles ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      TemplateBox[{
        SubscriptBox["\[Alpha]", "1"]},
       "Ket"], "\[RightArrow]", 
      SubscriptBox["p", "1"]}], ",", 
     RowBox[{
      TemplateBox[{
        SubscriptBox["\[Alpha]", "2"]},
       "Ket"], "\[RightArrow]", 
      SubscriptBox["p", "2"]}], ",", "\[Ellipsis]"}], "}"}], 
   TraditionalForm]],ExpressionUUID->"117fd647-0a8e-4f9a-9ee2-36b9ce3cb12d"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       TemplateBox[{
         SubscriptBox["\[Beta]", "1"]},
        "Ket"], "\[RightArrow]", 
       SubscriptBox["q", "1"]}], ",", 
      RowBox[{
       TemplateBox[{
         RowBox[{"\[NoBreak]", 
           SubscriptBox["\[Beta]", "2"]}]},
        "Ket"], "\[RightArrow]", 
       SubscriptBox["q", "2"]}], ",", "\[Ellipsis]"}], "}"}], " "}], 
   TraditionalForm]],ExpressionUUID->"1622cccd-faec-4f42-8e63-afa1c7cfeb24"],
 "give the same density operator if and only if there exists a unitary matrix \
such that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{
       SubscriptBox["\[Beta]", "j"]},
      "Ket"], 
     SqrtBox[
      SubscriptBox["q", "j"]]}], "=", 
    RowBox[{
     UnderscriptBox["\[CapitalSigma]", "i"], 
     TemplateBox[{
       SubscriptBox["\[Alpha]", "i"]},
      "Ket"], 
     SqrtBox[
      SubscriptBox["p", "i"]], 
     SubscriptBox["U", 
      RowBox[{"i", "\[VeryThinSpace]", "j"}]]}]}], TraditionalForm]],
  ExpressionUUID->"c4ca1446-bfa6-4999-b765-9e31b9a9d5cd"],
 " ."
}], "ItemNumbered",
 CellChangeTimes->{{3.904003785786018*^9, 3.904003793334063*^9}, {
  3.904003835591181*^9, 3.904003907586937*^9}, {3.9040039399972563`*^9, 
  3.904003944103445*^9}, {3.904004173256193*^9, 3.904004339812553*^9}, {
  3.914983345102927*^9, 3.914983375437948*^9}},
 CellID->1335527896,ExpressionUUID->"4abe2ecf-8eea-4eb0-82b8-ccbb2062e3bd"],

Cell[CellGroupData[{

Cell["Unit trace", "Subsection",
 CellChangeTimes->{{3.914982964448638*^9, 3.914982976001918*^9}},
 CellID->94665248,ExpressionUUID->"cf13b322-5c86-46c0-8a6d-b8746105aadf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tr", "[", "mat", "]"}], "//", "Chop"}]], "Input",
 CellChangeTimes->{{3.914982951668902*^9, 3.914982955858509*^9}},
 CellLabel->"In[113]:=",
 CellID->777539586,ExpressionUUID->"2799df66-ac3a-44e6-858b-f2928f37a857"]
}, Closed]],

Cell[CellGroupData[{

Cell["Hermiticity", "Subsection",
 CellChangeTimes->{{3.914982983007399*^9, 3.914982983901353*^9}, {
  3.914983095263077*^9, 3.9149830966045732`*^9}},
 CellID->2137998787,ExpressionUUID->"6715c7cc-2a02-4e4e-8b3f-340cc211f600"],

Cell[BoxData[
 RowBox[{"HermitianMatrixQ", "[", "mat", "]"}]], "Input",
 CellChangeTimes->{{3.914982986160677*^9, 3.9149829915071287`*^9}},
 CellLabel->"In[114]:=",
 CellID->58567610,ExpressionUUID->"edf96729-d15e-4ef2-b890-cf1ba1890d28"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Dagger", "[", "rho", "]"}], "-", "rho"}], "//", "Chop"}]], "Input",\

 CellChangeTimes->{{3.914983000114195*^9, 3.914983006548761*^9}},
 CellLabel->"In[115]:=",
 CellID->1685725046,ExpressionUUID->"0c8de888-40e2-4246-aeb8-6638888619b1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Positivity", "Subsection",
 CellChangeTimes->{{3.914983107876853*^9, 3.914983109112727*^9}},
 CellID->374096439,ExpressionUUID->"687b873b-93c5-488c-8bc1-a8547f7ce173"],

Cell[BoxData[
 RowBox[{"val", "=", 
  RowBox[{"Eigenvalues", "[", "mat", "]"}]}]], "Input",
 CellChangeTimes->{{3.9149831214507113`*^9, 3.914983124477643*^9}, {
  3.914983169320002*^9, 3.914983169784668*^9}},
 CellLabel->"In[116]:=",
 CellID->938531397,ExpressionUUID->"309be8b7-4eeb-4cd3-9658-b0eff52d41ef"],

Cell[BoxData[
 RowBox[{"Thread", "[", 
  RowBox[{"val", ">=", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.914983171339519*^9, 3.914983177816063*^9}},
 CellLabel->"In[117]:=",
 CellID->1502579979,ExpressionUUID->"550f58f9-c63d-41a1-9c27-59c986a5e98b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Diagonal and off-diagonal elements", "Subsection",
 CellChangeTimes->{{3.9149881940488434`*^9, 3.914988218817985*^9}},
 CellID->1098261154,ExpressionUUID->"122e3a90-9ad1-4341-b3e2-23dbc405312c"],

Cell[TextData[{
 StyleBox["(diagonal elements)",
  FontWeight->"Bold"],
 " For a mixed state ",
 Cell[BoxData[
  FormBox["\[Rho]", TraditionalForm]],ExpressionUUID->
  "7a7a3bcb-2bf0-496c-b78d-fc43d8cf4cfc"],
 ", the diagonal elements in a fixed basis are the probability to find the \
system in the corresponding basis states."
}], "ItemNumbered",
 CellChangeTimes->{{3.904003785786018*^9, 3.904003793334063*^9}, {
  3.904003835591181*^9, 3.90400386636233*^9}, {3.90400402168296*^9, 
  3.904004092540093*^9}},
 CellID->445655846,ExpressionUUID->"ba483d47-0575-4ff4-9c65-407978ae942c"],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["(off-diagonal elements)",
  FontWeight->"Bold"],
 " For a mixed state ",
 Cell[BoxData[
  FormBox["\[Rho]", TraditionalForm]],ExpressionUUID->
  "4f0fc4e9-11f6-411d-af6e-b08a51313c43"],
 ", the off-diagonal elements in a fixed basis are responsible for the \
coherence in the given basis."
}], "ItemNumbered",
 CellChangeTimes->{{3.904003785786018*^9, 3.904003793334063*^9}, {
  3.904003835591181*^9, 3.90400386636233*^9}, {3.90400402168296*^9, 
  3.904004141845137*^9}},
 CellID->1862326633,ExpressionUUID->"ca59c09c-0af9-406f-9135-37a77b7d961c"],

Cell[BoxData[
 RowBox[{"prb", "=", 
  RowBox[{
   RowBox[{"Diagonal", "[", "mat", "]"}], "//", "Normal"}]}]], "Input",
 CellChangeTimes->{{3.915567934213044*^9, 3.915567940733374*^9}, {
  3.915568162380831*^9, 3.915568162887923*^9}},
 CellLabel->"In[145]:=",
 CellID->868002592,ExpressionUUID->"58e27679-c5cd-45b3-9c0f-32b6cfd55bda"]
}, Open  ]],

Cell["\<\
Of course, this must be the same as the weighted sum of probabilities in the \
quantum states from the statistical ensemble.\
\>", "Text",
 CellChangeTimes->{{3.915567995611698*^9, 3.915568049048178*^9}},
 CellID->949113300,ExpressionUUID->"78620602-e244-4950-b1cb-878ffc192733"],

Cell[BoxData[
 RowBox[{"pp", "=", 
  RowBox[{
   RowBox[{"Normal", "@", 
    RowBox[{"Abs", "[", 
     RowBox[{"Matrix", "/@", 
      RowBox[{"Keys", "[", "ens", "]"}]}], "]"}]}], "^", "2"}]}]], "Input",
 CellChangeTimes->{{3.915568050717424*^9, 3.915568119267576*^9}},
 CellLabel->"In[146]:=",
 CellID->233169959,ExpressionUUID->"d33e139c-e96b-4304-b319-e49f52a4e531"],

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{
   RowBox[{"Values", "[", "ens", "]"}], ".", "pp"}]}]], "Input",
 CellChangeTimes->{{3.915568124464978*^9, 3.915568177508211*^9}},
 CellLabel->"In[148]:=",
 CellID->562748266,ExpressionUUID->"8b428502-3f34-4983-8b3c-138da2a6e05e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Purity", "Subsection",
 CellChangeTimes->{{3.914983409653131*^9, 3.914983410676245*^9}},
 CellID->235688213,ExpressionUUID->"7cb87888-eb53-4924-8f4b-ce647ad3ca30"],

Cell[BoxData[
 RowBox[{"purity", "=", 
  RowBox[{
   RowBox[{"Tr", "[", 
    RowBox[{"mat", ".", "mat"}], "]"}], "//", "Chop"}]}]], "Input",
 CellChangeTimes->{{3.914983415761109*^9, 3.914983427226259*^9}},
 CellLabel->"In[118]:=",
 CellID->747514611,ExpressionUUID->"56f2339d-634d-4322-9d25-d6cfd9fef58a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Unitary Freedom", "Subsection",
 CellChangeTimes->{{3.9149833985699453`*^9, 3.914983403125239*^9}},
 CellID->1584101584,ExpressionUUID->"bf2576e5-4264-41f0-b2dc-2c3860c2e5e9"],

Cell["Consider a random unitary matrix.", "Text",
 CellChangeTimes->{{3.914987761930476*^9, 3.914987775499947*^9}},
 CellID->1925764049,ExpressionUUID->"3993439f-d4b0-4197-8a61-c731f2a5d6af"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"trs", "=", 
   RowBox[{"RandomUnitary", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"trs", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.914983586736714*^9, 3.914983686281804*^9}, {
   3.914983969962165*^9, 3.91498404160329*^9}, 3.914984848103902*^9},
 CellLabel->"In[119]:=",
 CellID->2142177653,ExpressionUUID->"4acf60fe-45d4-4693-a3c0-82dd99ac537b"],

Cell["Construct a new statistical ensemble of quantum states.", "Text",
 CellChangeTimes->{{3.914987780913059*^9, 3.914987802037133*^9}},
 CellID->451078633,ExpressionUUID->"d5a27c69-159c-44f3-b978-4aa1e7565ea9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"KeyValueMap", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "*", 
         RowBox[{"Sqrt", "[", "#2", "]"}]}], "&"}], ",", "ens"}], "]"}], ".", 
     "trs"}], "//", "Elaborate"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "=", 
  RowBox[{"Association", "@", 
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"KetNormalize", "[", "#", "]"}], "->", 
       RowBox[{
        RowBox[{"KetNorm", "[", "#", "]"}], "^", "2"}]}], "&"}], "/@", 
     "new"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.914984048532381*^9, 3.914984116705527*^9}, {
   3.91498415031115*^9, 3.9149841812258244`*^9}, 3.914984587863175*^9, {
   3.914984900448778*^9, 3.914984900831016*^9}, {3.914985935477745*^9, 
   3.91498600222272*^9}, 3.914987277221068*^9, {3.914987435748685*^9, 
   3.91498743614205*^9}},
 CellLabel->"In[121]:=",
 CellID->1892982628,ExpressionUUID->"ada51f02-9087-4b2f-b0d4-36fd44a5b6c3"],

Cell["\<\
By the unitary freedom of density matrix, the above statistical ensemble also \
generates the same density operator.\
\>", "Text",
 CellChangeTimes->{{3.9149878211596107`*^9, 3.914987868040578*^9}},
 CellID->348538644,ExpressionUUID->"33501bf9-c4d7-422a-b7aa-aeafc1716452"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"more", "=", 
   RowBox[{"Total", "@", 
    RowBox[{"KeyValueMap", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Dyad", "[", 
         RowBox[{"#1", ",", "#1", ",", "S"}], "]"}], "*", "#2"}], "&"}], ",", 
      "new"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"more", "=", 
  RowBox[{"Chop", "@", 
   RowBox[{"Garner", "@", "more"}]}]}]}], "Input",
 CellChangeTimes->{{3.91498247958323*^9, 3.9149825761543493`*^9}, {
  3.914982829877078*^9, 3.91498283404344*^9}, {3.914987480609799*^9, 
  3.91498748421912*^9}, {3.914987674937951*^9, 3.914987703746933*^9}},
 CellLabel->"In[123]:=",
 CellID->998938623,ExpressionUUID->"80916aeb-8ff9-4c33-b95b-b2206403e1f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rho", "-", "more"}], "//", "Chop"}]], "Input",
 CellChangeTimes->{{3.914987495592362*^9, 3.914987499194787*^9}},
 CellLabel->"In[125]:=",
 CellID->1445837757,ExpressionUUID->"8c0977e4-e742-46f1-8348-f64cad932f5a"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Summary", "Section",
 CellChangeTimes->{{3.885306034976571*^9, 3.885306035833013*^9}},
 CellID->532058193,ExpressionUUID->"e61e4f1f-2ed0-42f1-8258-cbb4d7e6c464"],

Cell[CellGroupData[{

Cell["Keywords", "Subsection",
 CellChangeTimes->{{3.8913962649286203`*^9, 3.8913962658795958`*^9}},
 CellID->1081268205,ExpressionUUID->"8b76f74d-73c1-4620-a7ad-edc641c13f8f"],

Cell["Statistical ensemble (statistical vs. coherent mixture)", "Item",
 CellChangeTimes->{{3.902775924966546*^9, 3.902775967348959*^9}},
 CellID->1758715193,ExpressionUUID->"cfb662b5-5548-482c-99ab-56547a94a551"],

Cell["Density operator (matrix)", "Item",
 CellChangeTimes->{{3.902775924966546*^9, 3.90277597726891*^9}},
 CellID->920712980,ExpressionUUID->"689e7301-1303-4870-9fec-6b93ce772177"]
}, Closed]],

Cell[CellGroupData[{

Cell["Functions", "Subsection",
 CellChangeTimes->{{3.885356516796631*^9, 3.885356517785305*^9}},
 CellID->1316731321,ExpressionUUID->"effbd40c-bcac-4e0b-863d-59ad4463fa84"],

Cell[TextData[StyleBox["Dyad", "Input"]], "Item",
 CellChangeTimes->{{3.885356540099222*^9, 3.885356541907227*^9}, {
  3.885400476551014*^9, 3.8854004796405373`*^9}, {3.885536305942862*^9, 
  3.88553630638804*^9}, {3.885587493992428*^9, 3.885587525042856*^9}, {
  3.89139634821424*^9, 3.891396364534376*^9}, {3.892275238128506*^9, 
  3.892275238881791*^9}, {3.893811998663414*^9, 3.893812004305831*^9}, {
  3.902725024736968*^9, 3.902725025998858*^9}, {3.9040049063688726`*^9, 
  3.904004906371749*^9}, {3.914988260658979*^9, 3.914988261245499*^9}},
 CellID->849148097,ExpressionUUID->"b09d687e-e1ab-4b97-8d74-4366ca6d5482"]
}, Closed]],

Cell[CellGroupData[{

Cell["Related Links", "Subsection",
 CellChangeTimes->{{3.885356807098833*^9, 3.885356809897966*^9}},
 CellID->862852095,ExpressionUUID->"0a46d035-c801-4e0e-b499-2c5664749b21"],

Cell[TextData[{
 "Section 1.2 of the ",
 ButtonBox["Quantum Workbook (2022, 2023)",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://link.springer.com/book/10.1007/978-3-030-91214-7"], None}],
 "."
}], "Item",
 CellChangeTimes->{{3.885325833043219*^9, 3.885325887141716*^9}, {
   3.886926286725359*^9, 3.886926288901046*^9}, {3.887421003456878*^9, 
   3.8874210043282623`*^9}, {3.89009766315901*^9, 3.890097697560048*^9}, 
   3.890097745196322*^9, {3.890688755596345*^9, 3.890688755599209*^9}, {
   3.890695444071374*^9, 3.890695444102458*^9}, {3.891396397076474*^9, 
   3.891396397128636*^9}, {3.89227529678895*^9, 3.892275323155737*^9}, {
   3.893812012768976*^9, 3.893812017356299*^9}},
 CellID->1797404841,ExpressionUUID->"6655289a-7415-4abc-870b-06896c912a12"],

Cell[TextData[{
 "Tutorial: ",
 ButtonBox["Quantum States",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/tutorial/QuantumStates#2028958569"]
}], "Item",
 CellChangeTimes->{{3.885325833043219*^9, 3.885325887141716*^9}, {
   3.886926286725359*^9, 3.886926288901046*^9}, {3.887421003456878*^9, 
   3.8874210043282623`*^9}, {3.89009766315901*^9, 3.890097697560048*^9}, 
   3.890097745196322*^9, {3.890688755596345*^9, 3.890688755599209*^9}, {
   3.890695444071374*^9, 3.890695444102458*^9}, {3.891396397076474*^9, 
   3.891396397128636*^9}, {3.89227529678895*^9, 3.892275333592763*^9}, {
   3.893812283706864*^9, 3.893812286484273*^9}},
 CellID->281874570,ExpressionUUID->"5930e88a-ea0e-44d4-b961-d8c24c5ffeeb"]
}, Closed]]
}, Closed]]
}, Open  ]]
},
Saveable->False,
WindowSize->{855, 1041},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Visible->True,
DockedCells->Cell[
 "Q3: Symbolic Quantum Simulation", "Text", Background -> GrayLevel[0.9], 
  FontSize -> 12, CellFrameMargins -> {{22, 8}, {8, 8}}],
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
PageFooters->{{
   Cell["Q3: Symbolic Quantum Simulation", "Footer", CellMargins -> 4], None, 
   None}, {None, None, 
   Cell["Q3: Symbolic Quantum Simulation", "Footer", CellMargins -> 4]}},
PageFooterLines->{True, True},
FrontEndVersion->"14.0 for Mac OS X ARM (64-bit) (December 12, 2023)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Playbook.nb"]], 
   Cell[
    StyleData["Title"], Editable -> False], 
   Cell[
    StyleData["Subtitle"], Editable -> False], 
   Cell[
    StyleData["Chapter"], Editable -> False], 
   Cell[
    StyleData["Section"], Editable -> False], 
   Cell[
    StyleData["Subsection"], Editable -> False], 
   Cell[
    StyleData["Subsubsection"], Editable -> False], 
   Cell[
    StyleData["Text"], Editable -> False], 
   Cell[
    StyleData["Code"], Editable -> False], 
   Cell[
    StyleData["Item"], Editable -> False], 
   Cell[
    StyleData["Subitem"], Editable -> False], 
   Cell[
    StyleData["Subsubitem"], Editable -> False], 
   Cell[
    StyleData["DisplayFormula"], Editable -> False], 
   Cell[
    StyleData["Picture"], Editable -> False], 
   Cell[
    StyleData["Caption"], Editable -> False], 
   Cell[
    StyleData["OutlineSection"], Editable -> False], 
   Cell[
    StyleData["Outline1"], Editable -> False], 
   Cell[
    StyleData["Outline2"], Editable -> False], 
   Cell[
    StyleData["Outline3"], Editable -> False], 
   Cell[
    StyleData["Outline4"], Editable -> False]}, Visible -> False, 
  FrontEndVersion -> "14.0 for Mac OS X ARM (64-bit) (December 12, 2023)", 
  StyleDefinitions -> "Playbook.nb"],
ExpressionUUID->"a64d85d3-f4ff-45d1-84ac-a85df45a7494"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1201, 16, 98, "Title",ExpressionUUID->"e9c48138-d1bc-4785-bcfd-b73c69f38250",
 CellID->1462643787],
Cell[1784, 40, 394, 6, 35, "Text",ExpressionUUID->"6d71ec00-54e3-4f76-b5b5-c039f32115c7",
 CellID->1422026746],
Cell[2181, 48, 391, 5, 35, "Text",ExpressionUUID->"8782bda7-ba11-422a-a25b-210604206eef",
 CellID->1262776816],
Cell[CellGroupData[{
Cell[2597, 57, 252, 3, 67, "Section",ExpressionUUID->"f85990be-23b7-42f7-9630-d454e7c877f9",
 CellID->2027283748],
Cell[CellGroupData[{
Cell[2874, 64, 183, 2, 70, "Subsection",ExpressionUUID->"9429d087-577d-4cf6-901f-94834a053c20",
 CellID->858700978],
Cell[3060, 68, 643, 18, 70, "Text",ExpressionUUID->"650ea6a8-db8e-4e05-9e06-25c224f64f4b",
 CellID->1805640155]
}, Closed]],
Cell[CellGroupData[{
Cell[3740, 91, 238, 3, 70, "Subsection",ExpressionUUID->"670dfec3-9c29-4fb3-8734-727e6cb2d3e1",
 CellID->1394980842],
Cell[3981, 96, 708, 23, 70, "Text",ExpressionUUID->"6f74afdb-1e9a-4898-bf7c-ec0196bf9b73",
 CellID->1626536874]
}, Closed]],
Cell[CellGroupData[{
Cell[4726, 124, 172, 2, 70, "Subsection",ExpressionUUID->"89ae78d9-f6d3-42b0-9114-49a1b54857fa",
 CellID->1990080337],
Cell[4901, 128, 248, 5, 70, "Input",ExpressionUUID->"e1843983-e409-4cb8-8e98-4a80b56d02bd",
 CellID->49915569],
Cell[5152, 135, 1071, 31, 70, "Input",ExpressionUUID->"5488a128-4aa6-4918-afcc-2a1b0a60e38c",
 CellID->904619457],
Cell[6226, 168, 522, 14, 70, "Input",ExpressionUUID->"3ced82d2-d270-476b-9cc2-9d8a477e1c91",
 CellID->1060631821],
Cell[6751, 184, 528, 14, 70, "Input",ExpressionUUID->"88dbb49d-a9db-4528-8f14-20eba1008582",
 CellID->2048688451],
Cell[7282, 200, 421, 10, 70, "Input",ExpressionUUID->"7536553d-d407-4a94-8e80-25e12ff4293b",
 CellID->1630007386]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[7752, 216, 227, 3, 53, "Section",ExpressionUUID->"182020f1-1c0b-4540-a3e1-d37128cd5d93",
 CellID->105470271],
Cell[7982, 221, 446, 9, 70, "ItemNumbered",ExpressionUUID->"01f65b9c-a6e9-410b-a4f2-e5a3b7e1030b",
 CellID->1804958737],
Cell[8431, 232, 395, 8, 70, "ItemNumbered",ExpressionUUID->"60cc52cb-2c6d-4e30-90a6-71d2b52ea228",
 CellID->1482161502],
Cell[8829, 242, 418, 8, 70, "ItemNumbered",ExpressionUUID->"cde9090d-8bd3-4509-bba6-c25198b6c268",
 CellID->630679243],
Cell[9250, 252, 585, 13, 70, "ItemNumbered",ExpressionUUID->"cf6595c5-5f67-43e5-a73b-9d95bc23de5b",
 CellID->920896551],
Cell[9838, 267, 574, 13, 70, "ItemNumbered",ExpressionUUID->"92c64c8d-0bd4-4ffb-951f-038caf2975e1",
 CellID->1287773214],
Cell[10415, 282, 689, 19, 70, "ItemNumbered",ExpressionUUID->"9f038c0d-c6f4-4222-9843-db3786395c11",
 CellID->777463822],
Cell[11107, 303, 2035, 64, 70, "ItemNumbered",ExpressionUUID->"4abe2ecf-8eea-4eb0-82b8-ccbb2062e3bd",
 CellID->1335527896],
Cell[CellGroupData[{
Cell[13167, 371, 172, 2, 70, "Subsection",ExpressionUUID->"cf13b322-5c86-46c0-8a6d-b8746105aadf",
 CellID->94665248],
Cell[13342, 375, 250, 5, 70, "Input",ExpressionUUID->"2799df66-ac3a-44e6-858b-f2928f37a857",
 CellID->777539586]
}, Closed]],
Cell[CellGroupData[{
Cell[13629, 385, 226, 3, 70, "Subsection",ExpressionUUID->"6715c7cc-2a02-4e4e-8b3f-340cc211f600",
 CellID->2137998787],
Cell[13858, 390, 238, 4, 70, "Input",ExpressionUUID->"edf96729-d15e-4ef2-b890-cf1ba1890d28",
 CellID->58567610],
Cell[14099, 396, 283, 7, 70, "Input",ExpressionUUID->"0c8de888-40e2-4246-aeb8-6638888619b1",
 CellID->1685725046]
}, Closed]],
Cell[CellGroupData[{
Cell[14419, 408, 173, 2, 70, "Subsection",ExpressionUUID->"687b873b-93c5-488c-8bc1-a8547f7ce173",
 CellID->374096439],
Cell[14595, 412, 308, 6, 70, "Input",ExpressionUUID->"309be8b7-4eeb-4cd3-9658-b0eff52d41ef",
 CellID->938531397],
Cell[14906, 420, 252, 5, 70, "Input",ExpressionUUID->"550f58f9-c63d-41a1-9c27-59c986a5e98b",
 CellID->1502579979]
}, Closed]],
Cell[CellGroupData[{
Cell[15195, 430, 200, 2, 70, "Subsection",ExpressionUUID->"122e3a90-9ad1-4341-b3e2-23dbc405312c",
 CellID->1098261154],
Cell[15398, 434, 585, 13, 70, "ItemNumbered",ExpressionUUID->"ba483d47-0575-4ff4-9c65-407978ae942c",
 CellID->445655846],
Cell[CellGroupData[{
Cell[16008, 451, 574, 13, 70, "ItemNumbered",ExpressionUUID->"ca59c09c-0af9-406f-9135-37a77b7d961c",
 CellID->1862326633],
Cell[16585, 466, 333, 7, 70, "Input",ExpressionUUID->"58e27679-c5cd-45b3-9c0f-32b6cfd55bda",
 CellID->868002592]
}, Open  ]],
Cell[16933, 476, 289, 5, 70, "Text",ExpressionUUID->"78620602-e244-4950-b1cb-878ffc192733",
 CellID->949113300],
Cell[17225, 483, 369, 9, 70, "Input",ExpressionUUID->"d33e139c-e96b-4304-b319-e49f52a4e531",
 CellID->233169959],
Cell[17597, 494, 277, 6, 70, "Input",ExpressionUUID->"8b428502-3f34-4983-8b3c-138da2a6e05e",
 CellID->562748266]
}, Closed]],
Cell[CellGroupData[{
Cell[17911, 505, 169, 2, 70, "Subsection",ExpressionUUID->"7cb87888-eb53-4924-8f4b-ce647ad3ca30",
 CellID->235688213],
Cell[18083, 509, 306, 7, 70, "Input",ExpressionUUID->"56f2339d-634d-4322-9d25-d6cfd9fef58a",
 CellID->747514611]
}, Closed]],
Cell[CellGroupData[{
Cell[18426, 521, 181, 2, 70, "Subsection",ExpressionUUID->"bf2576e5-4264-41f0-b2dc-2c3860c2e5e9",
 CellID->1584101584],
Cell[18610, 525, 191, 2, 70, "Text",ExpressionUUID->"3993439f-d4b0-4197-8a61-c731f2a5d6af",
 CellID->1925764049],
Cell[18804, 529, 412, 8, 70, "Input",ExpressionUUID->"4acf60fe-45d4-4693-a3c0-82dd99ac537b",
 CellID->2142177653],
Cell[19219, 539, 212, 2, 70, "Text",ExpressionUUID->"d5a27c69-159c-44f3-b978-4aa1e7565ea9",
 CellID->451078633],
Cell[19434, 543, 1021, 27, 70, "Input",ExpressionUUID->"ada51f02-9087-4b2f-b0d4-36fd44a5b6c3",
 CellID->1892982628],
Cell[20458, 572, 283, 5, 70, "Text",ExpressionUUID->"33501bf9-c4d7-422a-b7aa-aeafc1716452",
 CellID->348538644],
Cell[20744, 579, 725, 18, 70, "Input",ExpressionUUID->"80916aeb-8ff9-4c33-b95b-b2206403e1f1",
 CellID->998938623],
Cell[21472, 599, 248, 5, 70, "Input",ExpressionUUID->"8c0977e4-e742-46f1-8348-f64cad932f5a",
 CellID->1445837757]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[21769, 610, 167, 2, 53, "Section",ExpressionUUID->"e61e4f1f-2ed0-42f1-8258-cbb4d7e6c464",
 CellID->532058193],
Cell[CellGroupData[{
Cell[21961, 616, 176, 2, 70, "Subsection",ExpressionUUID->"8b76f74d-73c1-4620-a7ad-edc641c13f8f",
 CellID->1081268205],
Cell[22140, 620, 213, 2, 70, "Item",ExpressionUUID->"cfb662b5-5548-482c-99ab-56547a94a551",
 CellID->1758715193],
Cell[22356, 624, 181, 2, 70, "Item",ExpressionUUID->"689e7301-1303-4870-9fec-6b93ce772177",
 CellID->920712980]
}, Closed]],
Cell[CellGroupData[{
Cell[22574, 631, 173, 2, 70, "Subsection",ExpressionUUID->"effbd40c-bcac-4e0b-863d-59ad4463fa84",
 CellID->1316731321],
Cell[22750, 635, 624, 8, 70, "Item",ExpressionUUID->"b09d687e-e1ab-4b97-8d74-4366ca6d5482",
 CellID->849148097]
}, Closed]],
Cell[CellGroupData[{
Cell[23411, 648, 176, 2, 70, "Subsection",ExpressionUUID->"0a46d035-c801-4e0e-b499-2c5664749b21",
 CellID->862852095],
Cell[23590, 652, 775, 15, 70, "Item",ExpressionUUID->"6655289a-7415-4abc-870b-06896c912a12",
 CellID->1797404841],
Cell[24368, 669, 708, 13, 70, "Item",ExpressionUUID->"5930e88a-ea0e-44d4-b961-d8c24c5ffeeb",
 CellID->281874570]
}, Closed]]
}, Closed]]
}, Open  ]]
}
]
*)

