(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    350627,       9401]
NotebookOptionsPosition[    317470,       8661]
NotebookOutlinePosition[    322951,       8804]
CellTagsIndexPosition[    322421,       8784]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Quantum Algorithms: Introduction", "Title",
 CellChangeTimes->{{3.81848277080221*^9, 3.818482778013246*^9}, {
  3.818621337257331*^9, 3.818621344827136*^9}, {3.8186783094240227`*^9, 
  3.818678314451894*^9}},ExpressionUUID->"b9269d85-53e8-4b1a-8e3e-\
227531db259b"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellEpilog:>Needs["QuantumWorkbook`Custom`"],
 CellChangeTimes->{{3.81862136736141*^9, 3.818621374064451*^9}, {
  3.823859231762335*^9, 3.823859238106399*^9}, {3.823917848999551*^9, 
  3.823917853066269*^9}, {3.82702872918224*^9, 3.827028729542859*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"461ddb1f-d118-47e8-96bb-6e4be8172a11"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellChangeTimes->{{3.8186213773725233`*^9, 3.8186213801841288`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"d69ce98c-fbd2-4f2c-9529-43b1fbb7afb1"],

Cell[BoxData[
 FormBox[GridBox[{
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"Quantum Teleportation\"\>", True->
       StyleBox["\<\"Quantum Teleportation\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookLocate["Section45"],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tNonlocality in Entanglement\"\>", True->
       
       StyleBox["\<\"\\tNonlocality in Entanglement\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookLocate["Section46"],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{
       False->"\<\"\\tImplementation of Quantum Teleportation\"\>", True->
       StyleBox["\<\"\\tImplementation of Quantum Teleportation\"\>", 
        "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookLocate["Section47"],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"Deutsch-Jozsa Algorithm\"\>", True->
       StyleBox["\<\"Deutsch-Jozsa Algorithm\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookLocate["Section48"],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tQuantum Oracle\"\>", True->
       StyleBox["\<\"\\tQuantum Oracle\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookLocate["Section49"],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tDeutsch-Jozsa Algorithm\"\>", True->
       StyleBox["\<\"\\tDeutsch-Jozsa Algorithm\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookLocate["Section50"],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tBernstein-Vazirani Algorithm\"\>", True->
       
       StyleBox["\<\"\\tBernstein-Vazirani Algorithm\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookLocate["Section51"],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tSimon\[CloseCurlyQuote]s Algorithm\"\>",
        True->
       StyleBox["\<\"\\tSimon\[CloseCurlyQuote]s Algorithm\"\>", 
        "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookLocate["Section52"],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"Quantum Fourier Transform\"\>", True->
       StyleBox["\<\"Quantum Fourier Transform\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookLocate["Section53"],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tDefinition and Physical Meaning\"\>", 
       True->
       StyleBox["\<\"\\tDefinition and Physical Meaning\"\>", 
        "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookLocate["Section54"],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tQuantum Implementation\"\>", True->
       StyleBox["\<\"\\tQuantum Implementation\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookLocate["Section55"],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tSemiclassical Implementation\"\>", True->
       
       StyleBox["\<\"\\tSemiclassical Implementation\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookLocate["Section56"],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"Quantum Phase Estimation\"\>", True->
       StyleBox["\<\"Quantum Phase Estimation\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookLocate["Section57"],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tDefinition\"\>", True->
       StyleBox["\<\"\\tDefinition\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookLocate["Section58"],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tImplementation\"\>", True->
       StyleBox["\<\"\\tImplementation\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookLocate["Section59"],
      Evaluator->Automatic,
      Method->"Preemptive"]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
  Column]], "Text",
 CellFrame->{{0, 0}, {0, 0.5}},
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellFrameColor->GrayLevel[0.7],
 CellTags->"TableOfContents",
 CellID->1286663326,ExpressionUUID->"f66ac599-f171-429f-9eef-3da3e73130b7"],

Cell[CellGroupData[{

Cell["Quantum Teleportation", "Section",
 CellChangeTimes->{{3.8186783639377327`*^9, 3.818678368336421*^9}},
 CellTags->"Section45",
 CellID->2095711634,ExpressionUUID->"3886c840-ec60-4cdc-b383-7657a1c495b8"],

Cell[CellGroupData[{

Cell["\<\
When one has access to both qubits, a SWAP gate for example is enough to send \
state from one qubit to the other.\
\>", "MathCaption",
 CellChangeTimes->{{3.823917879502029*^9, 
  3.8239179871483097`*^9}},ExpressionUUID->"8253e7cd-3585-427b-bcaf-\
270c233ab8b3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"LogicalForm", "[", 
       RowBox[{
        RowBox[{"Ket", "[", "]"}], ",", 
        RowBox[{"S", "[", "1", "]"}]}], "]"}], ",", 
      RowBox[{"ProductState", "[", 
       RowBox[{
        RowBox[{"S", "[", "2", "]"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"c", "[", "0", "]"}], ",", 
          RowBox[{"c", "[", "1", "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"SWAP", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"LogicalForm", "[", 
       RowBox[{
        RowBox[{"Ket", "[", "]"}], ",", 
        RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
      RowBox[{"ProductState", "[", 
       RowBox[{
        RowBox[{"S", "[", "1", "]"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"c", "[", "0", "]"}], ",", 
          RowBox[{"c", "[", "1", "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"\"\<PortSize\>\"", "\[Rule]", "2"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8206076890474*^9, 3.8206079872651443`*^9}, {
   3.8206080242428713`*^9, 3.8206081152380733`*^9}, {3.820623201937827*^9, 
   3.8206232198128242`*^9}, 3.823917873710122*^9, {3.823917999673588*^9, 
   3.823918011593699*^9}, {3.826341611003764*^9, 3.826341640825021*^9}, 
   3.829808701605588*^9},
 CellLabel->"In[25]:=",ExpressionUUID->"db0223f3-0f26-44f0-b237-b88ca9a274c7"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      RowBox[{
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], " ", 
        FormBox[
         SubscriptBox[
          TemplateBox[{"c"},
           "RowDefault"], 
          TemplateBox[{"0"},
           "RowDefault"]],
         TraditionalForm]}], "+", 
       RowBox[{
        TemplateBox[{"1"},
         "Ket"], " ", 
        FormBox[
         SubscriptBox[
          TemplateBox[{"c"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         TraditionalForm]}]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]]}, {
    LineBox[{{1, -1}, {1, -2}}], 
    LineBox[{{{0.91, -1.09}, {1.09, -0.91}}, {{0.91, -0.91}, {1.09, -1.09}}}],
     LineBox[{{{0.91, -2.09}, {1.09, -1.91}}, {{0.91, -1.91}, {
     1.09, -2.09}}}]}, {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {2.1, -2}, ImageScaled[{0, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      RowBox[{
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], " ", 
        FormBox[
         SubscriptBox[
          TemplateBox[{"c"},
           "RowDefault"], 
          TemplateBox[{"0"},
           "RowDefault"]],
         TraditionalForm]}], "+", 
       RowBox[{
        TemplateBox[{"1"},
         "Ket"], " ", 
        FormBox[
         SubscriptBox[
          TemplateBox[{"c"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         TraditionalForm]}]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {2.1, -1}, ImageScaled[{0, Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{72, 72}, {5, 5}},
  ImageSize->216,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.8239179890601254`*^9, 3.823918012350231*^9}, 
   3.8239441077294493`*^9, 3.824001204249385*^9, {3.826341584581862*^9, 
   3.826341643598193*^9}, 3.8298087125473433`*^9, 3.830132256722672*^9},
 CellLabel->"Out[26]=",
 CellID->381688254,ExpressionUUID->"076118ae-4da4-40bb-a1be-ea77df83a13e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"QuissoFactor", "@", 
   RowBox[{"ExpressionFor", "[", "qc", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8206076890474*^9, 3.8206079872651443`*^9}, {
   3.8206080242428713`*^9, 3.8206081152380733`*^9}, {3.820623201937827*^9, 
   3.8206232198128242`*^9}, 3.823917873710122*^9, 3.830132248287406*^9},
 CellLabel->"In[27]:=",ExpressionUUID->"d67a6af1-c5f4-43d2-b409-067f197dcd89"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   TagBox[
    RowBox[{
     RowBox[{
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"0"},
        "RowDefault"]], " ", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "+", 
     RowBox[{
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], " ", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}]}],
    HoldForm], ")"}], "\[CircleTimes]", 
  TagBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"],
   HoldForm]}]], "Output",
 CellChangeTimes->{
  3.820607716795273*^9, {3.820607790890019*^9, 3.820607987774851*^9}, {
   3.8206080332335577`*^9, 3.8206081156961737`*^9}, {3.820623184007908*^9, 
   3.820623220293353*^9}, {3.820623311293703*^9, 3.8206233207623663`*^9}, 
   3.820623522467767*^9, 3.823859241484501*^9, {3.823917992610868*^9, 
   3.823918013850889*^9}, 3.82394410892616*^9, 3.8240012051595297`*^9, 
   3.826341584626802*^9, 3.8263416443558483`*^9, 3.829808713872015*^9, 
   3.830132259051464*^9},
 CellLabel->"Out[27]=",
 CellID->908401257,ExpressionUUID->"e2d2b0d1-e8ad-4f0f-95dc-d3c3811e86c1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Nonlocality in Entanglement", "Subsection",
 CellChangeTimes->{{3.8206086868863983`*^9, 3.820608701555379*^9}, {
  3.820608752797825*^9, 3.820608760828293*^9}},
 CellTags->"Section46",
 CellID->1746138191,ExpressionUUID->"35a44857-9ee4-4e9a-8a3a-5b79ccff192d"],

Cell[CellGroupData[{

Cell["This is an entangler quantum circuit.", "MathCaption",
 CellChangeTimes->{{3.823918066225876*^9, 
  3.823918085103017*^9}},ExpressionUUID->"3a9f9482-813e-4fa8-9668-\
8c5dac04f70f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8196810214112263`*^9, 3.8196810932465467`*^9}, {
   3.819681663311687*^9, 3.8196816889377003`*^9}, {3.819682435416142*^9, 
   3.81968245528093*^9}, {3.819947891387398*^9, 3.8199479315921392`*^9}, {
   3.82062337224579*^9, 3.820623378184033*^9}, {3.82391804733279*^9, 
   3.823918051949298*^9}, {3.823918181628296*^9, 3.823918194621209*^9}, 
   3.826341651861103*^9, 3.82980870160754*^9},
 CellLabel->"In[28]:=",ExpressionUUID->"3cf3fcd2-d078-4c71-8a92-674a346c6bc1"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.10666666666666667`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.10666666666666667`],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.823918186311542*^9, 3.8239181965330267`*^9}, 
   3.8239441110613623`*^9, 3.824001207239872*^9, 3.8263415846646643`*^9, 
   3.826341652216069*^9, 3.82980871884466*^9, 3.8301322614863863`*^9},
 CellLabel->"Out[28]=",
 CellID->2001267736,ExpressionUUID->"4a9b6509-a673-48f3-97f8-7707557a70b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{"ExpressionFor", "[", "qc", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"vec", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.8196810214112263`*^9, 3.8196810932465467`*^9}, {
   3.819681663311687*^9, 3.8196816889377003`*^9}, {3.819682435416142*^9, 
   3.81968245528093*^9}, {3.819947891387398*^9, 3.8199479315921392`*^9}, {
   3.82062337224579*^9, 3.820623378184033*^9}, 3.82391804733279*^9, 
   3.830132248288884*^9},
 CellLabel->"In[29]:=",ExpressionUUID->"1cd7be62-287b-4b9a-a4da-32b541e752f3"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   SqrtBox["2"]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   SqrtBox["2"]]}]], "Output",
 CellChangeTimes->{{3.819947918754657*^9, 3.8199479446869717`*^9}, 
   3.819948323029711*^9, {3.820623322585906*^9, 3.820623333369824*^9}, {
   3.8206233730993223`*^9, 3.82062337844249*^9}, {3.820623524432777*^9, 
   3.8206235277249327`*^9}, 3.820623563747868*^9, 3.823918087444934*^9, 
   3.82391816571317*^9, 3.82391819735709*^9, 3.8239441121267567`*^9, 
   3.824001208058538*^9, 3.826341584706069*^9, 3.826341653752843*^9, 
   3.8298087198946667`*^9, 3.830132262352303*^9},
 CellLabel->"Out[30]=",
 CellID->66199179,ExpressionUUID->"abd0c284-6d7a-4187-b18d-6f47fb9ee5bc"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["This is a quantum circuit model for the Bel measurement.", "MathCaption",
 CellChangeTimes->{{3.823918479233938*^9, 
  3.823918495726202*^9}},ExpressionUUID->"dc115596-55cc-4aaa-933d-\
90a60121dc70"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"qc", ",", "\"\<Spacer\>\"", ",", 
    RowBox[{"Measurement", "@", 
     RowBox[{"S", "[", "2", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.81994832716678*^9, 3.819948376629531*^9}, {
   3.823918135901305*^9, 3.8239181776224823`*^9}, {3.823918225439268*^9, 
   3.8239182401835203`*^9}, 3.826341658126906*^9, 3.82980870160902*^9},
 CellLabel->"In[31]:=",ExpressionUUID->"41955f4b-3b09-41f4-83a8-90ac145fa2a8"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{{{4, -2}, {5, -2}}}]}, 
   LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {4, -2}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, 
    CircleBox[{4, -2.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{4, -2.2}, {4.24, -1.76}}]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->226.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.823918160837358*^9, 3.823918240509852*^9}, 
   3.824001209198943*^9, 3.8263415847428913`*^9, 3.826341658482609*^9, 
   3.8298087214283037`*^9, 3.830132263818049*^9},
 CellLabel->"Out[31]=",
 CellID->781758209,ExpressionUUID->"3b3ebf6b-da5f-4826-a6bb-db65567dbc01"]
}, Open  ]],

Cell["This shows that the measurement outcome is just random.", "Text",
 CellChangeTimes->{{3.82391860206037*^9, 
  3.823918636171028*^9}},ExpressionUUID->"542e65b5-34bc-494c-9716-\
43f33e9576e5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"val", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"out", "=", 
       RowBox[{
        RowBox[{"Elaborate", "[", "qc2", "]"}], "//", "Garner"}]}], ";", 
      RowBox[{"Readout", "[", 
       RowBox[{"out", ",", 
        RowBox[{"S", "[", "2", "]"}]}], "]"}]}], ",", 
     RowBox[{"{", "200", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", 
  RowBox[{"val", ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Measurement Readout\>\"", ",", "\"\<Counts\>\""}], "}"}]}], 
   ",", 
   RowBox[{"ImageSize", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", "Automatic"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.757833819085938*^9, 3.757833878367415*^9}, {
  3.75783415356551*^9, 3.757834157691675*^9}, {3.7578341980203867`*^9, 
  3.757834204277904*^9}, {3.757978993308991*^9, 3.757979003319545*^9}, {
  3.813354967009922*^9, 3.8133549951892223`*^9}, {3.813355032752533*^9, 
  3.813355060211356*^9}, {3.817791789367127*^9, 3.81779179920787*^9}, {
  3.819948432583926*^9, 3.8199484749712477`*^9}, {3.819948520645576*^9, 
  3.819948545391061*^9}, {3.819948579186079*^9, 3.819948582133692*^9}, {
  3.8199486296184587`*^9, 3.81994868359206*^9}, {3.823918498494471*^9, 
  3.823918509822711*^9}, {3.82980873429081*^9, 3.829808735246167*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"6f49f58c-e127-441c-853b-e72267b401b9"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
    Opacity[0.6719999999999999], Thickness[Small]}], {}, 
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
     Opacity[0.6719999999999999], Thickness[Small]}], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{-0.5, 0}, {0.5, 88.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{46.7375, 199.}, {-72.55802931762061, 
           79.21185940559137}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 88]& ,
        TagBoxNote->"88"],
       StyleBox["88", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[88, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{0.5, 0}, {1.5, 112.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{198.5, 
           350.76250000000005`}, {-113.81345351486026`, 79.21185940559137}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 112]& ,
        TagBoxNote->"112"],
       StyleBox["112", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[112, {}], "Tooltip"]& ]}, {}, {}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{-0.54, 0},
  AxesStyle->Large,
  Frame->True,
  FrameLabel->{{
     FormBox["\"Counts\"", TraditionalForm], None}, {
     FormBox["\"Measurement Readout\"", TraditionalForm], None}},
  FrameStyle->Automatic,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Automatic,
  PlotRange->{{-0.5, 1.5}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {None, 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.8199486752748938`*^9, 3.819948685560647*^9}, {
   3.820623569309709*^9, 3.820623580507407*^9}, 3.824001212214183*^9, 
   3.826341586278706*^9, 3.826341668685219*^9, 3.829808737040464*^9, 
   3.830132267716689*^9},
 CellLabel->"Out[33]=",
 CellID->1541609768,ExpressionUUID->"61967fab-a884-40a9-b06b-3e774594e491"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Here Alice -- possessing the first qubit -- measures her qubit before Bob \
measures his qubit.\
\>", "MathCaption",
 CellChangeTimes->{{3.82391866282165*^9, 
  3.823918721939959*^9}},ExpressionUUID->"877b7a67-7b67-4bc3-b690-\
9148b574f47e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc3", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"qc", ",", "\"\<Spacer\>\"", ",", 
    RowBox[{"Measurement", "@", 
     RowBox[{"S", "[", "1", "]"}]}], ",", "\"\<Separator\>\"", ",", 
    RowBox[{"Measurement", "@", 
     RowBox[{"S", "[", "2", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.81994832716678*^9, 3.819948376629531*^9}, {
   3.81994887421369*^9, 3.8199489041027803`*^9}, {3.823918656965748*^9, 
   3.8239186607296333`*^9}, 3.826341674247471*^9, 3.829808701620606*^9},
 CellLabel->"In[34]:=",ExpressionUUID->"98c9ed68-3059-4b85-99b9-3ac9c69e552a"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{4, -1}, {7, -1}}, {{6, -2}, {7, -2}}}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {6, -2}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.045714285714285714`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.045714285714285714`],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05714285714285714],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, 
    CircleBox[{4, -1.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{4, -1.2}, {4.24, -0.76}}]}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{5, Rational[-5, 2]}, {5, Rational[-1, 2]}}, {{5, -2.5}, {
       5, -0.5}}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, 
    CircleBox[{6, -2.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{6, -2.2}, {6.24, -1.76}}]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->298.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.819948892325859*^9, 3.819948916492695*^9}, 
   3.820623581887166*^9, 3.8239187236653223`*^9, 3.824001216031522*^9, 
   3.826341586384729*^9, 3.82634167457677*^9, 3.8298087412471123`*^9, 
   3.830132269673972*^9},
 CellLabel->"Out[34]=",
 CellID->569029721,ExpressionUUID->"0b0dad92-9438-4cab-ab9f-005f09b5f323"]
}, Open  ]],

Cell["\<\
This illustrates that Bob\[CloseCurlyQuote]s measurement results are affected \
by Alice measurement.\
\>", "Text",
 CellChangeTimes->{{3.8239187447558928`*^9, 
  3.8239187755691833`*^9}},ExpressionUUID->"fce603a3-39c5-4781-9594-\
8cd35c1a6302"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"val", "=", 
   RowBox[{"Boole", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"out", "=", 
        RowBox[{
         RowBox[{"Elaborate", "[", "qc2", "]"}], "//", "Garner"}]}], ";", 
       RowBox[{"Equal", "@@", 
        RowBox[{"Readout", "[", 
         RowBox[{"out", ",", 
          RowBox[{"S", "@", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}]}], ",", 
      RowBox[{"{", "200", "}"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", 
  RowBox[{"val", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.5"}], ",", "1.5", ",", "1"}], "}"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Bob's readout equal to Alice's\>\"", ",", "\"\<Counts\>\""}], 
     "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", "Automatic"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.757833819085938*^9, 3.757833878367415*^9}, {
   3.75783415356551*^9, 3.757834157691675*^9}, {3.7578341980203867`*^9, 
   3.757834204277904*^9}, {3.757978993308991*^9, 3.757979003319545*^9}, {
   3.813354967009922*^9, 3.8133549951892223`*^9}, {3.813355032752533*^9, 
   3.813355060211356*^9}, {3.817791789367127*^9, 3.81779179920787*^9}, {
   3.819948432583926*^9, 3.8199484749712477`*^9}, {3.819948520645576*^9, 
   3.819948545391061*^9}, {3.819948579186079*^9, 3.819948582133692*^9}, {
   3.8199486296184587`*^9, 3.81994868359206*^9}, {3.8199489332614326`*^9, 
   3.819948987708858*^9}, {3.819949104151166*^9, 3.819949106147994*^9}, 
   3.819949150453641*^9, {3.8199492007038383`*^9, 3.819949270765074*^9}, {
   3.8239187285897493`*^9, 3.823918741132864*^9}, {3.8298087474534883`*^9, 
   3.8298087505345573`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"11671a1e-7fdb-4f7d-a1af-4a9a4f40d956"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
    Opacity[0.6719999999999999], Thickness[Small]}], {}, 
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
     Opacity[0.6719999999999999], Thickness[Small]}], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{0.5, 0}, {1.5, 200.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{198.50000000000003`, 
           350.76250000000005`}, {-113.74999999999999`, 79.27531292045161}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 200]& ,
        TagBoxNote->"200"],
       StyleBox["200", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[200, {}], "Tooltip"]& ]}, {}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{-0.54, 0},
  AxesStyle->Large,
  Frame->True,
  FrameLabel->{{
     FormBox["\"Counts\"", TraditionalForm], None}, {
     FormBox["\"Bob's readout equal to Alice's\"", TraditionalForm], None}},
  FrameStyle->Automatic,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Automatic,
  PlotRange->{{-0.5, 1.5}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {None, 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.819949002460515*^9, 3.8199490633283978`*^9, {3.819949096284566*^9, 
   3.8199491151640863`*^9}, {3.819949272815937*^9, 3.819949277235587*^9}, 
   3.820623589659492*^9, 3.824001218800576*^9, 3.826341587819272*^9, 
   3.826341679533002*^9, 3.829808752404788*^9, 3.8301322787578697`*^9},
 CellLabel->"Out[36]=",
 CellID->621718415,ExpressionUUID->"4279bfce-8535-4b7d-81e4-4ac7c33989e2"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Implementation of Quantum Teleportation", "Subsection",
 CellChangeTimes->{{3.820608834883165*^9, 3.820608846953576*^9}},
 CellTags->"Section47",
 CellID->1980539882,ExpressionUUID->"44fd6f9e-cfc5-46eb-aa98-4c5faf2af388"],

Cell[CellGroupData[{

Cell["\<\
Here is a simulation of the quantum teleportation protocol using Q3. \
\>", "MathCaption",
 CellChangeTimes->{{3.820610713071062*^9, 3.820610737775258*^9}, {
  3.828484327556226*^9, 
  3.828484348324554*^9}},ExpressionUUID->"20ec431c-c846-45f3-90fa-\
8cbdd5f934ba"],

Cell["\<\
The initial state of the total system at the beginning of the protocol.\
\>", "Text",
 CellChangeTimes->{{3.820610713071062*^9, 3.820610737775258*^9}, {
  3.828484327556226*^9, 3.828484344080509*^9}},
 CellID->89151289,ExpressionUUID->"aabd563e-2e41-4f82-b262-3ee4c5268142"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "\[Psi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Ket", "[", "]"}], 
     RowBox[{"\[Psi]", "[", "0", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{
       RowBox[{"S", "[", "3", "]"}], "\[Rule]", "1"}], "]"}], 
     RowBox[{"\[Psi]", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"vec", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.820610480532551*^9, 3.8206105892914343`*^9}, {
   3.820610688412643*^9, 3.82061069020115*^9}, {3.820610907904666*^9, 
   3.820610909164497*^9}, {3.820625697863352*^9, 3.820625703093348*^9}, 
   3.824001232111161*^9},
 CellLabel->"In[37]:=",ExpressionUUID->"56c1fb4d-55b6-4edd-a586-5941bf77075c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], " ", 
   SubscriptBox[
    TemplateBox[{"\[Psi]"},
     "RowDefault"], 
    TemplateBox[{"0"},
     "RowDefault"]]}], "+", 
  RowBox[{
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], " ", 
   SubscriptBox[
    TemplateBox[{"\[Psi]"},
     "RowDefault"], 
    TemplateBox[{"1"},
     "RowDefault"]]}]}]], "Output",
 CellChangeTimes->{3.824001233703411*^9, 3.826341587869145*^9, 
  3.826341683225895*^9, 3.828484355415997*^9, 3.830132356510376*^9},
 CellLabel->"Out[39]=",
 CellID->500133707,ExpressionUUID->"13970fac-e856-40b1-92e2-0806120074de"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"tot", "=", 
   RowBox[{
    RowBox[{"BellState", "[", 
     RowBox[{
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"0", ",", "2"}], "}"}]}], ",", "0"}], "]"}], "**", "vec"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"tot", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.820610480532551*^9, 3.8206105892914343`*^9}, {
   3.820610688412643*^9, 3.82061069020115*^9}, {3.820610907904666*^9, 
   3.820610909164497*^9}, {3.820625697863352*^9, 3.820625703093348*^9}, 
   3.824001232111161*^9},
 CellLabel->"In[40]:=",ExpressionUUID->"034c6148-eb2c-443f-a21a-f2a06afb16ab"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"0"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], " ", 
    SubscriptBox[
     TemplateBox[{"\[Psi]"},
      "RowDefault"], 
     TemplateBox[{"0"},
      "RowDefault"]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"0"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], " ", 
    SubscriptBox[
     TemplateBox[{"\[Psi]"},
      "RowDefault"], 
     TemplateBox[{"0"},
      "RowDefault"]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"0"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], " ", 
    SubscriptBox[
     TemplateBox[{"\[Psi]"},
      "RowDefault"], 
     TemplateBox[{"1"},
      "RowDefault"]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"0"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], " ", 
    SubscriptBox[
     TemplateBox[{"\[Psi]"},
      "RowDefault"], 
     TemplateBox[{"1"},
      "RowDefault"]]}], 
   SqrtBox["2"]]}]], "Output",
 CellChangeTimes->{{3.820610570336235*^9, 3.82061059382568*^9}, {
   3.820610690686666*^9, 3.82061070336735*^9}, 3.820610739183467*^9, 
   3.8206109096088133`*^9, 3.820615705478013*^9, 3.820615824044629*^9, 
   3.820623591824802*^9, {3.820625706456706*^9, 3.8206257260325727`*^9}, 
   3.8239190904247093`*^9, 3.823919278469183*^9, {3.824001225634192*^9, 
   3.824001234691008*^9}, 3.826341587904613*^9, 3.826341684313527*^9, 
   3.828484356347959*^9, 3.830132357441215*^9},
 CellLabel->"Out[41]=",
 CellID->891414619,ExpressionUUID->"84646416-0db6-422f-864f-5be73e328b3a"]
}, Open  ]],

Cell[TextData[{
 "The total state is rewritten in the Bell basis for qubits ",
 StyleBox["S[2,None]", "Input"],
 " and ",
 StyleBox["S[3,None]", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.8206104279852667`*^9, 3.82061043383187*^9}, {
  3.820615728986845*^9, 
  3.8206157948071117`*^9}},ExpressionUUID->"5e2ff89d-fc0e-4362-b128-\
78c644cf3812"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"BellState", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prj", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Dyad", "[", 
      RowBox[{"#", ",", "#"}], "]"}], "&"}], "/@", "bs"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QuissoFactor", "/@", 
   RowBox[{"(", 
    RowBox[{"prj", "**", "tot"}], ")"}]}], "//", 
  "TableForm"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8206104366685553`*^9, 3.820610468402416*^9}, {
  3.820610613219509*^9, 3.820610645056326*^9}, {3.820615722418232*^9, 
  3.82061572313405*^9}, {3.823919082044626*^9, 3.823919084875095*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"3dd3cde4-82f6-4c9a-ac6b-fd1635c2d802"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         TagBox[
          RowBox[{
           TemplateBox[{
             TagBox[
              TemplateBox[{
                SubscriptBox["0", 
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"2"}, "RowDefault"]]], 
                SubscriptBox["0", 
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
              DisplayForm]},
            "Ket"], "+", 
           TemplateBox[{
             TagBox[
              TemplateBox[{
                SubscriptBox["1", 
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"2"}, "RowDefault"]]], 
                SubscriptBox["1", 
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
              DisplayForm]},
            "Ket"]}],
          HoldForm], ")"}], "\[CircleTimes]", 
        RowBox[{"(", 
         TagBox[
          RowBox[{
           RowBox[{
            TemplateBox[{
              TagBox[
               TemplateBox[{
                 SubscriptBox["0", 
                  SubscriptBox[
                   TemplateBox[{"S"}, "RowDefault"], 
                   TemplateBox[{"0"}, "RowDefault"]]]}, "RowDefault"], 
               DisplayForm]},
             "Ket"], " ", 
            SubscriptBox[
             TemplateBox[{"\[Psi]"},
              "RowDefault"], 
             TemplateBox[{"0"},
              "RowDefault"]]}], "+", 
           RowBox[{
            TemplateBox[{
              TagBox[
               TemplateBox[{
                 SubscriptBox["1", 
                  SubscriptBox[
                   TemplateBox[{"S"}, "RowDefault"], 
                   TemplateBox[{"0"}, "RowDefault"]]]}, "RowDefault"], 
               DisplayForm]},
             "Ket"], " ", 
            SubscriptBox[
             TemplateBox[{"\[Psi]"},
              "RowDefault"], 
             TemplateBox[{"1"},
              "RowDefault"]]}]}],
          HoldForm], ")"}]}], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         TagBox[
          RowBox[{
           TemplateBox[{
             TagBox[
              TemplateBox[{
                SubscriptBox["0", 
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"2"}, "RowDefault"]]], 
                SubscriptBox["1", 
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
              DisplayForm]},
            "Ket"], "+", 
           TemplateBox[{
             TagBox[
              TemplateBox[{
                SubscriptBox["1", 
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"2"}, "RowDefault"]]], 
                SubscriptBox["0", 
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
              DisplayForm]},
            "Ket"]}],
          HoldForm], ")"}], "\[CircleTimes]", 
        RowBox[{"(", 
         TagBox[
          RowBox[{
           RowBox[{
            TemplateBox[{
              TagBox[
               TemplateBox[{
                 SubscriptBox["1", 
                  SubscriptBox[
                   TemplateBox[{"S"}, "RowDefault"], 
                   TemplateBox[{"0"}, "RowDefault"]]]}, "RowDefault"], 
               DisplayForm]},
             "Ket"], " ", 
            SubscriptBox[
             TemplateBox[{"\[Psi]"},
              "RowDefault"], 
             TemplateBox[{"0"},
              "RowDefault"]]}], "+", 
           RowBox[{
            TemplateBox[{
              TagBox[
               TemplateBox[{
                 SubscriptBox["0", 
                  SubscriptBox[
                   TemplateBox[{"S"}, "RowDefault"], 
                   TemplateBox[{"0"}, "RowDefault"]]]}, "RowDefault"], 
               DisplayForm]},
             "Ket"], " ", 
            SubscriptBox[
             TemplateBox[{"\[Psi]"},
              "RowDefault"], 
             TemplateBox[{"1"},
              "RowDefault"]]}]}],
          HoldForm], ")"}]}], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         TagBox[
          RowBox[{
           RowBox[{"-", 
            TemplateBox[{
              TagBox[
               TemplateBox[{
                 SubscriptBox["0", 
                  SubscriptBox[
                   TemplateBox[{"S"}, "RowDefault"], 
                   TemplateBox[{"2"}, "RowDefault"]]], 
                 SubscriptBox["1", 
                  SubscriptBox[
                   TemplateBox[{"S"}, "RowDefault"], 
                   TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
               DisplayForm]},
             "Ket"]}], "+", 
           TemplateBox[{
             TagBox[
              TemplateBox[{
                SubscriptBox["1", 
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"2"}, "RowDefault"]]], 
                SubscriptBox["0", 
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
              DisplayForm]},
            "Ket"]}],
          HoldForm], ")"}], "\[CircleTimes]", 
        RowBox[{"(", 
         TagBox[
          RowBox[{
           RowBox[{
            TemplateBox[{
              TagBox[
               TemplateBox[{
                 SubscriptBox["1", 
                  SubscriptBox[
                   TemplateBox[{"S"}, "RowDefault"], 
                   TemplateBox[{"0"}, "RowDefault"]]]}, "RowDefault"], 
               DisplayForm]},
             "Ket"], " ", 
            SubscriptBox[
             TemplateBox[{"\[Psi]"},
              "RowDefault"], 
             TemplateBox[{"0"},
              "RowDefault"]]}], "-", 
           RowBox[{
            TemplateBox[{
              TagBox[
               TemplateBox[{
                 SubscriptBox["0", 
                  SubscriptBox[
                   TemplateBox[{"S"}, "RowDefault"], 
                   TemplateBox[{"0"}, "RowDefault"]]]}, "RowDefault"], 
               DisplayForm]},
             "Ket"], " ", 
            SubscriptBox[
             TemplateBox[{"\[Psi]"},
              "RowDefault"], 
             TemplateBox[{"1"},
              "RowDefault"]]}]}],
          HoldForm], ")"}]}], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         TagBox[
          RowBox[{
           TemplateBox[{
             TagBox[
              TemplateBox[{
                SubscriptBox["0", 
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"2"}, "RowDefault"]]], 
                SubscriptBox["0", 
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
              DisplayForm]},
            "Ket"], "-", 
           TemplateBox[{
             TagBox[
              TemplateBox[{
                SubscriptBox["1", 
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"2"}, "RowDefault"]]], 
                SubscriptBox["1", 
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
              DisplayForm]},
            "Ket"]}],
          HoldForm], ")"}], "\[CircleTimes]", 
        RowBox[{"(", 
         TagBox[
          RowBox[{
           RowBox[{
            TemplateBox[{
              TagBox[
               TemplateBox[{
                 SubscriptBox["0", 
                  SubscriptBox[
                   TemplateBox[{"S"}, "RowDefault"], 
                   TemplateBox[{"0"}, "RowDefault"]]]}, "RowDefault"], 
               DisplayForm]},
             "Ket"], " ", 
            SubscriptBox[
             TemplateBox[{"\[Psi]"},
              "RowDefault"], 
             TemplateBox[{"0"},
              "RowDefault"]]}], "-", 
           RowBox[{
            TemplateBox[{
              TagBox[
               TemplateBox[{
                 SubscriptBox["1", 
                  SubscriptBox[
                   TemplateBox[{"S"}, "RowDefault"], 
                   TemplateBox[{"0"}, "RowDefault"]]]}, "RowDefault"], 
               DisplayForm]},
             "Ket"], " ", 
            SubscriptBox[
             TemplateBox[{"\[Psi]"},
              "RowDefault"], 
             TemplateBox[{"1"},
              "RowDefault"]]}]}],
          HoldForm], ")"}]}], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.820610449183913*^9, 3.8206104686370077`*^9}, {
   3.820610629454199*^9, 3.820610639557543*^9}, 3.820610755908063*^9, {
   3.820615710520041*^9, 3.820615723956667*^9}, {3.820615817580792*^9, 
   3.8206158254009657`*^9}, 3.8206235943219223`*^9, {3.820625716539257*^9, 
   3.82062572742437*^9}, {3.8239190860745792`*^9, 3.823919092746128*^9}, 
   3.823919279814774*^9, {3.824001227303564*^9, 3.824001240338683*^9}, 
   3.826341587976707*^9, 3.826341686084917*^9, 3.828484357669713*^9, 
   3.8301323589373198`*^9},
 CellLabel->"Out[44]//TableForm=",
 CellID->625629734,ExpressionUUID->"503ec5f7-bee3-44be-89b5-5cf075552b97"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Step 1",
  FontWeight->"Bold"],
 ". Alice and Bob generates an entangled pair. Bob prepares a quantum state \
in a separate qubit."
}], "Text",
 CellChangeTimes->{{3.819680984754881*^9, 3.8196810170880117`*^9}, {
  3.8196811189854107`*^9, 3.81968112643225*^9}, {3.8206088020020533`*^9, 
  3.8206088110006123`*^9}, {3.820614184429797*^9, 
  3.820614232498385*^9}},ExpressionUUID->"5377a36f-9701-43c7-9b69-\
092ef0195e08"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}]}]}], "]"}], ",", 
    RowBox[{"ProductState", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "[", "4", "]"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Psi]", "[", "0", "]"}], ",", 
         RowBox[{"\[Psi]", "[", "1", "]"}]}], "}"}]}], ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", 
       RowBox[{"Ket", "[", "\[Psi]", "]"}]}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", "\"\<Separator\>\"", ",", 
    RowBox[{"\"\<Invisible\>\"", "\[Rule]", 
     RowBox[{"S", "[", "2", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8196810214112263`*^9, 3.8196810932465467`*^9}, {
   3.819681663311687*^9, 3.8196816889377003`*^9}, {3.819682435416142*^9, 
   3.81968245528093*^9}, {3.8206142371789207`*^9, 3.820614322594985*^9}, {
   3.820623601256412*^9, 3.820623607537077*^9}, {3.8206257324889603`*^9, 
   3.820625811403986*^9}, {3.8238593163038597`*^9, 3.823859344954926*^9}, {
   3.823859382889353*^9, 3.823859386803042*^9}, {3.823859437629483*^9, 
   3.823859461713778*^9}, 3.826341694159404*^9, 3.829808701655698*^9},
 CellLabel->"In[45]:=",ExpressionUUID->"405f8952-b853-4831-ae4e-525ecd8ddd34"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -3}, {4, -3}}, {{0, -4}, {
    4, -4}}}], {{InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]]}, 
    InsetBox[
     StyleBox[
      TemplateBox[{"\[Psi]"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -3}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
        2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{3, Rational[-9, 2]}, {3, Rational[-1, 2]}}, {{3, -4.5}, {
       3, -0.5}}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.8206143229921923`*^9, 3.8206143279967012`*^9}, 
   3.8206158273651257`*^9, {3.8206235963955812`*^9, 3.820623610379974*^9}, {
   3.8206257513203382`*^9, 3.820625764600428*^9}, {3.820625808191299*^9, 
   3.820625819227428*^9}, {3.823859317088916*^9, 3.82385934543661*^9}, {
   3.823859387153483*^9, 3.82385940347917*^9}, {3.8238594411538258`*^9, 
   3.8238594637124233`*^9}, 3.823919281122294*^9, 3.8240012418006268`*^9, 
   3.8263415880201263`*^9, {3.826341688512888*^9, 3.8263416945027246`*^9}, 
   3.826341791670527*^9, 3.826342387924938*^9, 3.828484361416594*^9, 
   3.83013236056247*^9},
 CellLabel->"Out[45]=",
 CellID->1564287566,ExpressionUUID->"2cc6143d-95f0-4693-bde4-a359e1e678a7"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Step 2",
  FontWeight->"Bold"],
 ". Bob performs a Bell measurement on his qubits. This can be done by \
reversing the entangler circuit."
}], "Text",
 CellChangeTimes->{{3.819681716329297*^9, 3.819681776783428*^9}, {
  3.8206143365215282`*^9, 
  3.820614379572941*^9}},ExpressionUUID->"81ae4a7a-4bd8-4df8-bec8-\
e16f3b69febb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"qc2a", "=", 
   RowBox[{"QuantumCircuit", "[", 
    RowBox[{
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{"S", "[", "3", "]"}], ",", 
       RowBox[{"S", "[", "4", "]"}]}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"3", ",", "6"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ExpressionFor", "[", "qc2a", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"BellState", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ls", "=", 
   RowBox[{"op", "**", "bs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LogicalForm", "@", 
   RowBox[{"Transpose", "@", 
    RowBox[{"Thread", "[", 
     RowBox[{"bs", "\[Rule]", "ls"}], "]"}]}]}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.81968178550368*^9, 3.819681868927196*^9}, {
   3.820614403826923*^9, 3.8206145037436533`*^9}, {3.820614552780044*^9, 
   3.820614557245816*^9}, {3.820614587507839*^9, 3.8206145917035103`*^9}, {
   3.820614643630529*^9, 3.820614732320513*^9}, {3.8206147934945927`*^9, 
   3.8206148073304987`*^9}, {3.8206148448477497`*^9, 3.820614868359404*^9}, {
   3.820614916877695*^9, 3.820614937947359*^9}, {3.820623679011879*^9, 
   3.820623682757235*^9}, {3.820625826197987*^9, 3.820625856447442*^9}, {
   3.820626147068818*^9, 3.820626155211606*^9}, 3.820626190030142*^9, {
   3.823859255735791*^9, 3.823859259705635*^9}, 3.823859292252767*^9, {
   3.823859485776475*^9, 3.8238594883638763`*^9}, 3.829808701663891*^9, 
   3.830132248332259*^9},
 CellLabel->"In[46]:=",ExpressionUUID->"6ce1e810-3eac-4926-a097-24db81f269cf"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       FractionBox[
        RowBox[{
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"3"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], "+", 
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"3"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"]}], 
        SqrtBox["2"]], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"3"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], "+", 
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"3"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"]}], 
        SqrtBox["2"]], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"3"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], "-", 
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"3"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"]}], 
        SqrtBox["2"]], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"3"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], "-", 
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"3"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"]}], 
        SqrtBox["2"]], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8238592941500597`*^9, 3.823859299273356*^9}, {
   3.82385936202118*^9, 3.823859372737845*^9}, {3.823859473848755*^9, 
   3.823859488887245*^9}, 3.823919282804644*^9, 3.8240012434420013`*^9, 
   3.826341588071189*^9, 3.826341698475767*^9, 3.82634238946891*^9, 
   3.828484362800097*^9, 3.8301323620509033`*^9},
 CellLabel->"Out[50]//TableForm=",
 CellID->598508531,ExpressionUUID->"9a4f7a64-ce9d-4a73-a856-95f1fd7867d8"]
}, Open  ]],

Cell["This is the corresponding quantum circuit model.", "Text",
 CellChangeTimes->{{3.823919185675393*^9, 
  3.8239192073867893`*^9}},ExpressionUUID->"9afda341-25b0-48c4-b566-\
5e947d183f57"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"\"\<Separator\>\"", ",", "qc2a", ",", 
    RowBox[{"Measurement", "@", 
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"3", ",", "4"}], "}"}]}]}], ",", 
    RowBox[{"\"\<Visible\>\"", "\[Rule]", 
     RowBox[{"S", "[", "1", "]"}]}], ",", 
    RowBox[{"\"\<Invisible\>\"", "\[Rule]", 
     RowBox[{"S", "[", "2", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.81968178550368*^9, 3.819681868927196*^9}, {
   3.820614403826923*^9, 3.8206145037436533`*^9}, {3.820614552780044*^9, 
   3.820614557245816*^9}, {3.820614587507839*^9, 3.8206145917035103`*^9}, {
   3.820614643630529*^9, 3.820614732320513*^9}, {3.8206147934945927`*^9, 
   3.8206148073304987`*^9}, {3.8206148448477497`*^9, 3.820614868359404*^9}, {
   3.820614916877695*^9, 3.820614937947359*^9}, {3.820623679011879*^9, 
   3.820623682757235*^9}, {3.820625826197987*^9, 3.820625856447442*^9}, {
   3.820626147068818*^9, 3.820626155211606*^9}, 3.820626190030142*^9, {
   3.823859255735791*^9, 3.823859259705635*^9}, 3.823859292252767*^9, 
   3.823859356487089*^9, 3.823859493606247*^9, {3.823919213541272*^9, 
   3.823919217951315*^9}, {3.826341702855031*^9, 3.826341703247864*^9}, 
   3.8298087016760902`*^9},
 CellLabel->"In[51]:=",ExpressionUUID->"4d7ec85a-14c6-4605-a3ca-e7ef18a8f5be"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{4, -3}, {5, -3}}, {{4, -4}, {5, -4}}}]}, 
   LineBox[{{{0, -1}, {5, -1}}, {{0, -3}, {4, -3}}, {{0, -4}, {4, -4}}}], 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{1, Rational[-9, 2]}, {1, Rational[-1, 2]}}, {{1, -4.5}, {
       1, -0.5}}]]}, {LineBox[{{2, -3}, {2, -4}}], 
    DiskBox[{2, -3}, 0.09], {CircleBox[{2, -4}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -4}, {2.2666666666666666`, -4}}, {{
        2, -4.266666666666667}, {2, -3.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light",
      FontSlant->Italic], {3, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, 
     CircleBox[{4, -3.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -3.2}, {4.24, -2.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, 
     CircleBox[{4, -4.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -4.2}, {4.24, -3.76}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->226.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.819681789935841*^9, 3.81968180212041*^9}, {
   3.8196818650954933`*^9, 3.8196818691998262`*^9}, 3.819803794999077*^9, 
   3.81980420663871*^9, 3.8198042867407503`*^9, 3.819947871565641*^9, {
   3.8206143832456284`*^9, 3.820614410639799*^9}, {3.820614448797456*^9, 
   3.82061450774603*^9}, {3.8206145576224937`*^9, 3.820614561686839*^9}, {
   3.8206145942715893`*^9, 3.820614597298908*^9}, {3.820614678290799*^9, 
   3.820614685380723*^9}, {3.820614724750433*^9, 3.820614735106225*^9}, {
   3.820614797296652*^9, 3.820614808164074*^9}, {3.820614862600165*^9, 
   3.820614868848022*^9}, {3.820614917344324*^9, 3.820614940762912*^9}, 
   3.820615832603849*^9, 3.82062361298812*^9, {3.820623663048524*^9, 
   3.820623685490617*^9}, {3.820625856960861*^9, 3.820625861329494*^9}, {
   3.820626155546088*^9, 3.820626191016008*^9}, {3.823859248394248*^9, 
   3.823859260134684*^9}, {3.823859295331983*^9, 3.8238593000886087`*^9}, {
   3.823859357592621*^9, 3.82385937346321*^9}, {3.823859481085997*^9, 
   3.823859494045043*^9}, 3.8239192848813877`*^9, 3.824001248164638*^9, 
   3.826341588111765*^9, 3.8263417036807833`*^9, 3.826342391177099*^9, 
   3.828484364421124*^9, 3.830132363563733*^9},
 CellLabel->"Out[51]=",
 CellID->2084885742,ExpressionUUID->"671246ad-28e7-4ce4-a393-6962dfa9bdb7"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Step 3",
  FontWeight->"Bold"],
 ". Bob sends the measurement outcome to Alice through a classical channel.\n",
 StyleBox["Step 4",
  FontWeight->"Bold"],
 ". Alice applies a proper Combining these leads to the whole protocol. These \
steps are simulated by a feedback control.\nCombining all these steps \
comprises, one can transmit a quantum state to a remote party without a \
quantum channel."
}], "Text",
 CellChangeTimes->{{3.819681887511485*^9, 3.819681926028859*^9}, {
  3.82061507842439*^9, 3.820615282938031*^9}, {3.8206153306365137`*^9, 
  3.8206154056011877`*^9}},ExpressionUUID->"7712b946-da0a-40d8-93fe-\
79fd869f046b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"in", "=", 
     RowBox[{"ProductState", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"S", "[", "4", "]"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Psi]", "[", "0", "]"}], ",", 
          RowBox[{"\[Psi]", "[", "1", "]"}]}], "}"}]}], ",", 
       RowBox[{"\"\<Label\>\"", "\[Rule]", 
        RowBox[{"Ket", "[", "\[Psi]", "]"}]}]}], "]"}]}], ",", 
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}]}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", "\"\<Separator\>\"", ",", 
    "\"\<Spacer\>\"", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "3", "]"}], ",", 
      RowBox[{"S", "[", "4", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"3", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"3", ",", "4"}], "}"}]}], "]"}], ",", "\"\<Separator\>\"", ",", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"S", "[", "4", "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"1", ",", "1"}], "]"}]}], "]"}], ",", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"S", "[", "3", "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"1", ",", "3"}], "]"}]}], "]"}], ",", 
    RowBox[{"ProductState", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "[", "1", "]"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Psi]", "[", "0", "]"}], ",", 
         RowBox[{"\[Psi]", "[", "1", "]"}]}], "}"}]}], ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", 
       RowBox[{"Ket", "[", "\[Psi]", "]"}]}]}], "]"}], ",", 
    RowBox[{"\"\<Invisible\>\"", "\[Rule]", 
     RowBox[{"S", "[", "2", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8196810214112263`*^9, 3.8196810932465467`*^9}, {
   3.819681152374172*^9, 3.8196815947691097`*^9}, {3.819681944064476*^9, 
   3.81968194439972*^9}, {3.820615640782695*^9, 3.8206156496460743`*^9}, {
   3.820625872197032*^9, 3.82062594660067*^9}, {3.820626001274185*^9, 
   3.820626047219674*^9}, 3.823859529380582*^9, {3.823919228308436*^9, 
   3.8239192400125093`*^9}, 3.826341765537208*^9, {3.8263423985684566`*^9, 
   3.826342405204833*^9}, 3.829808701680975*^9},
 CellLabel->"In[52]:=",ExpressionUUID->"f00faa65-2b56-46a3-b23e-2cb8c35f59e9"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{7, -3}, {11, -3}}, {{7, -4}, {11, -4}}}]}, 
   LineBox[{{{0, -1}, {11, -1}}, {{0, -3}, {7, -3}}, {{0, -4}, {7, -4}}}], {
    InsetBox[
     StyleBox[
      TemplateBox[{"\[Psi]"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.029090909090909098`],
      FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, Rational[1, 2]}]], {
     InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.029090909090909098`],
       FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.029090909090909098`],
       FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03636363636363637],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -3}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
        2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{3, Rational[-9, 2]}, {3, Rational[-1, 2]}}, {{3, -4.5}, {
       3, -0.5}}]]}, {LineBox[{{5, -3}, {5, -4}}], 
    DiskBox[{5, -3}, 0.09], {CircleBox[{5, -4}, 0.26666666666666666], 
     LineBox[{{{4.733333333333333, -4}, {5.266666666666667, -4}}, {{
        5, -4.266666666666667}, {5, -3.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03636363636363637],
      FontWeight->"Light",
      FontSlant->Italic], {6, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, 
     CircleBox[{7, -3.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{7, -3.2}, {7.24, -2.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, 
     CircleBox[{7, -4.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{7, -4.2}, {7.24, -3.76}}]}}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{8, Rational[-9, 2]}, {8, Rational[-1, 2]}}, {{8, -4.5}, {
       8, -0.5}}]]}, {LineBox[{{9, -4}, {9, -1}}], DiskBox[{9, -4}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -1.4}, {9.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03636363636363637],
      FontWeight->"Light",
      FontSlant->Italic], {9, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{10, -3}, {10, -1}}], DiskBox[{10, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -1.4}, {10.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03636363636363637],
      FontWeight->"Light",
      FontSlant->Italic], {10, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, InsetBox[
    StyleBox[
     TemplateBox[{"\[Psi]"},
      "Ket"],
     StripOnInput->False,
     FontSize->Scaled[0.029090909090909098`],
     FontWeight->"Light"], {11.1, -1}, ImageScaled[{0, Rational[1, 2]}]]},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->442.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.8196811620947123`*^9, 3.81968122608108*^9}, {
   3.819681286448214*^9, 3.8196813771203527`*^9}, 3.819681423188651*^9, {
   3.819681462965653*^9, 3.819681501573145*^9}, {3.819681543423397*^9, 
   3.8196815983052483`*^9}, {3.8196819278292837`*^9, 3.8196819447373247`*^9}, 
   3.819803798006016*^9, 3.819804206689385*^9, 3.81980428679165*^9, 
   3.820615071846488*^9, 3.820615208127811*^9, 3.8206153811535387`*^9, 
   3.820615650364822*^9, 3.8206158347262917`*^9, 3.8206236924084873`*^9, {
   3.820625932700736*^9, 3.820625951182274*^9}, {3.8206260214062366`*^9, 
   3.8206260565639143`*^9}, 3.823859530234894*^9, 3.8239192865536003`*^9, 
   3.824001250572239*^9, 3.826341588142724*^9, 3.8263417074391537`*^9, {
   3.826341747951825*^9, 3.826341765930768*^9}, {3.826342394046213*^9, 
   3.826342407903852*^9}, 3.828484366271377*^9, 3.828484460248975*^9, 
   3.830132365661663*^9},
 CellLabel->"Out[52]=",
 CellID->441879170,ExpressionUUID->"5408a6a9-16d4-400b-8f3f-e5412dc4b59e"]
}, Open  ]],

Cell["Check the result.", "Text",
 CellChangeTimes->{{3.823919260408451*^9, 
  3.8239192651670856`*^9}},ExpressionUUID->"c433d0fc-5610-44c8-9814-\
3a55bed8feb8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Psi]", "[", "0", "]"}], ",", 
     RowBox[{"\[Psi]", "[", "1", "]"}]}], "}"}], "=", 
   RowBox[{"Normalize", "@", 
    RowBox[{"Re", "@", 
     RowBox[{"RandomVector", "[", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"ExpressionFor", "[", "qc", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"in", "->", 
  RowBox[{"LogicalForm", "@", 
   RowBox[{"QuissoFactor", "[", 
    RowBox[{"out", ",", 
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"3", ",", "4"}], "}"}]}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.819681607235526*^9, 3.8196816228246717`*^9}, {
   3.819681946323516*^9, 3.819682121217149*^9}, {3.819803822980609*^9, 
   3.819803823486397*^9}, {3.820615654325889*^9, 3.820615657137817*^9}, {
   3.8206259619344683`*^9, 3.820625963373358*^9}, 3.830132248350807*^9},
 CellLabel->"In[53]:=",ExpressionUUID->"73247977-8429-4591-aa70-8c068b2cf3f7"],

Cell[BoxData[
 RowBox[{
  TagBox[
   SubscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "0.9566874860809402`"}], " ", 
       TemplateBox[{"0"},
        "Ket"]}], "+", 
      RowBox[{"0.2911169077469232`", " ", 
       TemplateBox[{"1"},
        "Ket"]}]}], ")"}], 
    SubscriptBox[
     TemplateBox[{"S"},
      "RowDefault"], 
     TemplateBox[{"4"},
      "RowDefault"]]],
   DisplayForm], "\[Rule]", 
  RowBox[{
   TagBox[
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"],
    HoldForm], "\[CircleTimes]", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "0.9566874860809401`"}], " ", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}], "+", 
      RowBox[{"0.2911169077469231`", " ", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]}],
     HoldForm], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.819681993501895*^9, 3.8196820160803747`*^9}, {
   3.819682051526339*^9, 3.819682060877207*^9}, {3.819682098504368*^9, 
   3.819682124109915*^9}, {3.819803800710024*^9, 3.8198038284282703`*^9}, 
   3.819804206734027*^9, 3.819804286835518*^9, {3.820615658089082*^9, 
   3.820615660650713*^9}, 3.820623694119419*^9, {3.820625963801478*^9, 
   3.820625965599852*^9}, {3.820626023051506*^9, 3.82062605828424*^9}, 
   3.8238595340812902`*^9, 3.823919288924312*^9, 3.824001252741226*^9, 
   3.826341588196217*^9, 3.826341713014358*^9, 3.8263424099685907`*^9, 
   3.828484368355275*^9, 3.828484463320517*^9, 3.830132367953751*^9},
 CellLabel->"Out[55]=",
 CellID->942519421,ExpressionUUID->"5b25bf25-571d-4759-9662-2966e4547029"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Deutsch-Jozsa Algorithm", "Section",
 CellChangeTimes->{{3.818666937476184*^9, 3.81866694190833*^9}, {
  3.81867834945993*^9, 3.8186783571659327`*^9}},
 CellTags->"Section48",
 CellID->937268274,ExpressionUUID->"147d10ce-32ef-4c90-adce-43267f63c000"],

Cell[CellGroupData[{

Cell["Quantum Oracle", "Subsection",
 CellChangeTimes->{{3.818667551341221*^9, 3.818667569758067*^9}, {
  3.818667712809558*^9, 3.818667746652706*^9}, {3.818902865032364*^9, 
  3.8189028674057693`*^9}},
 CellTags->"Section49",
 CellID->875330373,ExpressionUUID->"25bade32-d675-4545-a640-24c6cbd9b899"],

Cell[CellGroupData[{

Cell["\<\
Here is a simple example, which is used in the Deutsch-Jozsa algorithm.\
\>", "MathCaption",
 CellChangeTimes->{{3.81890287556196*^9, 
  3.818902902818839*^9}},ExpressionUUID->"5bfdb562-9ae7-484c-8c48-\
5f465405351e"],

Cell[TextData[{
 "Consider a balanced function ",
 Cell[BoxData[
  FormBox["f", TraditionalForm]],ExpressionUUID->
  "71a7d463-b98b-4e05-b92d-b1218006f6c0"],
 " as a classical oracle."
}], "Text",
 CellChangeTimes->{{3.8186671838914948`*^9, 3.818667200191592*^9}, {
  3.8186678036327467`*^9, 3.8186678127002172`*^9}, {3.818895342236134*^9, 
  3.818895342448854*^9}, {3.8206070180929317`*^9, 
  3.8206070262203693`*^9}},ExpressionUUID->"587bb975-3f3f-44b1-88ae-\
074d6937023a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "=", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "1"}], "]"}], "=", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "0"}], "]"}], "=", "1"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8186508164773283`*^9, 3.818650885233067*^9}, {
  3.818651470688508*^9, 3.818651533211761*^9}, {3.818667796534925*^9, 
  3.8186678007981577`*^9}, {3.818834201660343*^9, 3.818834206463353*^9}, {
  3.820581401118075*^9, 3.8205814057189817`*^9}, {3.820967135877077*^9, 
  3.820967139172207*^9}, {3.823919359318804*^9, 3.8239193755292892`*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"6ddfe543-ec47-493b-840b-65e7af264000"],

Cell["Here is the corresponding quantum oracle.", "Text",
 CellChangeTimes->{{3.8239194549648314`*^9, 
  3.823919467609632*^9}},ExpressionUUID->"01626fc4-125c-47f5-8c4b-\
5f41628a16f7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"S", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Oracle", "[", 
    RowBox[{"f", ",", "cc", ",", "tt"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8186674197347527`*^9, 3.81866745452712*^9}, {
   3.818669381184102*^9, 3.818669381568959*^9}, 3.82400126831072*^9, 
   3.826342419143506*^9, 3.829808701694859*^9},
 CellLabel->"In[58]:=",ExpressionUUID->"c850b8fa-65fe-41f1-95ad-3e6b68f47540"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {
    LineBox[{{1, -1}, {1, -2}, {1, -3}}], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     FilledCurveBox[{
      BezierCurve[{{1.4, -1}, {1.4, -0.47439999999999993`}, {
         0.6, -0.47439999999999993`}, {0.6, -1}}], 
       Line[{{0.6, -1}, {0.6, -2}}], 
       BezierCurve[{{0.6, -2.5256}, {1.4, -2.5256}, {1.4, -2}}]}]}, InsetBox[
     StyleBox["\<\"f\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.2],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{1, Rational[-3, 2]}, {1, -1.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]], {
     CircleBox[{1, -3}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
        1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{3.824001269720481*^9, 3.8263415882337437`*^9, 
  3.8263424195248938`*^9, 3.830132372043928*^9},
 CellLabel->"Out[60]=",
 CellID->2052048152,ExpressionUUID->"31074db8-4368-4ed2-816f-fe42680d58b6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}]], "Input",
 CellChangeTimes->{{3.8186674197347527`*^9, 3.81866745452712*^9}, {
   3.818669381184102*^9, 3.818669381568959*^9}, 3.82400126831072*^9, 
   3.8301322483574142`*^9},
 CellLabel->"In[61]:=",ExpressionUUID->"be2053d7-6a9b-4e34-a133-f9ddb233f8aa"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"3"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], "2"]}]], "Output",
 CellChangeTimes->{{3.81866745009214*^9, 3.818667454843136*^9}, 
   3.81866775048929*^9, 3.8186678149084063`*^9, 3.81866905411077*^9, 
   3.8186690967494793`*^9, {3.8186693239356823`*^9, 3.818669382107456*^9}, {
   3.8188341848784018`*^9, 3.818834208163007*^9}, 3.818977048337471*^9, 
   3.819682565776505*^9, 3.819803851477058*^9, 3.819804206777025*^9, 
   3.819804286880169*^9, 3.8205814074621696`*^9, 3.820967140760066*^9, 
   3.82391939313916*^9, {3.824001264640233*^9, 3.8240012707602987`*^9}, 
   3.8263415882660513`*^9, 3.826342421849168*^9, 3.830132373840843*^9},
 CellLabel->"Out[61]=",
 CellID->552465998,ExpressionUUID->"3757eb0c-e7bb-4d58-9757-95f992044f47"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"Basis", "@", 
    RowBox[{"Join", "[", 
     RowBox[{"cc", ",", 
      RowBox[{"{", "tt", "}"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"bs", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.818669125975196*^9, 3.818669147401524*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"e7cb7f3e-785f-4f3b-b37a-a134e7e106ce"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "}"}]], "Output",
 CellChangeTimes->{{3.8186691404483128`*^9, 3.818669147666494*^9}, 
   3.818669384332067*^9, 3.8188342095534277`*^9, 3.819682567066229*^9, 
   3.819803852851074*^9, 3.8198042068409643`*^9, 3.819804286918715*^9, 
   3.820581409594315*^9, 3.820967142326235*^9, 3.823919395324748*^9, 
   3.824001272424952*^9, 3.826341588278335*^9, 3.826342423202829*^9, 
   3.830132376719472*^9},
 CellLabel->"Out[63]=",
 CellID->1692940752,ExpressionUUID->"f17164e8-d397-439a-bb32-1ada2e3cc48b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "bs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.818669150128396*^9, 3.818669160957694*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"0efa830c-e112-46d8-a612-2e3f6510c697"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "}"}]], "Output",
 CellChangeTimes->{{3.818669152036134*^9, 3.8186691612336187`*^9}, 
   3.8186693851406*^9, 3.818834210320101*^9, 3.819682567717531*^9, 
   3.8198038537678423`*^9, 3.819804206879312*^9, 3.819804286956664*^9, 
   3.820581410311504*^9, 3.8209671432759457`*^9, 3.8239193965394373`*^9, 
   3.824001273211231*^9, 3.826341588317404*^9, 3.826342423933498*^9, 
   3.830132377767914*^9},
 CellLabel->"Out[65]=",
 CellID->1171495911,ExpressionUUID->"9c44fee8-e947-4703-a83b-e43f161ef01a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"bs", "\[Rule]", "out"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]], "Input",
 CellChangeTimes->{{3.8186691716714153`*^9, 3.818669232686678*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"d412f9fa-5d50-41bf-8686-34bfb9254ce1"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8186691871875134`*^9, 3.818669202452326*^9}, 
   3.8186692330741987`*^9, 3.818669386418865*^9, 3.818834211020423*^9, 
   3.819682568566146*^9, 3.8198038545147867`*^9, 3.819804206918117*^9, 
   3.819804286996956*^9, 3.8205814112617292`*^9, 3.820967144343652*^9, 
   3.823919399139598*^9, 3.824001273963195*^9, 3.826341588358282*^9, 
   3.8263424247856827`*^9, 3.8301323789657593`*^9},
 CellLabel->"Out[66]//TableForm=",
 CellID->307353150,ExpressionUUID->"58d8499b-c5e6-49e1-b62b-95cb56df275b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Let us consider another example, which is used in Simon\[CloseCurlyQuote]s \
algorithm.\
\>", "MathCaption",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.81890276823136*^9, 
  3.818902801315727*^9}},ExpressionUUID->"1de127be-6045-4115-af7b-\
07356f9bf72b"],

Cell["Consider a two-to-one function as a classical oracle.", "Text",
 CellChangeTimes->{{3.818667068937937*^9, 
  3.818667100857731*^9}},ExpressionUUID->"5c10a6e7-d503-4387-89f0-\
942ea65dbba3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "1"}], "]"}], "=", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "0"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8186508164773283`*^9, 3.818650885233067*^9}, {
  3.818651470688508*^9, 3.818651533211761*^9}, {3.820581416518656*^9, 
  3.8205814216935673`*^9}, {3.823919421902055*^9, 3.82391943173372*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"63c7fd9e-d1a7-44c2-8aed-fc6088d2751d"],

Cell["\<\
Here is an implementation of the corresponding quantum oracle.\
\>", "Text",
 CellChangeTimes->{{3.818667106879932*^9, 
  3.818667130610606*^9}},ExpressionUUID->"f03d2935-2471-4f83-86a2-\
d11af88fe7a6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"3", ",", "4"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Oracle", "[", 
    RowBox[{"f", ",", "cc", ",", "tt"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.818657304343545*^9, 3.818657362073503*^9}, {
   3.818657566718795*^9, 3.818657575098328*^9}, {3.8186656344167633`*^9, 
   3.818665646880411*^9}, 3.818667002511541*^9, 3.826342434408588*^9, 
   3.829808701732821*^9},
 CellLabel->"In[69]:=",ExpressionUUID->"4f460cfc-a4fc-4134-ac88-b815cae52b06"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
    0, -4}, {2, -4}}}], {LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}}], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     FilledCurveBox[{
      BezierCurve[{{1.4, -1}, {1.4, -0.47439999999999993`}, {
         0.6, -0.47439999999999993`}, {0.6, -1}}], 
       Line[{{0.6, -1}, {0.6, -2}}], 
       BezierCurve[{{0.6, -2.5256}, {1.4, -2.5256}, {1.4, -2}}]}]}, InsetBox[
     StyleBox["\<\"f\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.2],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{1, Rational[-3, 2]}, {1, -1.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]], {
     CircleBox[{1, -3}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
        1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}, {
     CircleBox[{1, -4}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -4}, {1.2666666666666666`, -4}}, {{
        1, -4.266666666666667}, {1, -3.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.81866699288649*^9, 3.818667004777478*^9}, 
   3.818667082015224*^9, 3.8186671327204657`*^9, 3.8188342149783154`*^9, 
   3.8196825719057093`*^9, 3.81980385895487*^9, 3.8198042069651537`*^9, 
   3.819804287045104*^9, 3.820581424945641*^9, 3.820967149624407*^9, 
   3.823919478798514*^9, 3.82400127823132*^9, 3.8263415884074783`*^9, {
   3.826342429254836*^9, 3.826342434874078*^9}, 3.830132382558268*^9},
 CellLabel->"Out[71]=",
 CellID->709585487,ExpressionUUID->"5efefbe9-4aed-4006-9ec2-6b741cbb95e4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"Elaborate", "@", 
   RowBox[{"QuissoOracle", "[", 
    RowBox[{"f", ",", "cc", ",", "tt"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8186555194531183`*^9, 3.818655543391605*^9}, {
   3.818655694757443*^9, 3.818655695643837*^9}, 3.818657558138802*^9, {
   3.8301323926397552`*^9, 3.830132394630026*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"6cfadacc-2806-448d-9541-2529de8dc1b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"4"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], "2"]}]], "Output",
 CellChangeTimes->{
  3.8186528179185963`*^9, {3.81865287043755*^9, 3.81865289402213*^9}, 
   3.818655362786578*^9, {3.818655473698975*^9, 3.818655543951762*^9}, {
   3.818655696164872*^9, 3.818655728383875*^9}, 3.818656335045885*^9, {
   3.818657544312244*^9, 3.818657579902013*^9}, 3.818667159322407*^9, 
   3.818834216359177*^9, 3.819682573837982*^9, 3.819803860389805*^9, 
   3.8198042070818243`*^9, 3.819804287160975*^9, 3.820581427052782*^9, 
   3.820967151652677*^9, {3.823919475116673*^9, 3.82391947983384*^9}, 
   3.824001279637068*^9, 3.826341588552984*^9, 3.826342436859271*^9, {
   3.8301323847437963`*^9, 3.8301323955663137`*^9}},
 CellLabel->"Out[73]=",
 CellID->107416673,ExpressionUUID->"83a430fa-048c-4558-806e-7be3930d85c9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"Basis", "@", 
    RowBox[{"Join", "[", 
     RowBox[{"cc", ",", "tt"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"bs", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.8186537072843227`*^9, 3.8186537324269667`*^9}, {
  3.8186538060238523`*^9, 3.818653809206686*^9}, {3.818655733466798*^9, 
  3.818655750767226*^9}, {3.8189028392386723`*^9, 3.818902840812481*^9}, {
  3.819682579070649*^9, 3.819682579620739*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"62d46754-e89c-4e76-83fc-32ad62252ca2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.818653734072915*^9, 3.8186538095165377`*^9, 3.818655598215893*^9, 
   3.818655636474676*^9, {3.818655698777288*^9, 3.8186557518810587`*^9}, 
   3.818656336015027*^9, 3.818657581029008*^9, 3.8186671599213037`*^9, 
   3.818834217213787*^9, {3.819682574530595*^9, 3.8196825800046997`*^9}, 
   3.819803861057811*^9, 3.8198042071153107`*^9, 3.819804287195079*^9, 
   3.820581427956897*^9, 3.820967153332909*^9, 3.823919481367729*^9, 
   3.8240012803020687`*^9, 3.826341588589465*^9, 3.826342437591687*^9, 
   3.830132396813025*^9},
 CellLabel->"Out[75]=",
 CellID->271047542,ExpressionUUID->"5932f1b8-7f88-4f10-b66d-1a5b5277b814"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "bs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.8186557551562634`*^9, 3.818655762634967*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"752c6e32-e938-44a2-85a3-d7051261f35d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "}"}]], "Output",
 CellChangeTimes->{3.8186557637060823`*^9, 3.818656336793481*^9, 
  3.818657581948091*^9, 3.8186671606454*^9, 3.8188342180547247`*^9, 
  3.81968258155282*^9, 3.819803862158731*^9, 3.819804207182549*^9, 
  3.819804287285782*^9, 3.8205814291531277`*^9, 3.8209671572816133`*^9, 
  3.823919482589678*^9, 3.824001281396783*^9, 3.8263415886575193`*^9, 
  3.826342438524213*^9, 3.830132397924754*^9},
 CellLabel->"Out[77]=",
 CellID->340803310,ExpressionUUID->"c7030e6b-c155-486b-b214-90a7d7fd99c3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"Rule", "[", 
     RowBox[{"bs", ",", "out"}], "]"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]], "Input",
 CellChangeTimes->{{3.81865564111726*^9, 3.8186556589002647`*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"2d0878c3-2104-47c8-81b6-fad14c347f16"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8186671615003233`*^9, 3.818834218900676*^9, 
  3.819682584759885*^9, 3.819803863198292*^9, 3.819804207233789*^9, 
  3.819804287337451*^9, 3.8205814303620167`*^9, 3.8209671582505283`*^9, 
  3.823919483923918*^9, 3.824001282819792*^9, 3.826341588715005*^9, 
  3.8263424394642982`*^9, 3.8301323988061113`*^9},
 CellLabel->"Out[78]//TableForm=",
 CellID->2082249761,ExpressionUUID->"f2afcc67-74ff-449d-b6b3-2c00de52168b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Here is demonstrate the feature of quantum oracle that makes a copy of the \
image f(x) of the native register to the ancillary qubit.\
\>", "MathCaption",
 CellChangeTimes->{{3.8302093224777*^9, 3.8302094462545137`*^9}},
 CellID->1089484095,ExpressionUUID->"b9bbfa87-21e4-469b-a635-7ad30d05fece"],

Cell["\<\
In this particular example, we consider a one-to-one function, but it can be \
arbitrary (but not constant if an entanglement is necessary).\
\>", "Text",
 CellChangeTimes->{{3.830209551673346*^9, 3.8302096647747793`*^9}},
 CellID->1334404591,ExpressionUUID->"0a6cfb8b-58a5-453f-97dd-aa11edd077ff"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "0"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "1"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "0"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "1"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.830209459027478*^9, 3.830209529951232*^9}, {
  3.830209670930111*^9, 3.830209675215191*^9}},
 CellLabel->"In[9]:=",
 CellID->219138262,ExpressionUUID->"75a513cd-ee2b-4264-b733-c0e7d6027bf8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"S", "@", "cc"}], ",", 
        RowBox[{"S", "@", "tt"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"cc", ",", "6"}], "]"}], ",", 
    RowBox[{"Oracle", "[", 
     RowBox[{"f", ",", 
      RowBox[{"S", "@", "cc"}], ",", 
      RowBox[{"S", "@", "tt"}]}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.830209685261272*^9, 3.8302097464687862`*^9}},
 CellLabel->"In[19]:=",
 CellID->1528492484,ExpressionUUID->"201e9610-5958-4732-9551-ec53893ee997"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}, {{0, -3}, {3, -3}}, {{
    0, -4}, {3, -4}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.10666666666666667`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.10666666666666667`],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.10666666666666667`],
      FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.10666666666666667`],
      FontWeight->"Light"], {-0.1, -4}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -2}, {2, -3}, {2, -4}}], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     FilledCurveBox[{
      BezierCurve[{{2.4, -1}, {2.4, -0.47439999999999993`}, {
         1.6, -0.47439999999999993`}, {1.6, -1}}], 
       Line[{{1.6, -1}, {1.6, -2}}], 
       BezierCurve[{{1.6, -2.5256}, {2.4, -2.5256}, {2.4, -2}}]}]}, InsetBox[
     StyleBox["\<\"f\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{2, Rational[-3, 2]}, {2, -1.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]], {
     CircleBox[{2, -3}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
        2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}, {
     CircleBox[{2, -4}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -4}, {2.2666666666666666`, -4}}, {{
        2, -4.266666666666667}, {2, -3.7333333333333334`}}}]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.830209720747389*^9, 3.830209749614572*^9}},
 CellLabel->"Out[21]=",
 CellID->1219350425,ExpressionUUID->"5619c912-74e9-4767-b39b-1d4870186cef"]
}, Open  ]],

Cell[TextData[{
 "The output state is an entangled state (unless the classical oracle ",
 StyleBox["f", "Input"],
 " is constant)."
}], "Text",
 CellChangeTimes->{{3.830209798496826*^9, 3.830209839073638*^9}},
 CellID->1245720949,ExpressionUUID->"7b4209c1-a5a1-47e0-b357-5d5efd91e144"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"ExpressionFor", "[", "qc", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"out", ",", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"S", "@", "cc"}], ",", 
     RowBox[{"S", "@", "tt"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.830209752602504*^9, 3.830209781308255*^9}},
 CellLabel->"In[26]:=",
 CellID->1881044746,ExpressionUUID->"d1210a33-dff3-4b6f-83b9-2d7d3883ec99"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{{3.830209760747807*^9, 3.830209781788172*^9}, 
   3.830209848693027*^9},
 CellLabel->"Out[27]=",
 CellID->562611887,ExpressionUUID->"ce17d29d-84bc-4976-888a-ece6197e5196"]
}, Open  ]],

Cell["\<\
To make clearer the copies made tot the ancillary register, it may be useful \
to rewrite the state vector in a form that distinguishes the native and \
ancillary register.\
\>", "Text",
 CellChangeTimes->{{3.8302099176863613`*^9, 3.830210017871719*^9}},
 CellID->254930395,ExpressionUUID->"d72a2f14-45a3-411f-a251-dd38e4b752fc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QuissoFactor", "[", 
   RowBox[{"out", ",", 
    RowBox[{"S", "@", "cc"}]}], "]"}], "//", "LogicalForm"}]], "Input",
 CellChangeTimes->{{3.830209852070178*^9, 3.830209864677494*^9}},
 CellLabel->"In[29]:=",
 CellID->427420082,ExpressionUUID->"57958642-d929-460d-abf0-1dda3bb8d0dd"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox["0", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]], 
          SubscriptBox["0", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"],
     HoldForm], "\[CircleTimes]", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], ")"}]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox["0", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]], 
          SubscriptBox["1", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"],
     HoldForm], "\[CircleTimes]", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], ")"}]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox["1", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]], 
          SubscriptBox["0", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"],
     HoldForm], "\[CircleTimes]", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], ")"}]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox["1", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]], 
          SubscriptBox["1", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"],
     HoldForm], "\[CircleTimes]", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], ")"}]}],
   DisplayForm]}]], "Output",
 CellChangeTimes->{3.8302098649215527`*^9, 3.830210019561301*^9},
 CellLabel->"Out[29]=",
 CellID->412654781,ExpressionUUID->"a549c9c8-a026-42ab-8b5d-16c6a79f3250"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
This is an interesting twist of the quantum oracle. It is useful in Grover\
\[CloseCurlyQuote]s search algorithm.\
\>", "MathCaption",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.8207352519815407`*^9, 3.820735304560794*^9}, {
  3.820737432315325*^9, 3.820737442979941*^9}, {3.829627797966975*^9, 
  3.829627799383397*^9}},ExpressionUUID->"7a513a07-14e9-49ab-9551-\
7f23b4dffe2a"],

Cell[TextData[{
 "The classical oracle mark the solutions, ",
 StyleBox["{0,0}=0", "Input"],
 " and {",
 StyleBox["1,1}=1", "Input"],
 " in this particular case."
}], "Text",
 CellChangeTimes->{{3.82073538287929*^9, 
  3.8207354280902348`*^9}},ExpressionUUID->"1019f323-5d42-4e4b-951f-\
265f64107e55"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "0"}], "]"}], "=", "1"}], ";", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "1"}], "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "0"}], "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "1"}], "]"}], "=", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.8207340710326757`*^9, 3.820734119555006*^9}, {
  3.820734678887533*^9, 3.820734687773491*^9}, {3.820735372238793*^9, 
  3.820735376332213*^9}, {3.823919502995899*^9, 3.823919505375963*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"2550c51d-10b5-42d3-9beb-3a91fea1afe6"],

Cell["This quantum circuit model implements the desired mapping.", "Text",
 CellChangeTimes->{{3.820736026971243*^9, 3.820736071934588*^9}, {
   3.820736338838376*^9, 3.820736355841976*^9}, {3.820736423356009*^9, 
   3.820736464619094*^9}, 3.820736518482196*^9, {3.820736605223884*^9, 
   3.820736711029003*^9}, {3.820736748911724*^9, 3.8207367517739162`*^9}, {
   3.820736795416318*^9, 3.820736813337393*^9}, {3.820736847263426*^9, 
   3.82073690497252*^9}, {3.820736963920908*^9, 3.8207369657358923`*^9}, 
   3.820737006882168*^9, {3.820737423496604*^9, 
   3.820737429582111*^9}},ExpressionUUID->"f0ec82fb-1e6a-4392-959d-\
1e96af5354bf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"{", "3", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ct", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"cc", ",", "tt"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{
        RowBox[{"S", "[", "tt", "]"}], "\[Rule]", "1"}], "]"}], ",", 
      RowBox[{"S", "[", "ct", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"ct", ",", "6"}], "]"}], ",", 
    RowBox[{"Oracle", "[", 
     RowBox[{"f", ",", 
      RowBox[{"S", "@", "cc"}], ",", 
      RowBox[{"S", "@", "tt"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"tt", ",", "6"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8207341237164783`*^9, 3.820734240699329*^9}, {
   3.820734283537939*^9, 3.820734381980672*^9}, {3.8207344778038797`*^9, 
   3.8207345284592743`*^9}, {3.820734699429063*^9, 3.820734699551868*^9}, {
   3.8207354709846563`*^9, 3.8207354723347054`*^9}, 3.823919513285721*^9, {
   3.82400129278986*^9, 3.8240012956468697`*^9}, 3.829808701814889*^9},
 CellLabel->"In[80]:=",ExpressionUUID->"828812a7-a3ab-4121-86a1-4c4005ea4bb0"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"1"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -3}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -2}, {2, -3}}], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     FilledCurveBox[{
      BezierCurve[{{2.4, -1}, {2.4, -0.47439999999999993`}, {
         1.6, -0.47439999999999993`}, {1.6, -1}}], 
       Line[{{1.6, -1}, {1.6, -2}}], 
       BezierCurve[{{1.6, -2.5256}, {2.4, -2.5256}, {2.4, -2}}]}]}, InsetBox[
     StyleBox["\<\"f\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{2, Rational[-3, 2]}, {2, -1.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]], {
     CircleBox[{2, -3}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
        2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {3, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{
  3.823919517217609*^9, {3.824001288702516*^9, 3.824001296523334*^9}, 
   3.826341588788279*^9, 3.826342443455125*^9, 3.8296278034017897`*^9, 
   3.83013240269462*^9},
 CellLabel->"Out[83]=",
 CellID->1767840518,ExpressionUUID->"e63142d8-0066-4cdf-b51a-e79a4134a59c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"ExpressionFor", "[", "qc", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QuissoFactor", "[", 
   RowBox[{"out", ",", 
    RowBox[{"S", "[", "tt", "]"}]}], "]"}], "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.8207341237164783`*^9, 3.820734240699329*^9}, {
   3.820734283537939*^9, 3.820734381980672*^9}, {3.8207344778038797`*^9, 
   3.8207345284592743`*^9}, {3.820734699429063*^9, 3.820734699551868*^9}, {
   3.8207354709846563`*^9, 3.8207354723347054`*^9}, 3.823919513285721*^9, 
   3.830132248467436*^9},
 CellLabel->"In[84]:=",ExpressionUUID->"c488cc91-fda1-4982-9983-c538e6e5cdd4"],

Cell[BoxData[
 RowBox[{
  TagBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"],
   HoldForm], "\[CircleTimes]", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "-", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}]}],
    HoldForm], ")"}]}]], "Output",
 CellChangeTimes->{{3.820734178221023*^9, 3.820734186573391*^9}, {
   3.820734234994615*^9, 3.820734242821121*^9}, {3.820734311577573*^9, 
   3.8207343324952383`*^9}, {3.820734364097548*^9, 3.820734388675584*^9}, {
   3.820734483834763*^9, 3.820734529822081*^9}, {3.820734693850215*^9, 
   3.820734704154944*^9}, {3.820735458104334*^9, 3.820735484234213*^9}, {
   3.82073690719611*^9, 3.8207369329243507`*^9}, 3.8207370156730213`*^9, 
   3.823919519477951*^9, 3.8240012983973303`*^9, 3.826341588854162*^9, 
   3.826342446299863*^9, 3.829627804408196*^9, 3.830132404645096*^9},
 CellLabel->"Out[85]=",
 CellID->1957073927,ExpressionUUID->"a5317077-50ac-4af5-a16a-6a0f0de82bda"]
}, Open  ]],

Cell["Check the result.", "Text",
 CellChangeTimes->{{3.82073694644897*^9, 3.820736953221857*^9}, {
  3.82962780508739*^9, 
  3.82962780774193*^9}},ExpressionUUID->"580fd625-e958-413a-93be-\
db1bc6d9d5e7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", "cc"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ff", "=", 
   RowBox[{"f", "@@@", 
    RowBox[{"IntegerDigits", "[", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"2", "^", "2"}], "-", "1"}]}], "]"}], ",", "2", ",", "2"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"bs", "\[Rule]", 
    RowBox[{"Power", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "ff"}], "]"}]}], "]"}], "//", 
  "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.820734539721662*^9, 3.820734622774235*^9}, {
   3.820734721049636*^9, 3.820734852239805*^9}, {3.820734897700405*^9, 
   3.820734897980145*^9}, {3.8207358674830103`*^9, 3.8207359870362253`*^9}, 
   3.824001305715301*^9},
 CellLabel->"In[86]:=",ExpressionUUID->"6417ab25-238a-4a31-bdd9-4a3d34246c75"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], "\[Rule]", "1"}], ",", 
   RowBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], "\[Rule]", "1"}], ",", 
   RowBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], "\[Rule]", 
    RowBox[{"-", "1"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.824001306871017*^9, 3.826341588903171*^9, 
  3.8263424477082157`*^9, 3.82962781025504*^9, 3.830132407041937*^9},
 CellLabel->"Out[88]=",
 CellID->1219006873,ExpressionUUID->"f1e7bda7-96ae-45ec-93df-c78ab8f22540"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{"bs", ".", 
     RowBox[{"Power", "[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "ff"}], "]"}]}], "/", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.820734539721662*^9, 3.820734622774235*^9}, {
   3.820734721049636*^9, 3.820734852239805*^9}, {3.820734897700405*^9, 
   3.820734897980145*^9}, {3.8207358674830103`*^9, 3.8207359870362253`*^9}, 
   3.824001305715301*^9},
 CellLabel->"In[89]:=",ExpressionUUID->"e00f4fbb-5dac-4148-b2df-32f1f55ee51f"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox["0", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]], 
          SubscriptBox["0", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"]}], "+", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], "+", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], "-", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.8207359230671062`*^9, 3.820735996812357*^9}, 
   3.820736320900751*^9, {3.820736934802186*^9, 3.820736954303666*^9}, 
   3.823919522776595*^9, {3.824001300180232*^9, 3.824001307749277*^9}, 
   3.826341588912094*^9, 3.826342448488612*^9, 3.8296278111972313`*^9, 
   3.8301324078431253`*^9},
 CellLabel->"Out[90]=",
 CellID->246224062,ExpressionUUID->"e6f72fdd-8b4b-40c6-9502-c6d6fb8fd89d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Deutsch-Jozsa Algorithm", "Subsection",
 CellChangeTimes->{{3.8189030988669033`*^9, 3.818903108282305*^9}},
 CellTags->"Section50",
 CellID->1414597061,ExpressionUUID->"6137aaa5-3d2a-4794-a331-4532a2a3e483"],

Cell[CellGroupData[{

Cell["Consider a balanced function as an example.", "MathCaption",
 CellChangeTimes->{{3.818903118373352*^9, 3.818903126821419*^9}, {
  3.823919545212079*^9, 
  3.8239195473383503`*^9}},ExpressionUUID->"b45446c7-744a-4b2a-a32e-\
e51174a7d807"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "=", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "1"}], "]"}], "=", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "0"}], "]"}], "=", "1"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8186508164773283`*^9, 3.818650885233067*^9}, {
  3.818651470688508*^9, 3.818651533211761*^9}, {3.818667796534925*^9, 
  3.8186678007981577`*^9}, {3.818834201660343*^9, 3.818834206463353*^9}, {
  3.820581436093001*^9, 3.820581441346249*^9}, {3.823919550792388*^9, 
  3.823919565957226*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"9830c86f-95aa-4f30-b862-950499eb46b2"],

Cell["\<\
Here is a quantum circuit model of the Deutsch-Jozsa algorithm. The final \
Hadamard gate on the third qubit is not necessary, but we put it here to make \
the output state more readable.\
\>", "Text",
 CellChangeTimes->{{3.818903862958913*^9, 3.8189039335168552`*^9}, {
  3.8239352344233093`*^9, 
  3.823935236953595*^9}},ExpressionUUID->"70e9111a-4a79-4dca-97fc-\
6ed5e0d6591b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"{", "3", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"all", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{
        RowBox[{"S", "[", "3", "]"}], "\[Rule]", "1"}], "]"}], ",", 
      RowBox[{"S", "@", "all"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"all", ",", "6"}], "]"}], ",", 
    RowBox[{"Oracle", "[", 
     RowBox[{"f", ",", 
      RowBox[{"S", "@", "cc"}], ",", 
      RowBox[{"S", "@", "tt"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"all", ",", "6"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8186674197347527`*^9, 3.81866745452712*^9}, {
   3.818669381184102*^9, 3.818669381568959*^9}, {3.81890313509046*^9, 
   3.818903226259439*^9}, {3.8189032703755207`*^9, 3.8189033651515408`*^9}, {
   3.8189036796627693`*^9, 3.8189037201816273`*^9}, 3.818977856093588*^9, {
   3.8239195733828087`*^9, 3.823919577218214*^9}, 3.829808701833343*^9},
 CellLabel->"In[93]:=",ExpressionUUID->"c29c2fa8-f4fd-476f-97a9-b8b6981d0e31"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"1"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -3}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -2}, {2, -3}}], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     FilledCurveBox[{
      BezierCurve[{{2.4, -1}, {2.4, -0.47439999999999993`}, {
         1.6, -0.47439999999999993`}, {1.6, -1}}], 
       Line[{{1.6, -1}, {1.6, -2}}], 
       BezierCurve[{{1.6, -2.5256}, {2.4, -2.5256}, {2.4, -2}}]}]}, InsetBox[
     StyleBox["\<\"f\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{2, Rational[-3, 2]}, {2, -1.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]], {
     CircleBox[{2, -3}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
        2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.8189031125563726`*^9, 3.818903129704894*^9}, {
   3.8189031623532877`*^9, 3.818903167663526*^9}, 3.8189032277523117`*^9, {
   3.818903295112104*^9, 3.8189033813132353`*^9}, 3.818903680082749*^9, {
   3.818903712054371*^9, 3.81890374382491*^9}, 3.8189039356169033`*^9, 
   3.818977058827387*^9, 3.818977822230962*^9, 3.8189778568055143`*^9, 
   3.8196825943483133`*^9, 3.819803869448086*^9, 3.819804207300788*^9, 
   3.819804287406341*^9, 3.820581444559362*^9, {3.8239195695539618`*^9, 
   3.823919578176765*^9}, 3.8240013138935547`*^9, 3.826341588962926*^9, 
   3.8263424519620533`*^9, 3.830132411127973*^9},
 CellLabel->"Out[96]=",
 CellID->917687971,ExpressionUUID->"ac989195-c9e7-4b25-bb7e-6e206d6d7932"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}]], "Input",
 CellChangeTimes->{{3.818977842875135*^9, 3.818977845451254*^9}, 
   3.830132248485298*^9},
 CellLabel->"In[97]:=",ExpressionUUID->"4e9e1446-0ecb-48cf-b741-704a43c93b0e"],

Cell[BoxData[
 TemplateBox[{
   TagBox[
    TemplateBox[{
      SubscriptBox["1", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"]]], 
      SubscriptBox["1", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"]]], 
      SubscriptBox["1", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
  "Ket"]], "Output",
 CellChangeTimes->{{3.818977845946446*^9, 3.818977857783165*^9}, 
   3.8196825979528847`*^9, 3.819803871114594*^9, 3.81980420735709*^9, 
   3.8198042874636707`*^9, 3.820581446567244*^9, {3.8239195707567167`*^9, 
   3.8239195808593597`*^9}, 3.824001315752549*^9, 3.82634158902773*^9, 
   3.830132413282453*^9},
 CellLabel->"Out[97]=",
 CellID->955994138,ExpressionUUID->"b283107d-cfb6-4e49-a041-2dd1a552a2b4"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bernstein-Vazirani Algorithm", "Subsection",
 CellChangeTimes->{{3.8189030988669033`*^9, 3.818903108282305*^9}, {
  3.818904066237439*^9, 3.8189040737851467`*^9}},
 CellTags->"Section51",
 CellID->341348290,ExpressionUUID->"0144cad6-22c0-4d32-aac1-b2a20db1544f"],

Cell[CellGroupData[{

Cell["\<\
Consider a secrete string of bits. The task is to find the secrete string.\
\>", "MathCaption",
 CellChangeTimes->{{3.818904084944839*^9, 3.818904091446907*^9}, {
  3.818904186954587*^9, 3.818904188079145*^9}, {3.820968282384454*^9, 
  3.8209683483281717`*^9}},ExpressionUUID->"0d6da1ed-84a9-4701-9a2e-\
073a5443510e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"string", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.818904094485598*^9, 3.818904102943906*^9}, 
   3.8239195963102903`*^9},
 CellLabel->
  "In[108]:=",ExpressionUUID->"8ea712e3-eb33-491f-9b5f-27f77fff50a1"],

Cell[TextData[{
 "In the Bernstein-Vazirani algorithm, the value of the classical oracle ",
 Cell[BoxData[
  FormBox["f", TraditionalForm]],ExpressionUUID->
  "6ee91faa-7c22-49df-8bcc-a3d4b5714084"],
 " is determined by the given secrete string."
}], "Text",
 CellChangeTimes->{{3.818903118373352*^9, 3.818903126821419*^9}, {
  3.820968184453271*^9, 3.820968274037355*^9}, {3.82967462715307*^9, 
  3.8296746356909523`*^9}},ExpressionUUID->"acb4a83b-2de2-4598-9c36-\
5bc90599cd30"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "f", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "[", "x__", "]"}], ":=", 
  RowBox[{"Mod", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", "x", "}"}], ".", "string"}], ",", "2"}], "]"}]}]}], "Input",\

 CellChangeTimes->{{3.818904119594163*^9, 3.8189041667165823`*^9}, {
   3.818904260964506*^9, 3.8189042615824747`*^9}, {3.82058146006627*^9, 
   3.820581474430538*^9}, 3.820968212173956*^9, {3.8239196078295603`*^9, 
   3.823919620676609*^9}, 3.829674668698045*^9, {3.830132467551529*^9, 
   3.83013248325613*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"b74733ba-dcd3-4286-9bcf-36564a2917a4"],

Cell[TextData[{
 "For example, ",
 StyleBox["f[1,1]=0\[CenterDot]1 + 1\[CenterDot]1=1", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.829674672330936*^9, 3.8296747076878767`*^9}, {
  3.8301324709367456`*^9, 3.830132472017712*^9}},
 CellID->224738400,ExpressionUUID->"f03f4611-e65c-4e09-85b9-8e97544a249e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"f", "[", 
  RowBox[{"1", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.818904119594163*^9, 3.8189041667165823`*^9}, {
   3.818904260964506*^9, 3.8189042615824747`*^9}, {3.82058146006627*^9, 
   3.820581474430538*^9}, 3.820968212173956*^9, {3.8239196078295603`*^9, 
   3.823919620676609*^9}, 3.829674668698045*^9},
 CellLabel->"In[121]:=",
 CellID->1599000074,ExpressionUUID->"930f2837-f261-4fcb-bb56-99d0c4df062e"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.823919620985218*^9, 3.8239196255542717`*^9}, 
   3.824001319223105*^9, 3.8263415890678797`*^9, 3.8263424585065527`*^9, 
   3.829674645198907*^9, 3.829674714743149*^9, 3.8296747876057243`*^9, {
   3.83013241835602*^9, 3.830132490411171*^9}},
 CellLabel->"Out[121]=",
 CellID->1818953928,ExpressionUUID->"89dcfef6-5610-48f9-95f1-deda33156ded"]
}, Open  ]],

Cell["\<\
Here is a quantum circuit model of the Bernstein-Vazirani algorithm. The \
final Hadamard gate on the third qubit is not necessary and we put it here to \
make the output state more readable.\
\>", "Text",
 CellChangeTimes->{{3.818903862958913*^9, 3.8189039335168552`*^9}, {
  3.818904207113173*^9, 
  3.8189042163939466`*^9}},ExpressionUUID->"fc3c1f12-4ce9-4b61-98dd-\
c54008cc63b9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"{", "3", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"all", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{
        RowBox[{"S", "[", "3", "]"}], "\[Rule]", "1"}], "]"}], ",", 
      RowBox[{"S", "@", "all"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"all", ",", "6"}], "]"}], ",", 
    RowBox[{"Oracle", "[", 
     RowBox[{"f", ",", 
      RowBox[{"S", "@", "cc"}], ",", 
      RowBox[{"S", "@", "tt"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"all", ",", "6"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8186674197347527`*^9, 3.81866745452712*^9}, {
   3.818669381184102*^9, 3.818669381568959*^9}, {3.81890313509046*^9, 
   3.818903226259439*^9}, {3.8189032703755207`*^9, 3.8189033651515408`*^9}, {
   3.8189036796627693`*^9, 3.8189037201816273`*^9}, 3.8189778720117397`*^9, {
   3.82391963203983*^9, 3.823919635819447*^9}, 3.82980870184414*^9},
 CellLabel->
  "In[122]:=",ExpressionUUID->"0ba36037-2522-4b52-aa50-5f184f614949"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"1"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -3}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -2}, {2, -3}}], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     FilledCurveBox[{
      BezierCurve[{{2.4, -1}, {2.4, -0.47439999999999993`}, {
         1.6, -0.47439999999999993`}, {1.6, -1}}], 
       Line[{{1.6, -1}, {1.6, -2}}], 
       BezierCurve[{{1.6, -2.5256}, {2.4, -2.5256}, {2.4, -2}}]}]}, InsetBox[
     StyleBox["\<\"f\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{2, Rational[-3, 2]}, {2, -1.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]], {
     CircleBox[{2, -3}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
        2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.8189031125563726`*^9, 3.818903129704894*^9}, {
   3.8189031623532877`*^9, 3.818903167663526*^9}, 3.8189032277523117`*^9, {
   3.818903295112104*^9, 3.8189033813132353`*^9}, 3.818903680082749*^9, {
   3.818903712054371*^9, 3.81890374382491*^9}, 3.8189039356169033`*^9, {
   3.818904221203209*^9, 3.8189042296312227`*^9}, 3.818904263526133*^9, {
   3.818977870152629*^9, 3.818977872761547*^9}, 3.8196826023404007`*^9, 
   3.8198038769071493`*^9, 3.819804207426532*^9, 3.819804287534464*^9, 
   3.820581479091004*^9, 3.820968353165903*^9, 3.823919636745912*^9, 
   3.824001321120735*^9, 3.8263415891110287`*^9, 3.8263424599746113`*^9, 
   3.829674748140437*^9, 3.8296747894082413`*^9, 3.830132492036614*^9},
 CellLabel->"Out[125]=",
 CellID->529011650,ExpressionUUID->"2f5e1294-5fe8-44c6-9efa-cb69dbcb1913"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"ExpressionFor", "[", "qc", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"out", ",", 
   RowBox[{"S", "@", "cc"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8189033819599047`*^9, 3.81890338749216*^9}, {
   3.818903431479766*^9, 3.818903510740753*^9}, 3.8189038260956783`*^9, {
   3.818977878254779*^9, 3.818977878569373*^9}, {3.829674797909436*^9, 
   3.829674807887768*^9}, 3.8301322484935207`*^9},
 CellLabel->
  "In[126]:=",ExpressionUUID->"a5535642-5409-4f72-8ff9-1c63801349a3"],

Cell[BoxData[
 TemplateBox[{
   TagBox[
    TemplateBox[{
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"]]], 
      SubscriptBox["1", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"]]], 
      SubscriptBox["1", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
  "Ket"]], "Output",
 CellChangeTimes->{{3.818903457785836*^9, 3.8189035118395357`*^9}, 
   3.818903681632509*^9, {3.818903721426993*^9, 3.818903744914145*^9}, 
   3.818903826856085*^9, 3.818903936882328*^9, 3.818904230427023*^9, 
   3.8189042644354143`*^9, 3.81897787904102*^9, 3.8196826039717216`*^9, 
   3.819803878464964*^9, 3.819804207479177*^9, 3.819804287586084*^9, 
   3.8205814816075*^9, 3.820968354492276*^9, 3.823919637931217*^9, 
   3.824001323277062*^9, 3.8263415891767387`*^9, 3.826342462075377*^9, {
   3.829674792967708*^9, 3.8296748100012207`*^9}, 3.8301324935299263`*^9},
 CellLabel->"Out[127]=",
 CellID->101451550,ExpressionUUID->"089afe18-e0ff-40ec-85e9-678dc40ec45a"]
}, Open  ]],

Cell["Here is the secrete string successfully retrieved.", "Text",
 CellChangeTimes->{{3.818904330946151*^9, 3.81890435461495*^9}, {
  3.820968355731267*^9, 
  3.820968356833029*^9}},ExpressionUUID->"6bc5583d-3f49-4c2e-bf43-\
13c893ef56f5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"answer", "=", 
  RowBox[{"out", "[", 
   RowBox[{"S", "@", "cc"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.818904298765443*^9, 3.8189043179196577`*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"9360ad6b-a03c-4fb6-852d-28923d6c0f52"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{{3.8189043182895803`*^9, 3.8189043214080153`*^9}, 
   3.818977883300321*^9, 3.819682605127398*^9, 3.8198038797988462`*^9, 
   3.819804207485951*^9, 3.819804287593141*^9, 3.8205814831219397`*^9, 
   3.820968358096036*^9, 3.824001324449862*^9, 3.826341589183804*^9, 
   3.826342463320889*^9, 3.829674815512308*^9, 3.830132494843184*^9},
 CellLabel->"Out[128]=",
 CellID->604631219,ExpressionUUID->"38c188df-fac4-421b-b67f-661a3ed3827c"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simon\[CloseCurlyQuote]s Algorithm", "Subsection",
 CellChangeTimes->{{3.8189043663034573`*^9, 3.818904371905249*^9}},
 CellTags->"Section52",
 CellID->1111888893,ExpressionUUID->"241c7854-4cba-419d-943e-669ba872fff9"],

Cell[CellGroupData[{

Cell["Consider again a secrete bit string.", "MathCaption",
 CellChangeTimes->{{3.818904468841568*^9, 3.818904477638376*^9}, {
  3.823919664810712*^9, 
  3.823919665383595*^9}},ExpressionUUID->"c9458ad1-85e5-4819-97ba-\
ae56d927e586"],

Cell[BoxData[
 RowBox[{
  RowBox[{"string", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.818904479394968*^9, 3.818904486648967*^9}, {
   3.8189045779726343`*^9, 3.818904578522773*^9}, 3.8239196693215714`*^9},
 CellLabel->"In[3]:=",ExpressionUUID->"713d4ff2-220e-45e9-bacf-338b049f1714"],

Cell["\<\
Consider a two-to-one function obeying the rule (specified in Simon\
\[CloseCurlyQuote]s problem).\
\>", "Text",
 CellChangeTimes->{{3.818667068937937*^9, 3.818667100857731*^9}, {
  3.818904425228112*^9, 3.818904426228716*^9}, {3.818904530128048*^9, 
  3.818904540241255*^9}, {3.8189045945983677`*^9, 
  3.8189046183567533`*^9}},ExpressionUUID->"b2ee20e5-59b3-42bb-b099-\
270f84147052"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "1"}], "]"}], "=", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "0"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8186508164773283`*^9, 3.818650885233067*^9}, {
  3.818651470688508*^9, 3.818651533211761*^9}, {3.820581492666233*^9, 
  3.820581497412994*^9}, {3.823919672438292*^9, 3.823919683305297*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"4cbeb37b-2b67-444d-ae1a-b45fd31496a9"],

Cell["\<\
Here is an implementation of the corresponding quantum oracle.\
\>", "Text",
 CellChangeTimes->{{3.818667106879932*^9, 
  3.818667130610606*^9}},ExpressionUUID->"87907545-3afc-4ca1-a5d8-\
0f8a4ac1c82d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"all", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"cc", ",", "tt"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"S", "@", "all"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"cc", ",", "6"}], "]"}], ",", 
    RowBox[{"Oracle", "[", 
     RowBox[{"f", ",", 
      RowBox[{"S", "@", "cc"}], ",", 
      RowBox[{"S", "@", "tt"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"cc", ",", "6"}], "]"}], ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "@", "cc"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.818657304343545*^9, 3.818657362073503*^9}, {
   3.818657566718795*^9, 3.818657575098328*^9}, {3.8186656344167633`*^9, 
   3.818665646880411*^9}, 3.818667002511541*^9, {3.8189046330493393`*^9, 
   3.818904782249652*^9}, {3.8196825458067217`*^9, 3.819682546637857*^9}, {
   3.823919698875877*^9, 3.823919705625057*^9}, 3.829779079533222*^9, 
   3.829808701853804*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"e9427b1e-e7fb-4bca-a01f-2b9e7291b5d2"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{4, -1}, {5, -1}}, {{4, -2}, {5, -2}}}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {5, -3}}, {{
    0, -4}, {5, -4}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -4}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -2}, {2, -3}, {2, -4}}], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     FilledCurveBox[{
      BezierCurve[{{2.4, -1}, {2.4, -0.47439999999999993`}, {
         1.6, -0.47439999999999993`}, {1.6, -1}}], 
       Line[{{1.6, -1}, {1.6, -2}}], 
       BezierCurve[{{1.6, -2.5256}, {2.4, -2.5256}, {2.4, -2}}]}]}, InsetBox[
     StyleBox["\<\"f\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{2, Rational[-3, 2]}, {2, -1.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]], {
     CircleBox[{2, -3}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
        2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}, {
     CircleBox[{2, -4}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -4}, {2.2666666666666666`, -4}}, {{
        2, -4.266666666666667}, {2, -3.7333333333333334`}}}]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {3, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, 
     CircleBox[{4, -1.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -1.2}, {4.24, -0.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, 
     CircleBox[{4, -2.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -2.2}, {4.24, -1.76}}]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->226.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.81866699288649*^9, 3.818667004777478*^9}, 
   3.818667082015224*^9, 3.8186671327204657`*^9, 3.8188342149783154`*^9, 
   3.818904641791965*^9, {3.818904698263281*^9, 3.818904782722649*^9}, 
   3.818977888320998*^9, 3.819682553944664*^9, 3.81968260926081*^9, 
   3.819803884408242*^9, 3.819804207556581*^9, 3.819804287666625*^9, {
   3.820581500838455*^9, 3.8205815235013742`*^9}, 3.823919706737158*^9, 
   3.824001328691001*^9, 3.82634158923775*^9, 3.826342467527625*^9, {
   3.829779082232997*^9, 3.829779092194749*^9}, 3.830132499365251*^9, 
   3.830142132550832*^9},
 CellLabel->"Out[9]=",
 CellID->1513343040,ExpressionUUID->"07edfb49-eede-4684-9a9a-cb8206a2ee33"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"ExpressionFor", "[", "qc", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"out", ",", 
   RowBox[{"S", "@", "all"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"result", "=", 
  RowBox[{"Readout", "[", 
   RowBox[{"out", ",", 
    RowBox[{"S", "@", "cc"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.818904790025478*^9, 3.818904832825738*^9}, {
   3.8189051241846123`*^9, 3.818905147875737*^9}, {3.818977896310096*^9, 
   3.818977896669578*^9}, 3.830132248502214*^9},
 CellLabel->"In[10]:=",ExpressionUUID->"675d0aa5-0422-45d6-bf13-d1bac9d8465b"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   SqrtBox["2"]], "-", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   SqrtBox["2"]]}]], "Output",
 CellChangeTimes->{{3.818904813285017*^9, 3.81890486434695*^9}, {
   3.8189051253179617`*^9, 3.8189051585431623`*^9}, 3.818977897189589*^9, 
   3.8196825569866953`*^9, 3.8196826106393957`*^9, 3.819803887311562*^9, 
   3.819804207693643*^9, 3.8198042878003473`*^9, {3.8205815036260643`*^9, 
   3.8205815247493896`*^9}, 3.8239197085313463`*^9, 3.8240013318755903`*^9, 
   3.826341589410653*^9, 3.82634247087998*^9, {3.8297790856813993`*^9, 
   3.829779093154599*^9}, 3.830132501947054*^9, 3.830142133585362*^9},
 CellLabel->"Out[11]=",
 CellID->1455422470,ExpressionUUID->"99f91e7b-b8a4-4222-acc0-9f1c529f6d3c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{{3.818904813285017*^9, 3.81890486434695*^9}, {
   3.8189051253179617`*^9, 3.8189051585431623`*^9}, 3.818977897189589*^9, 
   3.8196825569866953`*^9, 3.8196826106393957`*^9, 3.819803887311562*^9, 
   3.819804207693643*^9, 3.8198042878003473`*^9, {3.8205815036260643`*^9, 
   3.8205815247493896`*^9}, 3.8239197085313463`*^9, 3.8240013318755903`*^9, 
   3.826341589410653*^9, 3.82634247087998*^9, {3.8297790856813993`*^9, 
   3.829779093154599*^9}, 3.830132501947054*^9, 3.830142133590383*^9},
 CellLabel->"Out[12]=",
 CellID->1446713960,ExpressionUUID->"bf376120-30b5-4938-ba92-51cb9584aa3f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqs", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"out", "=", 
      RowBox[{"ExpressionFor", "[", 
       RowBox[{
        RowBox[{"Matrix", "[", "qc", "]"}], ",", 
        RowBox[{"S", "@", "all"}]}], "]"}]}], ";", 
     RowBox[{"result", "=", 
      RowBox[{"Readout", "[", 
       RowBox[{"out", ",", 
        RowBox[{"S", "@", "cc"}]}], "]"}]}]}], ",", 
    RowBox[{"{", "2", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.818904790025478*^9, 3.818904832825738*^9}, {
   3.8189051241846123`*^9, 3.818905215586441*^9}, {3.823919719444059*^9, 
   3.823919723782661*^9}, 3.8301322485071697`*^9},
 CellLabel->"In[13]:=",ExpressionUUID->"56187403-9428-4aff-be77-ba2e1647d23e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8189052134477863`*^9, 3.8189052165380707`*^9}, 
   3.8189052806594467`*^9, {3.818977904213007*^9, 3.818977907219247*^9}, 
   3.819682558006394*^9, 3.819682612488873*^9, 3.8198038902186527`*^9, 
   3.819804207957123*^9, 3.819804288059783*^9, {3.8205815061763983`*^9, 
   3.8205815700234747`*^9}, {3.823919710370219*^9, 3.8239197256179047`*^9}, 
   3.8240013333757067`*^9, 3.826341589737027*^9, 3.8263424726383343`*^9, 
   3.829779101860836*^9, 3.830132504903571*^9, 3.83014213536446*^9},
 CellLabel->"Out[13]=",
 CellID->1067279918,ExpressionUUID->"7d1447f1-edc6-4606-ac2f-02f86989c603"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Now let us examine a lager system. Suppose that we are given a secrete bit \
string.\
\>", "MathCaption",
 CellChangeTimes->{{3.818904468841568*^9, 3.818904477638376*^9}, {
  3.823919664810712*^9, 3.823919665383595*^9}, {3.829810076269121*^9, 
  3.829810140245269*^9}},
 CellID->1555491913,ExpressionUUID->"43705915-bfca-450c-94b2-4ea4ee8a0bfd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"string", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.818904479394968*^9, 3.818904486648967*^9}, {
   3.8189045779726343`*^9, 3.818904578522773*^9}, 3.8239196693215714`*^9, {
   3.8297779181082687`*^9, 3.829777918457204*^9}},
 CellLabel->"In[14]:=",
 CellID->1834146860,ExpressionUUID->"ade458f6-cea1-4951-97d7-19fadc48a610"],

Cell["\<\
This is a function consistent with the above secrete bit string.\
\>", "Text",
 CellChangeTimes->{{3.818667068937937*^9, 3.818667100857731*^9}, {
  3.818904425228112*^9, 3.818904426228716*^9}, {3.818904530128048*^9, 
  3.818904540241255*^9}, {3.8189045945983677`*^9, 3.8189046183567533`*^9}, {
  3.829810147816004*^9, 3.829810183398014*^9}},
 CellID->1526006982,ExpressionUUID->"a6f85606-cc16-4b5b-80f1-35c79eaef247"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "0", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "1", ",", "0"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "1"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "0", ",", "1"}], "]"}], "=", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "1", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "1", ",", "1"}], "]"}], "=", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "0", ",", "1"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8186508164773283`*^9, 3.818650885233067*^9}, {
  3.818651470688508*^9, 3.818651533211761*^9}, {3.820581492666233*^9, 
  3.820581497412994*^9}, {3.823919672438292*^9, 3.823919683305297*^9}, {
  3.8297779306294613`*^9, 3.82977796686373*^9}, {3.8297780048201227`*^9, 
  3.8297780977432423`*^9}},
 CellLabel->"In[15]:=",
 CellID->202150353,ExpressionUUID->"93cfef95-f9c8-4880-90d6-91776ae0aa6a"],

Cell["\<\
Here is an implementation of the corresponding quantum oracle.\
\>", "Text",
 CellChangeTimes->{{3.818667106879932*^9, 3.818667130610606*^9}},
 CellID->221853317,ExpressionUUID->"c0f3c799-38da-4469-a049-58ea7e1c8bcb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5", ",", "6"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"all", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"cc", ",", "tt"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qc1", "=", 
   RowBox[{"QuantumCircuit", "[", 
    RowBox[{
     RowBox[{"LogicalForm", "[", 
      RowBox[{
       RowBox[{"Ket", "[", "]"}], ",", 
       RowBox[{"S", "@", "all"}]}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"cc", ",", "6"}], "]"}], ",", 
     RowBox[{"Oracle", "[", 
      RowBox[{"f", ",", 
       RowBox[{"S", "@", "cc"}], ",", 
       RowBox[{"S", "@", "tt"}]}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"cc", ",", "6"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"qc1", ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "@", "cc"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.818657304343545*^9, 3.818657362073503*^9}, {
   3.818657566718795*^9, 3.818657575098328*^9}, {3.8186656344167633`*^9, 
   3.818665646880411*^9}, 3.818667002511541*^9, {3.8189046330493393`*^9, 
   3.818904782249652*^9}, {3.8196825458067217`*^9, 3.819682546637857*^9}, {
   3.823919698875877*^9, 3.823919705625057*^9}, {3.829778992280254*^9, 
   3.8297790338476477`*^9}, {3.829779112786602*^9, 3.829779112999728*^9}, {
   3.829779302531023*^9, 3.8297793215192842`*^9}, {3.829808701866789*^9, 
   3.829808701867301*^9}},
 CellLabel->"In[19]:=",
 CellID->657087627,ExpressionUUID->"8d7979e8-ce3b-42e7-a245-3e8bff9880cf"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{4, -1}, {5, -1}}, {{4, -2}, {5, -2}}, {{4, -3}, {5, -3}}}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
    0, -4}, {5, -4}}, {{0, -5}, {5, -5}}, {{0, -6}, {5, -6}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -5}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -6}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -2}, {2, -3}, {2, -4}, {2, -5}, {2, -6}}], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     FilledCurveBox[{
      BezierCurve[{{2.4, -1}, {2.4, -0.47439999999999993`}, {
         1.6, -0.47439999999999993`}, {1.6, -1}}], 
       Line[{{1.6, -1}, {1.6, -3}}], 
       BezierCurve[{{1.6, -3.5256}, {2.4, -3.5256}, {2.4, -3}}]}]}, InsetBox[
     StyleBox["\<\"f\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light",
      FontSlant->Italic], {2, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]], {
     CircleBox[{2, -4}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -4}, {2.2666666666666666`, -4}}, {{
        2, -4.266666666666667}, {2, -3.7333333333333334`}}}]}, {
     CircleBox[{2, -5}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -5}, {2.2666666666666666`, -5}}, {{
        2, -5.266666666666667}, {2, -4.733333333333333}}}]}, {
     CircleBox[{2, -6}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -6}, {2.2666666666666666`, -6}}, {{
        2, -6.266666666666667}, {2, -5.733333333333333}}}]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {3, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {3, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, 
     CircleBox[{4, -1.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -1.2}, {4.24, -0.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, 
     CircleBox[{4, -2.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -2.2}, {4.24, -1.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, 
     CircleBox[{4, -3.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -3.2}, {4.24, -2.76}}]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->226.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.81866699288649*^9, 3.818667004777478*^9}, 
   3.818667082015224*^9, 3.8186671327204657`*^9, 3.8188342149783154`*^9, 
   3.818904641791965*^9, {3.818904698263281*^9, 3.818904782722649*^9}, 
   3.818977888320998*^9, 3.819682553944664*^9, 3.81968260926081*^9, 
   3.819803884408242*^9, 3.819804207556581*^9, 3.819804287666625*^9, {
   3.820581500838455*^9, 3.8205815235013742`*^9}, 3.823919706737158*^9, 
   3.824001328691001*^9, 3.82634158923775*^9, 3.826342467527625*^9, 
   3.829779003430479*^9, {3.829779036725359*^9, 3.829779039200865*^9}, {
   3.8297791071325703`*^9, 3.829779115144308*^9}, {3.829779304526758*^9, 
   3.8297793256691847`*^9}, 3.82977988286736*^9, 3.829780055508788*^9, 
   3.829810187351988*^9, 3.8301325121789713`*^9, 3.830142139628044*^9},
 CellLabel->"Out[23]=",
 CellID->1108756017,ExpressionUUID->"7d352728-3e5f-4deb-b9da-8cfddfc509f4"]
}, Open  ]],

Cell["This is one way to get the measurement outcome.", "Text",
 CellChangeTimes->{{3.8297801729388533`*^9, 3.829780191205616*^9}},
 CellID->1617894012,ExpressionUUID->"dc774785-2c92-4f57-880d-715206081e05"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"ExpressionFor", "[", "qc2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"out", ",", 
   RowBox[{"S", "@", "all"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"result", "=", 
  RowBox[{"Readout", "[", 
   RowBox[{"out", ",", 
    RowBox[{"S", "@", "cc"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.818904790025478*^9, 3.818904832825738*^9}, {
   3.8189051241846123`*^9, 3.818905147875737*^9}, {3.818977896310096*^9, 
   3.818977896669578*^9}, 3.8297793348614264`*^9, {3.829779458369731*^9, 
   3.829779458405448*^9}, 3.830132248516824*^9},
 CellLabel->"In[24]:=",
 CellID->154236232,ExpressionUUID->"cb95b0e4-43b0-458d-8765-c94403bcb5ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "2"]}], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{{3.82978016881574*^9, 3.829780196946645*^9}, 
   3.829810192841991*^9, 3.8301325296358547`*^9, 3.8301325670697317`*^9, 
   3.83014214174179*^9},
 CellLabel->"Out[25]=",
 CellID->639558572,ExpressionUUID->"4690e317-3502-4c35-868e-a9b20cd48b37"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{{3.82978016881574*^9, 3.829780196946645*^9}, 
   3.829810192841991*^9, 3.8301325296358547`*^9, 3.8301325670697317`*^9, 
   3.830142141750415*^9},
 CellLabel->"Out[26]=",
 CellID->905266369,ExpressionUUID->"713199f1-d28c-4eb2-b409-b09d347daebc"]
}, Open  ]],

Cell["\<\
To make repeated measurements, it is more efficient to first compute the \
state just before the measurement.\
\>", "Text",
 CellChangeTimes->{{3.8297802035917473`*^9, 3.829780267041131*^9}},
 CellID->494273051,ExpressionUUID->"01a85adc-869d-402e-8b87-51b03226a8b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"ExpressionFor", "[", "qc1", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.829779610754354*^9, 3.829779612182993*^9}, {
   3.8297804738380957`*^9, 3.829780473966215*^9}, 3.8301322485260057`*^9, {
   3.830132972245831*^9, 3.830132974697197*^9}, {3.83014215356872*^9, 
   3.8301421542882633`*^9}},
 CellLabel->"In[28]:=",
 CellID->289243815,ExpressionUUID->"109edc96-fcee-4275-a86c-899e1d860841"],

Cell["Now we perform the measurement repeatedly.", "Text",
 CellChangeTimes->{{3.829780271293535*^9, 3.829780282273882*^9}},
 CellID->929134592,ExpressionUUID->"9f13f585-92e9-4df9-a83f-7bcb65519ad5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"out", "=", 
       RowBox[{"Measurement", "[", 
        RowBox[{"new", ",", 
         RowBox[{"S", "@", "cc"}]}], "]"}]}], ";", 
      RowBox[{"Readout", "[", 
       RowBox[{"out", ",", 
        RowBox[{"S", "@", "cc"}]}], "]"}]}], ",", 
     RowBox[{"{", "12", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"data", "//", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.8297796172694473`*^9, 3.829779623152055*^9}, {
  3.8297800628837214`*^9, 3.8297801463514853`*^9}, {3.829780291769129*^9, 
  3.8297803117932587`*^9}, {3.8297803594266872`*^9, 3.8297803596279907`*^9}, {
  3.829780481003681*^9, 3.829780489935849*^9}},
 CellLabel->"In[29]:=",
 CellID->612895729,ExpressionUUID->"dc17c73d-0ebf-4b94-8754-a734c316e40c"],

Cell[BoxData[
 TagBox[GridBox[{
    {"1", "1", "1"},
    {"1", "1", "1"},
    {"0", "0", "1"},
    {"1", "1", "1"},
    {"0", "0", "1"},
    {"1", "1", "1"},
    {"0", "0", "1"},
    {"0", "0", "0"},
    {"1", "1", "0"},
    {"1", "1", "0"},
    {"0", "0", "1"},
    {"0", "0", "1"}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.829779623570291*^9, 3.82977977129375*^9, 3.829779888909697*^9, 
   3.829780080268927*^9, {3.829780122196973*^9, 3.829780147115911*^9}, {
   3.829780284730556*^9, 3.8297803124775543`*^9}, 3.829780361521147*^9, 
   3.8297804910134983`*^9, 3.829810202381242*^9, 3.830132610641554*^9, 
   3.8301421578640633`*^9},
 CellLabel->"Out[30]//TableForm=",
 CellID->509463432,ExpressionUUID->"291d37b8-b692-4f85-a360-90260cf624ee"]
}, Open  ]],

Cell["\<\
As two linearly independent vectors (bit strings), we choose these:\
\>", "Text",
 CellChangeTimes->{{3.829810208091785*^9, 3.829810243167761*^9}},
 CellID->701716311,ExpressionUUID->"26c3c285-eee4-42fe-a604-65eaaafd90ee"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mat", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.829810252417053*^9, 3.829810285252356*^9}},
 CellLabel->"In[31]:=",
 CellID->1789090274,ExpressionUUID->"5d3d409c-2546-4eb8-89cb-d4acd272dbfe"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8298102767429857`*^9, 3.8298102855782423`*^9}, 
   3.830142161856237*^9},
 CellLabel->"Out[31]=",
 CellID->564327070,ExpressionUUID->"c3de4442-5bbf-42ae-b5e9-e44c1c9158d6"]
}, Open  ]],

Cell[TextData[{
 "Then, the linear equation, ",
 StyleBox["mat.ss=0 (mod 2)", "Input"],
 ", for the Boolean variables ",
 StyleBox["ss:={s1,s2,s3}", "Input"],
 " is given by the following, which agrees with the given secrete bit \
string."
}], "Text",
 CellChangeTimes->{{3.829810304905257*^9, 3.829810433375836*^9}, {
  3.829810493303297*^9, 3.82981049560874*^9}},
 CellID->721731118,ExpressionUUID->"4d943bd4-0a6e-44f1-adbc-d59dc73936cb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ss", "=", 
  RowBox[{"{", 
   RowBox[{"1", ",", "1", ",", "0"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.829810363641958*^9, 3.829810391099534*^9}},
 CellLabel->"In[32]:=",
 CellID->371146945,ExpressionUUID->"9b290f7d-43c6-4784-8e54-64cede99cdbc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.8298104235916243`*^9, 3.829810511333975*^9, 
  3.83014216341708*^9},
 CellLabel->"Out[32]=",
 CellID->1565011659,ExpressionUUID->"d03d569a-1365-4e66-9edf-72bc967f9bf3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Mod", "[", 
  RowBox[{
   RowBox[{"mat", ".", "ss"}], ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.8298104545294447`*^9, 3.829810471928103*^9}},
 CellLabel->"In[33]:=",
 CellID->799014800,ExpressionUUID->"0d32a973-6aba-4828-af5a-d791bcc70279"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.8298104561997557`*^9, 3.8298104797237577`*^9}, 
   3.829810512065343*^9, 3.830142164092483*^9},
 CellLabel->"Out[33]=",
 CellID->178811984,ExpressionUUID->"60994b76-0c7a-49dc-aa64-b330967e841f"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Quantum Fourier Transform", "Section",
 CellChangeTimes->{{3.8186783783482513`*^9, 3.818678385862735*^9}},
 CellTags->"Section53",
 CellID->113928457,ExpressionUUID->"376ce1dd-bff8-4080-bc22-db5ee7488fe0"],

Cell["Definition and Physical Meaning", "Subsection",
 CellChangeTimes->{{3.821351001768704*^9, 3.821351007820595*^9}},
 CellTags->"Section54",
 CellID->1387647322,ExpressionUUID->"aea805f3-b3a6-49e8-85a8-06304c126a6e"],

Cell[CellGroupData[{

Cell["Quantum Implementation", "Subsection",
 CellChangeTimes->{{3.8213510481060534`*^9, 3.821351057858974*^9}},
 CellTags->"Section55",
 CellID->516134434,ExpressionUUID->"3181692c-1196-4295-9e8d-4bb3d0cd9808"],

Cell[CellGroupData[{

Cell["We demonstrate it for a four-qubit register.", "MathCaption",
 CellChangeTimes->{{3.818752062652533*^9, 
  3.818752077254423*^9}},ExpressionUUID->"1983da86-023b-423d-900e-\
0de28421caec"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$N", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ss", "=", 
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"Range", "[", "$N", "]"}], ",", "None"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7594476343156214`*^9, 3.7594476407822723`*^9}, {
  3.759543542877948*^9, 3.759543544147127*^9}, {3.785207187421732*^9, 
  3.7852071989731913`*^9}, {3.7852080243826437`*^9, 3.785208024456031*^9}, {
  3.7852080805154057`*^9, 3.785208080673696*^9}, {3.7852081205835342`*^9, 
  3.7852081206614027`*^9}, {3.785208190357152*^9, 3.785208190427886*^9}, {
  3.785208740837468*^9, 3.78520874092059*^9}, {3.7852090551567917`*^9, 
  3.78520905523431*^9}, {3.786141511401209*^9, 3.786141511512052*^9}, {
  3.8187516966604*^9, 3.8187516983805428`*^9}, {3.818752058907992*^9, 
  3.818752058962665*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"a18fc597-8779-4e54-9df0-9bd0fbe90a06"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SubscriptBox[
    TemplateBox[{"S"},
     "RowDefault"], 
    TemplateBox[{"1"},
     "RowDefault"]], ",", 
   SubscriptBox[
    TemplateBox[{"S"},
     "RowDefault"], 
    TemplateBox[{"2"},
     "RowDefault"]], ",", 
   SubscriptBox[
    TemplateBox[{"S"},
     "RowDefault"], 
    TemplateBox[{"3"},
     "RowDefault"]], ",", 
   SubscriptBox[
    TemplateBox[{"S"},
     "RowDefault"], 
    TemplateBox[{"4"},
     "RowDefault"]]}], "}"}]], "Output",
 CellChangeTimes->{{3.785207197097588*^9, 3.785207200863649*^9}, 
   3.785208024946724*^9, 3.785208081096096*^9, 3.785208125078937*^9, {
   3.785208186754281*^9, 3.7852081907585983`*^9}, 3.785208527404355*^9, 
   3.785208744737607*^9, 3.785209055602697*^9, 3.785209093342251*^9, 
   3.786141302804717*^9, {3.786141496409569*^9, 3.786141512214634*^9}, {
   3.818751690994458*^9, 3.818751710630349*^9}, {3.818752059356831*^9, 
   3.8187520785358543`*^9}, 3.818834017803381*^9, 3.818834068038178*^9, 
   3.818977923408136*^9, 3.819682617431842*^9, 3.81980389209645*^9, 
   3.8198042079633827`*^9, 3.819804288066284*^9, {3.823919757070722*^9, 
   3.823919761209941*^9}, 3.824001336877152*^9, 3.826341589743534*^9, 
   3.826342475621882*^9, 3.826342508080481*^9, 3.830142170214094*^9},
 CellLabel->"Out[35]=",
 CellID->111054546,ExpressionUUID->"a16f1e84-18a5-4d5a-89f8-2a2f0fa5e4bc"]
}, Open  ]],

Cell["Here defined are the controlled-phase gates.", "Text",
 CellChangeTimes->{{3.818752091439775*^9, 
  3.818752113005087*^9}},ExpressionUUID->"7490a608-ee1d-4fd9-b334-\
4ca4561da508"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CP", "[", 
   RowBox[{"j_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"S", "[", 
   RowBox[{"j", ",", "6"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CP", "[", 
   RowBox[{"j_", ",", "k_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "[", "j", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Phase", "[", 
      RowBox[{
       RowBox[{"Pi", " ", 
        RowBox[{"Power", "[", 
         RowBox[{"2", ",", 
          RowBox[{"k", "-", "j"}]}], "]"}]}], ",", 
       RowBox[{"S", "[", "k", "]"}], ",", 
       RowBox[{"\"\<Label\>\"", "\[Rule]", 
        RowBox[{"Subscript", "[", 
         RowBox[{"\"\<R\>\"", ",", 
          RowBox[{"j", "-", "k"}]}], "]"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "/;", 
   RowBox[{"j", ">", "k"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CP", "[", 
   RowBox[{"j_", ",", "k_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "[", "j", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Phase", "[", 
      RowBox[{
       RowBox[{"Pi", " ", 
        RowBox[{"Power", "[", 
         RowBox[{"2", ",", 
          RowBox[{"j", "-", "k"}]}], "]"}]}], ",", 
       RowBox[{"S", "[", "k", "]"}], ",", 
       RowBox[{"\"\<Label\>\"", "\[Rule]", 
        RowBox[{"Subscript", "[", 
         RowBox[{"\"\<R\>\"", ",", 
          RowBox[{"k", "-", "j"}]}], "]"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "/;", 
   RowBox[{"j", "<", "k"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SW", "[", "j_", "]"}], ":=", 
  RowBox[{"SWAP", "[", 
   RowBox[{
    RowBox[{"S", "[", "j", "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"$N", "-", "j", "+", "1"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.759820447989932*^9, 3.75982048821699*^9}, {
   3.7598205205046673`*^9, 3.7598206286907377`*^9}, {3.759820739083046*^9, 
   3.759820808300682*^9}, {3.759820946783554*^9, 3.759820973917048*^9}, 
   3.759821011602481*^9, {3.759821068998357*^9, 3.759821070437039*^9}, {
   3.759821276451549*^9, 3.759821296293956*^9}, {3.7598214373655777`*^9, 
   3.7598214388257217`*^9}, {3.759821941747143*^9, 3.759822000986926*^9}, {
   3.78520861801999*^9, 3.7852086431043158`*^9}, {3.818751721217849*^9, 
   3.818751751535943*^9}, {3.818834050234736*^9, 3.8188340509011497`*^9}, {
   3.818834083011331*^9, 3.8188340870717163`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"677d686f-c975-4c46-903c-1613f5d9b6f9"],

Cell["\<\
This is the standard implementation, which can be seen commonly in textbooks.\
\
\>", "Text",
 CellChangeTimes->{{3.8187517601631737`*^9, 
  3.818751793970254*^9}},ExpressionUUID->"b5fb0824-b3cd-4365-bf78-\
e7e95d1cca0c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"swaps", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"SW", "[", "j", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"$N", "/", "2"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gates4a", "=", 
   RowBox[{"Catenate", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"CP", "[", 
       RowBox[{"j", ",", "k"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "$N"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "k", ",", "$N"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qft4a", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"gates4a", ",", "swaps"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc4a", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Sequence", "@@", "qft4a"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.759821602455901*^9, 3.759821715507547*^9}, {
   3.759821776796034*^9, 3.7598218000143833`*^9}, {3.759821830895533*^9, 
   3.759821841895565*^9}, {3.759821906987432*^9, 3.759821923939027*^9}, {
   3.75982202304778*^9, 3.759822072285696*^9}, {3.759822433372991*^9, 
   3.759822437431732*^9}, {3.77684106455268*^9, 3.776841068931573*^9}, {
   3.776841283804262*^9, 3.776841331180581*^9}, {3.776845750440116*^9, 
   3.776845760389566*^9}, {3.785206760081921*^9, 3.785206770708784*^9}, {
   3.785206802181602*^9, 3.785206867409318*^9}, {3.7852082030537148`*^9, 
   3.785208205301676*^9}, {3.7852085169853563`*^9, 3.7852085170610228`*^9}, {
   3.785208961017174*^9, 3.785208966114057*^9}, 3.8263425028500443`*^9, 
   3.829808701887732*^9},
 CellLabel->"In[40]:=",ExpressionUUID->"22c45de2-5b5a-4565-8454-979479ab822e"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {13, -1}}, {{0, -2}, {13, -2}}, {{0, -3}, {13, -3}}, {{
    0, -4}, {13, -4}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -2}, {2, -1}}], DiskBox[{2, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {2, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{3, -3}, {3, -1}}], DiskBox[{3, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {3, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -4}, {4, -1}}], DiskBox[{4, -4}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "3"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {4, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {5, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{6, -3}, {6, -2}}], DiskBox[{6, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {6, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{7, -4}, {7, -2}}], DiskBox[{7, -4}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {7, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {8, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{9, -4}, {9, -3}}], DiskBox[{9, -4}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {9, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {10, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{11, -1}, {11, -4}}], 
    LineBox[{{{10.91, -1.09}, {11.09, -0.91}}, {{10.91, -0.91}, {
     11.09, -1.09}}}], 
    LineBox[{{{10.91, -4.09}, {11.09, -3.91}}, {{10.91, -3.91}, {
     11.09, -4.09}}}]}, {LineBox[{{12, -2}, {12, -3}}], 
    LineBox[{{{11.91, -2.09}, {12.09, -1.91}}, {{11.91, -1.91}, {
     12.09, -2.09}}}], 
    LineBox[{{{11.91, -3.09}, {12.09, -2.91}}, {{11.91, -2.91}, {
     12.09, -3.09}}}]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->514.8000000000001,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{
  3.785206773059022*^9, {3.7852068081131496`*^9, 3.785206811207465*^9}, {
   3.785206846670236*^9, 3.785206872451974*^9}, {3.785206910518312*^9, 
   3.785206922991712*^9}, 3.785207037484292*^9, 3.785208027609289*^9, 
   3.7852080829878387`*^9, 3.785208126658057*^9, {3.785208197518869*^9, 
   3.785208205740891*^9}, {3.7852085179353857`*^9, 3.7852085291953287`*^9}, 
   3.785208645409029*^9, 3.785208746508309*^9, 3.785208967475945*^9, 
   3.785209057920162*^9, 3.7852090953593493`*^9, 3.7861413051536818`*^9, {
   3.786141498892735*^9, 3.786141514252198*^9}, 3.818751714638822*^9, 
   3.818751753154832*^9, 3.818751798931346*^9, 3.818752118197735*^9, 
   3.818834021038803*^9, {3.818834070214184*^9, 3.8188340896175137`*^9}, 
   3.818977925801115*^9, 3.819682621194201*^9, 3.819803895747267*^9, 
   3.8198042080077267`*^9, 3.819804288111319*^9, 3.823919767002904*^9, 
   3.824001340012806*^9, 3.826341589792461*^9, {3.82634247982522*^9, 
   3.8263425105317574`*^9}, 3.830142172740704*^9},
 CellLabel->"Out[43]=",
 CellID->315417612,ExpressionUUID->"c929461c-0ba3-474b-a1c6-f570fd4e4db5"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Semiclassical Implementation", "Subsection",
 CellChangeTimes->{{3.821351036473692*^9, 3.82135107062739*^9}, {
  3.8230570284887667`*^9, 3.823057034382341*^9}},
 CellTags->"Section56",
 CellID->984982005,ExpressionUUID->"30e1877f-644c-48f1-ae88-4c536fd2c397"],

Cell[CellGroupData[{

Cell["\<\
You can convince yourself that the above implementation is equivalent to the \
following one.\
\>", "MathCaption",
 CellChangeTimes->{{3.818751805546454*^9, 
  3.8187518225778093`*^9}},ExpressionUUID->"eb0a6c1c-c2a6-476f-9869-\
99cdf48a9393"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"swaps", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"SW", "[", "j", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"$N", "/", "2"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gates4b", "=", 
   RowBox[{"Catenate", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"CP", "[", 
       RowBox[{"j", ",", "k"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "$N"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "k"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qft4b", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"gates4b", ",", "swaps"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc4b", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Sequence", "@@", "qft4b"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.759821602455901*^9, 3.759821715507547*^9}, {
   3.759821776796034*^9, 3.7598218000143833`*^9}, {3.759821830895533*^9, 
   3.759821841895565*^9}, {3.759821906987432*^9, 3.759821923939027*^9}, {
   3.75982202304778*^9, 3.759822072285696*^9}, {3.759822433372991*^9, 
   3.759822437431732*^9}, {3.77684106455268*^9, 3.776841068931573*^9}, {
   3.776841283804262*^9, 3.776841331180581*^9}, {3.776845750440116*^9, 
   3.776845760389566*^9}, {3.785206760081921*^9, 3.785206770708784*^9}, {
   3.785206802181602*^9, 3.785206867409318*^9}, {3.7852082030537148`*^9, 
   3.785208205301676*^9}, {3.785208264055751*^9, 3.785208265433721*^9}, {
   3.785208465269794*^9, 3.785208467665361*^9}, {3.785208508178133*^9, 
   3.7852085101410017`*^9}, {3.785208970066224*^9, 3.785208974192955*^9}, 
   3.826342496449066*^9, 3.8298087018922367`*^9},
 CellLabel->"In[44]:=",ExpressionUUID->"e744e3ee-a374-4954-8863-79fd64a99f0b"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {13, -1}}, {{0, -2}, {13, -2}}, {{0, -3}, {13, -3}}, {{
    0, -4}, {13, -4}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {2, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {3, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -1}, {4, -3}}], DiskBox[{4, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {4, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{5, -2}, {5, -3}}], DiskBox[{5, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {5, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {6, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{7, -1}, {7, -4}}], DiskBox[{7, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "3"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {7, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{8, -2}, {8, -4}}], DiskBox[{8, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -4.4}, {8.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {8, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{9, -3}, {9, -4}}], DiskBox[{9, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -4.4}, {9.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {9, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {10, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{11, -1}, {11, -4}}], 
    LineBox[{{{10.91, -1.09}, {11.09, -0.91}}, {{10.91, -0.91}, {
     11.09, -1.09}}}], 
    LineBox[{{{10.91, -4.09}, {11.09, -3.91}}, {{10.91, -3.91}, {
     11.09, -4.09}}}]}, {LineBox[{{12, -2}, {12, -3}}], 
    LineBox[{{{11.91, -2.09}, {12.09, -1.91}}, {{11.91, -1.91}, {
     12.09, -2.09}}}], 
    LineBox[{{{11.91, -3.09}, {12.09, -2.91}}, {{11.91, -2.91}, {
     12.09, -3.09}}}]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->514.8000000000001,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{
  3.78520826582617*^9, 3.785208468426087*^9, {3.785208511428855*^9, 
   3.785208560030025*^9}, {3.785208656062579*^9, 3.785208676951633*^9}, 
   3.785208747535349*^9, {3.785208975209828*^9, 3.785209010018783*^9}, 
   3.78520905920681*^9, {3.785209096617923*^9, 3.785209111214493*^9}, 
   3.786141307687056*^9, {3.786141499210494*^9, 3.786141515647305*^9}, 
   3.81875182387834*^9, 3.818752120331353*^9, 3.818834091191493*^9, 
   3.818977927349614*^9, 3.819682623259693*^9, 3.81980389764596*^9, 
   3.81980420804081*^9, 3.8198042881394653`*^9, 3.8239197738624563`*^9, 
   3.824001341697659*^9, 3.8263415898241997`*^9, {3.826342482223152*^9, 
   3.826342514322097*^9}, 3.830142174407073*^9},
 CellLabel->"Out[47]=",
 CellID->269543169,ExpressionUUID->"f84d77c2-5746-46b1-bf06-130c834b82d9"]
}, Open  ]],

Cell["The measurements are explicitly shown.", "Text",
 CellChangeTimes->{{3.8187518462805147`*^9, 
  3.818751865359686*^9}},ExpressionUUID->"b84fb900-02f4-47d7-8b48-\
880e5165530a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"qft4c", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"gates4b", ",", "swaps", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Spacer\>\"", ",", 
       RowBox[{"Measurement", "[", "ss", "]"}], ",", "\"\<Spacer\>\""}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc4c", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Sequence", "@@", "qft4c"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.77684199244716*^9, 3.776842025076467*^9}, {
   3.7768421972911663`*^9, 3.77684220165478*^9}, {3.776844885255991*^9, 
   3.776844976058004*^9}, {3.7768457944820347`*^9, 3.776845797148038*^9}, {
   3.7852071460495167`*^9, 3.785207167935343*^9}, {3.785207213101696*^9, 
   3.785207221422846*^9}, {3.785209115696018*^9, 3.785209138861218*^9}, {
   3.8187518404435053`*^9, 3.8187518406668377`*^9}, 3.826342490284861*^9, 
   3.8298087018963833`*^9},
 CellLabel->"In[48]:=",ExpressionUUID->"1d36445c-54e7-41d6-9c47-76978a1e756c"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{14, -1}, {16, -1}}, {{14, -2}, {16, -2}}, {{14, -3}, {
     16, -3}}, {{14, -4}, {16, -4}}}]}, 
   LineBox[{{{0, -1}, {14, -1}}, {{0, -2}, {14, -2}}, {{0, -3}, {14, -3}}, {{
    0, -4}, {14, -4}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.025],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.025],
      FontWeight->"Light",
      FontSlant->Italic], {2, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.025],
      FontWeight->"Light",
      FontSlant->Italic], {3, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -1}, {4, -3}}], DiskBox[{4, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.025],
      FontWeight->"Light",
      FontSlant->Italic], {4, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{5, -2}, {5, -3}}], DiskBox[{5, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.025],
      FontWeight->"Light",
      FontSlant->Italic], {5, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.025],
      FontWeight->"Light",
      FontSlant->Italic], {6, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{7, -1}, {7, -4}}], DiskBox[{7, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "3"],
      StripOnInput->False,
      FontSize->Scaled[0.025],
      FontWeight->"Light",
      FontSlant->Italic], {7, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{8, -2}, {8, -4}}], DiskBox[{8, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -4.4}, {8.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.025],
      FontWeight->"Light",
      FontSlant->Italic], {8, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{9, -3}, {9, -4}}], DiskBox[{9, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -4.4}, {9.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.025],
      FontWeight->"Light",
      FontSlant->Italic], {9, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.025],
      FontWeight->"Light",
      FontSlant->Italic], {10, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{11, -1}, {11, -4}}], 
    LineBox[{{{10.91, -1.09}, {11.09, -0.91}}, {{10.91, -0.91}, {
     11.09, -1.09}}}], 
    LineBox[{{{10.91, -4.09}, {11.09, -3.91}}, {{10.91, -3.91}, {
     11.09, -4.09}}}]}, {LineBox[{{12, -2}, {12, -3}}], 
    LineBox[{{{11.91, -2.09}, {12.09, -1.91}}, {{11.91, -1.91}, {
     12.09, -2.09}}}], 
    LineBox[{{{11.91, -3.09}, {12.09, -2.91}}, {{11.91, -2.91}, {
     12.09, -3.09}}}]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{13.6, -1.4}, {14.4, -0.6}]}, 
     CircleBox[{14, -1.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{14, -1.2}, {14.24, -0.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{13.6, -2.4}, {14.4, -1.6}]}, 
     CircleBox[{14, -2.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{14, -2.2}, {14.24, -1.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{13.6, -3.4}, {14.4, -2.6}]}, 
     CircleBox[{14, -3.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{14, -3.2}, {14.24, -2.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{13.6, -4.4}, {14.4, -3.6}]}, 
     CircleBox[{14, -4.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{14, -4.2}, {14.24, -3.76}}]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->622.8000000000001,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{
  3.7852071692458963`*^9, {3.785207207330299*^9, 3.7852072379658117`*^9}, 
   3.785208030348838*^9, 3.7852080852475224`*^9, 3.785208128591608*^9, {
   3.785209128676289*^9, 3.785209139285996*^9}, 3.786141311618725*^9, {
   3.7861414993463373`*^9, 3.786141516881847*^9}, {3.8187518329466257`*^9, 
   3.818751867262953*^9}, 3.818752122395343*^9, 3.8188340929590197`*^9, 
   3.8189779287497873`*^9, 3.819682624927307*^9, 3.8198038992809362`*^9, 
   3.8198042080756683`*^9, 3.819804288167774*^9, 3.823919775898178*^9, 
   3.824001343808284*^9, 3.8263415898499517`*^9, {3.826342484137953*^9, 
   3.826342516184375*^9}, 3.8301421758870277`*^9},
 CellLabel->"Out[49]=",
 CellID->1974633852,ExpressionUUID->"7f2b0fc1-08bb-4007-829d-a74d64b8f270"]
}, Open  ]],

Cell["This is the semiclassical implementation.", "Text",
 CellChangeTimes->{{3.818751896958559*^9, 
  3.818751907961173*^9}},ExpressionUUID->"029afe9d-0445-45f2-852f-\
459f1fb007d1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mm", "=", 
   RowBox[{"Measurement", "[", "ss", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mm", "=", 
   RowBox[{"Transpose", "@", 
    RowBox[{"{", 
     RowBox[{"Measurement", "[", "ss", "]"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gates4d", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"CP", "[", 
      RowBox[{"j", ",", "k"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "$N"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "k"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"more", "=", 
   RowBox[{"Catenate", "[", 
    RowBox[{"Join", "@@@", 
     RowBox[{"Thread", "[", 
      RowBox[{"{", 
       RowBox[{"gates4d", ",", "mm"}], "}"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qft4d", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"more", ",", 
     RowBox[{"{", "\"\<Separator\>\"", "}"}], ",", "swaps"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc4d", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Sequence", "@@", "qft4d"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.759821602455901*^9, 3.759821715507547*^9}, {
   3.759821776796034*^9, 3.7598218000143833`*^9}, {3.759821830895533*^9, 
   3.759821841895565*^9}, {3.759821906987432*^9, 3.759821923939027*^9}, {
   3.75982202304778*^9, 3.759822072285696*^9}, {3.759822433372991*^9, 
   3.759822437431732*^9}, {3.77684106455268*^9, 3.776841068931573*^9}, {
   3.776841283804262*^9, 3.776841331180581*^9}, {3.776845135817244*^9, 
   3.776845197534874*^9}, {3.776845241751616*^9, 3.776845264177053*^9}, {
   3.776845316739291*^9, 3.776845371809669*^9}, {3.776845663473452*^9, 
   3.776845719117017*^9}, {3.776845811248097*^9, 3.77684581897198*^9}, {
   3.785207369342847*^9, 3.785207463854187*^9}, {3.785207556588069*^9, 
   3.785207562941842*^9}, {3.785207611782508*^9, 3.7852076558325377`*^9}, {
   3.7852076879852743`*^9, 3.7852077038018417`*^9}, {3.7852077785878773`*^9, 
   3.78520778062821*^9}, {3.7852078231663733`*^9, 3.785207831010064*^9}, {
   3.7852091692609158`*^9, 3.7852092463392982`*^9}, {3.785209353601173*^9, 
   3.785209375204548*^9}, {3.81875187975598*^9, 3.818751882840087*^9}, 
   3.826342523425848*^9, 3.829808701901166*^9},
 CellLabel->"In[50]:=",ExpressionUUID->"08ddd18c-1d61-4037-8a1e-98bbe29b9504"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{2, -1}, {18, -1}}, {{5, -2}, {18, -2}}, {{9, -3}, {18, -3}}, {{
     14, -4}, {18, -4}}}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {9, -3}}, {{
    0, -4}, {14, -4}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, 
    CircleBox[{2, -1.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{2, -1.2}, {2.24, -0.76}}]}, {
    LineBox[{{3, -1}, {3, -2}}], DiskBox[{3, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {3, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {4, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, 
    CircleBox[{5, -2.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{5, -2.2}, {5.24, -1.76}}]}, {
    LineBox[{{6, -1}, {6, -3}}], DiskBox[{6, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {6, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{7, -2}, {7, -3}}], DiskBox[{7, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {7, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {8, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, 
    CircleBox[{9, -3.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{9, -3.2}, {9.24, -2.76}}]}, {
    LineBox[{{10, -1}, {10, -4}}], DiskBox[{10, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "3"],
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {10, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{11, -2}, {11, -4}}], DiskBox[{11, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{10.6, -4.4}, {11.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {11, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{12, -3}, {12, -4}}], DiskBox[{12, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{11.6, -4.4}, {12.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"R\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {12, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{12.6, -4.4}, {13.4, -3.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.022222222222222223`],
      FontWeight->"Light",
      FontSlant->Italic], {13, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{13.6, -4.4}, {14.4, -3.6}]}, 
    CircleBox[{14, -4.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{14, -4.2}, {14.24, -3.76}}]}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{15, Rational[-9, 2]}, {15, Rational[-1, 2]}}, {{
       15, -4.5}, {15, -0.5}}]]}, {LineBox[{{16, -1}, {16, -4}}], 
    LineBox[{{{15.91, -1.09}, {16.09, -0.91}}, {{15.91, -0.91}, {
     16.09, -1.09}}}], 
    LineBox[{{{15.91, -4.09}, {16.09, -3.91}}, {{15.91, -3.91}, {
     16.09, -4.09}}}]}, {LineBox[{{17, -2}, {17, -3}}], 
    LineBox[{{{16.91, -2.09}, {17.09, -1.91}}, {{16.91, -1.91}, {
     17.09, -2.09}}}], 
    LineBox[{{{16.91, -3.09}, {17.09, -2.91}}, {{16.91, -2.91}, {
     17.09, -3.09}}}]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->694.8000000000001,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.7852074113228693`*^9, 3.785207464267907*^9}, 
   3.785207565969812*^9, {3.785207613712514*^9, 3.7852076569838543`*^9}, {
   3.785207689960497*^9, 3.785207704196005*^9}, 3.785207781269203*^9, {
   3.785207826598832*^9, 3.785207831456151*^9}, 3.785208031644045*^9, 
   3.785208086382863*^9, 3.785208129545439*^9, 3.7852091992338467`*^9, 
   3.785209248200461*^9, 3.785209281893194*^9, {3.7852093588949223`*^9, 
   3.7852093919782457`*^9}, 3.7861413176823273`*^9, {3.78614150064541*^9, 
   3.786141519150777*^9}, {3.818751892315098*^9, 3.8187519103097467`*^9}, 
   3.818752124046637*^9, 3.818834095396285*^9, 3.818977930166815*^9, 
   3.819682626565071*^9, 3.819803901027429*^9, 3.8198042081104727`*^9, 
   3.819804288189734*^9, 3.823919778248447*^9, 3.824001345295804*^9, 
   3.8263415898799353`*^9, {3.82634251841896*^9, 3.826342523829713*^9}, 
   3.830142177423964*^9},
 CellLabel->"Out[55]=",
 CellID->1088569730,ExpressionUUID->"9ed603b7-37ba-4df8-9e80-261a3bb1d9e4"]
}, Open  ]],

Cell["Check the equivalence.", "Text",
 CellChangeTimes->{{3.8187519727012*^9, 
  3.8187519847606993`*^9}},ExpressionUUID->"4ca42a61-75bf-4bb6-a088-\
b85cdab8deaa"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat4a", "=", 
   RowBox[{"Matrix", "[", "qc4a", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat4b", "=", 
   RowBox[{"Matrix", "[", "qc4b", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mat4a", "-", "mat4b"}], "//", "Simplify"}], "//", 
  "Norm"}]}], "Input",
 CellChangeTimes->{{3.786141334360875*^9, 3.786141396064735*^9}, {
  3.818751919525339*^9, 3.818751961901861*^9}, {3.823919798330947*^9, 
  3.823919829624672*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"359e6336-8988-4e52-b691-d6ab463bf315"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.78614139844742*^9, {3.786141473390092*^9, 3.786141527220791*^9}, {
   3.818751924728784*^9, 3.81875196401542*^9}, 3.818752127958845*^9, 
   3.8188340983291893`*^9, 3.818977931975369*^9, 3.819682628930533*^9, 
   3.819803903033723*^9, 3.819804208336306*^9, 3.819804288918358*^9, {
   3.823919780742278*^9, 3.823919832581666*^9}, 3.8240013476639442`*^9, 
   3.826341590187026*^9, 3.826342530427671*^9, 3.830142179434181*^9},
 CellLabel->"Out[58]=",
 CellID->196562055,ExpressionUUID->"ce189f75-dce6-40db-8ce1-dc9b85c9d55b"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Quantum Phase Estimation", "Section",
 CellChangeTimes->{{3.818678388303872*^9, 3.8186783956161346`*^9}},
 CellTags->"Section57",
 CellID->1788606959,ExpressionUUID->"7b1be872-4718-438c-a460-480b0a261bd7"],

Cell["Definition", "Subsection",
 CellChangeTimes->{{3.820302363204175*^9, 3.820302369964678*^9}},
 CellTags->"Section58",
 CellID->641069207,ExpressionUUID->"ccf2212c-ee95-4476-b2a9-071d627d2562"],

Cell[CellGroupData[{

Cell["Implementation", "Subsection",
 CellChangeTimes->{{3.820302377108142*^9, 3.820302380617959*^9}},
 CellTags->"Section59",
 CellID->524705050,ExpressionUUID->"184f5541-c30e-4363-96f7-66eb6a8781bf"],

Cell[CellGroupData[{

Cell["We take an ancillary register consisting of three qubits.", \
"MathCaption",
 CellChangeTimes->{{3.8187435261988697`*^9, 
  3.818743550394718*^9}},ExpressionUUID->"4ec0c88b-5433-4713-ad78-\
5134fa5cb44c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ancilla", "=", 
   RowBox[{"Range", "[", "m", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sys", "=", 
   RowBox[{"m", "+", "1"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.818742545252225*^9, 3.818742575749165*^9}, {
  3.8187428560364122`*^9, 3.818742872178891*^9}, {3.818744194660828*^9, 
  3.81874419937315*^9}, {3.823919846893076*^9, 3.82391984824258*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"95677b7c-0169-4029-a274-91abdcf147a6"],

Cell["\<\
We consider a rotation around the z-axis for the unitary operator. In this \
case, the logical basis consists of the eigenstates of the unitary operator.\
\>", "Text",
 CellChangeTimes->{{3.818743472233326*^9, 3.8187434954070797`*^9}, {
  3.8187437119599037`*^9, 
  3.818743753874928*^9}},ExpressionUUID->"3a0b0e2e-689d-4b21-b088-\
0a1e929d7091"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"p", "=", 
   RowBox[{"18", "/", "25"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{
     RowBox[{"p", " ", "2", "Pi"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"sys", ",", "3"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8187426400329933`*^9, 3.818742744994976*^9}, {
   3.818742779991997*^9, 3.818742814852911*^9}, {3.8187431103507957`*^9, 
   3.818743164459857*^9}, {3.8187432387956543`*^9, 3.81874324877393*^9}, {
   3.818743299524045*^9, 3.8187433083011713`*^9}, {3.818743385050221*^9, 
   3.818743414749383*^9}, 3.81874346959093*^9},
 CellLabel->"In[62]:=",ExpressionUUID->"8c3deedc-1f8a-4760-9d47-1527a724dd94"],

Cell[TextData[{
 "Here is the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"controlled", "-", 
    SuperscriptBox["U", 
     SuperscriptBox["2", 
      RowBox[{"m", "-", "j"}]]]}], TraditionalForm]],ExpressionUUID->
  "61db0249-370f-461a-afb8-68438a0243c2"],
 " operator to be used in the phase estimation algorithm."
}], "Text",
 CellChangeTimes->{{3.818743606877872*^9, 
  3.818743643044842*^9}},ExpressionUUID->"c36dde83-2e78-416f-bd78-\
dabe650dd7b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ctrlU", "[", "j_", "]"}], ":=", 
  RowBox[{"ControlledU", "[", 
   RowBox[{
    RowBox[{"S", "[", "j", "]"}], ",", 
    RowBox[{"MultiplyPower", "[", 
     RowBox[{"U", ",", 
      RowBox[{"Power", "[", 
       RowBox[{"2", ",", 
        RowBox[{"m", "-", "j"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"\"\<Label\>\"", "\[Rule]", 
     RowBox[{"Superscript", "[", 
      RowBox[{"\"\<U\>\"", ",", 
       RowBox[{"Superscript", "[", 
        RowBox[{"\"\<2\>\"", ",", 
         RowBox[{"ToString", "[", 
          RowBox[{"m", "-", "j"}], "]"}]}], "]"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<LabelSize\>\"", "\[Rule]", "0.65"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8187426400329933`*^9, 3.818742744994976*^9}, {
   3.818742779991997*^9, 3.818742814852911*^9}, {3.8187431103507957`*^9, 
   3.818743164459857*^9}, {3.8187432387956543`*^9, 3.81874324877393*^9}, {
   3.818743299524045*^9, 3.8187433083011713`*^9}, {3.818743385050221*^9, 
   3.818743414749383*^9}, 3.81874346959093*^9, {3.8187435752909937`*^9, 
   3.8187435976422586`*^9}, 3.818834051868576*^9, {3.819796766729814*^9, 
   3.819796773580491*^9}, 3.826342560099493*^9},
 CellLabel->"In[64]:=",ExpressionUUID->"df9a4d6f-bd66-4857-ba55-c8fe55b1dc29"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"S", "@", "ancilla"}]}], "]"}], ",", 
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"S", "@", "sys"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"ancilla", ",", "6"}], "]"}], ",", 
      RowBox[{"\"\<LabelSize\>\"", "\[Rule]", "0.8"}]}], "}"}], ",", 
    RowBox[{"ctrlU", "[", "1", "]"}], ",", 
    RowBox[{"ctrlU", "[", "2", "]"}], ",", 
    RowBox[{"ctrlU", "[", "3", "]"}], ",", 
    RowBox[{"ctrlU", "[", "4", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.818742425522031*^9, 3.8187424317628107`*^9}, {
   3.818742484311056*^9, 3.8187425284999027`*^9}, {3.818742580677137*^9, 
   3.818742604806177*^9}, {3.818743315024571*^9, 3.8187433188716*^9}, {
   3.8187433719575167`*^9, 3.818743451523568*^9}, {3.818743580735165*^9, 
   3.818743594458509*^9}, {3.818743765574943*^9, 3.8187437782190113`*^9}, {
   3.818744213121214*^9, 3.8187442249657917`*^9}, {3.8187451503047*^9, 
   3.818745160585781*^9}, {3.818745316559771*^9, 3.818745331553199*^9}, {
   3.823919859785193*^9, 3.823919865128253*^9}, 3.8298087019080687`*^9},
 CellLabel->"In[65]:=",ExpressionUUID->"14e8ed5f-72ee-462c-b0cd-cc91ebfad36f"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}, {{
    0, -4}, {6, -4}}, {{0, -5}, {6, -5}}}], {{InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.05333333333333334],
       FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.05333333333333334],
       FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.05333333333333334],
       FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.05333333333333334],
       FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, Rational[1, 2]}]]}, 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.05333333333333334],
      FontWeight->"Light"], {-0.1, -5}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05333333333333334],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05333333333333334],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05333333333333334],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05333333333333334],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -5}}], DiskBox[{2, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -5.4}, {2.4, -4.6}]}, InsetBox[
     StyleBox[
      TemplateBox[{"\"U\"", 
        TemplateBox[{"\"2\"", "\"3\""}, "Superscript", SyntaxForm -> 
         SuperscriptBox]},
       "Superscript"],
      StripOnInput->False,
      FontSize->Scaled[0.043333333333333335`],
      FontWeight->"Light",
      FontSlant->Italic], {2, -5}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{3, -2}, {3, -5}}], DiskBox[{3, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -5.4}, {3.4, -4.6}]}, InsetBox[
     StyleBox[
      TemplateBox[{"\"U\"", 
        TemplateBox[{"\"2\"", "\"2\""}, "Superscript", SyntaxForm -> 
         SuperscriptBox]},
       "Superscript"],
      StripOnInput->False,
      FontSize->Scaled[0.043333333333333335`],
      FontWeight->"Light",
      FontSlant->Italic], {3, -5}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -3}, {4, -5}}], DiskBox[{4, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -5.4}, {4.4, -4.6}]}, InsetBox[
     StyleBox[
      TemplateBox[{"\"U\"", 
        TemplateBox[{"\"2\"", "\"1\""}, "Superscript", SyntaxForm -> 
         SuperscriptBox]},
       "Superscript"],
      StripOnInput->False,
      FontSize->Scaled[0.043333333333333335`],
      FontWeight->"Light",
      FontSlant->Italic], {4, -5}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{5, -4}, {5, -5}}], DiskBox[{5, -4}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -5.4}, {5.4, -4.6}]}, InsetBox[
     StyleBox[
      TemplateBox[{"\"U\"", 
        TemplateBox[{"\"2\"", "\"0\""}, "Superscript", SyntaxForm -> 
         SuperscriptBox]},
       "Superscript"],
      StripOnInput->False,
      FontSize->Scaled[0.043333333333333335`],
      FontWeight->"Light",
      FontSlant->Italic], {5, -5}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->262.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{
  3.818742528885425*^9, {3.8187425822836647`*^9, 3.8187426091009817`*^9}, {
   3.818743311933858*^9, 3.818743320315392*^9}, {3.818743380606806*^9, 
   3.8187434159811172`*^9}, {3.818743451847126*^9, 3.818743454849667*^9}, 
   3.818743499842695*^9, 3.818743645254384*^9, {3.818743778571032*^9, 
   3.818743781017764*^9}, 3.818743883597103*^9, 3.818744076806739*^9, 
   3.818744226294116*^9, 3.818744268900242*^9, 3.818744368678122*^9, 
   3.818744968623699*^9, {3.81874516094093*^9, 3.818745187938205*^9}, {
   3.8187453227844553`*^9, 3.818745332031316*^9}, 3.8187454120360003`*^9, 
   3.818745460128068*^9, 3.818745512162929*^9, 3.818834109744969*^9, 
   3.818977944547256*^9, 3.819682641605607*^9, {3.819796749089797*^9, 
   3.819796775733391*^9}, {3.819798283742365*^9, 3.819798292303955*^9}, 
   3.81980391068215*^9, 3.8198042084045057`*^9, 3.819804289570404*^9, 
   3.820302392747643*^9, {3.823919855869385*^9, 3.823919865973839*^9}, 
   3.824001355074217*^9, 3.82634159077402*^9, {3.826342541145718*^9, 
   3.826342577305209*^9}, 3.830142187824366*^9},
 CellLabel->"Out[65]=",
 CellID->1043998813,ExpressionUUID->"a64d5aae-1131-4f01-aec9-5ee25d9f2703"]
}, Open  ]],

Cell[TextData[{
 "As the QFT step is clear, we do not simulate the step here and just process \
the data using the built-in function ",
 StyleBox["Fourier", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.818744998065833*^9, 3.8187450994898787`*^9}, {
  3.818746755399577*^9, 3.8187467657594624`*^9}, {3.820302393903946*^9, 
  3.8203023948936243`*^9}},ExpressionUUID->"c57e7447-9d82-4218-a87e-\
891da79943a4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{"ExpressionFor", "[", "qc", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "=", 
  RowBox[{"Fourier", "@", 
   RowBox[{"Matrix", "[", 
    RowBox[{"vec", ",", 
     RowBox[{"S", "@", "ancilla"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.8187446763019037`*^9, 3.818744748801853*^9}, 
   3.830132248555395*^9},
 CellLabel->"In[66]:=",ExpressionUUID->"741ad98d-1077-46c4-8cb8-bb21aec0438c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.014611679699288171`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.04497012606097713`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.006251734399651543`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.05282063724255108`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.004987736653864816`"}], "-", 
    RowBox[{"0.0633752030941293`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.022515855780098876`"}], "-", 
    RowBox[{"0.07983520256307819`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.05734113752506314`"}], "-", 
    RowBox[{"0.11253831890430444`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.17815969653452865`"}], "-", 
    RowBox[{"0.22599449767699176`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.6906348483603997`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.5898578846926075`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.15484404901531568`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.0867168340656557`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.0955663824400922`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.0310513999525125`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.07151342763344051`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.008464171939463333`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.0576669978022028`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.004538491154484847`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.04806470133039541`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.013555647740902808`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.040516287877704595`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.020644079792733132`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.03397675270074832`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.026785112082887322`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.027816991709946226`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.03256951267414676`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.02154057352437029`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.03846346166305218`", " ", "\[ImaginaryI]"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8187447042699327`*^9, 3.8187447694495792`*^9}, 
   3.8187449696322603`*^9, 3.818745189540251*^9, 3.8187455154570093`*^9, 
   3.818834113456881*^9, 3.818977947810351*^9, 3.819682645717781*^9, 
   3.819796786951171*^9, 3.8197982948135357`*^9, 3.8198039140912952`*^9, 
   3.81980420857329*^9, 3.81980429084933*^9, 3.82030239730787*^9, 
   3.82391986871198*^9, 3.824001358359931*^9, 3.8263415919788637`*^9, 
   3.826342579904686*^9, 3.830142190881711*^9},
 CellLabel->"Out[67]=",
 CellID->1043599891,ExpressionUUID->"7eefb783-8ba3-41c6-8e14-d6736e68a18a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Prob", "=", 
  RowBox[{
   RowBox[{"Abs", "[", "out", "]"}], "^", "2"}]}]], "Input",
 CellChangeTimes->{{3.81874408398995*^9, 3.818744130976798*^9}, {
  3.8187444874687653`*^9, 3.8187444892790823`*^9}, {3.8187447567446117`*^9, 
  3.818744758847365*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"34ecf7ba-fee3-4518-9482-4c8ba297692c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.0022358134215747644`", ",", "0.0028291039017129616`", ",", 
   "0.0040412938841504435`", ",", "0.006880623329797937`", ",", 
   "0.015952879274475126`", ",", "0.08281439044955116`", ",", 
   "0.8249088179038297`", ",", "0.03149648882582796`", ",", 
   "0.010097122891696859`", ",", "0.005185812538504132`", ",", 
   "0.0033460805374785994`", ",", "0.002493971099655558`", ",", 
   "0.002067747613877764`", ",", "0.0018718619533806445`", ",", 
   "0.001834558183622624`", ",", "0.0019434341908638867`"}], "}"}]], "Output",\

 CellChangeTimes->{{3.8187441035591793`*^9, 3.81874413127874*^9}, 
   3.818744440606485*^9, {3.818744497278186*^9, 3.818744502564398*^9}, {
   3.818744759352323*^9, 3.818744770283372*^9}, 3.8187449703838453`*^9, 
   3.818745190326729*^9, 3.818745517380577*^9, 3.81883411404939*^9, 
   3.8189779484827213`*^9, 3.819682646827506*^9, 3.819796788094939*^9, 
   3.819798295567313*^9, 3.8198039147833433`*^9, 3.8198042085796423`*^9, 
   3.819804290856229*^9, 3.820302398778236*^9, 3.8239198701561527`*^9, 
   3.8240013593047256`*^9, 3.8263415920432053`*^9, 3.826342581049605*^9, 
   3.830142192651186*^9},
 CellLabel->"Out[68]=",
 CellID->1914934620,ExpressionUUID->"eebb2306-28be-4124-a4a7-ec8ac71ecb0e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Prob", ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"DataRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<\[Phi] / 2\[Pi]\>\"", ",", "\"\<Probability\>\""}], "}"}]}],
    ",", 
   RowBox[{"FrameStyle", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8187441364684134`*^9, 3.81874416869645*^9}, {
  3.818744906282579*^9, 3.818744909668273*^9}, {3.818834052773019*^9, 
  3.818834061467946*^9}, {3.81979938191483*^9, 3.819799388460472*^9}, {
  3.819799531643135*^9, 3.819799556267354*^9}, {3.823919878065881*^9, 
  3.8239198832632313`*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"dd2a8a89-564b-4157-8956-4c2147d3983f"],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`], 
    AbsoluteThickness[1.6], 
    PointBox[{{0., 0.0022358134215747644`}, {0.06666666666666667, 
     0.0028291039017129616`}, {0.13333333333333333`, 
     0.0040412938841504435`}, {0.2, 0.006880623329797937}, {
     0.26666666666666666`, 0.015952879274475126`}, {0.3333333333333333, 
     0.08281439044955116}, {0.4, 0.8249088179038297}, {0.4666666666666667, 
     0.03149648882582796}, {0.5333333333333333, 0.010097122891696859`}, {0.6, 
     0.005185812538504132}, {0.6666666666666666, 0.0033460805374785994`}, {
     0.7333333333333333, 0.002493971099655558}, {0.8, 0.002067747613877764}, {
     0.8666666666666667, 0.0018718619533806445`}, {0.9333333333333333, 
     0.001834558183622624}, {1., 0.0019434341908638867`}}]}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  AxesStyle->Automatic,
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{
     FormBox["\"Probability\"", TraditionalForm], None}, {
     FormBox["\"\[Phi] / 2\[Pi]\"", TraditionalForm], None}},
  FrameStyle->Automatic,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 1.}, {0, 0.8249088179038297}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {
     Scaled[0.025], 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.819804291024629*^9, 3.8203024005209312`*^9, 
  3.823919884265624*^9, 3.8240013603829403`*^9, 3.826341592133787*^9, 
  3.826342581987187*^9, 3.830142193737191*^9},
 CellLabel->"Out[69]=",
 CellID->692181331,ExpressionUUID->"8700a979-ab98-48ce-a3b8-c98f3e3a01f7"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
Saveable->False,
WindowToolbars->"EditBar",
WindowSize->{996, 1340},
WindowMargins->{{Automatic, 239}, {Automatic, 0}},
DockedCells->Cell[
 "Quantum Computation Workbook", "Text", Background -> GrayLevel[0.9], 
  FontSize -> 12, CellFrameMargins -> {{22, 8}, {8, 8}}],
PageFooters->{{
   Cell["Quantum Computation Workbook", "Footer", CellMargins -> 4], None, 
   None}, {None, None, 
   Cell["Quantum Computation Workbook", "Footer", CellMargins -> 4]}},
PageFooterLines->{True, True},
TaggingRules->{
 "DocuToolsSettings" -> {
   "$ApplicationName" -> "Q3", "$LinkBase" -> "Q3", "$DocumentationDirectory" -> 
    "/Users/Masso/Math/Apples/Q3App/Q3/Documentation/English/", 
    "$ApplicationDirectory" -> "/Users/Masso/Math/Apples/Q3App/Q3"}, 
  "TryRealOnly" -> False},
CreateCellID->True,
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (December 12, 2020)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]], 
   Cell[
    CellGroupData[{
      Cell[
       StyleData["MathCaption"], CellMargins -> {{66, 10}, {7, 8}}, 
       CellGroupingRules -> {"SectionGrouping", 70}, TabSpacings -> {2.5}, 
       MenuSortingValue -> 1450, MenuCommandKey :> "8", FontFamily -> 
       "Source Sans Pro", FontSize -> 15], 
      Cell[
       StyleData["MathCaption", "Presentation"], 
       CellFrame -> {{0, 0}, {0, 1}}, CellMargins -> {{100, 10}, {10, 10}}, 
       LineSpacing -> {1, 5}, FontSize -> 24], 
      Cell[
       StyleData["MathCaption", "SlideShow"], 
       CellMargins -> {{
         0.135 FrontEnd`AbsoluteCurrentValue[{WindowSize, 1}], 0.03 
          FrontEnd`AbsoluteCurrentValue[{WindowSize, 1}]}, {10, 10}}, 
       FontSize -> 22], 
      Cell[
       StyleData["MathCaption", "Printout"], 
       CellMargins -> {{49, Inherited}, {Inherited, Inherited}}, Hyphenation -> 
       True]}, Open]], 
   Cell[
    StyleData["Code"], MenuSortingValue -> 1530, MenuCommandKey :> None]}, 
  Visible -> False, FrontEndVersion -> 
  "12.2 for Mac OS X x86 (64-bit) (December 12, 2020)", StyleDefinitions -> 
  "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"a9b5e516-22bb-4dc2-98c0-90d5a5075e92"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "TableOfContents"->{
  Cell[1471, 42, 7809, 231, 410, "Text",ExpressionUUID->"f66ac599-f171-429f-9eef-3da3e73130b7",
   CellTags->"TableOfContents",
   CellID->1286663326]},
 "Section45"->{
  Cell[9305, 277, 208, 3, 67, "Section",ExpressionUUID->"3886c840-ec60-4cdc-b383-7657a1c495b8",
   CellTags->"Section45",
   CellID->2095711634]},
 "Section46"->{
  Cell[16361, 492, 266, 4, 54, "Subsection",ExpressionUUID->"35a44857-9ee4-4e9a-8a3a-5b79ccff192d",
   CellTags->"Section46",
   CellID->1746138191]},
 "Section47"->{
  Cell[36214, 1007, 227, 3, 54, "Subsection",ExpressionUUID->"44fd6f9e-cfc5-46eb-aa98-4c5faf2af388",
   CellTags->"Section47",
   CellID->1980539882]},
 "Section48"->{
  Cell[84239, 2319, 256, 4, 67, "Section",ExpressionUUID->"147d10ce-32ef-4c90-adce-43267f63c000",
   CellTags->"Section48",
   CellID->937268274]},
 "Section49"->{
  Cell[84520, 2327, 301, 5, 54, "Subsection",ExpressionUUID->"25bade32-d675-4545-a640-24c6cbd9b899",
   CellTags->"Section49",
   CellID->875330373]},
 "Section50"->{
  Cell[200374, 5697, 213, 3, 54, "Subsection",ExpressionUUID->"6137aaa5-3d2a-4794-a331-4532a2a3e483",
   CellTags->"Section50",
   CellID->1414597061]},
 "Section51"->{
  Cell[209078, 5929, 268, 4, 54, "Subsection",ExpressionUUID->"0144cad6-22c0-4d32-aac1-b2a20db1544f",
   CellTags->"Section51",
   CellID->341348290]},
 "Section52"->{
  Cell[221510, 6252, 224, 3, 54, "Subsection",ExpressionUUID->"241c7854-4cba-419d-943e-669ba872fff9",
   CellTags->"Section52",
   CellID->1111888893]},
 "Section53"->{
  Cell[257650, 7218, 211, 3, 67, "Section",ExpressionUUID->"376ce1dd-bff8-4080-bc22-db5ee7488fe0",
   CellTags->"Section53",
   CellID->113928457]},
 "Section54"->{
  Cell[257864, 7223, 219, 3, 54, "Subsection",ExpressionUUID->"aea805f3-b3a6-49e8-85a8-06304c126a6e",
   CellTags->"Section54",
   CellID->1387647322]},
 "Section55"->{
  Cell[258108, 7230, 211, 3, 38, "Subsection",ExpressionUUID->"3181692c-1196-4295-9e8d-4bb3d0cd9808",
   CellTags->"Section55",
   CellID->516134434]},
 "Section56"->{
  Cell[271194, 7556, 265, 4, 54, "Subsection",ExpressionUUID->"30e1877f-644c-48f1-ae88-4c536fd2c397",
   CellTags->"Section56",
   CellID->984982005]},
 "Section57"->{
  Cell[297262, 8174, 211, 3, 67, "Section",ExpressionUUID->"7b1be872-4718-438c-a460-480b0a261bd7",
   CellTags->"Section57",
   CellID->1788606959]},
 "Section58"->{
  Cell[297476, 8179, 197, 3, 54, "Subsection",ExpressionUUID->"ccf2212c-ee95-4476-b2a9-071d627d2562",
   CellTags->"Section58",
   CellID->641069207]},
 "Section59"->{
  Cell[297698, 8186, 201, 3, 38, "Subsection",ExpressionUUID->"184f5541-c30e-4363-96f7-66eb6a8781bf",
   CellTags->"Section59",
   CellID->524705050]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"TableOfContents", 319738, 8717},
 {"Section45", 319907, 8721},
 {"Section46", 320070, 8725},
 {"Section47", 320237, 8729},
 {"Section48", 320405, 8733},
 {"Section49", 320569, 8737},
 {"Section50", 320736, 8741},
 {"Section51", 320905, 8745},
 {"Section52", 321073, 8749},
 {"Section53", 321242, 8753},
 {"Section54", 321407, 8757},
 {"Section55", 321576, 8761},
 {"Section56", 321744, 8765},
 {"Section57", 321912, 8769},
 {"Section58", 322078, 8773},
 {"Section59", 322246, 8777}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 271, 4, 98, "Title",ExpressionUUID->"b9269d85-53e8-4b1a-8e3e-227531db259b"],
Cell[854, 28, 380, 6, 30, "Input",ExpressionUUID->"461ddb1f-d118-47e8-96bb-6e4be8172a11"],
Cell[1237, 36, 231, 4, 30, "Input",ExpressionUUID->"d69ce98c-fbd2-4f2c-9529-43b1fbb7afb1"],
Cell[1471, 42, 7809, 231, 410, "Text",ExpressionUUID->"f66ac599-f171-429f-9eef-3da3e73130b7",
 CellTags->"TableOfContents",
 CellID->1286663326],
Cell[CellGroupData[{
Cell[9305, 277, 208, 3, 67, "Section",ExpressionUUID->"3886c840-ec60-4cdc-b383-7657a1c495b8",
 CellTags->"Section45",
 CellID->2095711634],
Cell[CellGroupData[{
Cell[9538, 284, 273, 6, 38, "MathCaption",ExpressionUUID->"8253e7cd-3585-427b-bcaf-270c233ab8b3"],
Cell[CellGroupData[{
Cell[9836, 294, 1643, 42, 73, "Input",ExpressionUUID->"db0223f3-0f26-44f0-b237-b88ca9a274c7"],
Cell[11482, 338, 2602, 81, 66, "Output",ExpressionUUID->"076118ae-4da4-40bb-a1be-ea77df83a13e",
 CellID->381688254]
}, Open  ]],
Cell[CellGroupData[{
Cell[14121, 424, 422, 7, 30, "Input",ExpressionUUID->"d67a6af1-c5f4-43d2-b409-067f197dcd89"],
Cell[14546, 433, 1766, 53, 38, "Output",ExpressionUUID->"e2d2b0d1-e8ad-4f0f-95dc-d3c3811e86c1",
 CellID->908401257]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16361, 492, 266, 4, 54, "Subsection",ExpressionUUID->"35a44857-9ee4-4e9a-8a3a-5b79ccff192d",
 CellTags->"Section46",
 CellID->1746138191],
Cell[CellGroupData[{
Cell[16652, 500, 186, 3, 38, "MathCaption",ExpressionUUID->"3a9f9482-813e-4fa8-9668-8c5dac04f70f"],
Cell[CellGroupData[{
Cell[16863, 507, 972, 22, 30, "Input",ExpressionUUID->"3cf3fcd2-d078-4c71-8a92-674a346c6bc1"],
Cell[17838, 531, 1630, 38, 85, "Output",ExpressionUUID->"4a9b6509-a673-48f3-97f8-7707557a70b7",
 CellID->2001267736]
}, Open  ]],
Cell[CellGroupData[{
Cell[19505, 574, 573, 11, 52, "Input",ExpressionUUID->"1cd7be62-287b-4b9a-a4da-32b541e752f3"],
Cell[20081, 587, 1437, 38, 59, "Output",ExpressionUUID->"abd0c284-6d7a-4187-b18d-6f47fb9ee5bc",
 CellID->66199179]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[21567, 631, 205, 3, 38, "MathCaption",ExpressionUUID->"dc115596-55cc-4aaa-933d-90a60121dc70"],
Cell[CellGroupData[{
Cell[21797, 638, 497, 9, 30, "Input",ExpressionUUID->"41955f4b-3b09-41f4-83a8-90ac145fa2a8"],
Cell[22297, 649, 1885, 43, 91, "Output",ExpressionUUID->"3b3ebf6b-da5f-4826-a6bb-db65567dbc01",
 CellID->781758209]
}, Open  ]],
Cell[24197, 695, 196, 3, 35, "Text",ExpressionUUID->"542e65b5-34bc-494c-9716-43f33e9576e5"],
Cell[CellGroupData[{
Cell[24418, 702, 1451, 30, 73, "Input",ExpressionUUID->"6f49f58c-e127-441c-853b-e72267b401b9",
 CellID->133327041],
Cell[25872, 734, 2702, 74, 251, "Output",ExpressionUUID->"61967fab-a884-40a9-b06b-3e774594e491",
 CellID->1541609768]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28623, 814, 251, 6, 38, "MathCaption",ExpressionUUID->"877b7a67-7b67-4bc3-b690-9148b574f47e",
 CellID->54109863],
Cell[CellGroupData[{
Cell[28899, 824, 599, 11, 30, "Input",ExpressionUUID->"98c9ed68-3059-4b85-99b9-3ac9c69e552a",
 CellID->1038884760],
Cell[29501, 837, 2340, 53, 98, "Output",ExpressionUUID->"0b0dad92-9438-4cab-ab9f-005f09b5f323",
 CellID->569029721]
}, Open  ]],
Cell[31856, 893, 255, 6, 35, "Text",ExpressionUUID->"fce603a3-39c5-4781-9594-8cd35c1a6302",
 CellID->1494111210],
Cell[CellGroupData[{
Cell[32136, 903, 1889, 41, 73, "Input",ExpressionUUID->"11671a1e-7fdb-4f7d-a1af-4a9a4f40d956",
 CellID->1000822099],
Cell[34028, 946, 2125, 54, 252, "Output",ExpressionUUID->"4279bfce-8535-4b7d-81e4-4ac7c33989e2",
 CellID->621718415]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[36214, 1007, 227, 3, 54, "Subsection",ExpressionUUID->"44fd6f9e-cfc5-46eb-aa98-4c5faf2af388",
 CellTags->"Section47",
 CellID->1980539882],
Cell[CellGroupData[{
Cell[36466, 1014, 275, 6, 38, "MathCaption",ExpressionUUID->"20ec431c-c846-45f3-90fa-8cbdd5f934ba",
 CellID->1725094589],
Cell[36744, 1022, 284, 5, 35, "Text",ExpressionUUID->"aabd563e-2e41-4f82-b262-3ee4c5268142",
 CellID->89151289],
Cell[CellGroupData[{
Cell[37053, 1031, 806, 19, 73, "Input",ExpressionUUID->"56c1fb4d-55b6-4edd-a586-5941bf77075c",
 CellID->488039176],
Cell[37862, 1052, 1000, 33, 38, "Output",ExpressionUUID->"13970fac-e856-40b1-92e2-0806120074de",
 CellID->500133707]
}, Open  ]],
Cell[CellGroupData[{
Cell[38899, 1090, 630, 15, 52, "Input",ExpressionUUID->"034c6148-eb2c-443f-a21a-f2a06afb16ab",
 CellID->1234383139],
Cell[39532, 1107, 3439, 106, 59, "Output",ExpressionUUID->"84646416-0db6-422f-864f-5be73e328b3a",
 CellID->891414619]
}, Open  ]],
Cell[42986, 1216, 349, 10, 35, "Text",ExpressionUUID->"5e2ff89d-fc0e-4362-b128-78c644cf3812",
 CellID->1585387153],
Cell[CellGroupData[{
Cell[43360, 1230, 829, 22, 94, "Input",ExpressionUUID->"3dd3cde4-82f6-4c9a-ac6b-fd1635c2d802",
 CellID->1772272142],
Cell[44192, 1254, 10266, 301, 170, "Output",ExpressionUUID->"503ec5f7-bee3-44be-89b5-5cf075552b97",
 CellID->625629734]
}, Open  ]],
Cell[54473, 1558, 447, 10, 35, "Text",ExpressionUUID->"5377a36f-9701-43c7-9b69-092ef0195e08",
 CellID->979706704],
Cell[CellGroupData[{
Cell[54945, 1572, 1555, 35, 52, "Input",ExpressionUUID->"405f8952-b853-4831-ae4e-525ecd8ddd34",
 CellID->1002134266],
Cell[56503, 1609, 2400, 55, 167, "Output",ExpressionUUID->"2cc6143d-95f0-4693-bde4-a359e1e678a7",
 CellID->1564287566]
}, Open  ]],
Cell[58918, 1667, 354, 9, 35, "Text",ExpressionUUID->"81ae4a7a-4bd8-4df8-bec8-e16f3b69febb",
 CellID->156365241],
Cell[CellGroupData[{
Cell[59297, 1680, 1752, 41, 115, "Input",ExpressionUUID->"6ce1e810-3eac-4926-a097-24db81f269cf",
 CellID->1658105206],
Cell[61052, 1723, 6725, 197, 170, "Output",ExpressionUUID->"9a4f7a64-ce9d-4a73-a856-95f1fd7867d8",
 CellID->598508531]
}, Open  ]],
Cell[67792, 1923, 192, 3, 35, "Text",ExpressionUUID->"9afda341-25b0-48c4-b566-5e947d183f57",
 CellID->2026393770],
Cell[CellGroupData[{
Cell[68009, 1930, 1343, 24, 30, "Input",ExpressionUUID->"4d7ec85a-14c6-4605-a3ca-e7ef18a8f5be",
 CellID->656934617],
Cell[69355, 1956, 2921, 52, 171, "Output",ExpressionUUID->"671246ad-28e7-4ce4-a393-6962dfa9bdb7",
 CellID->2084885742]
}, Open  ]],
Cell[72291, 2011, 661, 14, 81, "Text",ExpressionUUID->"7712b946-da0a-40d8-93fe-79fd869f046b",
 CellID->886678692],
Cell[CellGroupData[{
Cell[72977, 2029, 2673, 67, 94, "Input",ExpressionUUID->"f00faa65-2b56-46a3-b23e-2cb8c35f59e9",
 CellID->1019749911],
Cell[75653, 2098, 4930, 107, 168, "Output",ExpressionUUID->"5408a6a9-16d4-400b-8f3f-e5412dc4b59e",
 CellID->441879170]
}, Open  ]],
Cell[80598, 2208, 161, 3, 35, "Text",ExpressionUUID->"c433d0fc-5610-44c8-9814-3a55bed8feb8",
 CellID->2017251117],
Cell[CellGroupData[{
Cell[80784, 2215, 1000, 25, 73, "Input",ExpressionUUID->"73247977-8429-4591-aa70-8c068b2cf3f7",
 CellID->1615188230],
Cell[81787, 2242, 2379, 69, 41, "Output",ExpressionUUID->"5b25bf25-571d-4759-9662-2966e4547029",
 CellID->942519421]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[84239, 2319, 256, 4, 67, "Section",ExpressionUUID->"147d10ce-32ef-4c90-adce-43267f63c000",
 CellTags->"Section48",
 CellID->937268274],
Cell[CellGroupData[{
Cell[84520, 2327, 301, 5, 54, "Subsection",ExpressionUUID->"25bade32-d675-4545-a640-24c6cbd9b899",
 CellTags->"Section49",
 CellID->875330373],
Cell[CellGroupData[{
Cell[84846, 2336, 227, 5, 38, "MathCaption",ExpressionUUID->"5bfdb562-9ae7-484c-8c48-5f465405351e",
 CellID->127799883],
Cell[85076, 2343, 476, 11, 35, "Text",ExpressionUUID->"587bb975-3f3f-44b1-88ae-074d6937023a",
 CellID->448986581],
Cell[85555, 2356, 849, 21, 52, "Input",ExpressionUUID->"6ddfe543-ec47-493b-840b-65e7af264000",
 CellID->2007414956],
Cell[86407, 2379, 185, 3, 35, "Text",ExpressionUUID->"01626fc4-125c-47f5-8c4b-5f41628a16f7",
 CellID->1655071122],
Cell[CellGroupData[{
Cell[86617, 2386, 671, 16, 73, "Input",ExpressionUUID->"c850b8fa-65fe-41f1-95ad-3e6b68f47540",
 CellID->424667863],
Cell[87291, 2404, 1299, 28, 128, "Output",ExpressionUUID->"31074db8-4368-4ed2-816f-fe42680d58b6",
 CellID->2052048152]
}, Open  ]],
Cell[CellGroupData[{
Cell[88627, 2437, 336, 6, 30, "Input",ExpressionUUID->"be2053d7-6a9b-4e34-a133-f9ddb233f8aa",
 CellID->1304614460],
Cell[88966, 2445, 2176, 63, 52, "Output",ExpressionUUID->"3757eb0c-e7bb-4d58-9757-95f992044f47",
 CellID->552465998]
}, Open  ]],
Cell[CellGroupData[{
Cell[91179, 2513, 393, 9, 52, "Input",ExpressionUUID->"e7cb7f3e-785f-4f3b-b37a-a134e7e106ce",
 CellID->847193350],
Cell[91575, 2524, 4723, 138, 38, "Output",ExpressionUUID->"f17164e8-d397-439a-bb32-1ada2e3cc48b",
 CellID->1692940752]
}, Open  ]],
Cell[CellGroupData[{
Cell[96335, 2667, 306, 6, 52, "Input",ExpressionUUID->"0efa830c-e112-46d8-a612-2e3f6510c697",
 CellID->962053840],
Cell[96644, 2675, 4723, 138, 38, "Output",ExpressionUUID->"9c44fee8-e947-4703-a83b-e43f161ef01a",
 CellID->1171495911]
}, Open  ]],
Cell[CellGroupData[{
Cell[101404, 2818, 310, 7, 30, "Input",ExpressionUUID->"d412f9fa-5d50-41bf-8686-34bfb9254ce1",
 CellID->834510617],
Cell[101717, 2827, 10731, 310, 210, "Output",ExpressionUUID->"58d8499b-c5e6-49e1-b62b-95cb56df275b",
 CellID->307353150]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[112497, 3143, 275, 7, 38, "MathCaption",ExpressionUUID->"1de127be-6045-4115-af7b-07356f9bf72b",
 CellID->404241362],
Cell[112775, 3152, 195, 3, 35, "Text",ExpressionUUID->"5c10a6e7-d503-4387-89f0-942ea65dbba3",
 CellID->1593795673],
Cell[112973, 3157, 799, 22, 52, "Input",ExpressionUUID->"63c7fd9e-d1a7-44c2-8aed-fc6088d2751d",
 CellID->1360347080],
Cell[113775, 3181, 212, 5, 35, "Text",ExpressionUUID->"f03d2935-2471-4f83-86a2-d11af88fe7a6",
 CellID->1242467598],
Cell[CellGroupData[{
Cell[114012, 3190, 769, 19, 73, "Input",ExpressionUUID->"4f460cfc-a4fc-4134-ac88-b815cae52b06",
 CellID->21936158],
Cell[114784, 3211, 1821, 35, 164, "Output",ExpressionUUID->"5efefbe9-4aed-4006-9ec2-6b741cbb95e4",
 CellID->709585487]
}, Open  ]],
Cell[CellGroupData[{
Cell[116642, 3251, 429, 8, 30, "Input",ExpressionUUID->"6cfadacc-2806-448d-9541-2529de8dc1b6",
 CellID->1461303869],
Cell[117074, 3261, 3163, 97, 52, "Output",ExpressionUUID->"83a430fa-048c-4558-806e-7be3930d85c9",
 CellID->107416673]
}, Open  ]],
Cell[CellGroupData[{
Cell[120274, 3363, 567, 11, 52, "Input",ExpressionUUID->"62d46754-e89c-4e76-83fc-32ad62252ca2",
 CellID->1511139191],
Cell[120844, 3376, 11359, 333, 86, "Output",ExpressionUUID->"5932f1b8-7f88-4f10-b66d-1a5b5277b814",
 CellID->271047542]
}, Open  ]],
Cell[CellGroupData[{
Cell[132240, 3714, 308, 6, 52, "Input",ExpressionUUID->"752c6e32-e938-44a2-85a3-d7051261f35d",
 CellID->1574773715],
Cell[132551, 3722, 11202, 330, 86, "Output",ExpressionUUID->"c7030e6b-c155-486b-b214-90a7d7fd99c3",
 CellID->340803310]
}, Open  ]],
Cell[CellGroupData[{
Cell[143790, 4057, 337, 8, 30, "Input",ExpressionUUID->"2d0878c3-2104-47c8-81b6-fad14c347f16",
 CellID->1633362377],
Cell[144130, 4067, 25494, 725, 394, "Output",ExpressionUUID->"f2afcc67-74ff-449d-b6b3-2c00de52168b",
 CellID->2082249761]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[169673, 4798, 307, 5, 38, "MathCaption",ExpressionUUID->"b9bbfa87-21e4-469b-a635-7ad30d05fece",
 CellID->1089484095],
Cell[169983, 4805, 308, 5, 35, "Text",ExpressionUUID->"0a6cfb8b-58a5-453f-97dd-aa11edd077ff",
 CellID->1334404591],
Cell[170294, 4812, 898, 28, 94, "Input",ExpressionUUID->"75a513cd-ee2b-4264-b733-c0e7d6027bf8",
 CellID->219138262],
Cell[CellGroupData[{
Cell[171217, 4844, 933, 27, 73, "Input",ExpressionUUID->"201e9610-5958-4732-9551-ec53893ee997",
 CellID->1528492484],
Cell[172153, 4873, 3040, 75, 159, "Output",ExpressionUUID->"5619c912-74e9-4767-b39b-1d4870186cef",
 CellID->1219350425]
}, Open  ]],
Cell[175208, 4951, 285, 6, 35, "Text",ExpressionUUID->"7b4209c1-a5a1-47e0-b357-5d5efd91e144",
 CellID->1245720949],
Cell[CellGroupData[{
Cell[175518, 4961, 483, 13, 52, "Input",ExpressionUUID->"d1210a33-dff3-4b6f-83b9-2d7d3883ec99",
 CellID->1881044746],
Cell[176004, 4976, 3065, 93, 50, "Output",ExpressionUUID->"ce17d29d-84bc-4976-888a-ece6197e5196",
 CellID->562611887]
}, Open  ]],
Cell[179084, 5072, 339, 6, 58, "Text",ExpressionUUID->"d72a2f14-45a3-411f-a251-dd38e4b752fc",
 CellID->254930395],
Cell[CellGroupData[{
Cell[179448, 5082, 316, 7, 30, "Input",ExpressionUUID->"57958642-d929-460d-abf0-1dda3bb8d0dd",
 CellID->427420082],
Cell[179767, 5091, 4151, 136, 50, "Output",ExpressionUUID->"a549c9c8-a026-42ab-8b5d-16c6a79f3250",
 CellID->412654781]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[183967, 5233, 399, 8, 38, "MathCaption",ExpressionUUID->"7a513a07-14e9-49ab-9551-7f23b4dffe2a",
 CellID->638010638],
Cell[184369, 5243, 301, 9, 35, "Text",ExpressionUUID->"1019f323-5d42-4e4b-951f-265f64107e55",
 CellID->658943395],
Cell[184673, 5254, 673, 17, 30, "Input",ExpressionUUID->"2550c51d-10b5-42d3-9beb-3a91fea1afe6",
 CellID->288472186],
Cell[185349, 5273, 640, 9, 35, "Text",ExpressionUUID->"f0ec82fb-1e6a-4392-959d-1e96af5354bf",
 CellID->1481438823],
Cell[CellGroupData[{
Cell[186014, 5286, 1365, 34, 94, "Input",ExpressionUUID->"828812a7-a3ab-4121-86a1-4c4005ea4bb0",
 CellID->616894843],
Cell[187382, 5322, 3280, 84, 130, "Output",ExpressionUUID->"e63142d8-0066-4cdf-b51a-e79a4134a59c",
 CellID->1767840518]
}, Open  ]],
Cell[CellGroupData[{
Cell[190699, 5411, 672, 14, 52, "Input",ExpressionUUID->"c488cc91-fda1-4982-9983-c538e6e5cdd4",
 CellID->100578585],
Cell[191374, 5427, 2947, 82, 50, "Output",ExpressionUUID->"a5317077-50ac-4af5-a16a-6a0f0de82bda",
 CellID->1957073927]
}, Open  ]],
Cell[194336, 5512, 205, 4, 35, "Text",ExpressionUUID->"580fd625-e958-413a-93be-db1bc6d9d5e7",
 CellID->354647906],
Cell[CellGroupData[{
Cell[194566, 5520, 963, 26, 73, "Input",ExpressionUUID->"6417ab25-238a-4a31-bdd9-4a3d34246c75",
 CellID->1300235717],
Cell[195532, 5548, 2023, 60, 38, "Output",ExpressionUUID->"f1e7bda7-96ae-45ec-93df-c78ab8f22540",
 CellID->1219006873]
}, Open  ]],
Cell[CellGroupData[{
Cell[197592, 5613, 594, 14, 52, "Input",ExpressionUUID->"e00f4fbb-5dac-4148-b2df-32f1f55ee51f",
 CellID->268103747],
Cell[198189, 5629, 2124, 61, 50, "Output",ExpressionUUID->"e6f72fdd-8b4b-40c6-9502-c6d6fb8fd89d",
 CellID->246224062]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[200374, 5697, 213, 3, 54, "Subsection",ExpressionUUID->"6137aaa5-3d2a-4794-a331-4532a2a3e483",
 CellTags->"Section50",
 CellID->1414597061],
Cell[CellGroupData[{
Cell[200612, 5704, 243, 4, 38, "MathCaption",ExpressionUUID->"b45446c7-744a-4b2a-a32e-e51174a7d807",
 CellID->598984423],
Cell[200858, 5710, 799, 21, 52, "Input",ExpressionUUID->"9830c86f-95aa-4f30-b862-950499eb46b2",
 CellID->1875343872],
Cell[201660, 5733, 390, 8, 58, "Text",ExpressionUUID->"70e9111a-4a79-4dca-97fc-6ed5e0d6591b",
 CellID->286969685],
Cell[CellGroupData[{
Cell[202075, 5745, 1365, 35, 94, "Input",ExpressionUUID->"c29c2fa8-f4fd-476f-97a9-b8b6981d0e31",
 CellID->1998708280],
Cell[203443, 5782, 4352, 105, 130, "Output",ExpressionUUID->"ac989195-c9e7-4b25-bb7e-6e206d6d7932",
 CellID->917687971]
}, Open  ]],
Cell[CellGroupData[{
Cell[207832, 5892, 263, 5, 30, "Input",ExpressionUUID->"4e9e1446-0ecb-48cf-b741-704a43c93b0e",
 CellID->1350855586],
Cell[208098, 5899, 919, 23, 38, "Output",ExpressionUUID->"b283107d-cfb6-4e49-a041-2dd1a552a2b4",
 CellID->955994138]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[209078, 5929, 268, 4, 54, "Subsection",ExpressionUUID->"0144cad6-22c0-4d32-aac1-b2a20db1544f",
 CellTags->"Section51",
 CellID->341348290],
Cell[CellGroupData[{
Cell[209371, 5937, 328, 6, 38, "MathCaption",ExpressionUUID->"0d6da1ed-84a9-4701-9a2e-073a5443510e",
 CellID->632717818],
Cell[209702, 5945, 298, 8, 30, "Input",ExpressionUUID->"8ea712e3-eb33-491f-9b5f-27f77fff50a1",
 CellID->1896830829],
Cell[210003, 5955, 480, 10, 35, "Text",ExpressionUUID->"acb4a83b-2de2-4598-9c36-5bc90599cd30",
 CellID->641003288],
Cell[210486, 5967, 668, 16, 52, "Input",ExpressionUUID->"b74733ba-dcd3-4286-9bcf-36564a2917a4",
 CellID->1564288064],
Cell[211157, 5985, 308, 7, 35, "Text",ExpressionUUID->"f03f4611-e65c-4e09-85b9-8e97544a249e",
 CellID->224738400],
Cell[CellGroupData[{
Cell[211490, 5996, 443, 8, 30, "Input",ExpressionUUID->"930f2837-f261-4fcb-bb56-99d0c4df062e",
 CellID->1599000074],
Cell[211936, 6006, 392, 6, 34, "Output",ExpressionUUID->"89dcfef6-5610-48f9-95f1-deda33156ded",
 CellID->1818953928]
}, Open  ]],
Cell[212343, 6015, 394, 8, 58, "Text",ExpressionUUID->"fc3c1f12-4ce9-4b61-98dd-c54008cc63b9",
 CellID->1494685074],
Cell[CellGroupData[{
Cell[212762, 6027, 1367, 36, 94, "Input",ExpressionUUID->"0ba36037-2522-4b52-aa50-5f184f614949",
 CellID->1724419263],
Cell[214132, 6065, 4449, 106, 130, "Output",ExpressionUUID->"2f5e1294-5fe8-44c6-9efa-cb69dbcb1913",
 CellID->529011650]
}, Open  ]],
Cell[CellGroupData[{
Cell[218618, 6176, 579, 13, 52, "Input",ExpressionUUID->"a5535642-5409-4f72-8ff9-1c63801349a3",
 CellID->2022736976],
Cell[219200, 6191, 1179, 26, 38, "Output",ExpressionUUID->"089afe18-e0ff-40ec-85e9-678dc40ec45a",
 CellID->101451550]
}, Open  ]],
Cell[220394, 6220, 240, 4, 35, "Text",ExpressionUUID->"6bc5583d-3f49-4c2e-bf43-13c893ef56f5",
 CellID->1474223622],
Cell[CellGroupData[{
Cell[220659, 6228, 260, 6, 30, "Input",ExpressionUUID->"9360ad6b-a03c-4fb6-852d-28923d6c0f52",
 CellID->1757579515],
Cell[220922, 6236, 527, 9, 34, "Output",ExpressionUUID->"38c188df-fac4-421b-b67f-661a3ed3827c",
 CellID->604631219]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[221510, 6252, 224, 3, 54, "Subsection",ExpressionUUID->"241c7854-4cba-419d-943e-669ba872fff9",
 CellTags->"Section52",
 CellID->1111888893],
Cell[CellGroupData[{
Cell[221759, 6259, 234, 4, 38, "MathCaption",ExpressionUUID->"c9458ad1-85e5-4819-97ba-ae56d927e586",
 CellID->1001344120],
Cell[221996, 6265, 341, 7, 30, "Input",ExpressionUUID->"713d4ff2-220e-45e9-bacf-338b049f1714",
 CellID->1908766948],
Cell[222340, 6274, 396, 8, 35, "Text",ExpressionUUID->"b2ee20e5-59b3-42bb-b099-270f84147052",
 CellID->1535376150],
Cell[222739, 6284, 797, 22, 52, "Input",ExpressionUUID->"4cbeb37b-2b67-444d-ae1a-b45fd31496a9",
 CellID->903450698],
Cell[223539, 6308, 212, 5, 35, "Text",ExpressionUUID->"87907545-3afc-4ca1-a5d8-0f8a4ac1c82d",
 CellID->1586496996],
Cell[CellGroupData[{
Cell[223776, 6317, 1410, 36, 94, "Input",ExpressionUUID->"e9427b1e-e7fb-4bca-a01f-2b9e7291b5d2",
 CellID->1098050620],
Cell[225189, 6355, 4798, 110, 161, "Output",ExpressionUUID->"07edfb49-eede-4684-9a9a-cb8206a2ee33",
 CellID->1513343040]
}, Open  ]],
Cell[CellGroupData[{
Cell[230024, 6470, 642, 15, 73, "Input",ExpressionUUID->"675d0aa5-0422-45d6-bf13-d1bac9d8465b",
 CellID->1609791669],
Cell[230669, 6487, 2040, 54, 59, "Output",ExpressionUUID->"99f91e7b-b8a4-4222-acc0-9f1c529f6d3c",
 CellID->1455422470],
Cell[232712, 6543, 683, 11, 34, "Output",ExpressionUUID->"bf376120-30b5-4938-ba92-51cb9584aa3f",
 CellID->1446713960]
}, Open  ]],
Cell[CellGroupData[{
Cell[233432, 6559, 728, 18, 30, "Input",ExpressionUUID->"56187403-9428-4aff-be77-ba2e1647d23e",
 CellID->1769595977],
Cell[234163, 6579, 780, 15, 34, "Output",ExpressionUUID->"7d1447f1-edc6-4606-ac2f-02f86989c603",
 CellID->1067279918]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[234992, 6600, 355, 7, 38, "MathCaption",ExpressionUUID->"43705915-bfca-450c-94b2-4ea4ee8a0bfd",
 CellID->1555491913],
Cell[235350, 6609, 425, 9, 30, "Input",ExpressionUUID->"ade458f6-cea1-4951-97d7-19fadc48a610",
 CellID->1834146860],
Cell[235778, 6620, 427, 7, 35, "Text",ExpressionUUID->"a6f85606-cc16-4b5b-80f1-35c79eaef247",
 CellID->1526006982],
Cell[236208, 6629, 1556, 46, 94, "Input",ExpressionUUID->"93cfef95-f9c8-4880-90d6-91776ae0aa6a",
 CellID->202150353],
Cell[237767, 6677, 227, 4, 35, "Text",ExpressionUUID->"c0f3c799-38da-4469-a049-58ea7e1c8bcb",
 CellID->221853317],
Cell[CellGroupData[{
Cell[238019, 6685, 1754, 46, 115, "Input",ExpressionUUID->"8d7979e8-ce3b-42e7-a245-3e8bff9880cf",
 CellID->657087627],
Cell[239776, 6733, 6574, 150, 231, "Output",ExpressionUUID->"7d352728-3e5f-4deb-b9da-8cfddfc509f4",
 CellID->1108756017]
}, Open  ]],
Cell[246365, 6886, 207, 2, 35, "Text",ExpressionUUID->"dc774785-2c92-4f57-880d-715206081e05",
 CellID->1617894012],
Cell[CellGroupData[{
Cell[246597, 6892, 734, 16, 73, "Input",ExpressionUUID->"cb95b0e4-43b0-458d-8765-c94403bcb5ab",
 CellID->154236232],
Cell[247334, 6910, 4293, 127, 50, "Output",ExpressionUUID->"4690e317-3502-4c35-868e-a9b20cd48b37",
 CellID->639558572],
Cell[251630, 7039, 347, 7, 34, "Output",ExpressionUUID->"713199f1-d28c-4eb2-b409-b09d347daebc",
 CellID->905266369]
}, Open  ]],
Cell[251992, 7049, 276, 5, 35, "Text",ExpressionUUID->"01a85adc-869d-402e-8b87-51b03226a8b2",
 CellID->494273051],
Cell[252271, 7056, 454, 9, 30, "Input",ExpressionUUID->"109edc96-fcee-4275-a86c-899e1d860841",
 CellID->289243815],
Cell[252728, 7067, 199, 2, 35, "Text",ExpressionUUID->"9f13f585-92e9-4df9-a83f-7bcb65519ad5",
 CellID->929134592],
Cell[CellGroupData[{
Cell[252952, 7073, 847, 20, 52, "Input",ExpressionUUID->"dc17c73d-0ebf-4b94-8754-a734c316e40c",
 CellID->612895729],
Cell[253802, 7095, 1097, 32, 230, "Output",ExpressionUUID->"291d37b8-b692-4f85-a360-90260cf624ee",
 CellID->509463432]
}, Open  ]],
Cell[254914, 7130, 232, 4, 35, "Text",ExpressionUUID->"26c3c285-eee4-42fe-a604-65eaaafd90ee",
 CellID->701716311],
Cell[CellGroupData[{
Cell[255171, 7138, 386, 10, 30, "Input",ExpressionUUID->"5d3d409c-2546-4eb8-89cb-d4acd272dbfe",
 CellID->1789090274],
Cell[255560, 7150, 386, 10, 34, "Output",ExpressionUUID->"c3de4442-5bbf-42ae-b5e9-e44c1c9158d6",
 CellID->564327070]
}, Open  ]],
Cell[255961, 7163, 440, 10, 58, "Text",ExpressionUUID->"4d943bd4-0a6e-44f1-adbc-d59dc73936cb",
 CellID->721731118],
Cell[CellGroupData[{
Cell[256426, 7177, 272, 6, 30, "Input",ExpressionUUID->"9b290f7d-43c6-4784-8e54-64cede99cdbc",
 CellID->371146945],
Cell[256701, 7185, 273, 6, 34, "Output",ExpressionUUID->"d03d569a-1365-4e66-9edf-72bc967f9bf3",
 CellID->1565011659]
}, Open  ]],
Cell[CellGroupData[{
Cell[257011, 7196, 273, 6, 30, "Input",ExpressionUUID->"0d32a973-6aba-4828-af5a-d791bcc70279",
 CellID->799014800],
Cell[257287, 7204, 290, 6, 34, "Output",ExpressionUUID->"60994b76-0c7a-49dc-aa64-b330967e841f",
 CellID->178811984]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[257650, 7218, 211, 3, 67, "Section",ExpressionUUID->"376ce1dd-bff8-4080-bc22-db5ee7488fe0",
 CellTags->"Section53",
 CellID->113928457],
Cell[257864, 7223, 219, 3, 54, "Subsection",ExpressionUUID->"aea805f3-b3a6-49e8-85a8-06304c126a6e",
 CellTags->"Section54",
 CellID->1387647322],
Cell[CellGroupData[{
Cell[258108, 7230, 211, 3, 38, "Subsection",ExpressionUUID->"3181692c-1196-4295-9e8d-4bb3d0cd9808",
 CellTags->"Section55",
 CellID->516134434],
Cell[CellGroupData[{
Cell[258344, 7237, 193, 3, 38, "MathCaption",ExpressionUUID->"1983da86-023b-423d-900e-0de28421caec",
 CellID->1098558136],
Cell[CellGroupData[{
Cell[258562, 7244, 900, 16, 52, "Input",ExpressionUUID->"a18fc597-8779-4e54-9df0-9bd0fbe90a06",
 CellID->1549678493],
Cell[259465, 7262, 1377, 35, 34, "Output",ExpressionUUID->"a16f1e84-18a5-4d5a-89f8-2a2f0fa5e4bc",
 CellID->111054546]
}, Open  ]],
Cell[260857, 7300, 186, 3, 35, "Text",ExpressionUUID->"7490a608-ee1d-4fd9-b334-4ca4561da508",
 CellID->764761035],
Cell[261046, 7305, 2489, 62, 178, "Input",ExpressionUUID->"677d686f-c975-4c46-903c-1613f5d9b6f9",
 CellID->649087950],
Cell[263538, 7369, 231, 6, 35, "Text",ExpressionUUID->"b5fb0824-b3cd-4365-bf78-e7e95d1cca0c",
 CellID->4248890],
Cell[CellGroupData[{
Cell[263794, 7379, 1736, 41, 94, "Input",ExpressionUUID->"22c45de2-5b5a-4565-8454-979479ab822e",
 CellID->544133879],
Cell[265533, 7422, 5600, 127, 164, "Output",ExpressionUUID->"c929461c-0ba3-474b-a1c6-f570fd4e4db5",
 CellID->315417612]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[271194, 7556, 265, 4, 54, "Subsection",ExpressionUUID->"30e1877f-644c-48f1-ae88-4c536fd2c397",
 CellTags->"Section56",
 CellID->984982005],
Cell[CellGroupData[{
Cell[271484, 7564, 252, 6, 38, "MathCaption",ExpressionUUID->"eb0a6c1c-c2a6-476f-9869-99cdf48a9393",
 CellID->1272735427],
Cell[CellGroupData[{
Cell[271761, 7574, 1829, 42, 94, "Input",ExpressionUUID->"e744e3ee-a374-4954-8863-79fd64a99f0b",
 CellID->1927197469],
Cell[273593, 7618, 5300, 123, 164, "Output",ExpressionUUID->"f84d77c2-5746-46b1-bf06-130c834b82d9",
 CellID->269543169]
}, Open  ]],
Cell[278908, 7744, 182, 3, 35, "Text",ExpressionUUID->"b84fb900-02f4-47d7-8b48-880e5165530a",
 CellID->2059497429],
Cell[CellGroupData[{
Cell[279115, 7751, 965, 19, 52, "Input",ExpressionUUID->"1d36445c-54e7-41d6-9c47-76978a1e756c",
 CellID->831866857],
Cell[280083, 7772, 6313, 144, 164, "Output",ExpressionUUID->"7f2b0fc1-08bb-4007-829d-a74d64b8f270",
 CellID->1974633852]
}, Open  ]],
Cell[286411, 7919, 183, 3, 35, "Text",ExpressionUUID->"029afe9d-0445-45f2-852f-459f1fb007d1",
 CellID->1067723629],
Cell[CellGroupData[{
Cell[286619, 7926, 2397, 54, 136, "Input",ExpressionUUID->"08ddd18c-1d61-4037-8a1e-98bbe29b9504",
 CellID->857678271],
Cell[289019, 7982, 6807, 149, 171, "Output",ExpressionUUID->"9ed603b7-37ba-4df8-9e80-261a3bb1d9e4",
 CellID->1088569730]
}, Open  ]],
Cell[295841, 8134, 164, 3, 35, "Text",ExpressionUUID->"4ca42a61-75bf-4bb6-a088-b85cdab8deaa",
 CellID->1088462033],
Cell[CellGroupData[{
Cell[296030, 8141, 582, 14, 73, "Input",ExpressionUUID->"359e6336-8988-4e52-b691-d6ab463bf315",
 CellID->1515683485],
Cell[296615, 8157, 574, 9, 34, "Output",ExpressionUUID->"ce189f75-dce6-40db-8ce1-dc9b85c9d55b",
 CellID->196562055]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[297262, 8174, 211, 3, 67, "Section",ExpressionUUID->"7b1be872-4718-438c-a460-480b0a261bd7",
 CellTags->"Section57",
 CellID->1788606959],
Cell[297476, 8179, 197, 3, 54, "Subsection",ExpressionUUID->"ccf2212c-ee95-4476-b2a9-071d627d2562",
 CellTags->"Section58",
 CellID->641069207],
Cell[CellGroupData[{
Cell[297698, 8186, 201, 3, 38, "Subsection",ExpressionUUID->"184f5541-c30e-4363-96f7-66eb6a8781bf",
 CellTags->"Section59",
 CellID->524705050],
Cell[CellGroupData[{
Cell[297924, 8193, 210, 4, 38, "MathCaption",ExpressionUUID->"4ec0c88b-5433-4713-ad78-5134fa5cb44c",
 CellID->641311681],
Cell[298137, 8199, 559, 12, 73, "Input",ExpressionUUID->"95677b7c-0169-4029-a274-91abdcf147a6",
 CellID->304998274],
Cell[298699, 8213, 356, 7, 58, "Text",ExpressionUUID->"3a0b0e2e-689d-4b21-b088-0a1e929d7091",
 CellID->62525729],
Cell[299058, 8222, 735, 16, 52, "Input",ExpressionUUID->"8c3deedc-1f8a-4760-9d47-1527a724dd94",
 CellID->750423920],
Cell[299796, 8240, 450, 13, 39, "Text",ExpressionUUID->"c36dde83-2e78-416f-bd78-dabe650dd7b7",
 CellID->203364609],
Cell[300249, 8255, 1273, 27, 73, "Input",ExpressionUUID->"df9a4d6f-bd66-4857-ba55-c8fe55b1dc29",
 CellID->1302501086],
Cell[CellGroupData[{
Cell[301547, 8286, 1384, 29, 52, "Input",ExpressionUUID->"14e8ed5f-72ee-462c-b0cd-cc91ebfad36f",
 CellID->1834938531],
Cell[302934, 8317, 6039, 146, 197, "Output",ExpressionUUID->"a64d5aae-1131-4f01-aec9-5ee25d9f2703",
 CellID->1043998813]
}, Open  ]],
Cell[308988, 8466, 410, 9, 35, "Text",ExpressionUUID->"c57e7447-9d82-4218-a87e-891da79943a4",
 CellID->1946719597],
Cell[CellGroupData[{
Cell[309423, 8479, 463, 12, 52, "Input",ExpressionUUID->"741ad98d-1077-46c4-8cb8-bb21aec0438c",
 CellID->1602904734],
Cell[309889, 8493, 2698, 48, 98, "Output",ExpressionUUID->"7eefb783-8ba3-41c6-8e14-d6736e68a18a",
 CellID->1043599891]
}, Open  ]],
Cell[CellGroupData[{
Cell[312624, 8546, 356, 7, 30, "Input",ExpressionUUID->"34ecf7ba-fee3-4518-9482-4c8ba297692c",
 CellID->1984996370],
Cell[312983, 8555, 1268, 22, 56, "Output",ExpressionUUID->"eebb2306-28be-4124-a4a7-ec8ac71ecb0e",
 CellID->1914934620]
}, Open  ]],
Cell[CellGroupData[{
Cell[314288, 8582, 872, 18, 52, "Input",ExpressionUUID->"dd2a8a89-564b-4157-8956-4c2147d3983f",
 CellID->675534445],
Cell[315163, 8602, 2243, 52, 253, "Output",ExpressionUUID->"8700a979-ab98-48ce-a3b8-c98f3e3a01f7",
 CellID->692181331]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

