(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    410499,      11534]
NotebookOptionsPosition[    367900,      10787]
NotebookOutlinePosition[    370191,      10847]
CellTagsIndexPosition[    370148,      10844]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Quantum Computation: Overview", "Title",
 CellChangeTimes->{{3.81848277080221*^9, 3.818482778013246*^9}, {
  3.818621337257331*^9, 
  3.818621344827136*^9}},ExpressionUUID->"b9269d85-53e8-4b1a-8e3e-\
227531db259b"],

Cell[BoxData[{
 RowBox[{"<<", "Q3`"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "Q3`Gray`"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "WorkbookTools`"}]}], "Input",
 CellChangeTimes->{{3.81862136736141*^9, 3.818621374064451*^9}, {
  3.819804603089723*^9, 3.819804603474471*^9}, {3.82044708816819*^9, 
  3.820447090260006*^9}, {3.8223628653829613`*^9, 3.822362866135529*^9}, {
  3.8228059408010607`*^9, 3.8228059410543423`*^9}, {3.82384509173897*^9, 
  3.8238450942011337`*^9}, {3.824001730504662*^9, 3.824001734328494*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"461ddb1f-d118-47e8-96bb-6e4be8172a11"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8186213773725233`*^9, 3.8186213801841288`*^9}, {
  3.8257131068437862`*^9, 3.825713111714123*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"d69ce98c-fbd2-4f2c-9529-43b1fbb7afb1"],

Cell["\<\
Quantum computation is an implementation of an arbitrary unitary operation on \
a finite collection of qubits. It is typically depicted in a quantum circuit \
model.\
\>", "Text",
 CellChangeTimes->{{3.825878599535288*^9, 
  3.8258786817803097`*^9}},ExpressionUUID->"a7976343-ed47-4d86-a1b6-\
b3930570d83c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SS", "=", 
   RowBox[{"S", "[", 
    RowBox[{
     RowBox[{"Range", "[", "$n", "]"}], ",", "None"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuissoCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"LogicalForm", "[", 
      RowBox[{
       RowBox[{"Ket", "[", "]"}], ",", "SS"}], "]"}], "}"}], ",", 
    "\"\<Spacer\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"One", "[", "SS", "]"}], ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "}"}], ",", 
    "\"\<Spacer\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{"Measurement", "[", "SS", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.820446043338406*^9, 3.820446164269044*^9}, {
   3.820446362247291*^9, 3.820446363439393*^9}, {3.820446508635497*^9, 
   3.820446550178968*^9}, {3.825878566713632*^9, 3.825878567475039*^9}, {
   3.826329903733292*^9, 3.8263299118559628`*^9}, {3.826330277752688*^9, 
   3.826330279799423*^9}, {3.826330552418887*^9, 3.82633055329523*^9}, {
   3.826333190160123*^9, 3.826333207090252*^9}, 3.826333368678383*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"3e2dd1fd-cd7f-4ae8-b76e-704703ab5311"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{4, -1}, {5, -1}}, {{4, -2}, {5, -2}}, {{4, -3}, {5, -3}}, {{
     4, -4}, {5, -4}}}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
    0, -4}, {4, -4}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -4.4}, {2.4, -0.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{2, Rational[-5, 2]}, {2, -2.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, 
     CircleBox[{4, -1.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -1.2}, {4.24, -0.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, 
     CircleBox[{4, -2.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -2.2}, {4.24, -1.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, 
     CircleBox[{4, -3.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -3.2}, {4.24, -2.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, 
     CircleBox[{4, -4.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -4.2}, {4.24, -3.76}}]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->226.79999999999998`]], "Output",
 CellChangeTimes->{{3.825878569234447*^9, 3.825878587970479*^9}, {
   3.825878683372089*^9, 3.8258786882096863`*^9}, 3.8260505642687883`*^9, 
   3.826128270922245*^9, 3.826225402088735*^9, 3.826326498044672*^9, 
   3.8263297155889397`*^9, {3.826329881701082*^9, 3.826329912433399*^9}, 
   3.8263300469002047`*^9, 3.826330280162805*^9, {3.826330543537323*^9, 
   3.826330590875557*^9}, 3.826330652903831*^9, {3.826330757366248*^9, 
   3.826330773675263*^9}, 3.82633082334127*^9, {3.826333184707642*^9, 
   3.826333210493709*^9}, {3.8263333694358*^9, 3.826333371900917*^9}, {
   3.8263336418876667`*^9, 3.8263336584695463`*^9}, 3.826338027867628*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"8b1c4c5b-cdf8-425e-8def-116c05649a38"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Single-Qubit Gates", "Section",
 CellChangeTimes->{{3.8186213530507107`*^9, 
  3.8186213557050323`*^9}},ExpressionUUID->"5bc389d6-af93-46ff-ba79-\
0f6e03fa1fb7"],

Cell[CellGroupData[{

Cell["Pauli Gates", "Subsection",
 CellChangeTimes->{{3.818624532533708*^9, 
  3.818624534231947*^9}},ExpressionUUID->"487375be-ba69-4daa-8e13-\
7b1a6deac423"],

Cell[CellGroupData[{

Cell[TextData[{
 "The Pauli X gate is represented by ",
 StyleBox["S[\[Ellipsis],1]", "Input"],
 "."
}], "MathCaption",
 CellChangeTimes->{{3.818621389465086*^9, 3.818621404291617*^9}, {
   3.818623248350463*^9, 3.818623251578162*^9}, 3.8186236523965263`*^9, {
   3.81862455866608*^9, 3.818624571906344*^9}, {3.823839977926812*^9, 
   3.8238400228684483`*^9}, {3.8257129267045097`*^9, 
   3.8257129390101767`*^9}},ExpressionUUID->"d40d797f-b56b-4c8d-b649-\
45cb89dd8676"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"S", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.81862454665527*^9, 3.818624585529467*^9}, {
  3.8257129435107718`*^9, 3.825712944826384*^9}, {3.825713453938369*^9, 
  3.825713464997376*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"9f04b05c-bb2d-4a40-b996-1f4295e63b61"],

Cell[BoxData[
 TemplateBox[{
   TemplateBox[{"S"}, "RowDefault"], 
   TemplateBox[{"\"x\""}, "RowDefault"]},
  "Superscript"]], "Output",
 CellChangeTimes->{
  3.8257134661030607`*^9, 3.826326506784478*^9, 3.826329715650999*^9, 
   3.826330658725959*^9, {3.826333643752534*^9, 3.8263336584821453`*^9}},
 CellLabel->"Out[83]=",ExpressionUUID->"799544f8-36ad-4b0f-a58f-593cdc78a9f9"]
}, Open  ]],

Cell["It corresponds to the Pauli X matrix.", "Text",
 CellChangeTimes->{{3.825713470723015*^9, 
  3.825713479238593*^9}},ExpressionUUID->"80fb2058-0246-442b-b3e1-\
508dbf47c715"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", 
   RowBox[{"S", "[", "1", "]"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.81862454665527*^9, 3.818624585529467*^9}, {
  3.8257129435107718`*^9, 3.825712944826384*^9}, {3.825713453938369*^9, 
  3.825713464997376*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"aa7af65a-3649-47da-8cf9-a438d55cc478"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1"},
     {"1", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {1, {{0, 1, 2}, {{2}, {1}}}, {1, 1}}]]]]], "Output",\

 CellChangeTimes->{
  3.8186245509055023`*^9, {3.818624585864015*^9, 3.818624595248075*^9}, 
   3.8186479411326227`*^9, 3.8188353220012197`*^9, 3.819804608063644*^9, 
   3.8200219351450253`*^9, 3.822805955548738*^9, 3.823839332576545*^9, {
   3.825712624287004*^9, 3.825712631932041*^9}, {3.825712945471085*^9, 
   3.8257129474264927`*^9}, {3.8257134574077997`*^9, 3.825713484665298*^9}, 
   3.826326508032309*^9, 3.82632971565663*^9, 3.826330660051331*^9, {
   3.826333644810904*^9, 3.826333658512786*^9}},
 CellLabel->
  "Out[84]//MatrixForm=",ExpressionUUID->"14539434-9aa7-482b-be08-\
c92c476b9f71"]
}, Open  ]],

Cell["\<\
In the quantum circuit model, it is denoted by the following quantum circuit \
element.\
\>", "Text",
 CellChangeTimes->{{3.825712645340199*^9, 3.825712702769148*^9}, {
  3.825712954141368*^9, 
  3.825712961127268*^9}},ExpressionUUID->"054c6e66-8b9c-41eb-abf0-\
5b8eaa37e570"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuissoCircuit", "[", 
  RowBox[{"S", "[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8257127061020813`*^9, 3.8257127500068817`*^9}, {
   3.82571296812493*^9, 3.8257129685965757`*^9}, 3.826326515516995*^9},
 CellLabel->"In[85]:=",ExpressionUUID->"a95d7495-bada-4c60-a336-2108079ab32c"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, LineBox[{{{0, -1}, {2, -1}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.2],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8]], "Output",
 CellChangeTimes->{{3.8257127275339813`*^9, 3.825712750355772*^9}, {
   3.82571296976722*^9, 3.825712971537015*^9}, {3.8263265092012043`*^9, 
   3.826326515884384*^9}, 3.826329715690259*^9, 3.826330661120195*^9, 
   3.8263307636632843`*^9, 3.826330827446179*^9, {3.826333645819489*^9, 
   3.826333658518984*^9}},
 CellLabel->"Out[85]=",ExpressionUUID->"23e3c210-7c9b-4731-8bcb-0e407591435b"]
}, Open  ]],

Cell["\<\
Operating on the logical basis states, it flips the states and is similar to \
the classical logical gate NOT.\
\>", "Text",
 CellChangeTimes->{{3.8257130279380407`*^9, 3.825713068886476*^9}, {
  3.8257131493667994`*^9, 
  3.8257131810223*^9}},ExpressionUUID->"6ebc6fee-93f6-4100-ab1d-a3925d832171"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"Basis", "[", "S", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"S", "[", "1", "]"}], "**", "bs"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"bs", "\[Rule]", "out"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.8257127862107267`*^9, 3.825712808504332*^9}, {
  3.82571297791226*^9, 3.8257130053489923`*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"ac64401f-2be2-440f-a859-7dda40e2db16"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", "S"]}, "RowDefault"], DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", "S"]}, "RowDefault"], DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", "S"]}, "RowDefault"], DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", "S"]}, "RowDefault"], DisplayForm]},
        "Ket"]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.825712995474132*^9, 3.8257130236885777`*^9}, 
   3.825713081826483*^9, 3.825713183450844*^9, 3.82632651848739*^9, 
   3.826329715696488*^9, 3.826333658548737*^9},
 CellLabel->
  "Out[88]//TableForm=",ExpressionUUID->"dc4c7f0d-b8fa-46f7-940f-\
e6bfd7566536"]
}, Open  ]],

Cell["\<\
Operating on a superposition state, it flips the state \
\[OpenCurlyDoubleQuote]simultaneously\[CloseCurlyDoubleQuote].\
\>", "Text",
 CellChangeTimes->{{3.825713119176529*^9, 3.825713140815971*^9}, {
  3.825713189245635*^9, 
  3.825713193419155*^9}},ExpressionUUID->"2461e8f2-87b4-402e-9cdb-\
0a444be5c840"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Ket", "[", "]"}], 
     RowBox[{"c", "[", "0", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"S", "\[Rule]", "1"}], "]"}], 
     RowBox[{"c", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"in", "//", "LogicalForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"S", "[", "1", "]"}], "**", "in"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.825713197089552*^9, 3.825713230509366*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"e9dc21d0-10de-4c40-ac88-9260c8ff2db3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox[
    TemplateBox[{"c"},
     "RowDefault"], 
    TemplateBox[{"0"},
     "RowDefault"]], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", "S"]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   SubscriptBox[
    TemplateBox[{"c"},
     "RowDefault"], 
    TemplateBox[{"1"},
     "RowDefault"]], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", "S"]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{{3.825713206712913*^9, 3.825713245437133*^9}, 
   3.8263265211604757`*^9, 3.826329715728849*^9, 3.826333658555901*^9},
 CellLabel->"Out[90]=",ExpressionUUID->"6b502060-556a-4c47-b81b-74aea6b80f64"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox[
    TemplateBox[{"c"},
     "RowDefault"], 
    TemplateBox[{"1"},
     "RowDefault"]], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", "S"]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   SubscriptBox[
    TemplateBox[{"c"},
     "RowDefault"], 
    TemplateBox[{"0"},
     "RowDefault"]], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", "S"]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{{3.825713206712913*^9, 3.825713245437133*^9}, 
   3.8263265211604757`*^9, 3.826329715728849*^9, 3.826333658562294*^9},
 CellLabel->"Out[92]=",ExpressionUUID->"63b0eb2c-802f-4b26-8a1a-5a0b8fc8ecbd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The Pauli Z gate is represented by ",
 StyleBox["S[\[Ellipsis],3]", "Input"],
 "."
}], "MathCaption",
 CellChangeTimes->{{3.818621389465086*^9, 3.818621404291617*^9}, {
   3.818623248350463*^9, 3.818623251578162*^9}, 3.8186236523965263`*^9, {
   3.81862455866608*^9, 3.818624571906344*^9}, {3.823839977926812*^9, 
   3.8238400228684483`*^9}, {3.8257129267045097`*^9, 
   3.8257129390101767`*^9}, {3.82571325909439*^9, 
   3.8257132609617577`*^9}},ExpressionUUID->"a6ac5eb1-d684-4c82-8a9b-\
7174c87b2019"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"S", "[", "3", "]"}]], "Input",
 CellChangeTimes->{{3.81862454665527*^9, 3.818624585529467*^9}, {
   3.8257129435107718`*^9, 3.825712944826384*^9}, {3.825713262942047*^9, 
   3.82571326301998*^9}, {3.825713440653366*^9, 3.825713443903433*^9}, 
   3.8257134989839363`*^9},
 CellLabel->"In[93]:=",ExpressionUUID->"1a85a8d3-1cb7-4325-825c-ee9b21250c1b"],

Cell[BoxData[
 TemplateBox[{
   TemplateBox[{"S"}, "RowDefault"], 
   TemplateBox[{"\"z\""}, "RowDefault"]},
  "Superscript"]], "Output",
 CellChangeTimes->{3.8257135088430433`*^9, 3.826326523180141*^9, 
  3.826329715736793*^9, 3.8263336585682783`*^9},
 CellLabel->"Out[93]=",ExpressionUUID->"82e8da1c-fc47-4890-8fe6-74b73684626f"]
}, Open  ]],

Cell["It corresponds to the Pauli Z matrix.", "Text",
 CellChangeTimes->{{3.825713470723015*^9, 3.825713479238593*^9}, {
  3.82571351906275*^9, 
  3.825713519400065*^9}},ExpressionUUID->"8720ff9d-2e56-405f-a9c8-\
2d0b67114b55"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", 
   RowBox[{"S", "[", "3", "]"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.81862454665527*^9, 3.818624585529467*^9}, {
  3.8257129435107718`*^9, 3.825712944826384*^9}, {3.825713453938369*^9, 
  3.825713464997376*^9}, {3.825713505620495*^9, 3.8257135056435747`*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"ce76741a-8ca8-4bc2-a88d-2561bf01c4e9"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0"},
     {"0", 
      RowBox[{"-", "1"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {1, {{0, 1, 2}, {{1}, {2}}}, {1, -1}}]]]]], "Output",\

 CellChangeTimes->{
  3.8186245509055023`*^9, {3.818624585864015*^9, 3.818624595248075*^9}, 
   3.8186479411326227`*^9, 3.8188353220012197`*^9, 3.819804608063644*^9, 
   3.8200219351450253`*^9, 3.822805955548738*^9, 3.823839332576545*^9, {
   3.825712624287004*^9, 3.825712631932041*^9}, {3.825712945471085*^9, 
   3.8257129474264927`*^9}, 3.825713263330449*^9, 3.825713444260021*^9, {
   3.825713506033587*^9, 3.825713512446046*^9}, 3.826326524530183*^9, 
   3.8263297157421722`*^9, 3.8263336585985413`*^9},
 CellLabel->
  "Out[94]//MatrixForm=",ExpressionUUID->"8befe265-0954-4b0e-b98a-\
e6b35c0fd766"]
}, Open  ]],

Cell["\<\
In the quantum circuit model, it is denoted by the following quantum circuit \
element.\
\>", "Text",
 CellChangeTimes->{{3.825712645340199*^9, 3.825712702769148*^9}, {
  3.825712954141368*^9, 
  3.825712961127268*^9}},ExpressionUUID->"039859f0-c61e-4b04-afa2-\
cf8765ed58c1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuissoCircuit", "[", 
  RowBox[{"S", "[", "3", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8257127061020813`*^9, 3.8257127500068817`*^9}, {
   3.82571296812493*^9, 3.8257129685965757`*^9}, {3.825713271458117*^9, 
   3.8257132714799433`*^9}, 3.826326529600905*^9},
 CellLabel->
  "In[299]:=",ExpressionUUID->"820ac768-ef2a-45c2-afc7-5eb82aa224f1"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, LineBox[{{{0, -1}, {2, -1}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.2],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8]], "Output",
 CellChangeTimes->{{3.8257127275339813`*^9, 3.825712750355772*^9}, {
   3.82571296976722*^9, 3.825712971537015*^9}, 3.825713271835907*^9, 
   3.826326529979529*^9, 3.826329715747568*^9, 3.826330682232589*^9, {
   3.826333658605288*^9, 3.826333671851139*^9}},
 CellLabel->
  "Out[299]=",ExpressionUUID->"3e4f376f-f4d6-434d-bac3-8de2d4b9c7d6"]
}, Open  ]],

Cell[TextData[{
 "Operating on the logical basis states, it \[OpenCurlyDoubleQuote]flips the \
phase\[CloseCurlyDoubleQuote], that is, it changes the phase factor to ",
 StyleBox["-1", "Input"],
 " of the logical basis state ",
 Cell[BoxData[
  TemplateBox[{"1"},
   "Ket"]],ExpressionUUID->"4b1bf8f5-0d0e-4ec5-99ba-13e32527d87f"],
 "."
}], "Text",
 CellChangeTimes->{{3.8257130279380407`*^9, 3.825713068886476*^9}, {
  3.8257131493667994`*^9, 3.8257131810223*^9}, {3.8257132833259897`*^9, 
  3.825713334872046*^9}},ExpressionUUID->"976291a9-1dfc-4f2f-95f7-\
814fc2a4dc1d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"Basis", "[", "S", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"S", "[", "3", "]"}], "**", "bs"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"bs", "\[Rule]", "out"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.8257127862107267`*^9, 3.825712808504332*^9}, {
  3.82571297791226*^9, 3.8257130053489923`*^9}, {3.825713275260957*^9, 
  3.8257132753387327`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"94f69b26-de8b-4a12-83d9-7b1159fad58b"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", "S"]}, "RowDefault"], DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", "S"]}, "RowDefault"], DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", "S"]}, "RowDefault"], DisplayForm]},
        "Ket"], "\[Rule]", 
       RowBox[{"-", 
        TemplateBox[{
          TagBox[
           TemplateBox[{
             SubscriptBox["1", "S"]}, "RowDefault"], DisplayForm]},
         "Ket"]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.825712995474132*^9, 3.8257130236885777`*^9}, 
   3.825713081826483*^9, 3.825713183450844*^9, 3.8257132756940823`*^9, {
   3.825713341943788*^9, 3.825713352702548*^9}, 3.82632653256609*^9, 
   3.826329715778534*^9, 3.826330685259638*^9, 3.826333658612545*^9},
 CellLabel->
  "Out[98]//TableForm=",ExpressionUUID->"5e6db7d1-c6c8-4c06-bd36-\
1c4de6851a7a"]
}, Open  ]],

Cell["\<\
Here is an example how the Pauli Z gate acts on a superposition state.\
\>", "Text",
 CellChangeTimes->{{3.825713361972435*^9, 
  3.825713380690618*^9}},ExpressionUUID->"0915300b-ea63-40a0-b571-\
ba028cd9d6ea"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Ket", "[", "]"}], 
     RowBox[{"c", "[", "0", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"S", "\[Rule]", "1"}], "]"}], 
     RowBox[{"c", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"in", "//", "LogicalForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"S", "[", "3", "]"}], "**", "in"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.825713197089552*^9, 3.825713230509366*^9}, {
  3.8257133856749496`*^9, 3.8257133857416*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"91f59bd1-33ee-493a-869a-37d6dbd4a595"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox[
    TemplateBox[{"c"},
     "RowDefault"], 
    TemplateBox[{"0"},
     "RowDefault"]], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", "S"]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   SubscriptBox[
    TemplateBox[{"c"},
     "RowDefault"], 
    TemplateBox[{"1"},
     "RowDefault"]], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", "S"]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{{3.825713206712913*^9, 3.825713245437133*^9}, {
   3.825713353803855*^9, 3.825713390521796*^9}, 3.826326533919094*^9, 
   3.826329715785612*^9, 3.826333658619411*^9},
 CellLabel->
  "Out[100]=",ExpressionUUID->"f282da42-149b-4220-bd5e-71aa951d71e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox[
    TemplateBox[{"c"},
     "RowDefault"], 
    TemplateBox[{"0"},
     "RowDefault"]], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", "S"]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   SubscriptBox[
    TemplateBox[{"c"},
     "RowDefault"], 
    TemplateBox[{"1"},
     "RowDefault"]], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", "S"]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{{3.825713206712913*^9, 3.825713245437133*^9}, {
   3.825713353803855*^9, 3.825713390521796*^9}, 3.826326533919094*^9, 
   3.826329715785612*^9, 3.826333658621924*^9},
 CellLabel->
  "Out[102]=",ExpressionUUID->"4f2bf179-428e-4288-8bf2-1c43bf9cd21c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The Pauli Y gate is represented by ",
 StyleBox["S[\[Ellipsis],2]", "Input"],
 "."
}], "MathCaption",
 CellChangeTimes->{{3.818621389465086*^9, 3.818621404291617*^9}, {
   3.818623248350463*^9, 3.818623251578162*^9}, 3.8186236523965263`*^9, {
   3.81862455866608*^9, 3.818624571906344*^9}, {3.823839977926812*^9, 
   3.8238400228684483`*^9}, {3.8257129267045097`*^9, 
   3.8257129390101767`*^9}, {3.82571325909439*^9, 3.8257132609617577`*^9}, {
   3.825713399736334*^9, 
   3.825713406587365*^9}},ExpressionUUID->"34ec3e66-ffaf-4447-963d-\
07cbb97eb58c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"S", "[", "2", "]"}]], "Input",
 CellChangeTimes->{{3.81862454665527*^9, 3.818624585529467*^9}, {
   3.8257129435107718`*^9, 3.825712944826384*^9}, {3.825713262942047*^9, 
   3.82571326301998*^9}, {3.825713411706872*^9, 3.825713424104177*^9}, 
   3.825713527182322*^9},
 CellLabel->
  "In[103]:=",ExpressionUUID->"ebb6e219-9b2e-4788-beb7-5d1a35d34947"],

Cell[BoxData[
 TemplateBox[{
   TemplateBox[{"S"}, "RowDefault"], 
   TemplateBox[{"\"y\""}, "RowDefault"]},
  "Superscript"]], "Output",
 CellChangeTimes->{3.825713528149259*^9, 3.826326536099168*^9, 
  3.826329715819648*^9, 3.826333658651154*^9},
 CellLabel->
  "Out[103]=",ExpressionUUID->"475820cf-6b26-4787-b03c-65f93fe803d2"]
}, Open  ]],

Cell["It corresponds to the Pauli Y matrix.", "Text",
 CellChangeTimes->{{3.825713470723015*^9, 3.825713479238593*^9}, {
  3.825713534734255*^9, 
  3.825713535059946*^9}},ExpressionUUID->"7873df99-9826-4131-9179-\
b307bf904799"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", 
   RowBox[{"S", "[", "2", "]"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.81862454665527*^9, 3.818624585529467*^9}, {
  3.8257129435107718`*^9, 3.825712944826384*^9}, {3.825713453938369*^9, 
  3.825713464997376*^9}, {3.8257135389414587`*^9, 3.8257135389857264`*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"20673574-c5e0-413d-b784-8929a71b2f36"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"-", "\[ImaginaryI]"}]},
     {"\[ImaginaryI]", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 1, 2}, {{2}, {1}}}, {
      Complex[0, -1], Complex[0, 1]}}]]]]], "Output",
 CellChangeTimes->{
  3.8186245509055023`*^9, {3.818624585864015*^9, 3.818624595248075*^9}, 
   3.8186479411326227`*^9, 3.8188353220012197`*^9, 3.819804608063644*^9, 
   3.8200219351450253`*^9, 3.822805955548738*^9, 3.823839332576545*^9, {
   3.825712624287004*^9, 3.825712631932041*^9}, {3.825712945471085*^9, 
   3.8257129474264927`*^9}, 3.825713263330449*^9, {3.825713408994506*^9, 
   3.825713424368416*^9}, 3.8257135394025373`*^9, 3.826326537559196*^9, 
   3.826329715825872*^9, 3.82633365865774*^9},
 CellLabel->
  "Out[104]//MatrixForm=",ExpressionUUID->"58eb0578-5810-42d7-9661-\
05bd6e9391b5"]
}, Open  ]],

Cell["\<\
In the quantum circuit model, it is denoted by the following quantum circuit \
element.\
\>", "Text",
 CellChangeTimes->{{3.825712645340199*^9, 3.825712702769148*^9}, {
  3.825712954141368*^9, 
  3.825712961127268*^9}},ExpressionUUID->"59e2dccf-2e45-42c4-a9b4-\
17c6b958522e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuissoCircuit", "[", 
  RowBox[{"S", "[", "2", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8257127061020813`*^9, 3.8257127500068817`*^9}, {
   3.82571296812493*^9, 3.8257129685965757`*^9}, {3.825713271458117*^9, 
   3.8257132714799433`*^9}, {3.825713544937821*^9, 3.8257135449609747`*^9}, 
   3.826326544180491*^9},
 CellLabel->
  "In[105]:=",ExpressionUUID->"8f326858-ced0-4ce4-a0ec-a8aa72348012"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, LineBox[{{{0, -1}, {2, -1}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Y\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.2],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8]], "Output",
 CellChangeTimes->{{3.8257127275339813`*^9, 3.825712750355772*^9}, {
   3.82571296976722*^9, 3.825712971537015*^9}, 3.825713271835907*^9, {
   3.825713541006668*^9, 3.8257135454616957`*^9}, 3.826128286029435*^9, {
   3.826326538828508*^9, 3.826326544578589*^9}, 3.826329715857389*^9, 
   3.82633365868841*^9},
 CellLabel->
  "Out[105]=",ExpressionUUID->"56772fed-4f47-4207-b0eb-0c76b639b2af"]
}, Open  ]],

Cell["\<\
Pauli Y is a combination of the bit-flip (Pauli X) and phase-flip (Pauli Z) \
operation.\
\>", "Text",
 CellChangeTimes->{{3.826050594979191*^9, 3.8260506232933283`*^9}, {
  3.826050755946941*^9, 
  3.82605075763421*^9}},ExpressionUUID->"19fa5d6e-4835-4fa4-90e5-\
9a2c951f7ea6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuissoCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", "1", "]"}], ",", 
    RowBox[{"S", "[", "3", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"op", "=", 
  RowBox[{"QuissoExpression", "[", "qc", "]"}]}]}], "Input",
 CellChangeTimes->{{3.826050627040928*^9, 3.826050665738103*^9}, {
   3.82612824219531*^9, 3.826128250789013*^9}, 3.826326552358045*^9},
 CellLabel->
  "In[106]:=",ExpressionUUID->"c9e81ac5-8510-4af7-b766-fe5474c8677d"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, LineBox[{{{0, -1}, {3, -1}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {2, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`]], "Output",
 CellChangeTimes->{
  3.826050762759324*^9, {3.826128252295397*^9, 3.826128280818079*^9}, {
   3.826326547371611*^9, 3.826326552786172*^9}, 3.826329715864098*^9, 
   3.826333658696054*^9},
 CellLabel->
  "Out[106]=",ExpressionUUID->"0de9a2cd-b11f-4e76-ba08-e86649447119"],

Cell[BoxData[
 RowBox[{"\[ImaginaryI]", " ", 
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"\"y\""}, "RowDefault"]},
   "Superscript"]}]], "Output",
 CellChangeTimes->{
  3.826050762759324*^9, {3.826128252295397*^9, 3.826128280818079*^9}, {
   3.826326547371611*^9, 3.826326552786172*^9}, 3.826329715864098*^9, 
   3.826333658698592*^9},
 CellLabel->
  "Out[107]=",ExpressionUUID->"216273bd-36dd-48be-bdbb-ffca67f66b7d"]
}, Open  ]],

Cell["\<\
This shows more explicitly how Pauli Y \[OpenCurlyDoubleQuote]flips\
\[CloseCurlyDoubleQuote] both the bit and phase of the logical basis states.\
\>", "Text",
 CellChangeTimes->{{3.826050773148386*^9, 
  3.826050832555676*^9}},ExpressionUUID->"e07c1c22-ab65-4dd2-ab0d-\
2aff26f0976d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"Basis", "[", "S", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"S", "[", "2", "]"}], "**", "bs"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"bs", "\[Rule]", "out"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.8257127862107267`*^9, 3.825712808504332*^9}, {
  3.82571297791226*^9, 3.8257130053489923`*^9}, {3.825713275260957*^9, 
  3.8257132753387327`*^9}, {3.825713549358869*^9, 3.8257135494593782`*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"435c8fe5-586d-4a98-9cb0-e352c3bb0b5b"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", "S"]}, "RowDefault"], DisplayForm]},
        "Ket"], "\[Rule]", 
       RowBox[{"\[ImaginaryI]", " ", 
        TemplateBox[{
          TagBox[
           TemplateBox[{
             SubscriptBox["1", "S"]}, "RowDefault"], DisplayForm]},
         "Ket"]}]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", "S"]}, "RowDefault"], DisplayForm]},
        "Ket"], "\[Rule]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        TemplateBox[{
          TagBox[
           TemplateBox[{
             SubscriptBox["0", "S"]}, "RowDefault"], DisplayForm]},
         "Ket"]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.825712995474132*^9, 3.8257130236885777`*^9}, 
   3.825713081826483*^9, 3.825713183450844*^9, 3.8257132756940823`*^9, {
   3.825713341943788*^9, 3.825713352702548*^9}, 3.8257135497945538`*^9, {
   3.826050588431753*^9, 3.826050591436213*^9}, 3.82605069091007*^9, 
   3.826050834113041*^9, 3.826326554271883*^9, 3.82632971589795*^9, 
   3.826333658727742*^9},
 CellLabel->
  "Out[110]//TableForm=",ExpressionUUID->"de3ae2dd-e4ce-464c-a42b-\
ebd1ec4318f6"]
}, Open  ]],

Cell["\<\
Here is an example how the Pauli Y gate acts on a superposition state.\
\>", "Text",
 CellChangeTimes->{{3.825713361972435*^9, 3.825713380690618*^9}, {
  3.826050682601389*^9, 
  3.826050683253064*^9}},ExpressionUUID->"e71f598d-7326-4c0d-99bf-\
cd63e059da65"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Ket", "[", "]"}], 
     RowBox[{"c", "[", "0", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"S", "\[Rule]", "1"}], "]"}], 
     RowBox[{"c", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"in", "//", "LogicalForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"S", "[", "2", "]"}], "**", "in"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.825713197089552*^9, 3.825713230509366*^9}, {
  3.8257133856749496`*^9, 3.8257133857416*^9}, {3.825713556266737*^9, 
  3.825713556333317*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"5c35afb4-3385-4510-916c-2a6ba6834367"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox[
    TemplateBox[{"c"},
     "RowDefault"], 
    TemplateBox[{"0"},
     "RowDefault"]], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", "S"]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   SubscriptBox[
    TemplateBox[{"c"},
     "RowDefault"], 
    TemplateBox[{"1"},
     "RowDefault"]], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", "S"]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{{3.825713206712913*^9, 3.825713245437133*^9}, {
   3.825713353803855*^9, 3.825713390521796*^9}, {3.82571355189587*^9, 
   3.825713563167523*^9}, 3.826050684768147*^9, 3.826050836073306*^9, 
   3.826326555758396*^9, 3.8263297159050417`*^9, 3.826333658736106*^9},
 CellLabel->
  "Out[112]=",ExpressionUUID->"0e6fea28-2727-495e-a854-c82c02ef0db5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "\[ImaginaryI]"}], " ", 
   SubscriptBox[
    TemplateBox[{"c"},
     "RowDefault"], 
    TemplateBox[{"1"},
     "RowDefault"]], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", "S"]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   SubscriptBox[
    TemplateBox[{"c"},
     "RowDefault"], 
    TemplateBox[{"0"},
     "RowDefault"]], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", "S"]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{{3.825713206712913*^9, 3.825713245437133*^9}, {
   3.825713353803855*^9, 3.825713390521796*^9}, {3.82571355189587*^9, 
   3.825713563167523*^9}, 3.826050684768147*^9, 3.826050836073306*^9, 
   3.826326555758396*^9, 3.8263297159050417`*^9, 3.826333658738933*^9},
 CellLabel->
  "Out[114]=",ExpressionUUID->"bf1d100e-02ad-4873-adf4-dee7a668fba5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The Pauli gates also correspond, up to a global phase factor (",
 Cell[BoxData[
  FormBox[
   RowBox[{"-", "i"}], TraditionalForm]],ExpressionUUID->
  "9bf9124c-9402-4a43-93b4-222a57daa433"],
 "), to rotations by the corresponding axes by angle \[Pi]. Here ",
 StyleBox["QuissoRotation[\[Phi],S[\[Ellipsis],\[Mu]]]", "Input"],
 " gives the rotation operator around the \[Mu]-axis by angle \[Phi]."
}], "MathCaption",
 CellChangeTimes->{{3.826050889511829*^9, 3.826050993073821*^9}, {
  3.826051025787265*^9, 
  3.8260511106636677`*^9}},ExpressionUUID->"e92b7fcd-10a8-4e75-b8b1-\
7af847a1dc0f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuissoRotation", "[", 
  RowBox[{"Pi", ",", 
   RowBox[{"S", "[", "1", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.826050924578861*^9, 3.826050934194028*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"40194263-cb82-4031-9c80-cb57644eedd4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "\[ImaginaryI]"}], " ", 
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"\"x\""}, "RowDefault"]},
   "Superscript"]}]], "Output",
 CellChangeTimes->{{3.826050934824108*^9, 3.8260509467506723`*^9}, {
   3.826050994614525*^9, 3.82605101257932*^9}, 3.826051085794194*^9, 
   3.8263265578432302`*^9, 3.82632971593931*^9, 3.8263336587711477`*^9},
 CellLabel->
  "Out[115]=",ExpressionUUID->"2344a2b0-d034-401e-bc4d-36904b04fb66"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuissoRotation", "[", 
  RowBox[{"Pi", ",", 
   RowBox[{"S", "[", "2", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8260509960242653`*^9, 3.826051002140452*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"77b6cd2e-cbee-44ad-9d20-25c06d263e23"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "\[ImaginaryI]"}], " ", 
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"\"y\""}, "RowDefault"]},
   "Superscript"]}]], "Output",
 CellChangeTimes->{{3.82605100271344*^9, 3.826051013276938*^9}, 
   3.8260510865227423`*^9, 3.8263265585346413`*^9, 3.826329715945683*^9, 
   3.826333658779913*^9},
 CellLabel->
  "Out[116]=",ExpressionUUID->"68773ff5-d277-42cc-bf11-acd3b1e47d55"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuissoRotation", "[", 
  RowBox[{"Pi", ",", 
   RowBox[{"S", "[", "3", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.826051009532477*^9, 3.826051009609573*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"177acc05-085b-463a-bae7-2522109e4b9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "\[ImaginaryI]"}], " ", 
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"\"z\""}, "RowDefault"]},
   "Superscript"]}]], "Output",
 CellChangeTimes->{{3.826051009961281*^9, 3.826051013885168*^9}, 
   3.826051087163536*^9, 3.8263265593294973`*^9, 3.826329715976301*^9, 
   3.826333658814295*^9},
 CellLabel->
  "Out[117]=",ExpressionUUID->"27e9ab7c-3f87-4add-b561-77f164322ef9"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Hadamard Gates", "Subsection",
 CellChangeTimes->{{3.818624536999832*^9, 
  3.818624539924034*^9}},ExpressionUUID->"476c341a-e282-4b67-9f50-\
0e82cfb82f9a"],

Cell[CellGroupData[{

Cell["The Hadamard gate is represented by S[..., 6] .", "MathCaption",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.818621389465086*^9, 3.818621404291617*^9}, {
   3.818623248350463*^9, 3.818623251578162*^9}, 3.8186236523965263`*^9, {
   3.818626536239739*^9, 3.818626536588682*^9}, {3.824001743846092*^9, 
   3.824001756075741*^9}},ExpressionUUID->"f769a5e3-bf2f-4e09-92a4-\
b93206f50249"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"S", "[", 
  RowBox[{"1", ",", "6"}], "]"}]], "Input",
 CellChangeTimes->{{3.818623254481566*^9, 3.818623265764312*^9}, {
   3.8186241154423428`*^9, 3.8186241321127787`*^9}, 3.818624169226514*^9},
 CellLabel->
  "In[118]:=",ExpressionUUID->"47f3a970-fafe-4050-812a-e1f285709a34"],

Cell[BoxData[
 TemplateBox[{
   TemplateBox[{"S"}, "RowDefault"], 
   TemplateBox[{"1"}, "RowDefault"], 
   TemplateBox[{"\"H\""}, "RowDefault"]},
  "Subsuperscript"]], "Output",
 CellChangeTimes->{3.818624172442634*^9, 3.818624221756383*^9, 
  3.8186479426419067`*^9, 3.818835323489685*^9, 3.819804609828603*^9, 
  3.8200219378568153`*^9, 3.8228059569377832`*^9, 3.8238393340072813`*^9, 
  3.82632656148142*^9, 3.826329715982497*^9, 3.826333658821361*^9},
 CellLabel->
  "Out[118]=",ExpressionUUID->"c1ef9cde-36a3-4c3a-bfb0-31c506da8533"]
}, Open  ]],

Cell["Let us consider all the logical basis states.", "Text",
 CellChangeTimes->{{3.8238393724442253`*^9, 
  3.8238394009278727`*^9}},ExpressionUUID->"e4dd0856-6164-478e-9665-\
3afc13159e36"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"bs", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.818623778213904*^9, 3.818623817302516*^9}, 
   3.823839345717217*^9},
 CellLabel->
  "In[119]:=",ExpressionUUID->"04b6ea28-31d2-40b7-a99d-54c71b6141d7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "}"}]], "Output",
 CellChangeTimes->{3.823839349162426*^9, 3.82383940215973*^9, 
  3.8263265627095222`*^9, 3.8263297160151367`*^9, 3.826333658854739*^9},
 CellLabel->
  "Out[120]=",ExpressionUUID->"5828755d-3f54-4704-93f2-6b248dd9ab96"]
}, Open  ]],

Cell["\<\
Operating the Hadamard gate on them gives the two superposition states.\
\>", "Text",
 CellChangeTimes->{{3.8238394090851507`*^9, 
  3.8238394358580513`*^9}},ExpressionUUID->"739ff9df-a0e3-45d7-b955-\
463b615443e9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], "**", "bs"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.818623778213904*^9, 3.818623817302516*^9}, 
   3.823839345717217*^9},
 CellLabel->
  "In[121]:=",ExpressionUUID->"1be73668-5869-47f8-af91-31634c0e24fb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox[
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox["0", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"], 
     SqrtBox["2"]], "+", 
    FractionBox[
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox["1", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"], 
     SqrtBox["2"]]}], ",", 
   RowBox[{
    FractionBox[
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox["0", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"], 
     SqrtBox["2"]], "-", 
    FractionBox[
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox["1", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"], 
     SqrtBox["2"]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.818623784387833*^9, 3.818623823385322*^9}, 
   3.8186242224002647`*^9, 3.818647943238207*^9, 3.818835324016183*^9, 
   3.819804617256995*^9, 3.8228059575206823`*^9, 3.823839341729044*^9, {
   3.823839437132477*^9, 3.823839439213262*^9}, 3.8263265641419897`*^9, 
   3.8263297160253687`*^9, 3.826333658888667*^9},
 CellLabel->
  "Out[122]=",ExpressionUUID->"89f263f3-543d-4e4a-bcef-fd6653f6b532"]
}, Open  ]],

Cell["\<\
In the quantum circuit model, it is denoted by the following circuit element.\
\
\>", "Text",
 CellChangeTimes->{{3.81862417666151*^9, 
  3.8186242040754137`*^9}},ExpressionUUID->"96104f7d-8059-4047-87e8-\
d6b041f591b5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuissoCircuit", "[", 
  RowBox[{"S", "[", 
   RowBox[{"1", ",", "6"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.818623254481566*^9, 3.818623265764312*^9}, {
   3.8186241154423428`*^9, 3.8186241321127787`*^9}, 3.818624169226514*^9, {
   3.818626366978307*^9, 3.818626375267912*^9}, {3.8186264234299383`*^9, 
   3.818626425082181*^9}, 3.826326569918501*^9},
 CellLabel->
  "In[123]:=",ExpressionUUID->"e5bf2746-cb4f-41e2-8a75-e4ee262cb69d"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, LineBox[{{{0, -1}, {2, -1}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.2],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8]], "Output",
 CellChangeTimes->{{3.818623255939554*^9, 3.818623267650558*^9}, 
   3.818624132446986*^9, 3.818624206038434*^9, {3.818626369569408*^9, 
   3.818626425365265*^9}, 3.818647944577664*^9, 3.818835326211357*^9, 
   3.8198046190538197`*^9, 3.822805958895524*^9, 3.823839442145761*^9, {
   3.826326565490086*^9, 3.8263265702990427`*^9}, 3.8263297160591183`*^9, 
   3.82633365889781*^9},
 CellLabel->
  "Out[123]=",ExpressionUUID->"737dbe8e-0996-45a3-aa24-c695a335a699"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Geometrically, the Hadamard gate can be regarded as a rotation around the \
axis ",
 StyleBox["(1,0,1)", "Input"],
 " in the Pauli space by angle \[Pi]."
}], "MathCaption",
 CellChangeTimes->{{3.8260524842996693`*^9, 3.826052530805764*^9}, {
  3.826052662885573*^9, 
  3.826052666843919*^9}},ExpressionUUID->"225048a0-0443-4fc4-8b86-\
1db97d08705d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"op", "=", 
  RowBox[{
   RowBox[{"I", " ", 
    RowBox[{"QuissoRotation", "[", 
     RowBox[{"\[Pi]", ",", "S", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "//", 
   "Garner"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "[", "op", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.826052532552526*^9, 3.826052603138674*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"26e4ef14-b02c-409c-b9a7-60883d5c07b5"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Superscript"], 
   SqrtBox["2"]], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Superscript"], 
   SqrtBox["2"]]}]], "Output",
 CellChangeTimes->{{3.82605255199437*^9, 3.8260526185430403`*^9}, {
   3.8260526776615963`*^9, 3.8260526825712547`*^9}, 3.82632657207556*^9, 
   3.826329716065509*^9, 3.826330834371745*^9, 3.826333658928131*^9},
 CellLabel->
  "Out[124]=",ExpressionUUID->"dafa19b2-1a07-488a-8ed7-dc546fcd8455"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       SqrtBox["2"]], 
      FractionBox["1", 
       SqrtBox["2"]]},
     {
      FractionBox["1", 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {2}, {1}}}, {
      2^Rational[-1, 2], 2^Rational[-1, 2], -2^Rational[-1, 2], 2^
       Rational[-1, 2]}}]]]]], "Output",
 CellChangeTimes->{{3.82605255199437*^9, 3.8260526185430403`*^9}, {
   3.8260526776615963`*^9, 3.8260526825712547`*^9}, 3.82632657207556*^9, 
   3.826329716065509*^9, 3.826330834371745*^9, 3.826333658930879*^9},
 CellLabel->
  "Out[126]//MatrixForm=",ExpressionUUID->"a4566f8f-c90b-4983-aa85-\
5d675ba4f83f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Suppose the Hadamard gates are applied to three qubits.", "MathCaption",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.81862314528251*^9, 3.81862317766955*^9}, {
  3.826052449158119*^9, 
  3.826052456423436*^9}},ExpressionUUID->"2f4837d8-be97-403a-8c5c-\
173cb2279e61"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"HoldForm", "@", 
   RowBox[{"Multiply", "[", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "6"}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "6"}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"3", ",", "6"}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.818621967766716*^9, 3.8186220674346027`*^9}, {
   3.818622120466002*^9, 3.818622211309163*^9}, 3.823839447885399*^9},
 CellLabel->
  "In[127]:=",ExpressionUUID->"ca38990a-0cdc-4826-a204-9f637171dc4f"],

Cell[BoxData[
 TagBox[
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"H\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"H\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"3"}, "RowDefault"], 
       TemplateBox[{"\"H\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm],
  HoldForm]], "Output",
 CellChangeTimes->{3.823839449472801*^9, 3.823839616012266*^9, 
  3.8260653124368343`*^9, 3.826326573817881*^9, 3.826329716099231*^9, 
  3.826330696253277*^9, 3.826330788287939*^9, 3.82633083574472*^9, 
  3.826333658937055*^9},
 CellLabel->
  "Out[127]=",ExpressionUUID->"13ebda0b-4ea5-4707-91aa-53e966162989"]
}, Open  ]],

Cell["\<\
This shows the overall operation in the quantum circuit model.\
\>", "Text",
 CellChangeTimes->{{3.826065352554059*^9, 
  3.8260653792844887`*^9}},ExpressionUUID->"9fb0127a-a410-4390-8586-\
f24c4d7d2157"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuissoCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "6"}], "]"}], ",", 
    "Null"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.826065380871759*^9, 3.8260654050026627`*^9}, {
  3.82632657999852*^9, 3.826326585735145*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"b69d0e72-36c6-4e41-98b7-873a1904e2ab"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8]], "Output",
 CellChangeTimes->{{3.8260653929102983`*^9, 3.826065430762723*^9}, {
   3.826326575087737*^9, 3.82632658607876*^9}, 3.826329716106995*^9, 
   3.826330697422243*^9, 3.826330789497633*^9, 3.826330837228321*^9, 
   3.826333658967948*^9},
 CellLabel->
  "Out[128]=",ExpressionUUID->"4572257f-a619-41f6-ba89-9ea07b18ea83"]
}, Open  ]],

Cell["\<\
Operating the Hadamard gate on each qubit produces a superposition state \
consisting all logical basis states.\
\>", "Text",
 CellChangeTimes->{{3.823839463408526*^9, 3.823839491779254*^9}, {
  3.8238395647884417`*^9, 
  3.823839610372003*^9}},ExpressionUUID->"7e18452a-0569-4adf-a1d9-\
0a2b54f17598"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"ReleaseHold", "[", "op", "]"}], "**", 
    RowBox[{"Ket", "[", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.818621967766716*^9, 3.8186220674346027`*^9}, {
   3.818622120466002*^9, 3.818622211309163*^9}, 3.823839447885399*^9, {
   3.826065424104863*^9, 3.826065427288601*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"94bed628-1c51-4ad9-bafc-34b38a28a9e5"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellChangeTimes->{{3.818622017372534*^9, 3.818622079470892*^9}, {
   3.818622121946135*^9, 3.8186221531650352`*^9}, {3.818622194316663*^9, 
   3.818622211540777*^9}, 3.81862233614688*^9, 3.818623162663619*^9, 
   3.818647946063623*^9, 3.8188353277992783`*^9, 3.819804620943947*^9, 
   3.8228059599757977`*^9, {3.823839613270158*^9, 3.823839617127058*^9}, 
   3.826065427649295*^9, 3.8263265895864697`*^9, 3.826329716140184*^9, 
   3.826333658999794*^9},
 CellLabel->
  "Out[130]=",ExpressionUUID->"6e6e85ce-8e9b-4ec1-9879-c13e57af71a7"]
}, Open  ]],

Cell["This show the same result in the quantum circuit model.", "Text",
 CellChangeTimes->{{3.82606545410914*^9, 
  3.826065464638153*^9}},ExpressionUUID->"eb4db5f6-63cf-4ad3-b807-\
39e17b864335"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuissoCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "6"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QuissoExpression", "[", "qc", "]"}], "//", 
  "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.826065469454503*^9, 3.82606551769351*^9}, 
   3.8263265971874228`*^9},
 CellLabel->
  "In[131]:=",ExpressionUUID->"ecd7fa40-6853-472e-bdae-fd0c3b6067de"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -3}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8]], "Output",
 CellChangeTimes->{{3.826065479330636*^9, 3.826065520426506*^9}, {
   3.826326591514491*^9, 3.826326597600089*^9}, 3.826329716180189*^9, 
   3.826330701879363*^9, 3.82633365903902*^9},
 CellLabel->
  "Out[131]=",ExpressionUUID->"5a726fe8-486e-467f-b70e-5fdae866717b"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellChangeTimes->{{3.826065479330636*^9, 3.826065520426506*^9}, {
   3.826326591514491*^9, 3.826326597600089*^9}, 3.826329716180189*^9, 
   3.826330701879363*^9, 3.826333659042959*^9},
 CellLabel->
  "Out[132]=",ExpressionUUID->"56d50d89-7df3-4a8f-ae40-99adb3257591"]
}, Open  ]],

Cell["\<\
Let us compare it with an explicit construction. To do it first prepare the \
indices of the logical basis states in binary digits.\
\>", "Text",
 CellChangeTimes->{{3.818622997994567*^9, 3.818623031135189*^9}, {
  3.818623163450779*^9, 3.818623164361787*^9}, {3.818627349095077*^9, 
  3.81862735606868*^9}, {3.823839683943412*^9, 3.823839685439266*^9}, {
  3.8238397183552427`*^9, 
  3.823839764917315*^9}},ExpressionUUID->"49a71700-0dcb-4633-aa86-\
3803e2291de7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nn", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"2", "^", "3"}], "-", "1"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"bit", "=", 
  RowBox[{"IntegerDigits", "[", 
   RowBox[{"nn", ",", "2", ",", "3"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.818622236826311*^9, 3.818622325839716*^9}, {
  3.823839692268979*^9, 3.82383971125762*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"e62c0322-d909-4cd3-b091-d1310628f0ea"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.823839695352281*^9, 3.8238397149275312`*^9}, 
   3.823839767204403*^9, 3.826326599318389*^9, 3.826329716196309*^9, 
   3.826333659055791*^9},
 CellLabel->
  "Out[134]=",ExpressionUUID->"cadb8001-ff7b-4f03-9ccd-b2fc7eb85571"]
}, Open  ]],

Cell["\<\
This gives an explicit construction (unnormalized) of the superposition of \
all local basis states.\
\>", "Text",
 CellChangeTimes->{{3.823839776571801*^9, 
  3.82383986868263*^9}},ExpressionUUID->"04bb896f-583a-43f1-bc24-\
93f3c2ff4058"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{
        RowBox[{"S", "@", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "\[Rule]", "#"}], "]"}],
       "&"}], "/@", "bit"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"vec", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.818622236826311*^9, 3.818622325839716*^9}, 
   3.823839692268979*^9, {3.823839850414407*^9, 3.8238398511356993`*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"7a389b76-cb08-43ea-8403-cbda62c14015"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{
    TagBox[
     TemplateBox[{
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"]]], 
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"]]], 
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
   "Ket"], "+", 
  TemplateBox[{
    TagBox[
     TemplateBox[{
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"]]], 
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"]]], 
       SubscriptBox["1", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
   "Ket"], "+", 
  TemplateBox[{
    TagBox[
     TemplateBox[{
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"]]], 
       SubscriptBox["1", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"]]], 
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
   "Ket"], "+", 
  TemplateBox[{
    TagBox[
     TemplateBox[{
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"]]], 
       SubscriptBox["1", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"]]], 
       SubscriptBox["1", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
   "Ket"], "+", 
  TemplateBox[{
    TagBox[
     TemplateBox[{
       SubscriptBox["1", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"]]], 
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"]]], 
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
   "Ket"], "+", 
  TemplateBox[{
    TagBox[
     TemplateBox[{
       SubscriptBox["1", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"]]], 
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"]]], 
       SubscriptBox["1", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
   "Ket"], "+", 
  TemplateBox[{
    TagBox[
     TemplateBox[{
       SubscriptBox["1", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"]]], 
       SubscriptBox["1", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"]]], 
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
   "Ket"], "+", 
  TemplateBox[{
    TagBox[
     TemplateBox[{
       SubscriptBox["1", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"]]], 
       SubscriptBox["1", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"]]], 
       SubscriptBox["1", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
   "Ket"]}]], "Output",
 CellChangeTimes->{
  3.818622245816828*^9, {3.818622276843924*^9, 3.8186223370244493`*^9}, 
   3.818623033645576*^9, 3.818623165599573*^9, 3.818647947609105*^9, 
   3.8188353293069572`*^9, 3.8198046226503687`*^9, 3.8228059615076523`*^9, {
   3.823839697629305*^9, 3.8238397155846567`*^9}, 3.823839768153839*^9, 
   3.823839816089711*^9, 3.8238398700298243`*^9, 3.82632660079144*^9, 
   3.826329716228609*^9, 3.826333659085726*^9},
 CellLabel->
  "Out[136]=",ExpressionUUID->"eb8931e5-9402-4922-81ea-fe42642e93e4"]
}, Open  ]],

Cell["\<\
On other elements of the logical basis, the sign of each term is determined \
by the bitwise dot product of the its bit-string with that of the input state.\
\>", "Text",
 CellChangeTimes->{{3.818647775358218*^9, 3.818647932196763*^9}, {
  3.818648171920697*^9, 
  3.818648185733927*^9}},ExpressionUUID->"a34cdfc0-2df5-4237-8347-\
c3e10dab4246"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Ket", "[", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"in", "=", 
  RowBox[{"LogicalForm", "[", 
   RowBox[{"in", ",", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8186479509750853`*^9, 3.818648017512011*^9}, 
   3.823839885715028*^9},
 CellLabel->
  "In[137]:=",ExpressionUUID->"d2b5a4e7-ed69-4ff9-8110-c7150d0a5e80"],

Cell[BoxData[
 TemplateBox[{
   TagBox[
    TemplateBox[{
      SubscriptBox["1", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"]]], 
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"]]], 
      SubscriptBox["1", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
  "Ket"]], "Output",
 CellChangeTimes->{{3.823839887116048*^9, 3.823839903383971*^9}, 
   3.8263266030618477`*^9, 3.826329716241003*^9, 3.826333659099058*^9},
 CellLabel->
  "Out[138]=",ExpressionUUID->"1422b311-30b9-4672-abc6-69611abd6348"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"ReleaseHold", "[", "op", "]"}], "**", "in"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.8186479509750853`*^9, 3.818648017512011*^9}, 
   3.823839885715028*^9},
 CellLabel->
  "In[139]:=",ExpressionUUID->"18d52081-3866-4c2d-90be-9779731acb86"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellChangeTimes->{{3.818647977378962*^9, 3.8186480179753923`*^9}, 
   3.8188353309893713`*^9, 3.819804625138587*^9, 3.822805962974943*^9, {
   3.823839888428165*^9, 3.823839904230537*^9}, 3.826326604053279*^9, 
   3.8263297162749166`*^9, 3.8263336591308727`*^9},
 CellLabel->
  "Out[140]=",ExpressionUUID->"c056a5de-73c3-4b3c-a25e-7df1e06b6a5d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rotations", "Subsection",
 CellChangeTimes->{{3.818624660855891*^9, 
  3.818624661788609*^9}},ExpressionUUID->"d1571d4d-c4a1-4cad-a4dc-\
a2013736de46"],

Cell[CellGroupData[{

Cell["\<\
The Pauli operators are generators of the rotational transformations in a \
two-dimensional complex vector space, and hence satisfy the fundamental \
commutation relations of angular momentum operators (up to a normalization \
factor).\
\>", "MathCaption",
 CellChangeTimes->{{3.825713761461204*^9, 3.825713864283833*^9}, {
  3.82571394216571*^9, 
  3.8257139524590597`*^9}},ExpressionUUID->"f2f24e04-9fdb-403f-add0-\
d8e929804caa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"S", "[", "All", "]"}]}]], "Input",
 CellChangeTimes->{{3.825713886348961*^9, 3.825713892486732*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"2a54fb18-00e8-4bf7-a7da-686ca3965443"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Superscript"], ",", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Superscript"], ",", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Superscript"]}], "}"}]], "Output",
 CellChangeTimes->{3.8257138927575617`*^9, 3.82632660609004*^9, 
  3.826329716287725*^9, 3.826333659144226*^9},
 CellLabel->
  "Out[141]=",ExpressionUUID->"301b3378-f932-44ef-a7f8-162ed9398af7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Outer", "[", 
    RowBox[{
     RowBox[{"HoldForm", "@*", "Commutator"}], ",", "op", ",", "op"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"ReleaseHold", "[", "in", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", "in", "]"}], "\[Rule]", 
    RowBox[{"Flatten", "[", "out", "]"}]}], "]"}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.8257140410316477`*^9, 3.825714155246338*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"3cd06a72-4ad6-4c15-82bf-a8c4a29647f5"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       TagBox[
        RowBox[{"Commutator", "[", 
         RowBox[{
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"\"x\""}, "RowDefault"]},
           "Superscript"], ",", 
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"\"x\""}, "RowDefault"]},
           "Superscript"]}], "]"}],
        HoldForm], "\[Rule]", "0"}]},
     {
      RowBox[{
       TagBox[
        RowBox[{"Commutator", "[", 
         RowBox[{
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"\"x\""}, "RowDefault"]},
           "Superscript"], ",", 
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"\"y\""}, "RowDefault"]},
           "Superscript"]}], "]"}],
        HoldForm], "\[Rule]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"\"z\""}, "RowDefault"]},
         "Superscript"]}]}]},
     {
      RowBox[{
       TagBox[
        RowBox[{"Commutator", "[", 
         RowBox[{
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"\"x\""}, "RowDefault"]},
           "Superscript"], ",", 
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Superscript"]}], "]"}],
        HoldForm], "\[Rule]", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"\"y\""}, "RowDefault"]},
         "Superscript"]}]}]},
     {
      RowBox[{
       TagBox[
        RowBox[{"Commutator", "[", 
         RowBox[{
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"\"y\""}, "RowDefault"]},
           "Superscript"], ",", 
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"\"x\""}, "RowDefault"]},
           "Superscript"]}], "]"}],
        HoldForm], "\[Rule]", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"\"z\""}, "RowDefault"]},
         "Superscript"]}]}]},
     {
      RowBox[{
       TagBox[
        RowBox[{"Commutator", "[", 
         RowBox[{
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"\"y\""}, "RowDefault"]},
           "Superscript"], ",", 
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"\"y\""}, "RowDefault"]},
           "Superscript"]}], "]"}],
        HoldForm], "\[Rule]", "0"}]},
     {
      RowBox[{
       TagBox[
        RowBox[{"Commutator", "[", 
         RowBox[{
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"\"y\""}, "RowDefault"]},
           "Superscript"], ",", 
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Superscript"]}], "]"}],
        HoldForm], "\[Rule]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Superscript"]}]}]},
     {
      RowBox[{
       TagBox[
        RowBox[{"Commutator", "[", 
         RowBox[{
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Superscript"], ",", 
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"\"x\""}, "RowDefault"]},
           "Superscript"]}], "]"}],
        HoldForm], "\[Rule]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"\"y\""}, "RowDefault"]},
         "Superscript"]}]}]},
     {
      RowBox[{
       TagBox[
        RowBox[{"Commutator", "[", 
         RowBox[{
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Superscript"], ",", 
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"\"y\""}, "RowDefault"]},
           "Superscript"]}], "]"}],
        HoldForm], "\[Rule]", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Superscript"]}]}]},
     {
      RowBox[{
       TagBox[
        RowBox[{"Commutator", "[", 
         RowBox[{
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Superscript"], ",", 
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Superscript"]}], "]"}],
        HoldForm], "\[Rule]", "0"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8257141288598537`*^9, 3.825714155480908*^9}, 
   3.826326607551297*^9, 3.826329716320489*^9, 3.8263336591769047`*^9},
 CellLabel->
  "Out[144]//TableForm=",ExpressionUUID->"774cabac-83e9-4c56-b743-\
427faa8ef8fb"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Consider a unitary operator represented by the following matrix.\
\>", "MathCaption",
 CellChangeTimes->{{3.825734679286174*^9, 
  3.825734715768078*^9}},ExpressionUUID->"f2a37467-9d73-47e9-90b1-\
c57fcb5994a3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"3", "-", 
         RowBox[{"I", " ", 
          RowBox[{"Sqrt", "[", "3", "]"}]}]}], ",", 
        RowBox[{"I", "-", 
         RowBox[{"Sqrt", "[", "3", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"I", "+", 
         RowBox[{"Sqrt", "[", "3", "]"}]}], ",", 
        RowBox[{"3", "+", 
         RowBox[{"I", " ", 
          RowBox[{"Sqrt", "[", "3", "]"}]}]}]}], "}"}]}], 
     "\[IndentingNewLine]", "}"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.825734718447136*^9, 3.825734762666945*^9}},
 CellLabel->
  "In[145]:=",ExpressionUUID->"686ac139-226e-4657-ae10-f3f6c796d108"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"3", "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          SqrtBox["3"]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", "-", 
         SqrtBox["3"]}], ")"}]}]},
     {
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", "+", 
         SqrtBox["3"]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SqrtBox["3"]}]}], ")"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.825734762923908*^9, 3.825734765237566*^9}, 
   3.826326610168688*^9, 3.826329716329056*^9, 3.8263336591867113`*^9},
 CellLabel->
  "Out[146]//MatrixForm=",ExpressionUUID->"89fa6adf-3696-421f-8058-\
8570c1286c6e"]
}, Open  ]],

Cell["This gives its expression in terms of the Pauli operators.", "Text",
 CellChangeTimes->{{3.825734790633033*^9, 
  3.825734858287446*^9}},ExpressionUUID->"3397093a-8d5c-400b-9b10-\
8e804271c37d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"QuissoExpression", "[", 
   RowBox[{"mat", ",", "S"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8257346096890793`*^9, 3.825734620609044*^9}, {
  3.825734780677945*^9, 3.82573481306184*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"93fb0ed6-df89-44fe-9cd5-ba48c57fc637"],

Cell[BoxData[
 RowBox[{
  FractionBox["3", "4"], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Superscript"]}], "4"], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   SqrtBox["3"], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Superscript"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   SqrtBox["3"], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Superscript"]}]}]], "Output",
 CellChangeTimes->{{3.82573461577647*^9, 3.825734620943535*^9}, {
   3.8257346510002203`*^9, 3.825734653216618*^9}, {3.825734781334725*^9, 
   3.825734813917458*^9}, 3.825734859573662*^9, 3.8263266119823017`*^9, 
   3.8263297163615627`*^9, 3.826333659217198*^9},
 CellLabel->
  "Out[147]=",ExpressionUUID->"c6442233-d049-4753-9302-a09e1264ffde"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Dagger", "[", "op", "]"}], "**", "op"}]], "Input",
 CellChangeTimes->{{3.8257348628780622`*^9, 3.825734866060289*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"66189222-96c7-43f8-83cf-2e8644a271b4"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.8257348663945837`*^9, 3.825734869303069*^9}, 
   3.8263266128758993`*^9, 3.826329716404234*^9, 3.82633365922854*^9},
 CellLabel->
  "Out[148]=",ExpressionUUID->"57463000-e4a2-4099-98df-1355443cb71e"]
}, Open  ]],

Cell["This gives the Euler angles of the unitary operator.", "Text",
 CellChangeTimes->{{3.825734901114027*^9, 
  3.82573491303852*^9}},ExpressionUUID->"c3344c8f-0bc2-44ed-b283-\
7bdcd12725d6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"angs", "=", 
  RowBox[{"TheEulerAngles", "[", "mat", "]"}]}]], "Input",
 CellChangeTimes->{{3.825734877234844*^9, 3.8257348987177753`*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"320d0567-bffb-4dbe-872d-654258002135"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["\[Pi]", "3"], ",", 
   FractionBox["\[Pi]", "3"], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.825734885577304*^9, 3.825734914448155*^9}, 
   3.826326614300914*^9, 3.8263297164393597`*^9, 3.826333659258875*^9},
 CellLabel->
  "Out[149]=",ExpressionUUID->"894bfa36-0cfb-4675-ba99-9b5d3ee3144f"]
}, Open  ]],

Cell["\<\
Indeed, the Euler angles reproduces the original unitary operator.\
\>", "Text",
 CellChangeTimes->{{3.825734951938533*^9, 
  3.825734972097846*^9}},ExpressionUUID->"6acacd65-c3d7-45d4-9030-\
ea5863a1d74d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"new", "=", 
  RowBox[{"QuissoEulerRotation", "[", 
   RowBox[{"angs", ",", "S"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"op", "-", "new"}]}], "Input",
 CellChangeTimes->{{3.825734916090334*^9, 3.825734946832988*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"f47f8d9d-3a73-418b-92af-38f97d7863c8"],

Cell[BoxData[
 RowBox[{
  FractionBox["3", "4"], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Superscript"]}], "4"], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   SqrtBox["3"], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Superscript"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   SqrtBox["3"], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Superscript"]}]}]], "Output",
 CellChangeTimes->{{3.8257349319054117`*^9, 3.825734973532976*^9}, 
   3.826326615803391*^9, 3.826329716446755*^9, 3.826333659266356*^9},
 CellLabel->
  "Out[150]=",ExpressionUUID->"a7f127f1-c864-4632-87ed-881262735422"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.8257349319054117`*^9, 3.825734973532976*^9}, 
   3.826326615803391*^9, 3.826329716446755*^9, 3.826333659269126*^9},
 CellLabel->
  "Out[151]=",ExpressionUUID->"5e606644-7dfe-4c15-b7b2-3818fa2bc893"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Two-Qubit Gates", "Section",
 CellChangeTimes->{{3.8186213588211613`*^9, 
  3.818621361667145*^9}},ExpressionUUID->"52604d20-1bc2-4b0a-a56e-\
66832804d763"],

Cell[CellGroupData[{

Cell["CNOT", "Subsection",
 CellChangeTimes->{{3.819078286654201*^9, 
  3.819078287305963*^9}},ExpressionUUID->"060db050-bf84-4b69-89bd-\
fb8b4802acc1"],

Cell[CellGroupData[{

Cell[TextData[{
 "CNOT[",
 StyleBox["control",
  FontSlant->"Italic"],
 ",",
 StyleBox[" target",
  FontSlant->"Italic"],
 "] denotes the CNOT gate in the quantum circuit model."
}], "MathCaption",
 CellChangeTimes->{{3.818622671791256*^9, 3.818622680036644*^9}, {
  3.818626548435519*^9, 3.8186265859538183`*^9}, {3.819942906901557*^9, 
  3.819942917330882*^9}, {3.824366463400527*^9, 
  3.82436648167868*^9}},ExpressionUUID->"3713a507-5340-45ca-a49e-\
2aaf835335d4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"CNOT", "[", 
   RowBox[{
    RowBox[{"S", "[", "1", "]"}], ",", 
    RowBox[{"S", "[", "2", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.818622689751131*^9, 3.8186226942701607`*^9}},
 CellLabel->
  "In[152]:=",ExpressionUUID->"73061649-43ed-4520-b6b7-d009d4ccbf88"],

Cell[BoxData[
 RowBox[{"CNOT", "[", 
  RowBox[{
   RowBox[{"{", 
    SubscriptBox[
     TemplateBox[{"S"},
      "RowDefault"], 
     TemplateBox[{"1"},
      "RowDefault"]], "}"}], ",", 
   RowBox[{"{", 
    SubscriptBox[
     TemplateBox[{"S"},
      "RowDefault"], 
     TemplateBox[{"2"},
      "RowDefault"]], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.818622694615285*^9, 3.818626453003921*^9, 
  3.818835334367969*^9, 3.8190783589214354`*^9, 3.819078411395906*^9, 
  3.8198046294360037`*^9, 3.822805966149784*^9, 3.82574215339258*^9, 
  3.826326618008523*^9, 3.826329716484005*^9, 3.826330854344953*^9, 
  3.826333659303748*^9},
 CellLabel->
  "Out[152]=",ExpressionUUID->"a0f42943-25b3-415e-a25d-c6840e65063c"]
}, Open  ]],

Cell["This displays the quantum circuit model of the CNOT gate.", "Text",
 CellChangeTimes->{{3.8243664886652193`*^9, 
  3.824366508294939*^9}},ExpressionUUID->"57dd86fe-cc77-4720-923f-\
bc98a2758b6d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuissoCircuit", "[", "op", "]"}]}]], "Input",
 CellChangeTimes->{{3.818622707594385*^9, 3.8186227247915287`*^9}, {
   3.818626446086946*^9, 3.8186264466809063`*^9}, {3.825742177412016*^9, 
   3.82574217787372*^9}, 3.826326624200954*^9},
 CellLabel->
  "In[153]:=",ExpressionUUID->"edccf931-013e-4e31-8d39-49d787084bd2"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
    LineBox[{{1, -1}, {1, -2}}], 
    DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
        1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8]], "Output",
 CellChangeTimes->{{3.8186227128444767`*^9, 3.8186227250838823`*^9}, {
   3.818626446944561*^9, 3.818626453619961*^9}, 3.81883533513256*^9, 
   3.819078412312392*^9, 3.8198046301993017`*^9, 3.822805967373239*^9, {
   3.825742154654841*^9, 3.825742178362797*^9}, 3.82632662463455*^9, 
   3.826329716492647*^9, 3.826330855668758*^9, 3.826333659311335*^9},
 CellLabel->
  "Out[153]=",ExpressionUUID->"32039142-ab37-4c3f-a326-adfa5e2aeaa0"]
}, Open  ]],

Cell["\<\
This is the explicit expression of the CNOT gate in terms of the Pauli \
operators.\
\>", "Text",
 CellChangeTimes->{{3.8257421952308893`*^9, 
  3.825742220215493*^9}},ExpressionUUID->"15672d67-45c3-4138-a721-\
87abf506e789"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"QuissoExpression", "[", "qc", "]"}]}]], "Input",
 CellChangeTimes->{{3.8257422228723707`*^9, 3.825742229575902*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"7c1e3e3f-1e75-4912-a7b9-7d54836007ed"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], "2"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], "2"]}]], "Output",
 CellChangeTimes->{{3.8257422299589243`*^9, 3.8257422314229803`*^9}, 
   3.826326626495455*^9, 3.826329716525732*^9, 3.826333659347484*^9},
 CellLabel->
  "Out[154]=",ExpressionUUID->"76aa3f1b-da92-4e16-8ec2-b29d45506b11"]
}, Open  ]],

Cell["\<\
This is the matrix representation of the CNOT gate in the logical basis.\
\>", "Text",
 CellChangeTimes->{{3.82574271299806*^9, 
  3.825742726765843*^9}},ExpressionUUID->"62136129-a8d2-4072-b6da-\
5df546df68f9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", "op", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.8257427317505293`*^9, 3.825742736238144*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"675cc0f9-bbcc-419e-880f-85ae0c71c10c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "0", "1"},
     {"0", "0", "1", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {2}, {2}, {1}, {3}, {4}, {4}, {3}}}, {1, 0, 1,
       0, 0, 1, 0, 1}}]]]]], "Output",
 CellChangeTimes->{{3.825742736467511*^9, 3.825742738768428*^9}, 
   3.8263266284358892`*^9, 3.8263297165327787`*^9, 3.8263336593551483`*^9},
 CellLabel->
  "Out[155]//MatrixForm=",ExpressionUUID->"c045ea40-7d91-4fb5-a9eb-\
c8a64e1b1dac"]
}, Open  ]],

Cell["\<\
This shows how the CNOT gate operates on the logical basis states.\
\>", "Text",
 CellChangeTimes->{{3.8257423088726807`*^9, 
  3.825742326297838*^9}},ExpressionUUID->"2f65ec29-3c79-44cc-bfaf-\
6d817b74308b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"in", "\[Rule]", "out"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.825742155670525*^9, 3.825742167759344*^9}, {
  3.825742279827004*^9, 3.825742304035431*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"5237c434-daa6-46f9-9caa-808e7c7ed4fc"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8257421622159653`*^9, 3.825742168030895*^9}, {
   3.825742272751733*^9, 3.8257423276689577`*^9}, 3.8257427399647503`*^9, 
   3.8263266297999907`*^9, 3.826329716565145*^9, 3.826333659392221*^9},
 CellLabel->
  "Out[158]//TableForm=",ExpressionUUID->"67b3e927-e60a-454d-b665-\
8c734b3db85e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
As an example of the application of the CNOT gate, this shows an entangler \
quantum circuit.\
\>", "MathCaption",
 CellChangeTimes->{{3.824366515730639*^9, 3.824366564621441*^9}, {
  3.82574277191061*^9, 
  3.825742773867064*^9}},ExpressionUUID->"19d7f2f6-e732-4008-add4-\
435ef192f7c9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"entangler", "=", 
  RowBox[{"QuissoCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8190784198223267`*^9, 3.819078447618651*^9}, {
   3.8190785002018003`*^9, 3.819078503171278*^9}, {3.819080152835722*^9, 
   3.819080173636093*^9}, 3.8263266376546507`*^9},
 CellLabel->
  "In[159]:=",ExpressionUUID->"25ac0706-c91a-476b-b4f8-d066587c6aeb"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`]], "Output",
 CellChangeTimes->{{3.819078443211891*^9, 3.819078447885042*^9}, 
   3.8190785222923117`*^9, {3.8190801561547623`*^9, 3.8190801740961657`*^9}, 
   3.819804631120545*^9, 3.8228059683882008`*^9, 3.824366678371805*^9, 
   3.825742778293648*^9, 3.82632663806441*^9, 3.826329716613097*^9, 
   3.8263308603267937`*^9, 3.826333659404598*^9},
 CellLabel->
  "Out[159]=",ExpressionUUID->"aef702e0-c962-4a3e-911b-8d8db77b190e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
This demonstrates the generation of an entangled state from a product state.\
\>", "MathCaption",
 CellChangeTimes->{{3.824366578672946*^9, 
  3.8243666140852957`*^9}},ExpressionUUID->"2e13d3e5-2de8-4d2a-8564-\
202c87ea586b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"new", "=", 
  RowBox[{"QuissoCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{
        RowBox[{"S", "@", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], ",", "entangler"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{"QuissoExpression", "[", "new", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"vec", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.819078481844549*^9, 3.81907854459369*^9}, {
  3.819078575284071*^9, 3.819078630127453*^9}, {3.819078667838171*^9, 
  3.8190786729450407`*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"b80b94c1-159c-4adb-9084-6329740a96ef"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.10666666666666667`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.10666666666666667`],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`]], "Output",
 CellChangeTimes->{{3.819078527129939*^9, 3.81907853023879*^9}, 
   3.8190785813042307`*^9, {3.8190786304391623`*^9, 3.819078637048346*^9}, 
   3.8190786737760468`*^9, 3.819804632481044*^9, 3.822805969301094*^9, 
   3.8243666796037827`*^9, 3.826326641429674*^9, 3.8263297166209517`*^9, 
   3.826330862489051*^9, 3.826333659439912*^9},
 CellLabel->
  "Out[160]=",ExpressionUUID->"a597af6b-1a8e-4320-83b6-e32fe710c8e1"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   SqrtBox["2"]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   SqrtBox["2"]]}]], "Output",
 CellChangeTimes->{{3.819078527129939*^9, 3.81907853023879*^9}, 
   3.8190785813042307`*^9, {3.8190786304391623`*^9, 3.819078637048346*^9}, 
   3.8190786737760468`*^9, 3.819804632481044*^9, 3.822805969301094*^9, 
   3.8243666796037827`*^9, 3.826326641429674*^9, 3.8263297166209517`*^9, 
   3.826330862489051*^9, 3.826333659444149*^9},
 CellLabel->
  "Out[162]=",ExpressionUUID->"2d1d6462-f075-495e-ac02-4e3f52730f11"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
This lists the mapping between the standard tensor-product basis states and \
the Bell states.\
\>", "MathCaption",
 CellChangeTimes->{{3.8243666391720257`*^9, 
  3.824366671097584*^9}},ExpressionUUID->"3d142bbd-6d0a-42be-92a0-\
5d822e70e255"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"Basis", "@", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"QuissoExpression", "[", "entangler", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "bs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"table", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"bs", "\[Rule]", "out"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"table", "//", "LogicalForm"}], "//", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.81907873699475*^9, 3.819078813142408*^9}, 
   3.819080150115711*^9, {3.8190801833335323`*^9, 3.819080184255352*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"0147afec-6f57-4ae9-873a-2960749d7463"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       RowBox[{
        FractionBox[
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], 
         SqrtBox["2"]], "+", 
        FractionBox[
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], 
         SqrtBox["2"]]}]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       RowBox[{
        FractionBox[
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], 
         SqrtBox["2"]], "+", 
        FractionBox[
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], 
         SqrtBox["2"]]}]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       RowBox[{
        FractionBox[
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], 
         SqrtBox["2"]], "-", 
        FractionBox[
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], 
         SqrtBox["2"]]}]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       RowBox[{
        FractionBox[
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], 
         SqrtBox["2"]], "-", 
        FractionBox[
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], 
         SqrtBox["2"]]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8190787618092957`*^9, 3.8190788153771353`*^9}, 
   3.8190801857497883`*^9, 3.8198046342385263`*^9, 3.82280597247996*^9, {
   3.824366673742155*^9, 3.824366681256322*^9}, 3.8263266442759438`*^9, 
   3.826329716686925*^9, 3.82633365958442*^9},
 CellLabel->
  "Out[167]//TableForm=",ExpressionUUID->"fdb2c424-efd1-4dfc-bd64-\
4eaaa95dca63"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Solution",
  FontWeight->"Bold"],
 ": To generate a maximally entangled state between two two-qubit registers."
}], "MathCaption",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.8194465988122997`*^9, 3.8194466504802856`*^9}, {
  3.8199481804746723`*^9, 
  3.819948181294593*^9}},ExpressionUUID->"99da444a-e79b-4f22-b4cf-\
69f285e8ab90"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuissoCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", "6"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "4", "]"}]}], "]"}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "0"}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"36", ",", "36"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "5"}], "}"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.819446823925454*^9, 3.8194468674925547`*^9}, 
   3.819447084774691*^9, {3.819447780725461*^9, 3.819447818829324*^9}, {
   3.8194478836830797`*^9, 3.819447892120175*^9}, {3.823840890647049*^9, 
   3.823840896597485*^9}, {3.826326650670429*^9, 3.826326651300371*^9}, {
   3.8263310044435*^9, 3.8263311212110453`*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"162b2b9b-998c-482b-a43c-a108917fe950"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
    0, -4}, {4, -4}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -4}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -3}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
        2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
    LineBox[{{3, -2}, {3, -4}}], 
    DiskBox[{3, -2}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
        3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{36, 36}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->0]], "Output",
 CellChangeTimes->{
  3.8263308919416*^9, {3.8263310099165373`*^9, 3.8263311215775642`*^9}, 
   3.826333659630981*^9},
 CellLabel->
  "Out[168]=",ExpressionUUID->"060bd225-2cbe-4b3c-a56a-959a7b6c80e0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuissoCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", "6"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "4", "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.819446823925454*^9, 3.8194468674925547`*^9}, 
   3.819447084774691*^9, {3.819447780725461*^9, 3.819447818829324*^9}, {
   3.8194478836830797`*^9, 3.819447892120175*^9}, {3.823840890647049*^9, 
   3.823840896597485*^9}, {3.826326650670429*^9, 3.826326651300371*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"8805d7ed-5906-4eb1-95d9-0ced1e7aa7c4"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
    0, -4}, {4, -4}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -4}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -3}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
        2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
    LineBox[{{3, -2}, {3, -4}}], 
    DiskBox[{3, -2}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
        3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`]], "Output",
 CellChangeTimes->{{3.8194468473117027`*^9, 3.819446867830964*^9}, 
   3.8194469754104643`*^9, {3.819447081096168*^9, 3.81944708509846*^9}, {
   3.8194477965764313`*^9, 3.819447821588307*^9}, 3.819804635881443*^9, 
   3.822805973950333*^9, 3.8238408989468193`*^9, 3.826326651747201*^9, 
   3.826329716728661*^9, 3.826333659643862*^9},
 CellLabel->
  "Out[169]=",ExpressionUUID->"9e256da8-8dad-48c0-97ba-36b2e8dcccf3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"QuissoExpression", "[", "qc", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.8194468712183027`*^9, 3.819446884996311*^9}, 
   3.819447087114505*^9},
 CellLabel->
  "In[170]:=",ExpressionUUID->"49801697-7284-448d-9a55-8d7062c506fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{{3.8194468776220713`*^9, 3.819446885275675*^9}, {
   3.819446976530141*^9, 3.819446979350876*^9}, 3.819447087467074*^9, 
   3.8194478222798033`*^9, 3.819804638239019*^9, 3.8228059757978992`*^9, 
   3.8238409017846613`*^9, 3.826326654544339*^9, 3.8263297167649603`*^9, 
   3.826333659675812*^9},
 CellLabel->
  "Out[171]=",ExpressionUUID->"d9857f91-c0b5-41dd-8217-25d63cbaad1b"]
}, Open  ]],

Cell["\<\
This example illustrate that the entanglement depends on the partition of the \
system. Indeed, the above system is a product state for the partition (1,3) \
and (2,4) qubits.\
\>", "Text",
 CellChangeTimes->{{3.8194471191522627`*^9, 
  3.819447189494157*^9}},ExpressionUUID->"ca1a3d64-8ee3-4f65-86cc-\
d69c6037c98a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuissoFactor", "[", "out", "]"}]], "Input",
 CellChangeTimes->{{3.819447192659738*^9, 3.8194471976503077`*^9}},
 CellLabel->
  "In[172]:=",ExpressionUUID->"9e8ead7d-ff3b-4592-af30-b98845f5770b"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], "+", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}],
     HoldForm], ")"}], "\[CircleTimes]", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]], 
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], "+", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]], 
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}],
     HoldForm], ")"}]}]}]], "Output",
 CellChangeTimes->{3.819447197940336*^9, 3.819447825487113*^9, 
  3.8198046396595078`*^9, 3.8228059772250147`*^9, 3.823840904424131*^9, 
  3.8263266565519753`*^9, 3.826329716776085*^9, 3.826333659717217*^9},
 CellLabel->
  "Out[172]=",ExpressionUUID->"c897dcdf-6c8c-4a62-b37c-8c7b80808106"]
}, Open  ]],

Cell[TextData[{
 "The above construction can be generalized for a pair of ",
 StyleBox["n",
  FontSlant->"Italic"],
 "-qubit systems."
}], "Text",
 CellChangeTimes->{{3.825743800986895*^9, 
  3.825743831991061*^9}},ExpressionUUID->"beedc2b8-0af7-48f7-934d-\
148ce1092bc4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuissoCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"Range", "[", 
        RowBox[{"2", "n"}], "]"}]}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"Range", "[", "n", "]"}], ",", "6"}], "]"}], ",", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"CNOT", "[", 
        RowBox[{
         RowBox[{"S", "[", "j", "]"}], ",", 
         RowBox[{"S", "[", 
          RowBox[{"n", "+", "j"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.819446823925454*^9, 3.8194468674925547`*^9}, 
   3.819447084774691*^9, {3.819447780725461*^9, 3.819447818829324*^9}, {
   3.8194478836830797`*^9, 3.819447892120175*^9}, {3.823840890647049*^9, 
   3.823840896597485*^9}, {3.825743846964202*^9, 3.825743896395183*^9}, {
   3.825743942174016*^9, 3.82574401241059*^9}, {3.825744267593985*^9, 
   3.8257442729470463`*^9}, 3.826326663112199*^9},
 CellLabel->
  "In[173]:=",ExpressionUUID->"93d13f21-efdf-46ea-ae94-857a21d2ffcc"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {5, -3}}, {{
    0, -4}, {5, -4}}, {{0, -5}, {5, -5}}, {{0, -6}, {5, -6}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -5}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -6}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -4}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -4}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -4}, {2.2666666666666666`, -4}}, {{
        2, -4.266666666666667}, {2, -3.7333333333333334`}}}]}}, {
    LineBox[{{3, -2}, {3, -5}}], 
    DiskBox[{3, -2}, 0.09], {CircleBox[{3, -5}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -5}, {3.2666666666666666`, -5}}, {{
        3, -5.266666666666667}, {3, -4.733333333333333}}}]}}, {
    LineBox[{{4, -3}, {4, -6}}], 
    DiskBox[{4, -3}, 0.09], {CircleBox[{4, -6}, 0.26666666666666666], 
     LineBox[{{{3.7333333333333334`, -6}, {4.266666666666667, -6}}, {{
        4, -6.266666666666667}, {4, -5.733333333333333}}}]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->226.79999999999998`]], "Output",
 CellChangeTimes->{{3.825743997624267*^9, 3.8257440153173513`*^9}, 
   3.8257442732415533`*^9, {3.826326657717353*^9, 3.826326663710225*^9}, 
   3.826329716819635*^9, 3.826333659758491*^9},
 CellLabel->
  "Out[174]=",ExpressionUUID->"9f64da29-0ea9-4814-923b-fad6b9e62e2a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"QuissoExpression", "[", "qc", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.82574402963694*^9, 3.8257440426939087`*^9}},
 CellLabel->
  "In[175]:=",ExpressionUUID->"b263c9c4-e604-4a79-8d6e-437d1139f391"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellChangeTimes->{3.8257440430211163`*^9, 3.8257442759320717`*^9, 
  3.8263266659269323`*^9, 3.826329716896146*^9, 3.82633365983525*^9},
 CellLabel->
  "Out[176]=",ExpressionUUID->"1ee68ae0-8acc-4fe7-80be-d2730bcdd8c4"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Controlled-U Gates", "Subsection",
 CellChangeTimes->{{3.819078292334853*^9, 
  3.819078296744832*^9}},ExpressionUUID->"0535d62f-2fad-4b5c-bc74-\
f09ef33f3aa7"],

Cell[CellGroupData[{

Cell[TextData[{
 "Consider a single-qubit rotation acting on the qubit ",
 StyleBox["S[2,None]", "Input"],
 ". It is a rotation around the y-axis by angle \[Phi]."
}], "MathCaption",
 CellChangeTimes->{{3.82574466152496*^9, 3.825744693529607*^9}, {
  3.825744807385701*^9, 
  3.825744820738614*^9}},ExpressionUUID->"ed065515-4cdf-4145-841b-\
4599eca48efe"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Phi]", ",", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "2"}], "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"U", "//", "Elaborate"}], "//", "Matrix"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.825744710403491*^9, 3.8257447130143557`*^9}, {
  3.825744743623795*^9, 3.825744768508255*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"f2d04065-a079-42c4-8e45-c96527d55c67"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        FractionBox["\[Phi]", "2"], "]"}]}]},
     {
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}], 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {2}, {1}}}, {
      Cos[Rational[1, 2] $CellContext`\[Phi]], -
       Sin[Rational[1, 2] $CellContext`\[Phi]], Cos[
       Rational[1, 2] $CellContext`\[Phi]], Sin[
       Rational[1, 2] $CellContext`\[Phi]]}}]]]]], "Output",
 CellChangeTimes->{{3.825744724828266*^9, 3.825744773186768*^9}, {
   3.825744822369238*^9, 3.825744826002254*^9}, 3.8257449670616903`*^9, 
   3.826326668383418*^9, 3.826329716913817*^9, 3.8263336598541307`*^9},
 CellLabel->
  "Out[178]//MatrixForm=",ExpressionUUID->"24029c7e-ddbb-4a10-8a4e-\
e4b2dfc897c2"]
}, Open  ]],

Cell["This shows the controlled-U gate.", "Text",
 CellChangeTimes->{{3.819685711167118*^9, 3.819685732934691*^9}, {
  3.82574523871229*^9, 
  3.825745246585534*^9}},ExpressionUUID->"31bdb47d-0746-4087-a416-\
776c5028e602"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuissoCircuit", "[", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", "U"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.819685742858782*^9, 3.819685848589415*^9}, {
   3.8238409178713093`*^9, 3.8238409209415903`*^9}, {3.825744704893298*^9, 
   3.8257447306989937`*^9}, 3.826326676488312*^9},
 CellLabel->
  "In[179]:=",ExpressionUUID->"618f59e3-3c1a-4b9b-b7d9-ad0eedfd9fbf"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
    LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.2],
      FontWeight->"Light",
      FontSlant->Italic], {1, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8]], "Output",
 CellChangeTimes->{
  3.825744731642995*^9, {3.8257448274859447`*^9, 3.825744849404435*^9}, 
   3.8257449689751587`*^9, 3.825745250303031*^9, {3.826326670548538*^9, 
   3.826326676906917*^9}, 3.826329716945243*^9, 3.8263336598862658`*^9},
 CellLabel->
  "Out[179]=",ExpressionUUID->"6412bc59-75c4-45f9-8638-761f0684200a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"QuissoExpression", "[", "qc", "]"}]}]], "Input",
 CellChangeTimes->{{3.819685742858782*^9, 3.819685848589415*^9}, {
  3.8238409178713093`*^9, 3.8238409209415903`*^9}, {3.825744704893298*^9, 
  3.8257447306989937`*^9}},
 CellLabel->
  "In[180]:=",ExpressionUUID->"660d6695-82f7-4a57-bb33-05d6e30434e2"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"Cos", "[", 
    FractionBox["\[Phi]", "4"], "]"}], "2"], "+", 
  RowBox[{
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Phi]", "4"], "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.819685794673809*^9, 3.819685850174438*^9}, 
   3.8198046412440233`*^9, 3.8228059787977*^9, 3.823840921769371*^9, {
   3.825744727076703*^9, 3.825744735597048*^9}, {3.825744828526429*^9, 
   3.825744850083908*^9}, {3.8257449698051777`*^9, 3.825744971988696*^9}, 
   3.8263266783474092`*^9, 3.826329716955696*^9, 3.826333659915946*^9},
 CellLabel->
  "Out[180]=",ExpressionUUID->"30b98ff7-4dd5-43c2-a44b-876f648e18c6"]
}, Open  ]],

Cell[TextData[{
 "When the first qubit is set to ",
 StyleBox["Ket[0]", "Input"],
 ", it does nothing."
}], "Text",
 CellChangeTimes->{{3.819686288621647*^9, 
  3.819686303436763*^9}},ExpressionUUID->"187be339-214b-4b10-a40f-\
396c310d8b6a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Ket", "[", "]"}], 
     RowBox[{"c", "[", "0", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{
       RowBox[{"S", "[", "2", "]"}], "\[Rule]", "1"}], "]"}], 
     RowBox[{"c", "[", "2", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"vec", ",", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.819686169064335*^9, 3.819686233701758*^9}, {
   3.819686265100257*^9, 3.819686278991638*^9}, {3.8196863713723927`*^9, 
   3.819686372114259*^9}, 3.8238409433970222`*^9},
 CellLabel->
  "In[181]:=",ExpressionUUID->"a6d7a75a-e2d6-489c-a4d0-67f6217085f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox[
    TemplateBox[{"c"},
     "RowDefault"], 
    TemplateBox[{"0"},
     "RowDefault"]], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   SubscriptBox[
    TemplateBox[{"c"},
     "RowDefault"], 
    TemplateBox[{"2"},
     "RowDefault"]], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{
  3.823840944704646*^9, {3.825744832774898*^9, 3.8257448514486237`*^9}, 
   3.825744931727421*^9, 3.825744974420405*^9, 3.826326679685437*^9, 
   3.8263297169886713`*^9, 3.8263336599236813`*^9},
 CellLabel->
  "Out[183]=",ExpressionUUID->"98d164e1-ef97-4b73-ba12-dc190054e0ae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"op", "**", "vec"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"new", ",", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.819686169064335*^9, 3.819686233701758*^9}, {
   3.819686265100257*^9, 3.819686278991638*^9}, {3.8196863713723927`*^9, 
   3.819686372114259*^9}, 3.8238409433970222`*^9},
 CellLabel->
  "In[184]:=",ExpressionUUID->"0b820882-78fc-4249-8fde-f20dd24dcf7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox[
    TemplateBox[{"c"},
     "RowDefault"], 
    TemplateBox[{"0"},
     "RowDefault"]], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   SubscriptBox[
    TemplateBox[{"c"},
     "RowDefault"], 
    TemplateBox[{"2"},
     "RowDefault"]], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{{3.819686211915139*^9, 3.819686236702231*^9}, {
   3.819686279501033*^9, 3.819686305464808*^9}, 3.819686372500503*^9, 
   3.8198046429066267`*^9, 3.822805980485939*^9, 3.823840945741871*^9, {
   3.825744833975176*^9, 3.825744852314356*^9}, 3.825744934369197*^9, 
   3.825744975522642*^9, 3.826326680653057*^9, 3.8263297170228777`*^9, 
   3.8263336599564247`*^9},
 CellLabel->
  "Out[185]=",ExpressionUUID->"88d546cf-7ed6-4736-b87a-4f4a1ac8cc28"]
}, Open  ]],

Cell[TextData[{
 "When the control qubit -- the first qubit in this case -- is set to ",
 StyleBox["Ket[1]", "Input"],
 ", it operates the unitary operator on the second qubit."
}], "Text",
 CellChangeTimes->{{3.8196863102877283`*^9, 3.8196863290513906`*^9}, {
  3.823841259743166*^9, 
  3.823841270024321*^9}},ExpressionUUID->"f8067e5d-6583-436c-b66a-\
29dc78d3c907"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], "\[Rule]", "1"}], "]"}], "**", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Ket", "[", "]"}], 
       RowBox[{"c", "[", "0", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Ket", "[", 
        RowBox[{
         RowBox[{"S", "[", "2", "]"}], "\[Rule]", "1"}], "]"}], 
       RowBox[{"c", "[", "2", "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"vec", ",", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.819686169064335*^9, 3.819686233701758*^9}, {
  3.819686265100257*^9, 3.819686278991638*^9}, {3.819686341437636*^9, 
  3.819686366039714*^9}, {3.823840957716393*^9, 3.8238409613270187`*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"3a303710-2874-4579-94c7-3d7040ed3d00"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox[
    TemplateBox[{"c"},
     "RowDefault"], 
    TemplateBox[{"0"},
     "RowDefault"]], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   SubscriptBox[
    TemplateBox[{"c"},
     "RowDefault"], 
    TemplateBox[{"2"},
     "RowDefault"]], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{
  3.8238409621993437`*^9, {3.825744841728447*^9, 3.825744853654954*^9}, 
   3.8257449358765373`*^9, 3.825744976624728*^9, 3.8263266822296553`*^9, 
   3.826329717056851*^9, 3.826333659989854*^9},
 CellLabel->
  "Out[187]=",ExpressionUUID->"a0cbbff7-0710-448a-9973-c04439cc6e6e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"op", "**", "vec"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"new", ",", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.819686169064335*^9, 3.819686233701758*^9}, {
   3.819686265100257*^9, 3.819686278991638*^9}, {3.819686341437636*^9, 
   3.819686366039714*^9}, 3.823840957716393*^9},
 CellLabel->
  "In[188]:=",ExpressionUUID->"4925dc93-e7a5-47a4-9644-ce18d2637c36"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]], " ", 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}], "+", 
     RowBox[{
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"0"},
        "RowDefault"]], " ", 
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"0"},
        "RowDefault"]], " ", 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}], "-", 
     RowBox[{
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]], " ", 
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.8196863491544447`*^9, 3.819686374014414*^9}, 
   3.819804644517398*^9, 3.822805982189055*^9, 3.823840963308662*^9, {
   3.8257448428123293`*^9, 3.825744854601082*^9}, 3.8257449405036087`*^9, 
   3.825744977864459*^9, 3.82632668303869*^9, 3.826329717090819*^9, 
   3.8263336600240173`*^9},
 CellLabel->
  "Out[189]=",ExpressionUUID->"0608bf76-71a1-4093-a76e-71296e52427b"]
}, Open  ]],

Cell["\<\
When the control qubit  is in a superposition, the resulting state is an \
entangled state in general.\
\>", "Text",
 CellChangeTimes->{{3.8196864014866133`*^9, 3.81968643368189*^9}, {
   3.8238412244091473`*^9, 3.823841247997426*^9}, 
   3.823841279642276*^9},ExpressionUUID->"06bc5fd9-b738-421f-9fef-\
fe5ac09b0b15"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], "+", 
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], "\[Rule]", "1"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"vec", ",", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.819685964539612*^9, 3.819685999726454*^9}, {
   3.819686380034342*^9, 3.819686391477515*^9}, 3.823840971013805*^9},
 CellLabel->
  "In[190]:=",ExpressionUUID->"332b5ad0-5897-4d08-8551-5cef7935e2db"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{
    TagBox[
     TemplateBox[{
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"]]], 
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
   "Ket"], "+", 
  TemplateBox[{
    TagBox[
     TemplateBox[{
       SubscriptBox["1", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"]]], 
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
   "Ket"]}]], "Output",
 CellChangeTimes->{3.8238409722354927`*^9, 3.825744948204419*^9, 
  3.825744982840343*^9, 3.826326684902014*^9, 3.826329717099327*^9, 
  3.82633366003327*^9},
 CellLabel->
  "Out[191]=",ExpressionUUID->"1a66fffa-b6a6-4869-85dc-b457a5bfce36"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"op", "**", "vec"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"new", ",", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.819685964539612*^9, 3.819685999726454*^9}, {
   3.819686380034342*^9, 3.819686391477515*^9}, 3.823840971013805*^9},
 CellLabel->
  "In[192]:=",ExpressionUUID->"4ae5b871-9dd2-4f67-93ec-97aac51c803e"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{
    TagBox[
     TemplateBox[{
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"]]], 
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
   "Ket"], "+", 
  RowBox[{
   RowBox[{"Cos", "[", 
    FractionBox["\[Phi]", "2"], "]"}], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.819685971534192*^9, 3.81968600185812*^9}, 
   3.819686155339982*^9, {3.81968638092448*^9, 3.819686392593672*^9}, 
   3.819686434923162*^9, 3.8198046462056704`*^9, 3.822805983611433*^9, {
   3.823840973267241*^9, 3.823840976068223*^9}, 3.825744983845606*^9, 
   3.8263266858045483`*^9, 3.826329717132237*^9, 3.826333660065692*^9},
 CellLabel->
  "Out[193]=",ExpressionUUID->"80dfd2d6-e4f9-4cbb-8153-402e4a1de8be"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
When the target qubit is set to an eigenstate of the unitary operator, it \
does not change but the control qubit acquires the phase factor given by the \
eigenvalue of the target state.\
\>", "MathCaption",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.819686469916267*^9, 
  3.819686526826673*^9}},ExpressionUUID->"481387f5-bfa4-4280-b916-\
1fae2b5f50e8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], "+", 
      RowBox[{"Ket", "[", 
       RowBox[{
        RowBox[{"S", "[", "1", "]"}], "\[Rule]", "1"}], "]"}]}], ")"}], "**", 
    
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], "-", 
      RowBox[{"I", " ", 
       RowBox[{"Ket", "[", 
        RowBox[{
         RowBox[{"S", "[", "2", "]"}], "\[Rule]", "1"}], "]"}]}]}], ")"}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{
   RowBox[{"QuissoFactor", "@", "vec"}], ",", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.819685964539612*^9, 3.819685999726454*^9}, {
   3.819686380034342*^9, 3.819686391477515*^9}, {3.819686551104377*^9, 
   3.819686626181493*^9}, 3.823841018261426*^9},
 CellLabel->
  "In[194]:=",ExpressionUUID->"3fdcd847-482f-42dd-9b95-76e08359d6dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   TagBox[
    RowBox[{
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox["0", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"], "+", 
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox["1", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"]}],
    HoldForm], ")"}], "\[CircleTimes]", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox["0", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"], "-", 
     RowBox[{"\[ImaginaryI]", " ", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}]}],
    HoldForm], ")"}]}]], "Output",
 CellChangeTimes->{3.8238410193097143`*^9, 3.8257449860135403`*^9, 
  3.826326687273068*^9, 3.826329717141816*^9, 3.8263336600758467`*^9},
 CellLabel->
  "Out[195]=",ExpressionUUID->"3750ea56-967e-4ede-bea0-6d00ab3219f4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{"op", "**", "vec"}], "//", "TrigToExp"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{
   RowBox[{"QuissoFactor", "@", "new"}], ",", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.819685964539612*^9, 3.819685999726454*^9}, {
   3.819686380034342*^9, 3.819686391477515*^9}, {3.819686551104377*^9, 
   3.819686626181493*^9}, 3.823841018261426*^9},
 CellLabel->
  "In[196]:=",ExpressionUUID->"f3b93758-21b9-4bc7-9e30-8860026bcc1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   TagBox[
    RowBox[{
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox["0", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}], "2"]], " ", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}]}],
    HoldForm], ")"}], "\[CircleTimes]", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox["0", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"], "-", 
     RowBox[{"\[ImaginaryI]", " ", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}]}],
    HoldForm], ")"}]}]], "Output",
 CellChangeTimes->{{3.819686569961321*^9, 3.819686629010851*^9}, 
   3.819804647609193*^9, 3.822805984986657*^9, 3.8238410202677298`*^9, 
   3.826326688059381*^9, 3.826329717176374*^9, 3.826333660109283*^9},
 CellLabel->
  "Out[197]=",ExpressionUUID->"fefc0c78-48e4-40ca-8224-8f70139cadfc"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Solution",
  FontWeight->"Bold"],
 ": The eigenstates of ",
 StyleBox["U", "Input"],
 " are the same as those of ",
 StyleBox["Pauli[1]", "Input"],
 "."
}], "MathCaption",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.81968695240767*^9, 3.8196870502743196`*^9}, {
  3.819948156187347*^9, 
  3.8199481570297737`*^9}},ExpressionUUID->"0d8b75cf-9457-420b-b9e5-\
488df2abc528"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U", "=", 
  RowBox[{
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Phi]", ",", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "1"}], "]"}]}], "]"}], "//", "Elaborate"}]}]], "Input",\

 CellChangeTimes->{{3.8196870536295223`*^9, 3.819687102685934*^9}, {
   3.820021975006493*^9, 3.82002198003436*^9}, {3.820022377443638*^9, 
   3.820022481918982*^9}, 3.823841454551785*^9},
 CellLabel->
  "In[198]:=",ExpressionUUID->"14222b28-85fe-45d9-b0f2-48e47af399e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Cos", "[", 
   FractionBox["\[Phi]", "2"], "]"}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}]}]], "Output",
 CellChangeTimes->{3.8238414681414433`*^9, 3.826326689265077*^9, 
  3.8263297171844788`*^9, 3.82633366011873*^9},
 CellLabel->
  "Out[198]=",ExpressionUUID->"f6997200-6a35-4263-a400-2404ee64e95a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], "**", 
    RowBox[{"Ket", "[", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"vec", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.8196870536295223`*^9, 3.819687102685934*^9}, {
  3.820021975006493*^9, 3.82002198003436*^9}, {3.820022377443638*^9, 
  3.820022481918982*^9}, {3.823841454551785*^9, 3.8238414560921917`*^9}},
 CellLabel->
  "In[199]:=",ExpressionUUID->"7d95e307-1dd6-423e-bd6b-3250d949c233"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   SqrtBox["2"]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   SqrtBox["2"]]}]], "Output",
 CellChangeTimes->{3.823841469029645*^9, 3.826326690133765*^9, 
  3.826329717216531*^9, 3.826333660149289*^9},
 CellLabel->
  "Out[200]=",ExpressionUUID->"8ee20949-77ea-4256-9461-1a8e75115819"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"U", "**", "vec"}], "//", "LogicalForm"}], "//", "TrigToExp"}], "//",
   "Simplify"}]], "Input",
 CellChangeTimes->{{3.8196870536295223`*^9, 3.819687102685934*^9}, {
  3.820021975006493*^9, 3.82002198003436*^9}, {3.820022377443638*^9, 
  3.820022481918982*^9}, {3.823841454551785*^9, 3.823841461694785*^9}},
 CellLabel->
  "In[201]:=",ExpressionUUID->"8b3538b2-96ad-43bd-86b1-e2f2acce12e3"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}], "2"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox["0", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"], "+", 
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox["1", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"]}], ")"}]}], 
  SqrtBox["2"]]], "Output",
 CellChangeTimes->{3.823841469991819*^9, 3.826326690997151*^9, 
  3.82632971725252*^9, 3.826333660191136*^9},
 CellLabel->
  "Out[201]=",ExpressionUUID->"1b1f5465-8aca-4397-bd66-057b2f769a97"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], "**", 
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], "\[Rule]", "1"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"vec", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.8196870536295223`*^9, 3.819687102685934*^9}, {
  3.820021975006493*^9, 3.82002198003436*^9}, {3.820022377443638*^9, 
  3.820022481918982*^9}, {3.823841454551785*^9, 3.823841465564097*^9}},
 CellLabel->
  "In[202]:=",ExpressionUUID->"3ff2cd83-be8b-4353-9c81-263c49e5f677"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   SqrtBox["2"]], "-", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   SqrtBox["2"]]}]], "Output",
 CellChangeTimes->{3.823841471157185*^9, 3.826326691835886*^9, 
  3.826329717260867*^9, 3.826333660199644*^9},
 CellLabel->
  "Out[203]=",ExpressionUUID->"d177a28c-1a38-451c-b4f3-dff9d4c88c20"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"U", "**", "vec"}], "//", "LogicalForm"}], "//", "TrigToExp"}], "//",
   "Simplify"}]], "Input",
 CellChangeTimes->{{3.8196870536295223`*^9, 3.819687102685934*^9}, {
  3.820021975006493*^9, 3.82002198003436*^9}, {3.820022377443638*^9, 
  3.820022481918982*^9}, {3.823841454551785*^9, 3.823841465564097*^9}},
 CellLabel->
  "In[204]:=",ExpressionUUID->"33dca60a-39ad-4361-a22f-af0d2d4dbb3e"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}], "2"]], " ", 
   RowBox[{"(", 
    RowBox[{
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox["0", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"], "-", 
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox["1", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"]}], ")"}]}], 
  SqrtBox["2"]]], "Output",
 CellChangeTimes->{{3.819687063695842*^9, 3.8196871090661383`*^9}, 
   3.819804649245264*^9, {3.8200219802999163`*^9, 3.820021983665201*^9}, 
   3.820022054084304*^9, {3.820022385860787*^9, 3.820022510328412*^9}, 
   3.822805986713573*^9, 3.823841472261272*^9, 3.8263266926138973`*^9, 
   3.826329717294209*^9, 3.826333660236116*^9},
 CellLabel->
  "Out[204]=",ExpressionUUID->"92add6b6-60f3-4e5c-abca-7321d2703350"]
}, Open  ]],

Cell["\<\
The ancillary qubit takes a relative phase shift depending on in which \
eigenstate the native qubit is.\
\>", "Text",
 CellChangeTimes->{{3.819687393823963*^9, 3.819687453615203*^9}, {
  3.820022241647435*^9, 3.820022269062476*^9}, {3.823841481685554*^9, 
  3.8238414817514877`*^9}},ExpressionUUID->"90ed5dba-e4a5-4217-92f8-\
55e00bb74cd8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Let", "[", 
   RowBox[{"Real", ",", "\[Phi]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuissoCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", "\"\<Separator\>\"", ",", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "6"}], "]"}], ",", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"Rotation", "[", 
       RowBox[{"\[Phi]", ",", 
        RowBox[{"S", "[", 
         RowBox[{"1", ",", "1"}], "]"}]}], "]"}], ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "]"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8196871168972397`*^9, 3.819687254194672*^9}, {
  3.8196875530510473`*^9, 3.819687556559984*^9}, {3.820022528302038*^9, 
  3.820022578205556*^9}, {3.823841666278249*^9, 3.82384167685259*^9}},
 CellLabel->
  "In[205]:=",ExpressionUUID->"797e152d-2bb2-45d7-ac76-6091fe6d275f"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{2, Rational[-5, 2]}, {2, Rational[-1, 2]}}, {{2, -2.5}, {
       2, -0.5}}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light",
      FontSlant->Italic], {3, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -2}, {4, -1}}], DiskBox[{4, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light",
      FontSlant->Italic], {4, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->226.79999999999998`]], "Output",
 CellChangeTimes->{3.823841678337593*^9, 3.826326696594069*^9, 
  3.826329717305407*^9, 3.8263336602723207`*^9},
 CellLabel->
  "Out[206]=",ExpressionUUID->"b714de67-ceb9-4678-bd71-d54daca4a3d8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"QuissoExpression", "[", "qc", "]"}], "//", "TrigToExp"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{
   RowBox[{"QuissoFactor", "@", "out"}], ",", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8196871168972397`*^9, 3.819687254194672*^9}, {
  3.8196875530510473`*^9, 3.819687556559984*^9}, {3.820022528302038*^9, 
  3.820022578205556*^9}, {3.823841666278249*^9, 3.82384167685259*^9}},
 CellLabel->
  "In[207]:=",ExpressionUUID->"7f3a41c0-c065-4ce4-bb03-b11e500bece2"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}], "2"]}]], " ", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], "+", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}],
     HoldForm], ")"}], "\[CircleTimes]", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}], "2"]], " ", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}], "+", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}],
     HoldForm], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.819687168462378*^9, 3.819687256886341*^9}, 
   3.8196874178811493`*^9, 3.819687454900815*^9, 3.8196875569406033`*^9, 
   3.81980465070321*^9, 3.82002200398384*^9, 3.8200220559644413`*^9, 
   3.820022275201632*^9, {3.820022540831194*^9, 3.820022578528946*^9}, 
   3.822806003439497*^9, {3.823841679805605*^9, 3.823841682339727*^9}, 
   3.826326698745481*^9, 3.826329717339448*^9, 3.826333660305541*^9},
 CellLabel->
  "Out[208]=",ExpressionUUID->"fe6a9bc5-5fbc-4694-86e1-4ab0e5c90939"]
}, Open  ]],

Cell["Make a basis change to detect it.", "Text",
 CellChangeTimes->{{3.8196874603877068`*^9, 3.8196874678344917`*^9}, {
  3.819687557909919*^9, 
  3.819687558629792*^9}},ExpressionUUID->"7630d419-080d-44f7-bc5c-\
aa7805027ff5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuissoCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", "\"\<Separator\>\"", ",", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "6"}], "]"}], ",", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"Rotation", "[", 
       RowBox[{"\[Phi]", ",", 
        RowBox[{"S", "[", 
         RowBox[{"1", ",", "1"}], "]"}]}], "]"}], ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "]"}], ",", 
    "\"\<Separator\>\"", ",", 
    RowBox[{"Rotation", "[", 
     RowBox[{
      RowBox[{"\[Phi]", "/", "2"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "3"}], "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "6"}], "]"}], ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", "2", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8196871168972397`*^9, 3.819687254194672*^9}, {
   3.819687470411421*^9, 3.819687536232012*^9}, {3.820022620238749*^9, 
   3.820022623136634*^9}, {3.823841628581933*^9, 3.8238416408981133`*^9}, 
   3.823841694211734*^9},
 CellLabel->
  "In[209]:=",ExpressionUUID->"f9e96e4f-7bc7-4aec-88f8-1dd8732a2670"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{{{8, -2}, {9, -2}}}]}, 
   LineBox[{{{0, -1}, {9, -1}}, {{0, -2}, {8, -2}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.035555555555555556`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.035555555555555556`],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.044444444444444446`],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{2, Rational[-5, 2]}, {2, Rational[-1, 2]}}, {{2, -2.5}, {
       2, -0.5}}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.044444444444444446`],
      FontWeight->"Light",
      FontSlant->Italic], {3, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -2}, {4, -1}}], DiskBox[{4, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.044444444444444446`],
      FontWeight->"Light",
      FontSlant->Italic], {4, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{5, Rational[-5, 2]}, {5, Rational[-1, 2]}}, {{5, -2.5}, {
       5, -0.5}}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"U\"\>", "\<\"z\"\>"],
      StripOnInput->False,
      FontSize->Scaled[0.044444444444444446`],
      FontWeight->"Light",
      FontSlant->Italic], {6, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.044444444444444446`],
      FontWeight->"Light",
      FontSlant->Italic], {7, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -2.4}, {8.4, -1.6}]}, 
    CircleBox[{8, -2.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{8, -2.2}, {8.24, -1.76}}]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->370.8]], "Output",
 CellChangeTimes->{{3.823841655370206*^9, 3.823841704545599*^9}, 
   3.82632670180735*^9, 3.826329717375252*^9, 3.8263336603480797`*^9},
 CellLabel->
  "Out[209]=",ExpressionUUID->"59fb157b-8318-470e-8267-674f20557f58"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"QuissoExpression", "[", "qc", "]"}], "//", "TrigToExp"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{
   RowBox[{"QuissoFactor", "@", "out"}], ",", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8196871168972397`*^9, 3.819687254194672*^9}, {
  3.819687470411421*^9, 3.819687536232012*^9}, {3.820022620238749*^9, 
  3.820022623136634*^9}, {3.823841628581933*^9, 3.82384164919107*^9}},
 CellLabel->
  "In[210]:=",ExpressionUUID->"4204d535-4175-4bd4-8022-5917b762eb05"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}], "4"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox["0", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]], 
          SubscriptBox["0", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"], "+", 
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox["1", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]], 
          SubscriptBox["0", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"]}], ")"}]}], 
  SqrtBox["2"]]], "Output",
 CellChangeTimes->{
  3.819687418942512*^9, {3.819687486561311*^9, 3.819687559853527*^9}, {
   3.8198046531284513`*^9, 3.819804657573023*^9}, 3.820022009069326*^9, 
   3.8200220592550573`*^9, 3.8200226235402308`*^9, 3.822806005170869*^9, {
   3.823841705475069*^9, 3.8238417240265207`*^9}, 3.82632670497712*^9, 
   3.82632971743484*^9, 3.826333660426029*^9},
 CellLabel->
  "Out[211]=",ExpressionUUID->"d22fc189-9ee5-45e3-b31a-3e9ce3deba74"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Solution",
  FontWeight->"Bold"],
 ": This constructs the desired quantum circuit model."
}], "MathCaption",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.8196879410450373`*^9, 3.8196879427657757`*^9}, {
  3.8200220210862103`*^9, 3.820022021917021*^9}, {3.826333759571608*^9, 
  3.8263337771437073`*^9}},ExpressionUUID->"703ce403-13c0-4183-a059-\
3319fcb432dc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuissoCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "6"}], "]"}], ",", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"Rotation", "[", 
       RowBox[{"\[Phi]", ",", 
        RowBox[{"S", "[", 
         RowBox[{"1", ",", "1"}], "]"}]}], "]"}], ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "]"}], ",", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"S", "[", "3", "]"}], ",", 
      RowBox[{"Rotation", "[", 
       RowBox[{
        RowBox[{"2", "\[Phi]"}], ",", 
        RowBox[{"S", "[", 
         RowBox[{"1", ",", "1"}], "]"}]}], "]"}], ",", 
      RowBox[{
      "\"\<Label\>\"", "\[Rule]", 
       "\"\<\!\(\*SuperscriptBox[\(U\), \(2\)]\)\>\""}]}], "]"}], ",", 
    "\"\<Separator\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Rotation", "[", 
       RowBox[{"0", ",", 
        RowBox[{"S", "[", 
         RowBox[{"2", ",", "3"}], "]"}]}], "]"}], ",", 
      RowBox[{"Rotation", "[", 
       RowBox[{
        RowBox[{"Pi", "/", "2"}], ",", 
        RowBox[{"S", "[", 
         RowBox[{"3", ",", "3"}], "]"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"3", ",", "6"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8196871168972397`*^9, 3.819687254194672*^9}, {
   3.8196875530510473`*^9, 3.819687556559984*^9}, {3.8196879809019747`*^9, 
   3.819688027957556*^9}, {3.819688097771923*^9, 3.819688099706802*^9}, {
   3.819688153085341*^9, 3.819688183131761*^9}, {3.8196882258350477`*^9, 
   3.8196882297265053`*^9}, {3.819688351928959*^9, 3.819688352559*^9}, {
   3.819688492625574*^9, 3.8196885968614807`*^9}, {3.8196886337599573`*^9, 
   3.819688648080633*^9}, {3.819688717547606*^9, 3.819688719584979*^9}, {
   3.8238419025016336`*^9, 3.823841915844253*^9}, 3.826333745871664*^9},
 CellLabel->
  "In[304]:=",ExpressionUUID->"a464271f-4d09-47f5-ad91-b3c5e570679a"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {7, -2}}, {{0, -3}, {7, -3}}}], {
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.045714285714285714`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.045714285714285714`],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.045714285714285714`],
      FontWeight->"Light"], {-0.1, -3}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -2}, {2, -1}}], DiskBox[{2, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05714285714285714],
      FontWeight->"Light",
      FontSlant->Italic], {2, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{3, -3}, {3, -1}}], DiskBox[{3, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
     StyleBox["\<\"\\!\\(\\*SuperscriptBox[\\(U\\), \\(2\\)]\\)\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05714285714285714],
      FontWeight->"Light",
      FontSlant->Italic], {3, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{4, Rational[-7, 2]}, {4, Rational[-1, 2]}}, {{4, -3.5}, {
       4, -0.5}}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"z\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {5, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"z\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {5, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05714285714285714],
      FontWeight->"Light",
      FontSlant->Italic], {6, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->298.8]], "Output",
 CellChangeTimes->{
  3.823841917137108*^9, 3.826326706277916*^9, 3.826329717473277*^9, 
   3.8263336604697847`*^9, {3.826333746768216*^9, 3.8263337795857553`*^9}},
 CellLabel->
  "Out[304]=",ExpressionUUID->"41d66c57-b89d-4720-8a4f-342e998a3ca9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"QuissoExpression", "[", "qc", "]"}], "//", "TrigToExp"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"QuissoFactor", "@", "out"}], "/.", 
    RowBox[{"\[Phi]", "\[Rule]", 
     RowBox[{"Pi", "/", "2"}]}]}], ",", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8196871168972397`*^9, 3.819687254194672*^9}, {
   3.8196875530510473`*^9, 3.819687556559984*^9}, {3.8196879809019747`*^9, 
   3.819688027957556*^9}, {3.819688097771923*^9, 3.819688099706802*^9}, {
   3.819688153085341*^9, 3.819688183131761*^9}, {3.8196882258350477`*^9, 
   3.8196882297265053`*^9}, {3.819688351928959*^9, 3.819688352559*^9}, {
   3.819688492625574*^9, 3.8196885968614807`*^9}, {3.8196886337599573`*^9, 
   3.819688648080633*^9}, {3.819688717547606*^9, 3.819688719584979*^9}, 
   3.8238419025016336`*^9},
 CellLabel->
  "In[305]:=",ExpressionUUID->"2f74268b-b98a-457f-bb35-78c483d53ce4"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "4"], "+", 
     FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], " ", 
   RowBox[{
    RowBox[{"(", 
     TagBox[
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "+", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}],
      HoldForm], ")"}], "\[CircleTimes]", 
    RowBox[{"(", 
     TagBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], " ", 
        TemplateBox[{
          TagBox[
           TemplateBox[{
             SubscriptBox["0", 
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
           DisplayForm]},
         "Ket"]}], "+", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}],
      HoldForm], ")"}], "\[CircleTimes]", 
    RowBox[{"(", 
     TagBox[
      RowBox[{"2", " ", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}],
      HoldForm], ")"}]}]}], 
  SqrtBox["2"]]], "Output",
 CellChangeTimes->{{3.819688029280664*^9, 3.8196880326355877`*^9}, 
   3.819688100488578*^9, {3.819688158546567*^9, 3.8196881843525133`*^9}, 
   3.819688230115443*^9, {3.819688331812152*^9, 3.819688353059363*^9}, {
   3.819688513194297*^9, 3.819688566573532*^9}, 3.819688597746622*^9, {
   3.819688639854166*^9, 3.81968864847297*^9}, 3.819688720236665*^9, 
   3.819804660353313*^9, 3.822806015588048*^9, {3.823841918895699*^9, 
   3.8238419231703663`*^9}, 3.8263267109080763`*^9, 3.826329717810245*^9, 
   3.826333660838051*^9, {3.826333751628367*^9, 3.826333780596161*^9}},
 CellLabel->
  "Out[306]=",ExpressionUUID->"7ae14ab5-496c-4fb9-8759-60e5845fe1b5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Consider a controlled-U gate.", "MathCaption",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.822362718029551*^9, 3.822362733565091*^9}, {
  3.822365160937088*^9, 
  3.8223651683205833`*^9}},ExpressionUUID->"35bb3dee-2c1d-46bb-bd1b-\
b7b7634ab11c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"matU", "=", 
   RowBox[{"RandomUnitary", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"matU", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8223629606711807`*^9, 3.8223630117542343`*^9}, {
   3.822363263775792*^9, 3.822363271898095*^9}, {3.822363577997953*^9, 
   3.822363603400749*^9}, 3.8223638155196657`*^9, 3.822365298686076*^9, 
   3.8238421913272343`*^9},
 CellLabel->
  "In[307]:=",ExpressionUUID->"821935eb-7c47-4517-b0f6-561730b37c4b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "0.17948442469631426`"}], "-", 
       RowBox[{"0.983392637127919`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.02603246470545196`"}], "-", 
       RowBox[{"0.006824464476377944`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.01989223383202112`"}], "+", 
       RowBox[{"0.01812626732678686`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.2973894551557779`"}], "-", 
       RowBox[{"0.9543768906611892`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8238421925311127`*^9, 3.823842200435399*^9}, 
   3.826326712378974*^9, 3.8263297178682833`*^9, 3.826333660849297*^9, 
   3.8263337845767107`*^9},
 CellLabel->
  "Out[308]//MatrixForm=",ExpressionUUID->"c1f97c3f-eb0b-4994-8941-\
68b684aaf32d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"opU", "=", 
   RowBox[{"QuissoExpression", "[", 
    RowBox[{"matU", ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc1", "=", 
  RowBox[{"QuissoCircuit", "[", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", "opU", ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "]"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8223629606711807`*^9, 3.8223630117542343`*^9}, {
   3.822363263775792*^9, 3.822363271898095*^9}, {3.822363577997953*^9, 
   3.822363603400749*^9}, 3.8223638155196657`*^9, 3.822365298686076*^9, 
   3.8238421913272343`*^9, 3.826326719528225*^9},
 CellLabel->
  "In[309]:=",ExpressionUUID->"3549e6be-0b07-4d3c-abd6-202a9712c3a4"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
    LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.2],
      FontWeight->"Light",
      FontSlant->Italic], {1, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8]], "Output",
 CellChangeTimes->{{3.822362991967246*^9, 3.822363012164209*^9}, 
   3.8223632726856728`*^9, 3.822363465187922*^9, {3.8223635894807987`*^9, 
   3.822363606190958*^9}, 3.822363764807948*^9, {3.822363808626041*^9, 
   3.822363818074554*^9}, 3.82236529942689*^9, 3.822806018105776*^9, {
   3.8238421946218967`*^9, 3.823842201426117*^9}, {3.8263267136517487`*^9, 
   3.826326719880548*^9}, 3.8263297178754883`*^9, 3.826333660883976*^9, 
   3.826333785813744*^9},
 CellLabel->
  "Out[310]=",ExpressionUUID->"ab050c73-f7ef-45a7-be05-2d879f1465ab"]
}, Open  ]],

Cell["\<\
For the decomposition, first find the Euler angles of the unitary operator.\
\>", "Text",
 CellChangeTimes->{{3.822363832730496*^9, 
  3.8223638495261297`*^9}},ExpressionUUID->"0350c74e-1d9e-4fab-997d-\
23bbaf569e0d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"detU", "=", 
   RowBox[{"Det", "[", "matU", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vphi", "=", 
   RowBox[{
    RowBox[{"Arg", "[", "detU", "]"}], "/", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", 
  RowBox[{"TheEulerAngles", "[", 
   RowBox[{"matU", "/", 
    RowBox[{"Sqrt", "[", "detU", "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.822363013758445*^9, 3.8223630913135023`*^9}, {
  3.822363140251796*^9, 3.822363141803712*^9}},
 CellLabel->
  "In[311]:=",ExpressionUUID->"397e4dc8-2900-4e45-a8d9-fe5be97cd6e3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "4.153936086613706`", ",", "0.053830751571005905`", ",", 
   "2.007707573558376`"}], "}"}]], "Output",
 CellChangeTimes->{{3.822363020673107*^9, 3.822363023432887*^9}, {
   3.822363076759039*^9, 3.822363102729035*^9}, 3.822363142408297*^9, 
   3.822363466096518*^9, 3.822363607934821*^9, 3.8223637665487347`*^9, 
   3.822363819309134*^9, 3.822363851304463*^9, 3.822365303028857*^9, 
   3.8228060196878443`*^9, 3.823842209355219*^9, 3.8263267216329603`*^9, 
   3.826329717915742*^9, 3.8263336608913*^9, 3.826333787455834*^9},
 CellLabel->
  "Out[313]=",ExpressionUUID->"ca5ef62f-5e50-450c-b756-314ad8232776"]
}, Open  ]],

Cell["From the Euler angles, choose the component operators.", "Text",
 CellChangeTimes->{{3.822363853891197*^9, 
  3.8223638814435587`*^9}},ExpressionUUID->"76f3ffa7-eddf-4476-8949-\
f31fb5836821"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"opA", "=", 
   RowBox[{"EulerRotation", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"b", "/", "2"}], ",", "0"}], "}"}], ",", 
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<A\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opB", "=", 
   RowBox[{"EulerRotation", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"-", "b"}], "/", "2"}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "+", "c"}], ")"}]}], "/", "2"}]}], "}"}], ",", 
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<B\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opC", "=", 
   RowBox[{"EulerRotation", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "-", "c"}], ")"}]}], "/", "2"}]}], "}"}], ",", 
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<C\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opD", "=", 
   RowBox[{"Phase", "[", 
    RowBox[{"vphi", ",", 
     RowBox[{"S", "[", "1", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.822363633272999*^9, 3.822363698900997*^9}, {
  3.82236394151866*^9, 3.8223639584487886`*^9}, {3.822363995596942*^9, 
  3.822364007386593*^9}},
 CellLabel->
  "In[314]:=",ExpressionUUID->"7468a672-6d94-416a-aa0a-cb58a12e7813"],

Cell["Finally, construct the equivalent quantum circuit model.", "Text",
 CellChangeTimes->{{3.822364017556203*^9, 
  3.8223640316517487`*^9}},ExpressionUUID->"5dc901f5-de25-4fad-8d11-\
2c928700511a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc2", "=", 
  RowBox[{"QuissoCircuit", "[", 
   RowBox[{"opC", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "opB", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "opA", ",", "opD"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.822363708972704*^9, 3.822363751292541*^9}, {
  3.822363886933374*^9, 3.8223639231247463`*^9}, {3.822363964040452*^9, 
  3.822363985797476*^9}},
 CellLabel->
  "In[318]:=",ExpressionUUID->"9a61e5ab-8d0f-438a-b10a-136d38176ee4"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {7, -2}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
     StyleBox["\<\"C\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05714285714285714],
      FontWeight->"Light",
      FontSlant->Italic], {1, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
     StyleBox["\<\"B\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05714285714285714],
      FontWeight->"Light",
      FontSlant->Italic], {3, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -1}, {4, -2}}], 
    DiskBox[{4, -1}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
     LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
        4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
     StyleBox["\<\"A\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05714285714285714],
      FontWeight->"Light",
      FontSlant->Italic], {5, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -1.4}, {6.4, -0.6}]}, InsetBox[
     StyleBox["\<\"\[CapitalPhi]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05714285714285714],
      FontWeight->"Light",
      FontSlant->Italic], {6, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->298.8]], "Output",
 CellChangeTimes->{{3.8223637518441353`*^9, 3.8223637704147387`*^9}, 
   3.822363820786264*^9, {3.822363923614994*^9, 3.822363926052693*^9}, 
   3.8223639862941732`*^9, 3.822364034410405*^9, 3.8223653056225853`*^9, 
   3.822806022682035*^9, 3.823842224568321*^9, 3.826326726253981*^9, 
   3.82632971796146*^9, 3.826333660965016*^9, 3.8263337907205563`*^9},
 CellLabel->
  "Out[318]=",ExpressionUUID->"7bc9399f-c127-4304-a402-4ba1e1fc7fae"]
}, Open  ]],

Cell["Check the result.", "Text",
 CellChangeTimes->{{3.822364039437107*^9, 
  3.8223640430028477`*^9}},ExpressionUUID->"a53ebdcd-5fd2-4321-a3c9-\
f72fadd4e239"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"QuissoExpression", "[", "qc1", "]"}], "-", 
   RowBox[{"QuissoExpression", "[", "qc2", "]"}]}], "//", "Chop"}]], "Input",
 CellChangeTimes->{{3.822363779700921*^9, 3.822363793985404*^9}},
 CellLabel->
  "In[228]:=",ExpressionUUID->"cbe7e41d-febf-43c1-aa67-a0d7f3636387"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.82236379110515*^9, 3.8223638215750933`*^9}, 
   3.822363987466702*^9, 3.8223640445161953`*^9, 3.822365307193075*^9, 
   3.822806024584317*^9, 3.8238422273515587`*^9, 3.8263297180105553`*^9, 
   3.826333661047138*^9},
 CellLabel->
  "Out[228]=",ExpressionUUID->"9fbbfa95-f8d8-42c2-a972-ab29891c5e92"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["General Unitary Gates", "Subsection",
 CellChangeTimes->{{3.8190783065101852`*^9, 
  3.8190783131586237`*^9}},ExpressionUUID->"200f1d43-862b-48e5-b0c4-\
66e7baf1bfd3"],

Cell[CellGroupData[{

Cell["\<\
Consider a Hermitian operator on a two-qubit system. Physically, it \
corresponds to a transverse-field Ising model.\
\>", "MathCaption",
 CellChangeTimes->{{3.82574680782373*^9, 
  3.825746859308683*^9}},ExpressionUUID->"dc7b920a-b5c6-48c5-88bc-\
9069675bb175"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"H", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}]}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matH", "=", 
   RowBox[{"Matrix", "[", "H", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"matH", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.825745785140683*^9, 3.825745853624226*^9}, {
  3.8257460693985167`*^9, 3.8257461559392653`*^9}, {3.825746186797338*^9, 
  3.8257462292965937`*^9}, {3.825746374786569*^9, 3.825746415351322*^9}, {
  3.8257464456581097`*^9, 3.825746446770846*^9}, {3.8257464949332952`*^9, 
  3.825746524909337*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"4554c789-7854-4252-a865-cefc4edb0552"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm], "+", 
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"1"}, "RowDefault"], 
    TemplateBox[{"\"y\""}, "RowDefault"]},
   "Subsuperscript"], "+", 
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"1"}, "RowDefault"], 
    TemplateBox[{"\"z\""}, "RowDefault"]},
   "Subsuperscript"], "+", 
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"2"}, "RowDefault"], 
    TemplateBox[{"\"y\""}, "RowDefault"]},
   "Subsuperscript"], "+", 
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"2"}, "RowDefault"], 
    TemplateBox[{"\"z\""}, "RowDefault"]},
   "Subsuperscript"]}]], "Output",
 CellChangeTimes->{{3.825745810052423*^9, 3.825745854311878*^9}, {
   3.825746047299778*^9, 3.8257460774980297`*^9}, {3.8257461120044003`*^9, 
   3.825746156243587*^9}, {3.8257461976648083`*^9, 3.825746229636919*^9}, 
   3.825746377015771*^9, 3.825746415757009*^9, {3.825746447175304*^9, 
   3.8257465252803717`*^9}, {3.825746861069104*^9, 3.825746865896688*^9}, 
   3.825748643009836*^9, 3.825748771274084*^9, 3.826225420635057*^9, 
   3.8263297180181427`*^9, 3.826333661055253*^9, 3.826338094852137*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"a2aa9b24-56ac-4cd9-9cda-713b2f25d963"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"2", 
      RowBox[{"-", "\[ImaginaryI]"}], 
      RowBox[{"-", "\[ImaginaryI]"}], "1"},
     {"\[ImaginaryI]", "0", "1", 
      RowBox[{"-", "\[ImaginaryI]"}]},
     {"\[ImaginaryI]", "1", "0", 
      RowBox[{"-", "\[ImaginaryI]"}]},
     {"1", "\[ImaginaryI]", "\[ImaginaryI]", 
      RowBox[{"-", "2"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 4, 8, 12, 16}, {{1}, {2}, {3}, {4}, {2}, {1}, {4}, {3}, {3}, {
       4}, {1}, {2}, {4}, {3}, {2}, {1}}}, {
      2, Complex[0, -1], Complex[0, -1], 1, 0, Complex[0, 1], Complex[0, -1], 
       1, 0, Complex[0, -1], Complex[0, 1], 1, -2, Complex[0, 1], Complex[
       0, 1], 1}}]]]]], "Output",
 CellChangeTimes->{{3.825745810052423*^9, 3.825745854311878*^9}, {
   3.825746047299778*^9, 3.8257460774980297`*^9}, {3.8257461120044003`*^9, 
   3.825746156243587*^9}, {3.8257461976648083`*^9, 3.825746229636919*^9}, 
   3.825746377015771*^9, 3.825746415757009*^9, {3.825746447175304*^9, 
   3.8257465252803717`*^9}, {3.825746861069104*^9, 3.825746865896688*^9}, 
   3.825748643009836*^9, 3.825748771274084*^9, 3.826225420635057*^9, 
   3.8263297180181427`*^9, 3.826333661055253*^9, 3.8263380948568363`*^9},
 CellLabel->
  "Out[22]//MatrixForm=",ExpressionUUID->"fa3bfaf7-be94-48c6-8891-\
0319332b2dfe"]
}, Open  ]],

Cell["\<\
This is the unitary operator generated by the above Hermitian operator.\
\>", "Text",
 CellChangeTimes->{{3.825746879422639*^9, 
  3.825746904801694*^9}},ExpressionUUID->"478bcb87-e014-45dc-8d24-\
55ebb8a2c205"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U", "=", 
  RowBox[{"MultiplyExp", "[", 
   RowBox[{
    RowBox[{"-", "I"}], "  ", "H", " ", 
    RowBox[{"Pi", "/", "4"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.825745857998559*^9, 3.8257460226450243`*^9}, {
  3.825746117669445*^9, 3.8257461177702007`*^9}, {3.825746207788409*^9, 
  3.825746211534068*^9}, {3.825746295657905*^9, 3.825746347067532*^9}, {
  3.825746454837264*^9, 3.825746471328614*^9}, {3.825746512142303*^9, 
  3.825746529791831*^9}, {3.8257469471236362`*^9, 3.825746949283082*^9}, {
  3.8257486459795837`*^9, 3.825748719190055*^9}, {3.825748785618828*^9, 
  3.825748796102779*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"059015e2-561f-4f7e-8385-2c3e93b5d8ff"],

Cell[BoxData[
 SuperscriptBox["\[ExponentialE]", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
   RowBox[{"(", 
    RowBox[{
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm], "+", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"], "+", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"], "+", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"], "+", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.82574694957581*^9, 3.825746951278034*^9}, {
   3.825748646402684*^9, 3.825748719630045*^9}, {3.82574877591192*^9, 
   3.8257487965814257`*^9}, 3.826225422081636*^9, 3.826329718061911*^9, 
   3.826333661092963*^9, 3.8263380963449*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"493744ba-796a-42a2-a7ea-44105a1d40e2"]
}, Open  ]],

Cell[TextData[{
 "This shows the matrix representation of ",
 StyleBox["U", "Input"],
 " in the logical basis."
}], "Text",
 CellChangeTimes->{{3.825746953613326*^9, 
  3.825746977574038*^9}},ExpressionUUID->"8b881b48-487f-415b-9e7c-\
c66f22aea752"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"matU", "=", 
   RowBox[{
    RowBox[{"Matrix", "[", "U", "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"matU", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.825745857998559*^9, 3.8257460226450243`*^9}, {
   3.825746117669445*^9, 3.8257461177702007`*^9}, {3.825746207788409*^9, 
   3.825746211534068*^9}, {3.825746295657905*^9, 3.825746347067532*^9}, {
   3.825746454837264*^9, 3.825746471328614*^9}, {3.825746512142303*^9, 
   3.825746529791831*^9}, 3.8257469471236362`*^9, {3.825748663922715*^9, 
   3.8257486656654663`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"9fc4c3d7-3782-4bd8-838d-9b8c9d109b4e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.825745865667531*^9, 3.8257460784460697`*^9}, {
   3.825746113569147*^9, 3.825746157720942*^9}, {3.8257461987377253`*^9, 
   3.82574623152573*^9}, {3.825746296711462*^9, 3.825746378439662*^9}, 
   3.8257464169432783`*^9, {3.825746451280964*^9, 3.8257464716949863`*^9}, {
   3.825746506952736*^9, 3.825746554794978*^9}, 3.8257468729477577`*^9, 
   3.825746907524428*^9, 3.825746985198106*^9, {3.8257486477443237`*^9, 
   3.8257487215960703`*^9}, {3.82574878888295*^9, 3.8257487980801487`*^9}, 
   3.826225423465539*^9, 3.8263297181112013`*^9, 3.8263336611370583`*^9, 
   3.826338097433136*^9},
 CellLabel->
  "Out[25]//MatrixForm=",ExpressionUUID->"6dccab85-0b9e-4af4-b735-\
666558c24787"]
}, Open  ]],

Cell[TextData[{
 "This shows the decomposition of the unitary matrix into two-level matrices \
(displaying the first three elements). For the purpose of efficiency, the \
resulting list is given in terms of ",
 StyleBox["TwoLevelU", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.825746917931465*^9, 3.8257469445792637`*^9}, {
  3.8257469913210773`*^9, 3.825747064216855*^9}, {3.826225461111587*^9, 
  3.826225480992959*^9}},ExpressionUUID->"e63f0239-5499-4844-8f0b-\
589257e37cd9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"twl", "=", 
   RowBox[{
    RowBox[{"TwoLevelDecomposition", "[", "matU", "]"}], "//", "Simplify"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"twl", "[", 
  RowBox[{"[", 
   RowBox[{";;", "3"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.825746609259522*^9, 3.825746661982821*^9}, {
  3.8262254843474817`*^9, 3.826225490806238*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"ec9a089a-cdf8-4e25-8f72-5e8bf0d9a6f2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           FractionBox["1", "2"], "-", 
           FractionBox[
            RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
          SqrtBox["7"]], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            FractionBox["3", "2"], "+", 
            FractionBox[
             RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
           SqrtBox["7"]]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           FractionBox["3", "2"], "-", 
           FractionBox[
            RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
          SqrtBox["7"]], ",", 
         FractionBox[
          RowBox[{
           FractionBox["1", "2"], "+", 
           FractionBox[
            RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
          SqrtBox["7"]]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"1", "-", 
            RowBox[{"3", " ", "\[ImaginaryI]"}]}], 
           SqrtBox["38"]]}], ",", 
         SqrtBox[
          FractionBox["14", "19"]]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          SqrtBox[
           FractionBox["14", "19"]]}], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"1", "+", 
            RowBox[{"3", " ", "\[ImaginaryI]"}]}], 
           SqrtBox["38"]]}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", "4"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8257466429230127`*^9, 3.825746664341507*^9}, 
   3.825746910193886*^9, 3.825747000567658*^9, 3.825747161659006*^9, {
   3.8257486955388727`*^9, 3.825748723835164*^9}, 3.825748799974234*^9, {
   3.8262254918136253`*^9, 3.8262254954273367`*^9}, 3.826329718272139*^9, 
   3.826333661287776*^9, 3.826338099217266*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"1a996f5c-49f4-4579-9213-eeeafc93674e"]
}, Open  ]],

Cell[TextData[{
 "For a more intuitive form, you can convert ",
 StyleBox["TwoLevelU", "Input"],
 " into the normal matrix form using ",
 StyleBox["Matrix", "Input"],
 ". Here the first three are shown."
}], "Text",
 CellChangeTimes->{{3.825747077536437*^9, 3.825747145077875*^9}, {
  3.826225520071632*^9, 
  3.826225541085203*^9}},ExpressionUUID->"f6fb3f00-cb3c-4283-a6f0-\
f582195ce967"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Matrix", "/@", 
   RowBox[{"twl", "[", 
    RowBox[{"[", 
     RowBox[{";;", "3"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.825746700470716*^9, 3.8257467087244473`*^9}, {
  3.826225502610517*^9, 3.826225503757389*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"ae2271fb-074d-4d33-9583-50ea101169c4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {1, 1, 1, 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        FractionBox[
         RowBox[{
          FractionBox["1", "2"], "-", 
          FractionBox[
           RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
         SqrtBox["7"]], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           FractionBox["3", "2"], "+", 
           FractionBox[
            RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
          SqrtBox["7"]]}]},
       {"0", "0", 
        FractionBox[
         RowBox[{
          FractionBox["3", "2"], "-", 
          FractionBox[
           RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
         SqrtBox["7"]], 
        FractionBox[
         RowBox[{
          FractionBox["1", "2"], "+", 
          FractionBox[
           RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
         SqrtBox["7"]]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[Rational[1, 2], Rational[-3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[-3, 2], Rational[-3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[1, 2], Rational[3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[3, 2], Rational[-3, 2]] 7^Rational[-1, 2]}}]]]], 
   ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"1", "-", 
           RowBox[{"3", " ", "\[ImaginaryI]"}]}], 
          SqrtBox["38"]]}], 
        SqrtBox[
         FractionBox["14", "19"]], "0"},
       {"0", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox["14", "19"]]}], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"3", " ", "\[ImaginaryI]"}]}], 
          SqrtBox["38"]]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[-1, 3] 38^Rational[-1, 2], Rational[14, 19]^Rational[1, 2],
          Complex[-1, -3] 38^Rational[-1, 2], -
         Rational[14, 19]^Rational[1, 2], 1}}]]]]}], "}"}]], "Output",
 CellChangeTimes->{{3.825746704250867*^9, 3.8257467090607357`*^9}, {
   3.825747136257801*^9, 3.825747162893362*^9}, 3.825748728342235*^9, 
   3.825748801831325*^9, 3.826225504153957*^9, 3.826225542648952*^9, 
   3.826329718280012*^9, 3.826333661296629*^9, 3.826338102162608*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"7d49a363-f048-4aa9-b8da-1540fbbb8d55"]
}, Open  ]],

Cell["Indeed, they reconstruct the original matrix.", "Text",
 CellChangeTimes->{{3.825747179242531*^9, 
  3.825747187825377*^9}},ExpressionUUID->"0419518a-7b40-42a8-bb90-\
a709b4a60a73"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"Dot", "@@", 
    RowBox[{"Matrix", "/@", "twl"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"matU", "-", "new"}], "//", "Simplify"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8257471890200653`*^9, 3.82574721506069*^9}, {
  3.825748754896859*^9, 3.825748756943139*^9}},
 CellLabel->
  "In[238]:=",ExpressionUUID->"44e32c84-7ed3-4fba-b6ba-05d594acf37f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.825747199763287*^9, 3.8257472153214693`*^9}, {
   3.825748733042242*^9, 3.825748758996829*^9}, 3.8257488037189503`*^9, 
   3.8262255098772573`*^9, 3.826329718321154*^9, 3.826333661331856*^9},
 CellLabel->
  "Out[239]//MatrixForm=",ExpressionUUID->"94d1139b-47b1-42c9-bb99-\
9c53fd04d496"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Consider a two-level matrix of the form.", "MathCaption",
 CellChangeTimes->{{3.8260541950441427`*^9, 
  3.82605421106446*^9}},ExpressionUUID->"4a451544-88b4-4e07-9ac8-\
ae17c65f7020"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"matU", "=", 
   RowBox[{"TheHadamard", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"code", "=", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{"matU", ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"full", "=", 
   RowBox[{"Matrix", "[", "code", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"full", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8260544561048517`*^9, 3.826054519888679*^9}, {
  3.826054613530467*^9, 3.826054640809328*^9}},
 CellLabel->
  "In[240]:=",ExpressionUUID->"88e897e6-5ca8-4cba-b007-a3e7a786aa5e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", 
      FractionBox["1", 
       SqrtBox["2"]], 
      FractionBox["1", 
       SqrtBox["2"]]},
     {"0", "0", 
      FractionBox["1", 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
      1, 1, 2^Rational[-1, 2], 2^Rational[-1, 2], -2^Rational[-1, 2], 2^
       Rational[-1, 2]}}]]]]], "Output",
 CellChangeTimes->{{3.826054512574505*^9, 3.826054575677123*^9}, {
   3.8260546179067097`*^9, 3.826054649563826*^9}, 3.8263297183299847`*^9, 
   3.8263297561552563`*^9, 3.826333661339849*^9},
 CellLabel->
  "Out[243]//MatrixForm=",ExpressionUUID->"16e62691-f44b-4d78-b9b9-\
b49f1f077f01"]
}, Open  ]],

Cell["It corresponds to a single controlled-U gate.", "Text",
 CellChangeTimes->{{3.826055023944199*^9, 
  3.8260550343498898`*^9}},ExpressionUUID->"ddcb9fe7-bc17-479a-832c-\
44297dffed5b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ctrlU", "=", 
   RowBox[{"GrayTwoLevelU", "[", 
    RowBox[{"matU", ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", 
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"QuissoCircuit", "[", "ctrlU", "]"}]}], "Input",
 CellChangeTimes->{{3.826054324793391*^9, 3.826054353106566*^9}, 
   3.826054428076798*^9, {3.82605456158013*^9, 3.826054587261544*^9}, {
   3.826054653668275*^9, 3.826054687247489*^9}, {3.826054875002886*^9, 
   3.8260548778585043`*^9}, {3.826054990151506*^9, 3.8260549971144257`*^9}, {
   3.826329751562418*^9, 3.8263297518431673`*^9}},
 CellLabel->
  "In[244]:=",ExpressionUUID->"be696d2e-22b3-40f5-b7a6-da4ba963d421"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
    LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.2],
      FontWeight->"Light",
      FontSlant->Italic], {1, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8]], "Output",
 CellChangeTimes->{{3.826054345666815*^9, 3.826054353417645*^9}, 
   3.82605442835625*^9, {3.82605453396813*^9, 3.826054589332481*^9}, {
   3.826054620201408*^9, 3.826054689576792*^9}, 3.826054878159926*^9, 
   3.826054997480523*^9, 3.8263297183742933`*^9, {3.826329752260511*^9, 
   3.826329757507287*^9}, 3.8263336613761377`*^9},
 CellLabel->
  "Out[245]=",ExpressionUUID->"55f78346-9468-44ee-9ee6-40f03ebfee7b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Consider a two-level matrix of the form.", "MathCaption",
 CellChangeTimes->{{3.8260541950441427`*^9, 
  3.82605421106446*^9}},ExpressionUUID->"3beeca0a-b1aa-4dc7-a2f1-\
23c557a061c7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"matU", "=", 
   RowBox[{"TheHadamard", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"code", "=", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{"matU", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], ",", "4"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"full", "=", 
   RowBox[{"Matrix", "[", "code", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"full", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8260544561048517`*^9, 3.826054519888679*^9}, {
  3.826054613530467*^9, 3.826054640809328*^9}, {3.8260548631109962`*^9, 
  3.8260548631261473`*^9}},
 CellLabel->
  "In[246]:=",ExpressionUUID->"0a8822e7-cf34-4ad9-ab0d-127993ff6fe6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", 
      FractionBox["1", 
       SqrtBox["2"]], "0", 
      FractionBox["1", 
       SqrtBox["2"]]},
     {"0", "0", "1", "0"},
     {"0", 
      FractionBox["1", 
       SqrtBox["2"]], "0", 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 1, 3, 4, 6}, {{1}, {2}, {4}, {3}, {4}, {2}}}, {
      1, 2^Rational[-1, 2], 2^Rational[-1, 2], 1, -2^Rational[-1, 2], 2^
       Rational[-1, 2]}}]]]]], "Output",
 CellChangeTimes->{{3.826054512574505*^9, 3.826054575677123*^9}, {
   3.8260546179067097`*^9, 3.826054649563826*^9}, {3.826054865499357*^9, 
   3.82605488088517*^9}, 3.826329718383037*^9, 3.826329763049575*^9, 
   3.826333661384575*^9},
 CellLabel->
  "Out[249]//MatrixForm=",ExpressionUUID->"efb07a50-b327-4229-967e-\
b2af4e9f31be"]
}, Open  ]],

Cell["\<\
It corresponds to a single controlled-U gate with the control and target \
qubit exchanged.\
\>", "Text",
 CellChangeTimes->{{3.826055023944199*^9, 
  3.826055063856986*^9}},ExpressionUUID->"433aecbc-0dee-412c-b2ca-\
09aca6549ae5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ctrlU", "=", 
   RowBox[{"GrayTwoLevelU", "[", 
    RowBox[{"matU", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], ",", 
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"QuissoCircuit", "[", "ctrlU", "]"}]}], "Input",
 CellChangeTimes->{{3.826054324793391*^9, 3.826054353106566*^9}, 
   3.826054428076798*^9, {3.82605456158013*^9, 3.826054587261544*^9}, {
   3.826054653668275*^9, 3.826054687247489*^9}, {3.826054884631419*^9, 
   3.8260548846874247`*^9}, 3.826055002628208*^9, 3.826329769381411*^9},
 CellLabel->
  "In[250]:=",ExpressionUUID->"58de3ff9-ffa3-4f82-be06-0a6d90534ecd"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
    LineBox[{{1, -2}, {1, -1}}], DiskBox[{1, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.2],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8]], "Output",
 CellChangeTimes->{{3.826054345666815*^9, 3.826054353417645*^9}, 
   3.82605442835625*^9, {3.82605453396813*^9, 3.826054589332481*^9}, {
   3.826054620201408*^9, 3.826054689576792*^9}, {3.826054867160961*^9, 
   3.8260548850779943`*^9}, 3.82605500317879*^9, 3.82605506517022*^9, 
   3.826329718425933*^9, {3.826329764603259*^9, 3.826329769766796*^9}, 
   3.826333661427513*^9},
 CellLabel->
  "Out[251]=",ExpressionUUID->"0adffde2-5422-4c3e-84ec-80f9cb578e16"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Consider a two-level matrix of the form.", "MathCaption",
 CellChangeTimes->{{3.8260541950441427`*^9, 
  3.82605421106446*^9}},ExpressionUUID->"829c9dbe-b262-4ef0-b036-\
2a89d9234cdd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"matU", "=", 
   RowBox[{"TheHadamard", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"code", "=", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{"matU", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", "4"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"full", "=", 
   RowBox[{"Matrix", "[", "code", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"full", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8260544561048517`*^9, 3.826054519888679*^9}, {
  3.826054613530467*^9, 3.826054640809328*^9}, {3.8260548631109962`*^9, 
  3.8260548631261473`*^9}, {3.826054909683794*^9, 3.826054909761827*^9}},
 CellLabel->
  "In[252]:=",ExpressionUUID->"77c6ead4-c199-4495-b5a8-539fa3cf5175"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", 
      FractionBox["1", 
       SqrtBox["2"]], 
      FractionBox["1", 
       SqrtBox["2"]], "0"},
     {"0", 
      FractionBox["1", 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}], "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
      1, 2^Rational[-1, 2], 2^Rational[-1, 2], -2^Rational[-1, 2], 2^
       Rational[-1, 2], 1}}]]]]], "Output",
 CellChangeTimes->{{3.826054512574505*^9, 3.826054575677123*^9}, {
   3.8260546179067097`*^9, 3.826054649563826*^9}, {3.826054865499357*^9, 
   3.82605488088517*^9}, 3.826054911120387*^9, 3.8260550057225237`*^9, 
   3.826055766511935*^9, 3.82613135178741*^9, 3.826329718434518*^9, 
   3.8263297714595127`*^9, 3.826333661436317*^9},
 CellLabel->
  "Out[255]//MatrixForm=",ExpressionUUID->"545a6549-ee99-4e53-a0f0-\
6bfdf314f947"]
}, Open  ]],

Cell["\<\
In this case, we need to apply the CNOT gate before and after the \
controlled-U gate.\
\>", "Text",
 CellChangeTimes->{{3.82605509325206*^9, 
  3.826055139870063*^9}},ExpressionUUID->"b508c97f-d0b2-44b0-8516-\
6d81b99e24be"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ctrlU", "=", 
   RowBox[{"GrayTwoLevelU", "[", 
    RowBox[{"matU", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", 
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"QuissoCircuit", "[", "ctrlU", "]"}]}], "Input",
 CellChangeTimes->{{3.826054324793391*^9, 3.826054353106566*^9}, 
   3.826054428076798*^9, {3.82605456158013*^9, 3.826054587261544*^9}, {
   3.826054653668275*^9, 3.826054687247489*^9}, {3.826054884631419*^9, 
   3.8260548846874247`*^9}, {3.826054914746058*^9, 3.826054914847007*^9}, {
   3.82613133454174*^9, 3.826131347870913*^9}, 3.826329777064439*^9},
 CellLabel->
  "In[256]:=",ExpressionUUID->"b8312eb3-4af7-4c72-8aaf-f09510dc4138"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
    LineBox[{{1, -2}, {1, -1}}], 
    DiskBox[{1, -2}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
        1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
    LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {2, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{3, -2}, {3, -1}}], 
    DiskBox[{3, -2}, 0.09], {CircleBox[{3, -1}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -1}, {3.2666666666666666`, -1}}, {{
        3, -1.2666666666666666`}, {3, -0.7333333333333334}}}]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`]], "Output",
 CellChangeTimes->{{3.826054345666815*^9, 3.826054353417645*^9}, 
   3.82605442835625*^9, {3.82605453396813*^9, 3.826054589332481*^9}, {
   3.826054620201408*^9, 3.826054689576792*^9}, {3.826054867160961*^9, 
   3.8260548850779943`*^9}, 3.826054915239068*^9, 3.826055006540514*^9, 
   3.826055141538521*^9, 3.826055768324479*^9, {3.826131348215242*^9, 
   3.826131353152464*^9}, 3.8263297184793587`*^9, {3.8263297774513493`*^9, 
   3.826329779743433*^9}, 3.8263336614782248`*^9},
 CellLabel->
  "Out[257]=",ExpressionUUID->"7f41934b-9b21-45b3-b26b-ed6cd7a5428d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Consider a two-level matrix of the form.", "MathCaption",
 CellChangeTimes->{{3.8260541950441427`*^9, 
  3.82605421106446*^9}},ExpressionUUID->"d5529d34-6855-40f5-8e23-\
6b09c9388f75"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"matU", "=", 
   RowBox[{"TheHadamard", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"code", "=", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{"matU", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}], ",", "4"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"full", "=", 
   RowBox[{"Matrix", "[", "code", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"full", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8260544561048517`*^9, 3.826054519888679*^9}, {
  3.826054613530467*^9, 3.826054640809328*^9}, {3.8260548631109962`*^9, 
  3.8260548631261473`*^9}, {3.826054909683794*^9, 3.826054939021677*^9}},
 CellLabel->
  "In[258]:=",ExpressionUUID->"eba3f428-2f21-4cd5-bc0b-7ea8ef112241"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       SqrtBox["2"]], "0", "0", 
      FractionBox["1", 
       SqrtBox["2"]]},
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {
      FractionBox["1", 
       SqrtBox["2"]], "0", "0", 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 3, 4, 6}, {{1}, {4}, {2}, {3}, {4}, {1}}}, {
      2^Rational[-1, 2], 2^Rational[-1, 2], 1, 1, -2^Rational[-1, 2], 2^
       Rational[-1, 2]}}]]]]], "Output",
 CellChangeTimes->{{3.826054512574505*^9, 3.826054575677123*^9}, {
   3.8260546179067097`*^9, 3.826054649563826*^9}, {3.826054865499357*^9, 
   3.82605488088517*^9}, {3.826054911120387*^9, 3.826054951637662*^9}, 
   3.8260550083130083`*^9, 3.826329718488061*^9, 3.826333661486759*^9},
 CellLabel->
  "Out[261]//MatrixForm=",ExpressionUUID->"4a413300-1002-4da4-b4dc-\
db4de79209b3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ctrlU", "=", 
   RowBox[{"GrayTwoLevelU", "[", 
    RowBox[{"matU", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}], ",", 
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"QuissoCircuit", "@@", "ctrlU"}]}], "Input",
 CellChangeTimes->{{3.826054324793391*^9, 3.826054353106566*^9}, 
   3.826054428076798*^9, {3.82605456158013*^9, 3.826054587261544*^9}, {
   3.826054653668275*^9, 3.826054687247489*^9}, {3.826054884631419*^9, 
   3.8260548846874247`*^9}, {3.826054914746058*^9, 3.826054944882676*^9}},
 CellLabel->
  "In[262]:=",ExpressionUUID->"26239bcb-03f4-4364-9d17-67709f8d15b9"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], {3, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -2}, {4, -1}}], DiskBox[{4, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], {4, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], {5, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{6, -1}, {6, -2}}], 
    DiskBox[{6, -1}, 0.09], {CircleBox[{6, -2}, 0.26666666666666666], 
     LineBox[{{{5.733333333333333, -2}, {6.266666666666667, -2}}, {{
        6, -2.2666666666666666`}, {6, -1.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], {7, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->334.8]], "Output",
 CellChangeTimes->{{3.826054345666815*^9, 3.826054353417645*^9}, 
   3.82605442835625*^9, {3.82605453396813*^9, 3.826054589332481*^9}, {
   3.826054620201408*^9, 3.826054689576792*^9}, {3.826054867160961*^9, 
   3.8260548850779943`*^9}, 3.826054915239068*^9, {3.826054945283372*^9, 
   3.8260549523725243`*^9}, 3.8263297185309143`*^9, 3.826329783884294*^9, 
   3.826333661600754*^9},
 CellLabel->
  "Out[263]=",ExpressionUUID->"424b11e5-40b4-471a-b211-54e72117beb8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Let us consider again the two-qubit model demonstrated before.\
\>", "MathCaption",
 CellChangeTimes->{{3.82574680782373*^9, 3.825746859308683*^9}, {
  3.8257477408766727`*^9, 3.8257477728815928`*^9}, {3.8260552689130774`*^9, 
  3.826055270251631*^9}},ExpressionUUID->"4af47efe-af18-48da-945a-\
38636bdfd5cb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"H", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}]}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"U", "=", 
  RowBox[{"MultiplyExp", "[", 
   RowBox[{
    RowBox[{"-", "I"}], "  ", "H", " ", 
    RowBox[{"Pi", "/", "4"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matU", "=", 
   RowBox[{"Matrix", "[", "U", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.825745785140683*^9, 3.825745853624226*^9}, {
  3.8257460693985167`*^9, 3.8257461559392653`*^9}, {3.825746186797338*^9, 
  3.8257462292965937`*^9}, {3.825746374786569*^9, 3.825746415351322*^9}, {
  3.8257464456581097`*^9, 3.825746446770846*^9}, {3.8257464949332952`*^9, 
  3.825746524909337*^9}, {3.8257477770561333`*^9, 3.8257478214012012`*^9}, {
  3.825748831156625*^9, 3.825748850730274*^9}},
 CellLabel->
  "In[264]:=",ExpressionUUID->"0718cfd3-6795-4fb5-a187-6a81dc9bc0f0"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm], "+", 
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"1"}, "RowDefault"], 
    TemplateBox[{"\"y\""}, "RowDefault"]},
   "Subsuperscript"], "+", 
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"1"}, "RowDefault"], 
    TemplateBox[{"\"z\""}, "RowDefault"]},
   "Subsuperscript"], "+", 
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"2"}, "RowDefault"], 
    TemplateBox[{"\"y\""}, "RowDefault"]},
   "Subsuperscript"], "+", 
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"2"}, "RowDefault"], 
    TemplateBox[{"\"z\""}, "RowDefault"]},
   "Subsuperscript"]}]], "Output",
 CellChangeTimes->{{3.825745810052423*^9, 3.825745854311878*^9}, {
   3.825746047299778*^9, 3.8257460774980297`*^9}, {3.8257461120044003`*^9, 
   3.825746156243587*^9}, {3.8257461976648083`*^9, 3.825746229636919*^9}, 
   3.825746377015771*^9, 3.825746415757009*^9, {3.825746447175304*^9, 
   3.8257465252803717`*^9}, {3.825746861069104*^9, 3.825746865896688*^9}, {
   3.825747774507472*^9, 3.825747827103168*^9}, {3.8257488052778397`*^9, 
   3.8257488516631403`*^9}, 3.825749347139398*^9, {3.82574943675066*^9, 
   3.825749442976117*^9}, 3.826055278133779*^9, 3.8261447745680447`*^9, 
   3.826329718541069*^9, 3.826329785619528*^9, 3.826333661609387*^9},
 CellLabel->
  "Out[264]=",ExpressionUUID->"a4999956-c8f8-4ead-bace-90f6f9cc71be"],

Cell[BoxData[
 SuperscriptBox["\[ExponentialE]", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
   RowBox[{"(", 
    RowBox[{
     TagBox[
      RowBox[{
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm], 
       TagBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"],
        DisplayForm]}],
      DisplayForm], "+", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"], "+", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"], "+", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"], "+", 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.825745810052423*^9, 3.825745854311878*^9}, {
   3.825746047299778*^9, 3.8257460774980297`*^9}, {3.8257461120044003`*^9, 
   3.825746156243587*^9}, {3.8257461976648083`*^9, 3.825746229636919*^9}, 
   3.825746377015771*^9, 3.825746415757009*^9, {3.825746447175304*^9, 
   3.8257465252803717`*^9}, {3.825746861069104*^9, 3.825746865896688*^9}, {
   3.825747774507472*^9, 3.825747827103168*^9}, {3.8257488052778397`*^9, 
   3.8257488516631403`*^9}, 3.825749347139398*^9, {3.82574943675066*^9, 
   3.825749442976117*^9}, 3.826055278133779*^9, 3.8261447745680447`*^9, 
   3.826329718541069*^9, 3.826329785619528*^9, 3.826333661640863*^9},
 CellLabel->
  "Out[265]=",ExpressionUUID->"a077ac29-4a02-4b6c-ac7b-1c660651c099"]
}, Open  ]],

Cell["\<\
This is the decomposition into the two-level matrices, just showing the first \
four.\
\>", "Text",
 CellChangeTimes->{{3.825746917931465*^9, 3.8257469445792637`*^9}, {
  3.8257469913210773`*^9, 3.825747064216855*^9}, {3.825747911418088*^9, 
  3.825747940947754*^9}, {3.826144798458065*^9, 
  3.8261448655271606`*^9}},ExpressionUUID->"3950a998-b0aa-413e-8da5-\
e18ca1c4a880"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"twl", "=", 
   RowBox[{
    RowBox[{"TwoLevelDecomposition", "[", "matU", "]"}], "//", "Simplify"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Matrix", "/@", 
   RowBox[{"twl", "[", 
    RowBox[{"[", 
     RowBox[{";;", "3"}], "]"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.825746609259522*^9, 3.825746661982821*^9}, {
  3.825747946842906*^9, 3.825747967868566*^9}, {3.826144782832835*^9, 
  3.82614479071791*^9}, {3.826144942982173*^9, 3.826144943058941*^9}},
 CellLabel->
  "In[267]:=",ExpressionUUID->"497b32ac-c7d6-4e8a-8941-b8d03016b322"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {1, 1, 1, 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        FractionBox[
         RowBox[{
          FractionBox["1", "2"], "-", 
          FractionBox[
           RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
         SqrtBox["7"]], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           FractionBox["3", "2"], "+", 
           FractionBox[
            RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
          SqrtBox["7"]]}]},
       {"0", "0", 
        FractionBox[
         RowBox[{
          FractionBox["3", "2"], "-", 
          FractionBox[
           RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
         SqrtBox["7"]], 
        FractionBox[
         RowBox[{
          FractionBox["1", "2"], "+", 
          FractionBox[
           RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
         SqrtBox["7"]]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[Rational[1, 2], Rational[-3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[-3, 2], Rational[-3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[1, 2], Rational[3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[3, 2], Rational[-3, 2]] 7^Rational[-1, 2]}}]]]], 
   ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"1", "-", 
           RowBox[{"3", " ", "\[ImaginaryI]"}]}], 
          SqrtBox["38"]]}], 
        SqrtBox[
         FractionBox["14", "19"]], "0"},
       {"0", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox["14", "19"]]}], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"3", " ", "\[ImaginaryI]"}]}], 
          SqrtBox["38"]]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[-1, 3] 38^Rational[-1, 2], Rational[14, 19]^Rational[1, 2],
          Complex[-1, -3] 38^Rational[-1, 2], -
         Rational[14, 19]^Rational[1, 2], 1}}]]]]}], "}"}]], "Output",
 CellChangeTimes->{{3.825746704250867*^9, 3.8257467090607357`*^9}, {
   3.825747136257801*^9, 3.825747162893362*^9}, {3.8257479538514843`*^9, 
   3.825747982333927*^9}, {3.825748809671051*^9, 3.825748857103544*^9}, 
   3.8257493489907618`*^9, {3.825749438502316*^9, 3.825749444453644*^9}, 
   3.825749487151297*^9, 3.826055279806766*^9, {3.826144775956691*^9, 
   3.826144791071947*^9}, 3.826144943419928*^9, 3.8263297186301537`*^9, 
   3.826329787136766*^9, 3.826333661684312*^9},
 CellLabel->
  "Out[268]=",ExpressionUUID->"167f8f6d-fd1b-4bfb-b80b-b45cb751b11a"]
}, Open  ]],

Cell[TextData[{
 "The two-level matrices are written in terms of the controlled-U and CNOT \
gate, again showing the first four. The first of the list ",
 StyleBox["twl", "Input"],
 " happens to be the identity matrix in this case, and it is excluded in the \
further analysis."
}], "Text",
 CellChangeTimes->{{3.8257479847923203`*^9, 3.825748021168288*^9}, {
  3.8261448951598997`*^9, 3.8261449141250067`*^9}, {3.8261449655586348`*^9, 
  3.826144997135497*^9}},ExpressionUUID->"c762f480-3826-4392-82d0-\
39cebcd912b0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gates", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"GrayTwoLevelU", "[", 
      RowBox[{"#", ",", 
       RowBox[{"S", "@", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], "&"}], "/@", 
    RowBox[{"Rest", "[", "twl", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"gates", "[", 
  RowBox[{"[", 
   RowBox[{";;", "3"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.825748027256527*^9, 3.825748086593872*^9}, {
  3.8257483258918753`*^9, 3.825748330616753*^9}, {3.825748877043056*^9, 
  3.825748900283119*^9}, {3.825749361005823*^9, 3.825749367473579*^9}, {
  3.826144764609969*^9, 3.82614476830916*^9}, {3.82614488448398*^9, 
  3.826144884583796*^9}, {3.826144945962186*^9, 3.826144946051495*^9}},
 CellLabel->
  "In[269]:=",ExpressionUUID->"0e19644d-eeb5-45bc-b2bd-03ef0283c7ef"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"{", 
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]], "}"}], ",", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["7"]}]], "-", 
       FractionBox[
        RowBox[{"3", " ", "\[ImaginaryI]", " ", 
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]},
          "Subsuperscript"]}], 
        RowBox[{"2", " ", 
         SqrtBox["7"]}]], "-", 
       FractionBox[
        RowBox[{"3", " ", "\[ImaginaryI]", " ", 
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]},
          "Subsuperscript"]}], 
        RowBox[{"2", " ", 
         SqrtBox["7"]}]], "-", 
       FractionBox[
        RowBox[{"3", " ", "\[ImaginaryI]", " ", 
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]},
          "Subsuperscript"]}], 
        RowBox[{"2", " ", 
         SqrtBox["7"]}]]}], ",", 
      RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{"{", 
        SubscriptBox[
         TemplateBox[{"S"},
          "RowDefault"], 
         TemplateBox[{"2"},
          "RowDefault"]], "}"}], ",", 
       RowBox[{"{", 
        SubscriptBox[
         TemplateBox[{"S"},
          "RowDefault"], 
         TemplateBox[{"1"},
          "RowDefault"]], "}"}]}], "]"}], ",", 
     RowBox[{"ControlledU", "[", 
      RowBox[{
       RowBox[{"{", 
        SubscriptBox[
         TemplateBox[{"S"},
          "RowDefault"], 
         TemplateBox[{"1"},
          "RowDefault"]], "}"}], ",", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", 
          SqrtBox["38"]]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         SqrtBox[
          FractionBox["14", "19"]], " ", 
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]},
          "Subsuperscript"]}], "-", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", 
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Subsuperscript"]}], 
         SqrtBox["38"]]}], ",", 
       RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{"{", 
        SubscriptBox[
         TemplateBox[{"S"},
          "RowDefault"], 
         TemplateBox[{"2"},
          "RowDefault"]], "}"}], ",", 
       RowBox[{"{", 
        SubscriptBox[
         TemplateBox[{"S"},
          "RowDefault"], 
         TemplateBox[{"1"},
          "RowDefault"]], "}"}]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"{", 
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]], "}"}], ",", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["5", 
         RowBox[{"14", " ", 
          SqrtBox["2"]}]]}], "+", 
       RowBox[{
        FractionBox["3", "14"], " ", "\[ImaginaryI]", " ", 
        SqrtBox["19"], " ", 
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"], 
          TemplateBox[{"\"y\""}, "RowDefault"]},
         "Subsuperscript"]}], "-", 
       FractionBox[
        RowBox[{"5", " ", "\[ImaginaryI]", " ", 
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]},
          "Subsuperscript"]}], 
        RowBox[{"14", " ", 
         SqrtBox["2"]}]]}], ",", 
      RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.82574889199146*^9, 3.825748903081205*^9}, {
   3.825749367911175*^9, 3.825749371866715*^9}, 3.8257495822269363`*^9, 
   3.8257502040369663`*^9, 3.8260552817099047`*^9, {3.82614476900635*^9, 
   3.826144777345052*^9}, 3.826144884929125*^9, 3.826144946419512*^9, 
   3.8263297186747*^9, 3.826329789126072*^9, 3.826333661732266*^9},
 CellLabel->
  "Out[270]=",ExpressionUUID->"80469a25-c1ae-4afa-a18b-1fffe8a7bbed"]
}, Open  ]],

Cell["\<\
This shows the overall quantum circuit model. Here the same label \
\[OpenCurlyDoubleQuote]U\[CloseCurlyDoubleQuote] has been used for different \
controlled-U gates just for \[LineSeparator]convenience. Do not forget to \
reverse the order before plugging the gates in the quantum circuit model.\
\>", "Text",
 CellChangeTimes->{{3.825749192017633*^9, 3.825749250522294*^9}, {
   3.825750212530529*^9, 3.825750306422181*^9}, 
   3.826329791115192*^9},ExpressionUUID->"a37bc400-a813-4061-8732-\
8b746194a448"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuissoCircuit", "@@", 
   RowBox[{"Reverse", "@", 
    RowBox[{"Flatten", "[", "gates", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.825748088994731*^9, 3.825748093951063*^9}, {
  3.825748340134009*^9, 3.8257483643847857`*^9}, {3.8257501672938557`*^9, 
  3.825750168744622*^9}},
 CellLabel->
  "In[271]:=",ExpressionUUID->"c7dd61fe-3679-4604-b55e-44fb7bb074c4"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {13, -1}}, {{0, -2}, {13, -2}}}], {
    LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {1, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -2}, {2, -1}}], 
    DiskBox[{2, -2}, 0.09], {CircleBox[{2, -1}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -1}, {2.2666666666666666`, -1}}, {{
        2, -1.2666666666666666`}, {2, -0.7333333333333334}}}]}}, {
    LineBox[{{3, -1}, {3, -2}}], DiskBox[{3, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {3, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -2}, {4, -1}}], 
    DiskBox[{4, -2}, 0.09], {CircleBox[{4, -1}, 0.26666666666666666], 
     LineBox[{{{3.7333333333333334`, -1}, {4.266666666666667, -1}}, {{
        4, -1.2666666666666666`}, {4, -0.7333333333333334}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {5, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{6, -1}, {6, -2}}], DiskBox[{6, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {6, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {7, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{8, -1}, {8, -2}}], DiskBox[{8, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -2.4}, {8.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {8, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{9, -2}, {9, -1}}], 
    DiskBox[{9, -2}, 0.09], {CircleBox[{9, -1}, 0.26666666666666666], 
     LineBox[{{{8.733333333333333, -1}, {9.266666666666667, -1}}, {{
        9, -1.2666666666666666`}, {9, -0.7333333333333334}}}]}}, {
    LineBox[{{10, -1}, {10, -2}}], DiskBox[{10, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -2.4}, {10.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {10, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{11, -2}, {11, -1}}], 
    DiskBox[{11, -2}, 0.09], {CircleBox[{11, -1}, 0.26666666666666666], 
     LineBox[{{{10.733333333333333`, -1}, {11.266666666666667`, -1}}, {{
        11, -1.2666666666666666`}, {11, -0.7333333333333334}}}]}}, {
    LineBox[{{12, -1}, {12, -2}}], DiskBox[{12, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{11.6, -2.4}, {12.4, -1.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {12, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->514.8000000000001]], "Output",
 CellChangeTimes->{{3.825748095779315*^9, 3.8257480982375097`*^9}, {
   3.825748334308405*^9, 3.825748366479651*^9}, 3.8257488601340857`*^9, 
   3.825748909430749*^9, 3.8257492519119377`*^9, 3.8257493738164186`*^9, 
   3.825750084412476*^9, {3.825750169967392*^9, 3.82575020587319*^9}, 
   3.825750315779475*^9, 3.826055284069018*^9, 3.826144949652862*^9, 
   3.8263297187163887`*^9, 3.826329792916909*^9, 3.826333661782683*^9},
 CellLabel->
  "Out[271]=",ExpressionUUID->"b55cd683-5895-4a2c-a1f7-03da6b9eb89f"]
}, Open  ]],

Cell["\<\
Check the above quantum circuit by converting it into the matrix \
representation.\
\>", "Text",
 CellChangeTimes->{{3.8257503369239273`*^9, 
  3.825750362199614*^9}},ExpressionUUID->"9ad5e768-cc99-4d70-bbba-\
3dab12973a1e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{"Matrix", "[", "qc", "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.825749254419982*^9, 3.8257492958448477`*^9}, {
  3.8257493343548517`*^9, 3.825749338962596*^9}},
 CellLabel->
  "In[272]:=",ExpressionUUID->"5c8cfbf7-22e5-4a08-97d5-57c06e1cea61"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 4, 8, 12, 16}, {{1}, {2}, {3}, {4}, {1}, {2}, {3}, {4}, {1}, {
       2}, {3}, {4}, {1}, {2}, {3}, {4}}}, {
      Complex[Rational[-1, 2], Rational[-5, 6]] 2^Rational[-1, 2], 
       Complex[Rational[-1, 6], Rational[1, 2]] 2^Rational[-1, 2], 
       Complex[Rational[-1, 6], Rational[1, 2]] 2^Rational[-1, 2], 
       Complex[Rational[1, 2], Rational[-1, 2]] 2^Rational[-1, 2], 
       Complex[Rational[1, 6], Rational[-1, 2]] 2^Rational[-1, 2], 
       Complex[Rational[1, 2], Rational[1, 6]] 2^Rational[-1, 2], 
       Complex[Rational[-1, 2], Rational[-5, 6]] 2^Rational[-1, 2], 
       Complex[Rational[-1, 2], Rational[-1, 2]] 2^Rational[-1, 2], 
       Complex[Rational[1, 6], Rational[-1, 2]] 2^Rational[-1, 2], 
       Complex[Rational[-1, 2], Rational[-5, 6]] 2^Rational[-1, 2], 
       Complex[Rational[1, 2], Rational[1, 6]] 2^Rational[-1, 2], 
       Complex[Rational[-1, 2], Rational[-1, 2]] 2^Rational[-1, 2], 
       Complex[Rational[1, 2], Rational[-1, 2]] 2^Rational[-1, 2], 
       Complex[Rational[1, 2], Rational[1, 2]] 2^Rational[-1, 2], 
       Complex[Rational[1, 2], Rational[1, 2]] 2^Rational[-1, 2], 
       Complex[Rational[-1, 2], Rational[1, 2]] 
       2^Rational[-1, 2]}}]]]]], "Output",
 CellChangeTimes->{{3.825749267248691*^9, 3.82574929629888*^9}, 
   3.825749339360044*^9, {3.825749375165617*^9, 3.8257493997653303`*^9}, 
   3.8257501712236433`*^9, 3.8257502076375837`*^9, 3.825750316882627*^9, 
   3.825750363653665*^9, 3.8260552859632196`*^9, 3.826144951196773*^9, 
   3.8263297188711348`*^9, 3.8263297945692863`*^9, 3.826333661933935*^9},
 CellLabel->
  "Out[273]//MatrixForm=",ExpressionUUID->"bf33c71c-4168-4593-a498-\
a6d337700f93"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"new", "-", "matU"}], "//", "Simplify"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.825749378536199*^9, 3.82574942461269*^9}},
 CellLabel->
  "In[274]:=",ExpressionUUID->"d5da649f-8eaf-4db0-872b-470c4892c285"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.825749380770463*^9, 3.825749424852693*^9}, 
   3.8257501721929007`*^9, 3.825750208542255*^9, 3.825750317585885*^9, 
   3.825750365184527*^9, 3.8260552874581747`*^9, 3.826144952008738*^9, 
   3.826329718924679*^9, 3.826329796306614*^9, 3.826333661941923*^9},
 CellLabel->
  "Out[274]//MatrixForm=",ExpressionUUID->"e444e1a0-c4a6-439b-a9c2-\
ef45e3992b51"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Multi-Qubit Controlled Gates", "Section",
 CellChangeTimes->{{3.81866689472717*^9, 
  3.818666920601658*^9}},ExpressionUUID->"e6eee955-95c5-4ff8-b4bc-\
ab9efcbd3a4c"],

Cell[CellGroupData[{

Cell["This is a three-qubit controlled-U gate.", "MathCaption",
 CellChangeTimes->{{3.826147550561845*^9, 
  3.826147568155792*^9}},ExpressionUUID->"96411d32-1277-4d4c-9750-\
fbb4773e5e49"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuissoCircuit", "[", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"4", ",", "1"}], "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8189167115205383`*^9, 3.8189167694392633`*^9}, {
   3.8262257626106377`*^9, 3.826225774972527*^9}, {3.8262259718606453`*^9, 
   3.8262259972050257`*^9}, {3.826226034947607*^9, 3.826226042146637*^9}, {
   3.8262260948965273`*^9, 3.826226100677535*^9}, {3.8262263282424593`*^9, 
   3.8262263315490637`*^9}, 3.8263298012850437`*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"647fe4eb-2dab-482e-9360-37659dc64fa6"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
    0, -4}, {2, -4}}}], {LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}}], 
    DiskBox[{1, -1}, 0.09], DiskBox[{1, -2}, 0.09], DiskBox[{1, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.2],
      FontWeight->"Light",
      FontSlant->Italic], {1, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8]], "Output",
 CellChangeTimes->{{3.818916759762372*^9, 3.818916769750588*^9}, 
   3.81968573937654*^9, 3.819804670434827*^9, 3.822806032935378*^9, 
   3.826147569530287*^9, {3.826225764785495*^9, 3.826225775653277*^9}, 
   3.82622620159033*^9, {3.82622633268637*^9, 3.8262263343768167`*^9}, 
   3.8263297189688673`*^9, 3.826329802136222*^9, 3.826333661983268*^9, 
   3.826337984634652*^9, 3.826338065593441*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"d9295236-15ba-42ec-bbef-0b4a76edb025"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Gray Code", "Subsection",
 CellChangeTimes->{{3.818893169096167*^9, 
  3.818893171593217*^9}},ExpressionUUID->"7b694882-15a8-4eee-846a-\
163ea3dcd26d"],

Cell[CellGroupData[{

Cell["Consider a three-qubit register as an example.", "MathCaption",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.81889429261147*^9, 
  3.8188943119376993`*^9}},ExpressionUUID->"7cb3e065-f9ff-4e28-929d-\
b4d1c5e0ae2c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$L", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jj", "=", 
   RowBox[{"Range", "[", "$L", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"S", "[", 
    RowBox[{"jj", ",", "None"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.818893283491221*^9, 3.818893283506422*^9}, {
  3.819805575972657*^9, 3.819805595994481*^9}, {3.819805666520472*^9, 
  3.8198056666082563`*^9}, {3.8238447723311777`*^9, 3.8238447923670588`*^9}},
 CellLabel->"In[10]:=",
 CellID->947038696,ExpressionUUID->"0d19ce3b-6693-49d4-822f-5a1c1b5140d2"],

Cell["This is the gate to operate on the target qubit.", "Text",
 CellChangeTimes->{{3.823844785210973*^9, 
  3.823844833797674*^9}},ExpressionUUID->"a3f69057-086f-466f-8a98-\
25a52619789f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"T", "=", 
   RowBox[{"S", "[", 
    RowBox[{
     RowBox[{"$L", "+", "1"}], ",", "None"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"op", "=", 
  RowBox[{"QuissoRotation", "[", 
   RowBox[{
    RowBox[{"Pi", "/", "3"}], ",", 
    RowBox[{"T", "[", "1", "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.819829465572304*^9, 3.8198294692161503`*^9}, {
  3.819829875827592*^9, 3.819829876097042*^9}, {3.819841779396325*^9, 
  3.819841779485509*^9}, {3.82384476237543*^9, 3.823844794469706*^9}},
 CellLabel->"In[13]:=",
 CellID->1878055755,ExpressionUUID->"10dd29bc-7c3b-4e0a-a16a-ff97918cc7a0"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SqrtBox["3"], "2"], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"4"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"]}], "2"]}]], "Output",
 CellChangeTimes->{
  3.818893284665743*^9, {3.818893330761344*^9, 3.818893351021337*^9}, {
   3.818893435498892*^9, 3.8188934632976913`*^9}, 3.81889376962414*^9, 
   3.8188939623543997`*^9, 3.8188943345612392`*^9, 3.819804678947275*^9, 
   3.819804785153796*^9, {3.8198055771576567`*^9, 3.819805597138835*^9}, 
   3.819805667965893*^9, 3.81980926050988*^9, 3.819810695679517*^9, 
   3.819829272571353*^9, 3.819829469554784*^9, {3.8198298479698267`*^9, 
   3.819829877167535*^9}, {3.819830722809836*^9, 3.819830730914476*^9}, 
   3.819830793498782*^9, 3.8198413284175262`*^9, {3.819841505513599*^9, 
   3.8198415188668213`*^9}, 3.819841558397957*^9, {3.819841771750594*^9, 
   3.819841779941565*^9}, 3.822806038128683*^9, 3.823844776137556*^9, 
   3.823844835176579*^9, 3.824002083199481*^9, 3.826329719012808*^9, 
   3.826329805679606*^9, 3.826333661994231*^9, 3.826337987784843*^9, 
   3.826338068738627*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"0b546b5a-ebf5-4e81-b14b-4c26abfb9e76"]
}, Open  ]],

Cell["\<\
This decomposes the multi-qubit controlled-U gate based on the Gray code -- \
showing only a part of it. Each component is either CNOT or a two-qubit \
controlled-U gate.\
\>", "Text",
 CellChangeTimes->{{3.8188943472948027`*^9, 3.8188944328131*^9}, {
  3.824002063715601*^9, 
  3.824002075245676*^9}},ExpressionUUID->"e6067341-e968-4420-b9b1-\
b0ff59f351ed"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gc", "=", 
   RowBox[{"GrayControlledU", "[", 
    RowBox[{"cc", ",", "op"}], "]"}]}], ";", " ", 
  RowBox[{"gc", "[", 
   RowBox[{"[", 
    RowBox[{";;", "3"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.819810620941033*^9, 3.81981062332524*^9}, {
  3.819810909968203*^9, 3.819810912171507*^9}, {3.819810979457185*^9, 
  3.819810981233572*^9}, {3.81982926383746*^9, 3.819829267672181*^9}, {
  3.819841575751299*^9, 3.819841579013205*^9}, {3.81984162951612*^9, 
  3.8198416298737793`*^9}, {3.823844842134853*^9, 3.823844844676456*^9}},
 CellLabel->"In[15]:=",
 CellID->1697248997,ExpressionUUID->"c4bfd11f-1235-4f0f-8848-85472af42874"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["2", 
          RowBox[{"1", "/", "4"}]], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "24"]}]]}], "+", 
        RowBox[{
         SuperscriptBox["2", 
          RowBox[{"1", "/", "4"}]], " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "24"]]}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["2", 
         RowBox[{"1", "/", "4"}]]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "4"}]], " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "24"]}]]}], "-", 
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "4"}]], " ", 
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "24"]]}]}], ")"}], " ", 
        
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["2", 
         RowBox[{"1", "/", "4"}]]}]]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"V\"\>"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]], "}"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]], "}"}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["2", 
          RowBox[{"1", "/", "4"}]], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "24"]}]]}], "+", 
        RowBox[{
         SuperscriptBox["2", 
          RowBox[{"1", "/", "4"}]], " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "24"]]}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["2", 
         RowBox[{"1", "/", "4"}]]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["2", 
             RowBox[{"1", "/", "4"}]]}], " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "24"]}]]}], "+", 
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "4"}]], " ", 
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "24"]]}]}], ")"}], " ", 
        
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["2", 
         RowBox[{"1", "/", "4"}]]}]]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", 
      TemplateBox[{"\"V\"", "\"\[Dagger]\""},
       "Superscript"]}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8188932855121202`*^9, {3.818893331545569*^9, 3.818893351751349*^9}, {
   3.8188934361801147`*^9, 3.818893464167491*^9}, 3.818893606356101*^9, 
   3.818893770498527*^9, 3.818893963000091*^9, 3.818894023716249*^9, 
   3.818894335537856*^9, 3.8188943841749487`*^9, 3.818894437840238*^9, 
   3.819804681085297*^9, 3.819804787015271*^9, {3.819805578782106*^9, 
   3.8198055986636457`*^9}, 3.81980566973525*^9, 3.819809262188201*^9, 
   3.819810627509006*^9, {3.819810690029333*^9, 3.819810701586196*^9}, 
   3.8198109125679502`*^9, 3.819810981766224*^9, {3.819829274209483*^9, 
   3.819829300052457*^9}, 3.8198294715225477`*^9, 3.8198297435230017`*^9, {
   3.819829863670824*^9, 3.819829878896983*^9}, 3.819830351160308*^9, 
   3.819830733327448*^9, 3.819830794845769*^9, 3.81983095304914*^9, 
   3.819831165547159*^9, 3.8198412493557167`*^9, 3.8198413303115873`*^9, {
   3.819841506944438*^9, 3.8198415206707373`*^9}, {3.8198415599694777`*^9, 
   3.8198415793184958`*^9}, 3.819841630413694*^9, 3.819841781959922*^9, 
   3.822806041162003*^9, {3.823844837210807*^9, 3.8238448451804323`*^9}, {
   3.824002077181522*^9, 3.824002084643756*^9}, 3.826329719116233*^9, 
   3.826329807256784*^9, 3.826333662094349*^9, 3.826337989647564*^9, 
   3.826338070281982*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"fa5a2a20-7dad-4767-b2a9-062134a284f6"]
}, Open  ]],

Cell["This is a quantum circuit model of the decomposition.", "Text",
 CellChangeTimes->{{3.81889444060893*^9, 
  3.8188944526572933`*^9}},ExpressionUUID->"bf813263-6327-493f-9ca7-\
1e98201d6ba0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuissoCircuit", "[", "gc", "]"}]}]], "Input",
 CellChangeTimes->{{3.81889347383357*^9, 3.818893474496975*^9}, {
   3.8188939829501543`*^9, 3.818893985727943*^9}, 3.826329813782613*^9},
 CellLabel->"In[16]:=",
 CellID->2133712687,ExpressionUUID->"811cc859-6537-44a2-a792-7dce5126894c"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {14, -1}}, {{0, -2}, {14, -2}}, {{0, -3}, {14, -3}}, {{
    0, -4}, {14, -4}}}], {LineBox[{{1, -1}, {1, -4}}], DiskBox[{1, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, InsetBox[
     StyleBox["\<\"V\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {1, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
    LineBox[{{3, -2}, {3, -4}}], DiskBox[{3, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, InsetBox[
     StyleBox[
      TemplateBox[{"\"V\"", "\"\[Dagger]\""},
       "Superscript"],
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {3, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -1}, {4, -2}}], 
    DiskBox[{4, -1}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
     LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
        4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {
    LineBox[{{5, -2}, {5, -4}}], DiskBox[{5, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, InsetBox[
     StyleBox["\<\"V\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {5, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{6, -2}, {6, -3}}], 
    DiskBox[{6, -2}, 0.09], {CircleBox[{6, -3}, 0.26666666666666666], 
     LineBox[{{{5.733333333333333, -3}, {6.266666666666667, -3}}, {{
        6, -3.2666666666666666`}, {6, -2.7333333333333334`}}}]}}, {
    LineBox[{{7, -3}, {7, -4}}], DiskBox[{7, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
     StyleBox[
      TemplateBox[{"\"V\"", "\"\[Dagger]\""},
       "Superscript"],
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {7, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{8, -1}, {8, -3}}], 
    DiskBox[{8, -1}, 0.09], {CircleBox[{8, -3}, 0.26666666666666666], 
     LineBox[{{{7.733333333333333, -3}, {8.266666666666667, -3}}, {{
        8, -3.2666666666666666`}, {8, -2.7333333333333334`}}}]}}, {
    LineBox[{{9, -3}, {9, -4}}], DiskBox[{9, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -4.4}, {9.4, -3.6}]}, InsetBox[
     StyleBox["\<\"V\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {9, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{10, -2}, {10, -3}}], 
    DiskBox[{10, -2}, 0.09], {CircleBox[{10, -3}, 0.26666666666666666], 
     LineBox[{{{9.733333333333333, -3}, {10.266666666666667`, -3}}, {{
        10, -3.2666666666666666`}, {10, -2.7333333333333334`}}}]}}, {
    LineBox[{{11, -3}, {11, -4}}], DiskBox[{11, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{10.6, -4.4}, {11.4, -3.6}]}, InsetBox[
     StyleBox[
      TemplateBox[{"\"V\"", "\"\[Dagger]\""},
       "Superscript"],
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {11, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{12, -1}, {12, -3}}], 
    DiskBox[{12, -1}, 0.09], {CircleBox[{12, -3}, 0.26666666666666666], 
     LineBox[{{{11.733333333333333`, -3}, {12.266666666666667`, -3}}, {{
        12, -3.2666666666666666`}, {12, -2.7333333333333334`}}}]}}, {
    LineBox[{{13, -3}, {13, -4}}], DiskBox[{13, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{12.6, -4.4}, {13.4, -3.6}]}, InsetBox[
     StyleBox["\<\"V\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {13, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->550.8000000000001]], "Output",
 CellChangeTimes->{
  3.818893286699377*^9, {3.8188933322832117`*^9, 3.818893354175539*^9}, {
   3.8188934369079123`*^9, 3.8188934751510487`*^9}, {3.818893891793996*^9, 
   3.818893906079411*^9}, {3.8188939669659767`*^9, 3.818893987755803*^9}, 
   3.818894024702594*^9, 3.818894336388372*^9, 3.819804686997624*^9, 
   3.81980478887497*^9, {3.8198055805950737`*^9, 3.8198056020894833`*^9}, 
   3.819805677140562*^9, 3.819809269755013*^9, 3.819810703369684*^9, 
   3.819810916961071*^9, 3.819810985980136*^9, 3.8198294799137707`*^9, {
   3.8198298671734743`*^9, 3.819829883941502*^9}, {3.819830821742236*^9, 
   3.819830830959455*^9}, 3.819830954943733*^9, 3.8198311690817738`*^9, 
   3.819841256629427*^9, 3.819841337435464*^9, 3.8198415244560328`*^9, {
   3.8198415618172693`*^9, 3.819841583361848*^9}, 3.819841632013712*^9, 
   3.8198417837466373`*^9, 3.822806043254528*^9, 3.8238448624699707`*^9, 
   3.824002086620577*^9, 3.8263297191640387`*^9, {3.82632980899685*^9, 
   3.82632981421809*^9}, 3.8263336621386757`*^9, 3.8263380733732224`*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"49775c7c-6b1b-4fb5-9488-96a7e4d81bf8"]
}, Open  ]],

Cell["Finally check the result.", "Text",
 CellChangeTimes->{{3.818894461825387*^9, 
  3.818894467236657*^9}},ExpressionUUID->"35d7666c-b5ee-4ad7-9186-\
e86da9e2e488"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"expr", "=", 
   RowBox[{"QuissoExpression", "[", "qc", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expr2", "=", 
   RowBox[{"QuissoControlledU", "[", 
    RowBox[{"cc", ",", "op"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expr", "-", "expr2"}], "//", "Garner"}]}], "Input",
 CellChangeTimes->{{3.819805622386992*^9, 3.819805638923142*^9}, {
   3.819805682566461*^9, 3.819805702630868*^9}, {3.8198107410659237`*^9, 
   3.8198107632935247`*^9}, 3.819829488880768*^9, {3.8198416402805643`*^9, 
   3.819841643115018*^9}, {3.8238448754447937`*^9, 3.82384487679424*^9}},
 CellLabel->"In[17]:=",
 CellID->818174054,ExpressionUUID->"d982bf28-e442-4a62-9e5f-f17c0c83722d"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.8188933624626226`*^9, {3.818893438339155*^9, 3.818893466608199*^9}, {
   3.8188939759181767`*^9, 3.818893989267692*^9}, 3.8188940263355513`*^9, 
   3.818894338721209*^9, 3.8188944704103203`*^9, 3.8198047971629457`*^9, {
   3.819805606305785*^9, 3.819805639283317*^9}, {3.819805685565786*^9, 
   3.8198057041616364`*^9}, 3.8198106434063263`*^9, 3.819810706092255*^9, {
   3.819810748398739*^9, 3.819810766783964*^9}, 3.8198109912429113`*^9, {
   3.819829485263402*^9, 3.819829489745191*^9}, {3.819829869489457*^9, 
   3.819829893112516*^9}, 3.819830864511333*^9, 3.819831179763674*^9, 
   3.8198412792016907`*^9, 3.819841354448694*^9, {3.81984153981325*^9, 
   3.819841585855583*^9}, {3.819841633832597*^9, 3.81984164416969*^9}, 
   3.81984178567155*^9, 3.822806046708206*^9, 3.82384487895321*^9, 
   3.8240020897090178`*^9, 3.826329720587729*^9, 3.826329816758874*^9, 
   3.82633366351337*^9, 3.826338076615706*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"12728580-98ca-46cb-89d5-29218e3c5445"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Multi-Qubit Controlled-NOT", "Subsection",
 CellChangeTimes->{{3.81889314380728*^9, 
  3.8188931636621227`*^9}},ExpressionUUID->"27de8466-be73-4d89-b932-\
1a5586c10007"],

Cell[CellGroupData[{

Cell["\<\
This shows a generalized CNOT gate, controlled by three qubits rather than a \
single qubit.\
\>", "MathCaption",
 CellChangeTimes->{{3.818918732690956*^9, 3.818918799163156*^9}, {
  3.822450581939344*^9, 3.822450595775689*^9}, {3.8261450927791233`*^9, 
  3.826145158138626*^9}},ExpressionUUID->"f1224d59-0d80-4db0-a22e-\
0a681a9db365"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuissoCircuit", "[", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ",", 
     RowBox[{"S", "[", "4", "]"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8189167115205383`*^9, 3.8189167694392633`*^9}, {
   3.818917062283753*^9, 3.818917190965084*^9}, {3.818917228088965*^9, 
   3.818917229426874*^9}, {3.81891731446873*^9, 3.8189173446930017`*^9}, {
   3.8189179622625837`*^9, 3.81891796309404*^9}, {3.8189185624957237`*^9, 
   3.818918678390057*^9}, {3.81980361250066*^9, 3.819803614513054*^9}, {
   3.822450607993363*^9, 3.822450618229458*^9}, {3.824001879894444*^9, 
   3.824001890887953*^9}, {3.824002017594308*^9, 3.824002017795327*^9}, {
   3.826145056275401*^9, 3.8261450626760387`*^9}, 3.826329821376112*^9},
 CellLabel->
  "In[286]:=",ExpressionUUID->"837e328e-6e89-4936-b84c-50e6d66b7125"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
    0, -4}, {2, -4}}}], {LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}}], 
    DiskBox[{1, -1}, 0.09], DiskBox[{1, -2}, 0.09], 
    DiskBox[{1, -3}, 0.09], {CircleBox[{1, -4}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -4}, {1.2666666666666666`, -4}}, {{
        1, -4.266666666666667}, {1, -3.7333333333333334`}}}]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8]], "Output",
 CellChangeTimes->{{3.818918659250866*^9, 3.8189187152026663`*^9}, {
   3.818918790763978*^9, 3.8189188027530117`*^9}, 3.818921210897138*^9, 
   3.819804673637415*^9, {3.8224506232048683`*^9, 3.822450634015456*^9}, 
   3.8228060343507032`*^9, 3.8240018924751673`*^9, 3.8240019466574287`*^9, 
   3.8240020200161343`*^9, {3.826145063365099*^9, 3.82614506495258*^9}, {
   3.826145160009324*^9, 3.826145165569203*^9}, 3.826329720709202*^9, 
   3.826329821772766*^9, 3.826333663624393*^9},
 CellLabel->
  "Out[286]=",ExpressionUUID->"221aa819-873e-4ca7-b1b0-2fe6d3fe94e7"]
}, Open  ]],

Cell["\<\
Here is the explicit expression of the multi-qubit CNOT gate in terms of the \
Pauli operators.\
\>", "Text",
 CellChangeTimes->{{3.826145201010715*^9, 
  3.82614524072114*^9}},ExpressionUUID->"9ef47557-2912-47bd-bd01-\
9a885bb44186"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"QuissoExpression", "[", "qc", "]"}]}]], "Input",
 CellChangeTimes->{{3.81891820973888*^9, 3.818918294860776*^9}, {
   3.818918363608721*^9, 3.818918390493059*^9}, {3.8189188817573233`*^9, 
   3.81891891249025*^9}, 3.824001900384553*^9, {3.826145255572693*^9, 
   3.826145255694799*^9}},
 CellLabel->
  "In[287]:=",ExpressionUUID->"652335da-6553-413c-bdc2-88af6fbb8d7b"],

Cell[BoxData[
 RowBox[{
  FractionBox["7", "8"], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], "8"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], "8"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"3"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], "8"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"4"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], "8"]}]], "Output",
 CellChangeTimes->{
  3.8240019014059563`*^9, 3.824001948706102*^9, 3.824002024498931*^9, {
   3.826145242140149*^9, 3.826145256052638*^9}, 3.826329720754607*^9, 
   3.826329823896707*^9, 3.826333663655777*^9},
 CellLabel->
  "Out[287]=",ExpressionUUID->"7511e44c-f21f-416d-9e92-7165f2c01c47"]
}, Open  ]],

Cell["\<\
Here we compare it with the expression explicitly constructed in terms of a \
projection operator.\
\>", "Text",
 CellChangeTimes->{{3.8189188284339943`*^9, 3.8189188767731543`*^9}, {
  3.826145287058618*^9, 3.826145288026266*^9}, {3.8261453272421427`*^9, 
  3.8261453403252363`*^9}},ExpressionUUID->"cca3c7c0-fc0c-4173-88fd-\
17b637c58d14"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"prj", "=", 
   RowBox[{"Multiply", "@@", 
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "11"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "prj"}], ")"}], "+", 
   RowBox[{"prj", "**", 
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "1"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "-", "new"}], "//", "Elaborate"}]}], "Input",
 CellChangeTimes->{{3.81891820973888*^9, 3.818918294860776*^9}, {
  3.818918363608721*^9, 3.818918390493059*^9}, {3.8189188817573233`*^9, 
  3.81891891249025*^9}, {3.824001900384553*^9, 3.824001912061225*^9}, {
  3.826145271781987*^9, 3.826145302482169*^9}},
 CellLabel->
  "In[288]:=",ExpressionUUID->"bb47bb06-d1c1-40c7-ab9b-aaf34f0a3fd5"],

Cell[BoxData[
 RowBox[{"1", "-", 
  TagBox[
   RowBox[{
    TagBox[
     SubscriptBox[
      TagBox[
       RowBox[{"(", 
        RowBox[{
         TemplateBox[{"1"},
          "Ket"], 
         TemplateBox[{"1"},
          "Bra"]}], ")"}],
       DisplayForm], 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]]],
     DisplayForm], 
    TagBox[
     SubscriptBox[
      TagBox[
       RowBox[{"(", 
        RowBox[{
         TemplateBox[{"1"},
          "Ket"], 
         TemplateBox[{"1"},
          "Bra"]}], ")"}],
       DisplayForm], 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]]],
     DisplayForm], 
    TagBox[
     SubscriptBox[
      TagBox[
       RowBox[{"(", 
        RowBox[{
         TemplateBox[{"1"},
          "Ket"], 
         TemplateBox[{"1"},
          "Bra"]}], ")"}],
       DisplayForm], 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"3"},
        "RowDefault"]]],
     DisplayForm]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     SubscriptBox[
      TagBox[
       RowBox[{"(", 
        RowBox[{
         TemplateBox[{"1"},
          "Ket"], 
         TemplateBox[{"1"},
          "Bra"]}], ")"}],
       DisplayForm], 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]]],
     DisplayForm], 
    TagBox[
     SubscriptBox[
      TagBox[
       RowBox[{"(", 
        RowBox[{
         TemplateBox[{"1"},
          "Ket"], 
         TemplateBox[{"1"},
          "Bra"]}], ")"}],
       DisplayForm], 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"2"},
        "RowDefault"]]],
     DisplayForm], 
    TagBox[
     SubscriptBox[
      TagBox[
       RowBox[{"(", 
        RowBox[{
         TemplateBox[{"1"},
          "Ket"], 
         TemplateBox[{"1"},
          "Bra"]}], ")"}],
       DisplayForm], 
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"3"},
        "RowDefault"]]],
     DisplayForm], 
    TagBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"4"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"],
     DisplayForm]}],
   DisplayForm]}]], "Output",
 CellChangeTimes->{{3.818918219137451*^9, 3.818918233198244*^9}, {
   3.818918263911606*^9, 3.818918295233986*^9}, {3.818918384936501*^9, 
   3.818918396936674*^9}, {3.818918485541746*^9, 3.818918523052661*^9}, {
   3.818918885331209*^9, 3.8189189161724367`*^9}, 3.818921212245525*^9, 
   3.819804675563073*^9, 3.8224506362817163`*^9, 3.8228060355910177`*^9, {
   3.824001902556982*^9, 3.82400191242992*^9}, {3.8240019500533257`*^9, 
   3.8240019614618998`*^9}, 3.824002026125411*^9, {3.826145302930238*^9, 
   3.82614530555649*^9}, 3.826145342341897*^9, 3.826329720767714*^9, 
   3.826329825488207*^9, 3.826333663667557*^9},
 CellLabel->
  "Out[289]=",ExpressionUUID->"541c8318-8155-41c4-92c5-1ba01bf219ea"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.818918219137451*^9, 3.818918233198244*^9}, {
   3.818918263911606*^9, 3.818918295233986*^9}, {3.818918384936501*^9, 
   3.818918396936674*^9}, {3.818918485541746*^9, 3.818918523052661*^9}, {
   3.818918885331209*^9, 3.8189189161724367`*^9}, 3.818921212245525*^9, 
   3.819804675563073*^9, 3.8224506362817163`*^9, 3.8228060355910177`*^9, {
   3.824001902556982*^9, 3.82400191242992*^9}, {3.8240019500533257`*^9, 
   3.8240019614618998`*^9}, 3.824002026125411*^9, {3.826145302930238*^9, 
   3.82614530555649*^9}, 3.826145342341897*^9, 3.826329720767714*^9, 
   3.826329825488207*^9, 3.8263336637055187`*^9},
 CellLabel->
  "Out[290]=",ExpressionUUID->"9b061f98-f259-4408-b4c6-2ecb699af09a"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell["Universal Quantum Computation", "Section",
 CellChangeTimes->{{3.818666927272718*^9, 
  3.818666931761381*^9}},ExpressionUUID->"16cd1aa2-c57d-441e-b1fa-\
9dbd1778f8d9"],

Cell[CellGroupData[{

Cell["Measurement", "Section",
 CellChangeTimes->{{3.820447073262347*^9, 
  3.820447074352992*^9}},ExpressionUUID->"e33fb164-f8c9-42fa-a016-\
bc5dd211017e"],

Cell[CellGroupData[{

Cell["First consider a measurement in the logical basis.", "MathCaption",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.8238450133175592`*^9, 
  3.8238450485168943`*^9}},ExpressionUUID->"1f2f73f0-4729-486e-8d90-\
c0b19240d74b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{"ProductState", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c", "[", "0", "]"}], ",", 
       RowBox[{"c", "[", "1", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuissoCircuit", "[", 
   RowBox[{"vec", ",", "\"\<Spacer\>\"", ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", "1", "]"}], "]"}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "0"}], "}"}], ",", "None"}], "}"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.820447096291321*^9, 3.820447194676956*^9}, {
   3.820447327297188*^9, 3.820447408449109*^9}, {3.8204474886979856`*^9, 
   3.820447499974351*^9}, {3.820450865714097*^9, 3.820450872732604*^9}, {
   3.820450904343988*^9, 3.820450909247834*^9}, 3.820451804524008*^9, {
   3.8238449628418713`*^9, 3.823844975833672*^9}},
 CellLabel->
  "In[291]:=",ExpressionUUID->"525aaa6d-aff1-45fe-9942-f14e2d0b11f9"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{{{2, -1}, {3, -1}}}]}, 
   LineBox[{{{0, -1}, {2, -1}}}], InsetBox[
    StyleBox[
     RowBox[{
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], " ", 
       FormBox[
        SubscriptBox[
         TemplateBox[{"c"},
          "RowDefault"], 
         TemplateBox[{"0"},
          "RowDefault"]],
        TraditionalForm]}], "+", 
      RowBox[{
       TemplateBox[{"1"},
        "Ket"], " ", 
       FormBox[
        SubscriptBox[
         TemplateBox[{"c"},
          "RowDefault"], 
         TemplateBox[{"1"},
          "RowDefault"]],
        TraditionalForm]}]}],
     StripOnInput->False,
     FontSize->Scaled[0.10666666666666667`],
     FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, 
    CircleBox[{2, -1.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{2, -1.2}, {2.24, -0.76}}]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->{{2, 0}, None}]], "Output",
 CellChangeTimes->{{3.820447140586274*^9, 3.8204471619219933`*^9}, {
   3.820447195943852*^9, 3.82044719824786*^9}, {3.820447329350333*^9, 
   3.820447410877399*^9}, {3.820447500308036*^9, 3.820447502514043*^9}, {
   3.820450873529148*^9, 3.820450909598802*^9}, {3.82045180510242*^9, 
   3.820451807315579*^9}, 3.822806048894188*^9, 3.823844977003832*^9, 
   3.823845050039975*^9, 3.82384510593804*^9, 3.824420681033041*^9, 
   3.826329720827373*^9, {3.826329829513109*^9, 3.826329831565793*^9}, 
   3.826333663743339*^9},
 CellLabel->
  "Out[293]=",ExpressionUUID->"6b4d1e33-85c2-45df-aa52-fe5ad8b8f77e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"c", ",", "data"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "=", 
     RowBox[{"1", "/", "2"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], "=", 
     RowBox[{
      RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"data", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"out", "=", 
         RowBox[{"QuissoExpression", "[", "qc", "]"}]}], ";", 
        RowBox[{"Readout", "[", 
         RowBox[{"out", ",", 
          RowBox[{"S", "[", "1", "]"}]}], "]"}]}], ",", "1000"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Histogram", "[", 
     RowBox[{"data", ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<Readout\>\"", ",", "\"\<Counts\>\""}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8204475203975887`*^9, 3.820447746633793*^9}, {
  3.823845067214673*^9, 3.823845068361569*^9}, {3.824420658819088*^9, 
  3.824420663825783*^9}},
 CellLabel->
  "In[294]:=",ExpressionUUID->"27d10c96-b339-4ea7-9f51-e224dec993c8"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
    Opacity[0.6719999999999999], Thickness[Small]}], {}, 
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
     Opacity[0.6719999999999999], Thickness[Small]}], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{-0.5, 0}, {0.5, 268.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{42.1602564102564, 
           107.4551282051282}, {-8.239397735500031, 22.355142558217533`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 268]& ,
        TagBoxNote->"268"],
       StyleBox["268", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[268, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{0.5, 0}, {1.5, 732.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{106.9551282051282, 172.25}, {-60.3433779455185, 
           22.355142558217537`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 732]& ,
        TagBoxNote->"732"],
       StyleBox["732", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[732, {}], "Tooltip"]& ]}, {}, {}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{-0.54, 0},
  AxesStyle->{},
  Frame->True,
  FrameLabel->{{
     FormBox["\"Counts\"", TraditionalForm], None}, {
     FormBox["\"Readout\"", TraditionalForm], None}},
  FrameStyle->Automatic,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Small,
  PlotRange->{{-0.5, 1.5}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {None, 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.823845118281712*^9, 3.8244206843156424`*^9, 
  3.826329723393724*^9, 3.826333666126177*^9},
 CellLabel->
  "Out[294]=",ExpressionUUID->"9c1190ad-a013-4ab1-8993-173da15909e9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Now consider a measurement in the eigen-basis of the Pauli X operator.\
\>", "MathCaption",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.823845151281322*^9, 
  3.823845199293363*^9}},ExpressionUUID->"00d628c7-cc8f-46e9-9789-\
1c7b7b12390b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{"ProductState", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c", "[", "0", "]"}], ",", 
       RowBox[{"c", "[", "1", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuissoCircuit", "[", 
   RowBox[{"vec", ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", "1", "]"}], "]"}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "0"}], "}"}], ",", "None"}], "}"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.820447096291321*^9, 3.820447194676956*^9}, {
   3.820447327297188*^9, 3.820447408449109*^9}, {3.8204474886979856`*^9, 
   3.820447499974351*^9}, {3.820447785995998*^9, 3.820447789009748*^9}, {
   3.820450883535749*^9, 3.8204509242433987`*^9}, 3.8204518126569366`*^9, {
   3.823845142405954*^9, 3.8238451484132767`*^9}},
 CellLabel->
  "In[295]:=",ExpressionUUID->"136c2e79-cf39-4bdf-8561-dfcd73f6f73d"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{{{2, -1}, {3, -1}}}]}, 
   LineBox[{{{0, -1}, {2, -1}}}], InsetBox[
    StyleBox[
     RowBox[{
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], " ", 
       FormBox[
        SubscriptBox[
         TemplateBox[{"c"},
          "RowDefault"], 
         TemplateBox[{"0"},
          "RowDefault"]],
        TraditionalForm]}], "+", 
      RowBox[{
       TemplateBox[{"1"},
        "Ket"], " ", 
       FormBox[
        SubscriptBox[
         TemplateBox[{"c"},
          "RowDefault"], 
         TemplateBox[{"1"},
          "RowDefault"]],
        TraditionalForm]}]}],
     StripOnInput->False,
     FontSize->Scaled[0.10666666666666667`],
     FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, 
    CircleBox[{2, -1.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{2, -1.2}, {2.24, -0.76}}]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->{{2, 0}, None}]], "Output",
 CellChangeTimes->{
  3.820447789404747*^9, 3.820450886711915*^9, {3.820450924619766*^9, 
   3.820450927584999*^9}, 3.8204518131258783`*^9, 3.82384512073866*^9, 
   3.823845202205289*^9, 3.8244206883681507`*^9, 3.826329723542635*^9, 
   3.826333666256782*^9},
 CellLabel->
  "Out[297]=",ExpressionUUID->"344779f7-5ccd-4f7f-bb5f-2cdad2a3576f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"c", ",", "data"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "=", 
     RowBox[{"1", "/", "2"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], "=", 
     RowBox[{
      RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"data", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"out", "=", 
         RowBox[{"QuissoExpression", "[", "qc", "]"}]}], ";", 
        RowBox[{"Readout", "[", 
         RowBox[{"out", ",", 
          RowBox[{"S", "[", "1", "]"}]}], "]"}]}], ",", "1000"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Histogram", "[", 
     RowBox[{"data", ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<Readout\>\"", ",", "\"\<Counts\>\""}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8204475203975887`*^9, 3.820447746633793*^9}, {
  3.8244206919708643`*^9, 3.8244207005893097`*^9}},
 CellLabel->
  "In[298]:=",ExpressionUUID->"099d9590-ffe1-4201-b2aa-535d06ab54f0"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.820447822547071*^9, 3.820451819132718*^9, 
  3.823845127615779*^9, 3.824420706514247*^9, 3.826329729308923*^9, 
  3.826333670169799*^9},
 CellLabel->
  "Out[298]=",ExpressionUUID->"37bc6ba4-e60e-4cba-a0a6-705ff479b8d1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
This is the \"disentangler\" quantum circuit, which is the inverse of the \
entangler quantum circuit .\
\>", "MathCaption",
 CellChangeTimes->{{3.823845265767459*^9, 3.823845315962512*^9}, {
  3.824002118291459*^9, 
  3.824002119796111*^9}},ExpressionUUID->"de83f5e8-7dad-430d-a994-\
5984dc50c454"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"disentangler", "=", 
  RowBox[{"QuissoCircuit", "[", 
   RowBox[{
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.82045054349924*^9, 3.820450745051745*^9}, {
   3.8204508374332027`*^9, 3.820450840458129*^9}, {3.820451022014032*^9, 
   3.820451044893031*^9}, 3.82384532033981*^9},
 CellLabel->
  "In[453]:=",ExpressionUUID->"b675937d-3b75-4735-a4b2-3820ed123780"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {
    LineBox[{{1, -1}, {1, -2}}], 
    DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
        1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {2, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImageSize->Small,
  PlotRangePadding->NCache[{
     Rational[1, 2], 0}, {0.5, 0}]]], "Output",
 CellChangeTimes->{3.823845321888852*^9, 3.824002146221314*^9, 
  3.824420714585251*^9, 3.82632972938535*^9},
 CellLabel->
  "Out[453]=",ExpressionUUID->"bf99cbbf-9e56-40b3-a3b4-da57d8deac4c"]
}, Open  ]],

Cell["\<\
This shows that the disentangler quantum circuit maps the Bell states into \
the logical basis states.\
\>", "Text",
 CellChangeTimes->{{3.8238453349295473`*^9, 
  3.823845377486038*^9}},ExpressionUUID->"518aec85-f82e-45c9-9ce5-\
04fae8b01d4f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"QuissoExpression", "[", "disentangler", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"BellState", "@", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"bs", "\[Rule]", 
     RowBox[{"op", "**", "bs"}]}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.82045054349924*^9, 3.820450745051745*^9}, {
   3.8204508374332027`*^9, 3.820450840458129*^9}, {3.820451022014032*^9, 
   3.820451044893031*^9}, 3.82384532033981*^9},
 CellLabel->
  "In[454]:=",ExpressionUUID->"284736ae-09ed-48c5-a65e-e92651ed7079"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       FractionBox[
        RowBox[{
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], "+", 
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"]}], 
        SqrtBox["2"]], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], "+", 
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"]}], 
        SqrtBox["2"]], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], "-", 
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"]}], 
        SqrtBox["2"]], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], "-", 
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"]}], 
        SqrtBox["2"]], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.820450557245205*^9, {3.820450656469426*^9, 3.820450690107777*^9}, {
   3.820450730291581*^9, 3.820450745330915*^9}, {3.8204508407380953`*^9, 
   3.820450842918436*^9}, 3.820450932016322*^9, {3.820451029898219*^9, 
   3.820451045253353*^9}, 3.8204511292844877`*^9, 3.82045182069986*^9, 
   3.823845329650875*^9, 3.8238453794142637`*^9, 3.824002147503174*^9, 
   3.824420716004243*^9, 3.826329729459651*^9},
 CellLabel->
  "Out[456]//TableForm=",ExpressionUUID->"eb099590-fcf6-41c1-add9-\
f9005ec702c5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["As an example, consider a two-qubit quantum state.", "MathCaption",
 CellChangeTimes->{{3.823845391606567*^9, 
  3.823845407600912*^9}},ExpressionUUID->"2dc4b1da-a102-4a8b-be27-\
3c4f649551b3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], "+", 
    RowBox[{"I", " ", 
     RowBox[{"Ket", "[", 
      RowBox[{
       RowBox[{"S", "[", "1", "]"}], "\[Rule]", "1"}], "]"}]}], "+", 
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], "\[Rule]", "1"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"vec", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.820450980258233*^9, 3.820451076954195*^9}, {
   3.820451380609254*^9, 3.820451398078719*^9}, 3.823845389085147*^9},
 CellLabel->
  "In[457]:=",ExpressionUUID->"6a5ba9cf-57a7-4743-8a42-89690406b2ec"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{
    TagBox[
     TemplateBox[{
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"]]], 
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
   "Ket"], "+", 
  TemplateBox[{
    TagBox[
     TemplateBox[{
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"]]], 
       SubscriptBox["1", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
   "Ket"], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{
  3.823845408838003*^9, {3.824002138671939*^9, 3.8240021487641077`*^9}, {
   3.824420719264933*^9, 3.824420741905867*^9}, 3.8263297294760933`*^9},
 CellLabel->
  "Out[458]=",ExpressionUUID->"8900b797-7425-4ca6-802d-cc62835bcefd"]
}, Open  ]],

Cell["\<\
This is a full quantum circuit model to perform the Bell measurement on the \
state specified above.\
\>", "Text",
 CellChangeTimes->{{3.823845428176402*^9, 
  3.8238455123899107`*^9}},ExpressionUUID->"ace106c4-ecdc-4351-85e3-\
7be4b8f20cad"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuissoCircuit", "[", 
   RowBox[{"vec", ",", "disentangler", ",", 
    RowBox[{"Measurement", "@", 
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}]}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "0"}], "}"}], ",", "None"}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.820450980258233*^9, 3.820451076954195*^9}, {
  3.820451380609254*^9, 3.820451398078719*^9}, {3.823845389085147*^9, 
  3.823845417253483*^9}},
 CellLabel->
  "In[459]:=",ExpressionUUID->"d403f668-2cb6-4cb0-9777-ed394f8fc9d4"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{3, -1}, {4, -1}}, {{3, -2}, {4, -2}}}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {
    LineBox[{{-0.1, -2}, {-0.2, -2.}, {-0.2, -1.}, {-0.1, -1}}], InsetBox[
     StyleBox[
      RowBox[{
       TemplateBox[{
         TemplateBox[{"0", "0"}, "RowDefault"]},
        "Ket"], "+", 
       TemplateBox[{
         TemplateBox[{"0", "1"}, "RowDefault"]},
        "Ket"], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        TemplateBox[{
          TemplateBox[{"1", "0"}, "RowDefault"]},
         "Ket"]}]}],
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light"], {-0.30000000000000004, -1.5}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {LineBox[{{1, -1}, {1, -2}}], 
    DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
        1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {2, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, 
   StyleBox[{{
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, 
      CircleBox[{3, -1.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{3, -1.2}, {3.24, -0.76}}]}, {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, 
      CircleBox[{3, -2.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{3, -2.2}, {3.24, -1.76}}]}},
    ImageSize->Small]},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImageSize->180,
  PlotRangePadding->{{2, 0}, None}]], "Output",
 CellChangeTimes->{
  3.8204510008818293`*^9, {3.820451055656859*^9, 3.8204510800745573`*^9}, 
   3.820451131422929*^9, {3.820451381454278*^9, 3.820451398459756*^9}, 
   3.820451823516562*^9, 3.823845417957909*^9, 3.823845513779017*^9, {
   3.82400214003821*^9, 3.824002150003292*^9}, 3.8244207430796413`*^9, 
   3.8263297295181704`*^9},
 CellLabel->
  "Out[459]=",ExpressionUUID->"82822b1d-28e2-44c1-becf-8dedcbdad7b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"out", "=", 
       RowBox[{"QuissoExpression", "[", "qc", "]"}]}], ";", 
      RowBox[{"FromDigits", "[", 
       RowBox[{
        RowBox[{"Readout", "[", 
         RowBox[{"out", ",", 
          RowBox[{"S", "@", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], ",", "2"}], "]"}]}], 
     ",", "500"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", 
  RowBox[{"data", ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Readout\>\"", ",", "\"\<Counts\>\""}], "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8204475203975887`*^9, 3.820447746633793*^9}, {
  3.82045111698005*^9, 3.820451157083246*^9}, {3.8204513414676647`*^9, 
  3.820451357074744*^9}, {3.824420730995162*^9, 3.824420734684799*^9}},
 CellLabel->
  "In[460]:=",ExpressionUUID->"35c86dd4-d3e7-4fe2-a980-e12f3782c5b0"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
    Opacity[0.6579999999999999], Thickness[Small]}], {}, 
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
     Opacity[0.6579999999999999], Thickness[Small]}], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{-0.5, 0}, {0.5, 81.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{42.2375, 
           75.86874999999999}, {-16.442191023575113`, 22.96574143061033}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 81]& ,
        TagBoxNote->"81"],
       StyleBox["81", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[81, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{0.5, 0}, {1.5, 175.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{75.36874999999999, 109.}, {-61.59460646423475, 
           22.96574143061033}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 175]& ,
        TagBoxNote->"175"],
       StyleBox["175", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[175, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{1.5, 0}, {2.5, 84.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{108.5, 142.13125}, {-17.883225558915314`, 
           22.96574143061033}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 84]& ,
        TagBoxNote->"84"],
       StyleBox["84", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[84, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{2.5, 0}, {3.5, 160.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{141.63125, 175.2625}, {-54.38943378753374, 
           22.96574143061033}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 160]& ,
        TagBoxNote->"160"],
       StyleBox["160", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[160, {}], "Tooltip"]& ]}, {}, {}}, {{}, {}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{-0.58, 0},
  AxesStyle->{},
  Frame->True,
  FrameLabel->{{
     FormBox["\"Counts\"", TraditionalForm], None}, {
     FormBox["\"Readout\"", TraditionalForm], None}},
  FrameStyle->Automatic,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Small,
  PlotRange->{{-0.5, 3.5}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {None, 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.820451159397303*^9, {3.820451346831991*^9, 3.8204514051695232`*^9}, 
   3.820451830509182*^9, 3.823845524359737*^9, 3.824002157870599*^9, {
   3.824420738496005*^9, 3.824420754765499*^9}, 3.826329736191433*^9},
 CellLabel->
  "Out[461]=",ExpressionUUID->"d5f59617-31f8-40b3-897d-e6accbc13bb3"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
Saveable->False,
WindowToolbars->"EditBar",
WindowSize->{996, 1340},
WindowMargins->{{Automatic, 731}, {Automatic, 0}},
DockedCells->Cell[
 "Quantum Computation Workbook", "Text", Background -> GrayLevel[0.9], 
  FontSize -> 12, CellFrameMargins -> {{22, 8}, {8, 8}}],
PageFooters->{{
   Cell["Quantum Computation Workbook", "Footer", CellMargins -> 4], None, 
   None}, {None, None, 
   Cell["Quantum Computation Workbook", "Footer", CellMargins -> 4]}},
PageFooterLines->{True, True},
TaggingRules->{
 "DocuToolsSettings" -> {
   "$ApplicationName" -> "Q3", "$LinkBase" -> "Q3", "$DocumentationDirectory" -> 
    "/Users/Masso/Math/Apples/Q3App/Q3/Documentation/English/", 
    "$ApplicationDirectory" -> "/Users/Masso/Math/Apples/Q3App/Q3"}, 
  "TryRealOnly" -> False},
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (December 12, 2020)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]], 
   Cell[
    CellGroupData[{
      Cell[
       StyleData["MathCaption"], CellMargins -> {{66, 10}, {7, 8}}, 
       CellGroupingRules -> {"SectionGrouping", 70}, TabSpacings -> {2.5}, 
       MenuSortingValue -> 1450, MenuCommandKey :> "8", FontFamily -> 
       "Source Sans Pro", FontSize -> 15], 
      Cell[
       StyleData["MathCaption", "Presentation"], 
       CellFrame -> {{0, 0}, {0, 1}}, CellMargins -> {{100, 10}, {10, 10}}, 
       LineSpacing -> {1, 5}, FontSize -> 24], 
      Cell[
       StyleData["MathCaption", "SlideShow"], 
       CellMargins -> {{
         0.135 FrontEnd`AbsoluteCurrentValue[{WindowSize, 1}], 0.03 
          FrontEnd`AbsoluteCurrentValue[{WindowSize, 1}]}, {10, 10}}, 
       FontSize -> 22], 
      Cell[
       StyleData["MathCaption", "Printout"], 
       CellMargins -> {{49, Inherited}, {Inherited, Inherited}}, Hyphenation -> 
       True]}, Open]], 
   Cell[
    StyleData["Code"], MenuSortingValue -> 1530, MenuCommandKey :> None]}, 
  Visible -> False, FrontEndVersion -> 
  "12.2 for Mac OS X x86 (64-bit) (December 12, 2020)", StyleDefinitions -> 
  "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"a9b5e516-22bb-4dc2-98c0-90d5a5075e92"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 220, 4, 98, "Title",ExpressionUUID->"b9269d85-53e8-4b1a-8e3e-227531db259b"],
Cell[803, 28, 598, 9, 73, "Input",ExpressionUUID->"461ddb1f-d118-47e8-96bb-6e4be8172a11"],
Cell[1404, 39, 370, 7, 52, "Input",ExpressionUUID->"d69ce98c-fbd2-4f2c-9529-43b1fbb7afb1"],
Cell[1777, 48, 317, 7, 58, "Text",ExpressionUUID->"a7976343-ed47-4d86-a1b6-b3930570d83c"],
Cell[CellGroupData[{
Cell[2119, 59, 1325, 30, 157, "Input",ExpressionUUID->"3e2dd1fd-cd7f-4ae8-b76e-704703ab5311"],
Cell[3447, 91, 3454, 75, 163, "Output",ExpressionUUID->"8b1c4c5b-cdf8-425e-8def-116c05649a38"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6938, 171, 167, 3, 67, "Section",ExpressionUUID->"5bc389d6-af93-46ff-ba79-0f6e03fa1fb7"],
Cell[CellGroupData[{
Cell[7130, 178, 159, 3, 54, "Subsection",ExpressionUUID->"487375be-ba69-4daa-8e13-7b1a6deac423"],
Cell[CellGroupData[{
Cell[7314, 185, 471, 10, 38, "MathCaption",ExpressionUUID->"d40d797f-b56b-4c8d-b649-45cb89dd8676"],
Cell[CellGroupData[{
Cell[7810, 199, 298, 5, 30, "Input",ExpressionUUID->"9f04b05c-bb2d-4a40-b996-1f4295e63b61"],
Cell[8111, 206, 381, 8, 34, "Output",ExpressionUUID->"799544f8-36ad-4b0f-a58f-593cdc78a9f9"]
}, Open  ]],
Cell[8507, 217, 179, 3, 35, "Text",ExpressionUUID->"80fb2058-0246-442b-b3e1-508dbf47c715"],
Cell[CellGroupData[{
Cell[8711, 224, 365, 7, 30, "Input",ExpressionUUID->"aa7af65a-3649-47da-8cf9-a438d55cc478"],
Cell[9079, 233, 1158, 29, 60, "Output",ExpressionUUID->"14539434-9aa7-482b-be08-c92c476b9f71"]
}, Open  ]],
Cell[10252, 265, 286, 7, 35, "Text",ExpressionUUID->"054c6e66-8b9c-41eb-abf0-5b8eaa37e570"],
Cell[CellGroupData[{
Cell[10563, 276, 316, 5, 30, "Input",ExpressionUUID->"a95d7495-bada-4c60-a336-2108079ab32c"],
Cell[10882, 283, 948, 20, 57, "Output",ExpressionUUID->"23e3c210-7c9b-4731-8bcb-0e407591435b"]
}, Open  ]],
Cell[11845, 306, 309, 6, 35, "Text",ExpressionUUID->"6ebc6fee-93f6-4100-ab1d-a3925d832171"],
Cell[CellGroupData[{
Cell[12179, 316, 593, 16, 73, "Input",ExpressionUUID->"ac64401f-2be2-440f-a859-7dda40e2db16"],
Cell[12775, 334, 1365, 44, 72, "Output",ExpressionUUID->"dc4c7f0d-b8fa-46f7-940f-e6bfd7566536"]
}, Open  ]],
Cell[14155, 381, 318, 7, 35, "Text",ExpressionUUID->"2461e8f2-87b4-402e-9cdb-0a444be5c840"],
Cell[CellGroupData[{
Cell[14498, 392, 689, 19, 94, "Input",ExpressionUUID->"e9dc21d0-10de-4c40-ac88-9260c8ff2db3"],
Cell[15190, 413, 757, 26, 38, "Output",ExpressionUUID->"6b502060-556a-4c47-b81b-74aea6b80f64"],
Cell[15950, 441, 757, 26, 38, "Output",ExpressionUUID->"63b0eb2c-802f-4b26-8a1a-5a0b8fc8ecbd"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16756, 473, 522, 11, 38, "MathCaption",ExpressionUUID->"a6ac5eb1-d684-4c82-8a9b-7174c87b2019"],
Cell[CellGroupData[{
Cell[17303, 488, 373, 6, 30, "Input",ExpressionUUID->"1a85a8d3-1cb7-4325-825c-ee9b21250c1b"],
Cell[17679, 496, 331, 7, 34, "Output",ExpressionUUID->"82e8da1c-fc47-4890-8fe6-74b73684626f"]
}, Open  ]],
Cell[18025, 506, 227, 4, 35, "Text",ExpressionUUID->"8720ff9d-2e56-405f-a9c8-2d0b67114b55"],
Cell[CellGroupData[{
Cell[18277, 514, 413, 7, 30, "Input",ExpressionUUID->"ce76741a-8ca8-4bc2-a88d-2561bf01c4e9"],
Cell[18693, 523, 1182, 30, 60, "Output",ExpressionUUID->"8befe265-0954-4b0e-b98a-e6b35c0fd766"]
}, Open  ]],
Cell[19890, 556, 286, 7, 35, "Text",ExpressionUUID->"039859f0-c61e-4b04-afa2-cf8765ed58c1"],
Cell[CellGroupData[{
Cell[20201, 567, 372, 7, 30, "Input",ExpressionUUID->"820ac768-ef2a-45c2-afc7-5eb82aa224f1"],
Cell[20576, 576, 898, 20, 57, "Output",ExpressionUUID->"3e4f376f-f4d6-434d-bac3-8de2d4b9c7d6"]
}, Open  ]],
Cell[21489, 599, 573, 13, 39, "Text",ExpressionUUID->"976291a9-1dfc-4f2f-95f7-814fc2a4dc1d"],
Cell[CellGroupData[{
Cell[22087, 616, 644, 17, 73, "Input",ExpressionUUID->"94f69b26-de8b-4a12-83d9-7b1159fad58b"],
Cell[22734, 635, 1489, 46, 72, "Output",ExpressionUUID->"5e6db7d1-c6c8-4c06-bd36-1c4de6851a7a"]
}, Open  ]],
Cell[24238, 684, 220, 5, 35, "Text",ExpressionUUID->"0915300b-ea63-40a0-b571-ba028cd9d6ea"],
Cell[CellGroupData[{
Cell[24483, 693, 738, 20, 94, "Input",ExpressionUUID->"91f59bd1-33ee-493a-869a-37d6dbd4a595"],
Cell[25224, 715, 809, 28, 38, "Output",ExpressionUUID->"f282da42-149b-4220-bd5e-71aa951d71e9"],
Cell[26036, 745, 809, 28, 38, "Output",ExpressionUUID->"4f2bf179-428e-4288-8bf2-1c43bf9cd21c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[26894, 779, 572, 12, 38, "MathCaption",ExpressionUUID->"34ec3e66-ffaf-4447-963d-07cbb97eb58c"],
Cell[CellGroupData[{
Cell[27491, 795, 375, 7, 30, "Input",ExpressionUUID->"ebb6e219-9b2e-4788-beb7-5d1a35d34947"],
Cell[27869, 804, 331, 8, 34, "Output",ExpressionUUID->"475820cf-6b26-4787-b03c-65f93fe803d2"]
}, Open  ]],
Cell[28215, 815, 228, 4, 35, "Text",ExpressionUUID->"7873df99-9826-4131-9179-b307bf904799"],
Cell[CellGroupData[{
Cell[28468, 823, 419, 8, 30, "Input",ExpressionUUID->"20673574-c5e0-413d-b784-8929a71b2f36"],
Cell[28890, 833, 1239, 31, 60, "Output",ExpressionUUID->"58eb0578-5810-42d7-9661-05bd6e9391b5"]
}, Open  ]],
Cell[30144, 867, 286, 7, 35, "Text",ExpressionUUID->"59e2dccf-2e45-42c4-a9b4-17c6b958522e"],
Cell[CellGroupData[{
Cell[30455, 878, 424, 8, 30, "Input",ExpressionUUID->"8f326858-ced0-4ce4-a0ec-a8aa72348012"],
Cell[30882, 888, 949, 21, 57, "Output",ExpressionUUID->"56772fed-4f47-4207-b0eb-0c76b639b2af"]
}, Open  ]],
Cell[31846, 912, 288, 7, 35, "Text",ExpressionUUID->"19fa5d6e-4835-4fa4-90e5-9a2c951f7ea6"],
Cell[CellGroupData[{
Cell[32159, 923, 491, 11, 52, "Input",ExpressionUUID->"c9e81ac5-8510-4af7-b766-fe5474c8677d"],
Cell[32653, 936, 1178, 28, 59, "Output",ExpressionUUID->"0de9a2cd-b11f-4e76-ba08-e86649447119"],
Cell[33834, 966, 447, 11, 34, "Output",ExpressionUUID->"216273bd-36dd-48be-bdbb-ffca67f66b7d"]
}, Open  ]],
Cell[34296, 980, 295, 6, 35, "Text",ExpressionUUID->"e07c1c22-ab65-4dd2-ab0d-2aff26f0976d"],
Cell[CellGroupData[{
Cell[34616, 990, 696, 18, 73, "Input",ExpressionUUID->"435c8fe5-586d-4a98-9cb0-e352c3bb0b5b"],
Cell[35315, 1010, 1675, 50, 72, "Output",ExpressionUUID->"de3ae2dd-e4ce-464c-a42b-ebd1ec4318f6"]
}, Open  ]],
Cell[37005, 1063, 269, 6, 35, "Text",ExpressionUUID->"e71f598d-7326-4c0d-99bf-cd63e059da65"],
Cell[CellGroupData[{
Cell[37299, 1073, 791, 22, 94, "Input",ExpressionUUID->"5c35afb4-3385-4510-916c-2a6ba6834367"],
Cell[38093, 1097, 904, 29, 38, "Output",ExpressionUUID->"0e6fea28-2727-495e-a854-c82c02ef0db5"],
Cell[39000, 1128, 967, 30, 38, "Output",ExpressionUUID->"bf1d100e-02ad-4873-adf4-dee7a668fba5"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[40016, 1164, 611, 13, 59, "MathCaption",ExpressionUUID->"e92b7fcd-10a8-4e75-b8b1-7af847a1dc0f"],
Cell[CellGroupData[{
Cell[40652, 1181, 269, 6, 30, "Input",ExpressionUUID->"40194263-cb82-4031-9c80-cb57644eedd4"],
Cell[40924, 1189, 488, 11, 34, "Output",ExpressionUUID->"2344a2b0-d034-401e-bc4d-36904b04fb66"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41449, 1205, 271, 6, 30, "Input",ExpressionUUID->"77b6cd2e-cbee-44ad-9d20-25c06d263e23"],
Cell[41723, 1213, 441, 11, 34, "Output",ExpressionUUID->"68773ff5-d277-42cc-bf11-acd3b1e47d55"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42201, 1229, 269, 6, 30, "Input",ExpressionUUID->"177acc05-085b-463a-bae7-2522109e4b9c"],
Cell[42473, 1237, 440, 11, 34, "Output",ExpressionUUID->"27e9ab7c-3f87-4add-b561-77f164322ef9"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[42974, 1255, 162, 3, 54, "Subsection",ExpressionUUID->"476c341a-e282-4b67-9f50-0e82cfb82f9a"],
Cell[CellGroupData[{
Cell[43161, 1262, 399, 6, 38, "MathCaption",ExpressionUUID->"f769a5e3-bf2f-4e09-92a4-b93206f50249"],
Cell[CellGroupData[{
Cell[43585, 1272, 302, 6, 30, "Input",ExpressionUUID->"47f3a970-fafe-4050-812a-e1f285709a34"],
Cell[43890, 1280, 539, 11, 36, "Output",ExpressionUUID->"c1ef9cde-36a3-4c3a-bfb0-31c506da8533"]
}, Open  ]],
Cell[44444, 1294, 191, 3, 35, "Text",ExpressionUUID->"e4dd0856-6164-478e-9665-3afc13159e36"],
Cell[CellGroupData[{
Cell[44660, 1301, 370, 9, 52, "Input",ExpressionUUID->"04b6ea28-31d2-40b7-a99d-54c71b6141d7"],
Cell[45033, 1312, 752, 22, 38, "Output",ExpressionUUID->"5828755d-3f54-4704-93f2-6b248dd9ab96"]
}, Open  ]],
Cell[45800, 1337, 225, 5, 35, "Text",ExpressionUUID->"739ff9df-a0e3-45d7-b955-463b615443e9"],
Cell[CellGroupData[{
Cell[46050, 1346, 394, 11, 52, "Input",ExpressionUUID->"1be73668-5869-47f8-af91-31634c0e24fb"],
Cell[46447, 1359, 1702, 55, 59, "Output",ExpressionUUID->"89f263f3-543d-4e4a-bcef-fd6653f6b532"]
}, Open  ]],
Cell[48164, 1417, 230, 6, 35, "Text",ExpressionUUID->"96104f7d-8059-4047-87e8-d6b041f591b5"],
Cell[CellGroupData[{
Cell[48419, 1427, 467, 9, 30, "Input",ExpressionUUID->"e5bf2746-cb4f-41e2-8a75-e4ee262cb69d"],
Cell[48889, 1438, 1020, 22, 57, "Output",ExpressionUUID->"737dbe8e-0996-45a3-aa24-c695a335a699"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[49958, 1466, 367, 9, 38, "MathCaption",ExpressionUUID->"225048a0-0443-4fc4-8b86-1db97d08705d"],
Cell[CellGroupData[{
Cell[50350, 1479, 573, 15, 73, "Input",ExpressionUUID->"26e4ef14-b02c-409c-b9a7-60883d5c07b5"],
Cell[50926, 1496, 647, 18, 56, "Output",ExpressionUUID->"dafa19b2-1a07-488a-8ed7-dc546fcd8455"],
Cell[51576, 1516, 1155, 35, 80, "Output",ExpressionUUID->"a4566f8f-c90b-4983-aa85-5d675ba4f83f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[52780, 1557, 283, 5, 38, "MathCaption",ExpressionUUID->"2f4837d8-be97-403a-8c5c-173cb2279e61"],
Cell[CellGroupData[{
Cell[53088, 1566, 548, 14, 30, "Input",ExpressionUUID->"ca38990a-0cdc-4826-a204-9f637171dc4f"],
Cell[53639, 1582, 1015, 32, 36, "Output",ExpressionUUID->"13ebda0b-4ea5-4707-91aa-53e966162989"]
}, Open  ]],
Cell[54669, 1617, 214, 5, 35, "Text",ExpressionUUID->"9fb0127a-a410-4390-8586-f24c4d7d2157"],
Cell[CellGroupData[{
Cell[54908, 1626, 442, 12, 30, "Input",ExpressionUUID->"b69d0e72-36c6-4e41-98b7-873a1904e2ab"],
Cell[55353, 1640, 1548, 37, 127, "Output",ExpressionUUID->"4572257f-a619-41f6-ba89-9ea07b18ea83"]
}, Open  ]],
Cell[56916, 1680, 312, 7, 35, "Text",ExpressionUUID->"7e18452a-0569-4adf-a1d9-0a2b54f17598"],
Cell[CellGroupData[{
Cell[57253, 1691, 500, 11, 52, "Input",ExpressionUUID->"94bed628-1c51-4ad9-bafc-34b38a28a9e5"],
Cell[57756, 1704, 5232, 162, 59, "Output",ExpressionUUID->"6e6e85ce-8e9b-4ec1-9879-c13e57af71a7"]
}, Open  ]],
Cell[63003, 1869, 196, 3, 35, "Text",ExpressionUUID->"eb4db5f6-63cf-4ad3-b807-39e17b864335"],
Cell[CellGroupData[{
Cell[63224, 1876, 714, 21, 52, "Input",ExpressionUUID->"ecd7fa40-6853-472e-bdae-fd0c3b6067de"],
Cell[63941, 1899, 2160, 58, 122, "Output",ExpressionUUID->"5a726fe8-486e-467f-b70e-5fdae866717b"],
Cell[66104, 1959, 4963, 158, 59, "Output",ExpressionUUID->"56d50d89-7df3-4a8f-ae40-99adb3257591"]
}, Open  ]],
Cell[71082, 2120, 475, 9, 35, "Text",ExpressionUUID->"49a71700-0dcb-4633-aa86-3803e2291de7"],
Cell[CellGroupData[{
Cell[71582, 2133, 508, 14, 52, "Input",ExpressionUUID->"e62c0322-d909-4cd3-b091-d1310628f0ea"],
Cell[72093, 2149, 852, 23, 34, "Output",ExpressionUUID->"cadb8001-ff7b-4f03-9ccd-b2fc7eb85571"]
}, Open  ]],
Cell[72960, 2175, 249, 6, 35, "Text",ExpressionUUID->"04bb896f-583a-43f1-bc24-93f3c2ff4058"],
Cell[CellGroupData[{
Cell[73234, 2185, 614, 16, 52, "Input",ExpressionUUID->"7a389b76-cb08-43ea-8403-cbda62c14015"],
Cell[73851, 2203, 4609, 138, 38, "Output",ExpressionUUID->"eb8931e5-9402-4922-81ea-fe42642e93e4"]
}, Open  ]],
Cell[78475, 2344, 355, 7, 58, "Text",ExpressionUUID->"a34cdfc0-2df5-4237-8347-c3e10dab4246"],
Cell[CellGroupData[{
Cell[78855, 2355, 673, 20, 52, "Input",ExpressionUUID->"d2b5a4e7-ed69-4ff9-8110-c7150d0a5e80"],
Cell[79531, 2377, 731, 20, 38, "Output",ExpressionUUID->"1422b311-30b9-4672-abc6-69611abd6348"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80299, 2402, 381, 10, 52, "Input",ExpressionUUID->"18d52081-3866-4c2d-90be-9779731acb86"],
Cell[80683, 2414, 5041, 159, 59, "Output",ExpressionUUID->"c056a5de-73c3-4b3c-a25e-7df1e06b6a5d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[85785, 2580, 157, 3, 54, "Subsection",ExpressionUUID->"d1571d4d-c4a1-4cad-a4dc-a2013736de46"],
Cell[CellGroupData[{
Cell[85967, 2587, 442, 9, 59, "MathCaption",ExpressionUUID->"f2f24e04-9fdb-403f-add0-d8e929804caa"],
Cell[CellGroupData[{
Cell[86434, 2600, 229, 5, 30, "Input",ExpressionUUID->"2a54fb18-00e8-4bf7-a7da-686ca3965443"],
Cell[86666, 2607, 629, 18, 37, "Output",ExpressionUUID->"301b3378-f932-44ef-a7f8-162ed9398af7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87332, 2630, 649, 18, 73, "Input",ExpressionUUID->"3cd06a72-4ad6-4c15-82bf-a8c4a29647f5"],
Cell[87984, 2650, 5839, 178, 224, "Output",ExpressionUUID->"774cabac-83e9-4c56-b743-427faa8ef8fb"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[93872, 2834, 221, 5, 38, "MathCaption",ExpressionUUID->"f2a37467-9d73-47e9-90b1-c57fcb5994a3"],
Cell[CellGroupData[{
Cell[94118, 2843, 879, 25, 115, "Input",ExpressionUUID->"686ac139-226e-4657-ae10-f3f6c796d108"],
Cell[95000, 2870, 1343, 42, 78, "Output",ExpressionUUID->"89fa6adf-3696-421f-8058-8570c1286c6e"]
}, Open  ]],
Cell[96358, 2915, 200, 3, 35, "Text",ExpressionUUID->"3397093a-8d5c-400b-9b10-8e804271c37d"],
Cell[CellGroupData[{
Cell[96583, 2922, 318, 7, 30, "Input",ExpressionUUID->"93fb0ed6-df89-44fe-9cd5-ba48c57fc637"],
Cell[96904, 2931, 1029, 28, 52, "Output",ExpressionUUID->"c6442233-d049-4753-9302-a09e1264ffde"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97970, 2964, 236, 5, 30, "Input",ExpressionUUID->"66189222-96c7-43f8-83cf-2e8644a271b4"],
Cell[98209, 2971, 250, 4, 34, "Output",ExpressionUUID->"57463000-e4a2-4099-98df-1355443cb71e"]
}, Open  ]],
Cell[98474, 2978, 193, 3, 35, "Text",ExpressionUUID->"c3344c8f-0bc2-44ed-b283-7bdcd12725d6"],
Cell[CellGroupData[{
Cell[98692, 2985, 246, 5, 30, "Input",ExpressionUUID->"320d0567-bffb-4dbe-872d-654258002135"],
Cell[98941, 2992, 356, 8, 48, "Output",ExpressionUUID->"894bfa36-0cfb-4675-ba99-9b5d3ee3144f"]
}, Open  ]],
Cell[99312, 3003, 216, 5, 35, "Text",ExpressionUUID->"6acacd65-c3d7-45d4-9030-ea5863a1d74d"],
Cell[CellGroupData[{
Cell[99553, 3012, 328, 7, 52, "Input",ExpressionUUID->"f47f8d9d-3a73-418b-92af-38f97d7863c8"],
Cell[99884, 3021, 904, 26, 52, "Output",ExpressionUUID->"a7f127f1-c864-4632-87ed-881262735422"],
Cell[100791, 3049, 249, 4, 34, "Output",ExpressionUUID->"5e606644-7dfe-4c15-b7b2-3818fa2bc893"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[101113, 3061, 162, 3, 67, "Section",ExpressionUUID->"52604d20-1bc2-4b0a-a56e-66832804d763"],
Cell[CellGroupData[{
Cell[101300, 3068, 152, 3, 54, "Subsection",ExpressionUUID->"060db050-bf84-4b69-89bd-fb8b4802acc1"],
Cell[CellGroupData[{
Cell[101477, 3075, 468, 13, 38, "MathCaption",ExpressionUUID->"3713a507-5340-45ca-a49e-2aaf835335d4"],
Cell[CellGroupData[{
Cell[101970, 3092, 316, 8, 30, "Input",ExpressionUUID->"73061649-43ed-4520-b6b7-d009d4ccbf88"],
Cell[102289, 3102, 723, 21, 34, "Output",ExpressionUUID->"a0f42943-25b3-415e-a25d-c6840e65063c"]
}, Open  ]],
Cell[103027, 3126, 201, 3, 35, "Text",ExpressionUUID->"57dd86fe-cc77-4720-923f-bc98a2758b6d"],
Cell[CellGroupData[{
Cell[103253, 3133, 365, 7, 30, "Input",ExpressionUUID->"edccf931-013e-4e31-8d39-49d787084bd2"],
Cell[103621, 3142, 960, 18, 77, "Output",ExpressionUUID->"32039142-ab37-4c3f-a326-adfa5e2aeaa0"]
}, Open  ]],
Cell[104596, 3163, 235, 6, 35, "Text",ExpressionUUID->"15672d67-45c3-4138-a721-87abf506e789"],
Cell[CellGroupData[{
Cell[104856, 3173, 245, 5, 30, "Input",ExpressionUUID->"7c1e3e3f-1e75-4912-a7b9-7d54836007ed"],
Cell[105104, 3180, 1186, 37, 52, "Output",ExpressionUUID->"76aa3f1b-da92-4e16-8ec2-b29d45506b11"]
}, Open  ]],
Cell[106305, 3220, 221, 5, 35, "Text",ExpressionUUID->"62136129-a8d2-4072-b6da-5df546df68f9"],
Cell[CellGroupData[{
Cell[106551, 3229, 244, 5, 30, "Input",ExpressionUUID->"675cc0f9-bbcc-419e-880f-85ae0c71c10c"],
Cell[106798, 3236, 932, 26, 94, "Output",ExpressionUUID->"c045ea40-7d91-4fb5-a9eb-c8a64e1b1dac"]
}, Open  ]],
Cell[107745, 3265, 218, 5, 35, "Text",ExpressionUUID->"2f65ec29-3c79-44cc-bfaf-6d817b74308b"],
Cell[CellGroupData[{
Cell[107988, 3274, 640, 18, 73, "Input",ExpressionUUID->"5237c434-daa6-46f9-9caa-808e7c7ed4fc"],
Cell[108631, 3294, 4371, 132, 118, "Output",ExpressionUUID->"67b3e927-e60a-454d-b665-8c734b3db85e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[113051, 3432, 298, 7, 38, "MathCaption",ExpressionUUID->"19d7f2f6-e732-4008-add4-435ef192f7c9"],
Cell[CellGroupData[{
Cell[113374, 3443, 577, 14, 30, "Input",ExpressionUUID->"25ac0706-c91a-476b-b4f8-d066587c6aeb"],
Cell[113954, 3459, 1275, 26, 89, "Output",ExpressionUUID->"aef702e0-c962-4a3e-911b-8d8db77b190e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[115278, 3491, 235, 5, 38, "MathCaption",ExpressionUUID->"2e13d3e5-2de8-4d2a-8564-202c87ea586b"],
Cell[CellGroupData[{
Cell[115538, 3500, 926, 26, 73, "Input",ExpressionUUID->"b80b94c1-159c-4adb-9084-6329740a96ef"],
Cell[116467, 3528, 1708, 39, 87, "Output",ExpressionUUID->"a597af6b-1a8e-4320-83b6-e32fe710c8e1"],
Cell[118178, 3569, 1280, 36, 59, "Output",ExpressionUUID->"2d1d6462-f075-495e-ac02-4e3f52730f11"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[119507, 3611, 253, 6, 38, "MathCaption",ExpressionUUID->"3d142bbd-6d0a-42be-92a0-5d822e70e255"],
Cell[CellGroupData[{
Cell[119785, 3621, 856, 23, 115, "Input",ExpressionUUID->"0147afec-6f57-4ae9-873a-2960749d7463"],
Cell[120644, 3646, 6831, 205, 170, "Output",ExpressionUUID->"fdb2c424-efd1-4dfc-bd64-4eaaa95dca63"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[127524, 3857, 370, 9, 38, "MathCaption",ExpressionUUID->"99da444a-e79b-4f22-b4cf-69f285e8ab90"],
Cell[CellGroupData[{
Cell[127919, 3870, 1388, 36, 52, "Input",ExpressionUUID->"162b2b9b-998c-482b-a43c-a108917fe950"],
Cell[129310, 3908, 2511, 66, 133, "Output",ExpressionUUID->"060bd225-2cbe-4b3c-a56a-959a7b6c80e0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[131858, 3979, 1061, 27, 30, "Input",ExpressionUUID->"8805d7ed-5906-4eb1-95d9-0ced1e7aa7c4"],
Cell[132922, 4008, 2738, 67, 156, "Output",ExpressionUUID->"9e256da8-8dad-48c0-97ba-36b2e8dcccf3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135697, 4080, 359, 9, 52, "Input",ExpressionUUID->"49801697-7284-448d-9a55-8d7062c506fe"],
Cell[136059, 4091, 3271, 96, 50, "Output",ExpressionUUID->"d9857f91-c0b5-41dd-8217-25d63cbaad1b"]
}, Open  ]],
Cell[139345, 4190, 327, 7, 58, "Text",ExpressionUUID->"ca1a3d64-8ee3-4f65-86cc-d69c6037c98a"],
Cell[CellGroupData[{
Cell[139697, 4201, 218, 4, 30, "Input",ExpressionUUID->"9e8ead7d-ff3b-4592-af30-b98845f5770b"],
Cell[139918, 4207, 2186, 64, 50, "Output",ExpressionUUID->"c897dcdf-6c8c-4a62-b37c-8c7b80808106"]
}, Open  ]],
Cell[142119, 4274, 272, 8, 35, "Text",ExpressionUUID->"beedc2b8-0af7-48f7-934d-148ce1092bc4"],
Cell[CellGroupData[{
Cell[142416, 4286, 1295, 33, 73, "Input",ExpressionUUID->"93d13f21-efdf-46ea-ae94-857a21d2ffcc"],
Cell[143714, 4321, 3661, 91, 226, "Output",ExpressionUUID->"9f64da29-0ea9-4814-923b-fad6b9e62e2a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[147412, 4417, 332, 8, 52, "Input",ExpressionUUID->"b263c9c4-e604-4a79-8d6e-437d1139f391"],
Cell[147747, 4427, 8323, 253, 109, "Output",ExpressionUUID->"1ee68ae0-8acc-4fe7-80be-d2730bcdd8c4"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[156131, 4687, 166, 3, 54, "Subsection",ExpressionUUID->"0535d62f-2fad-4b5c-bc74-f09ef33f3aa7"],
Cell[CellGroupData[{
Cell[156322, 4694, 356, 8, 38, "MathCaption",ExpressionUUID->"ed065515-4cdf-4145-841b-4599eca48efe"],
Cell[CellGroupData[{
Cell[156703, 4706, 583, 16, 52, "Input",ExpressionUUID->"f2d04065-a079-42c4-8e45-c96527d55c67"],
Cell[157289, 4724, 1351, 37, 78, "Output",ExpressionUUID->"24029c7e-ddbb-4a10-8a4e-e4b2dfc897c2"]
}, Open  ]],
Cell[158655, 4764, 223, 4, 35, "Text",ExpressionUUID->"31bdb47d-0746-4087-a416-776c5028e602"],
Cell[CellGroupData[{
Cell[158903, 4772, 462, 10, 30, "Input",ExpressionUUID->"618f59e3-3c1a-4b9b-b7d9-ad0eedfd9fbf"],
Cell[159368, 4784, 960, 22, 81, "Output",ExpressionUUID->"6412bc59-75c4-45f9-8638-761f0684200a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160365, 4811, 347, 7, 30, "Input",ExpressionUUID->"660d6695-82f7-4a57-bb33-05d6e30434e2"],
Cell[160715, 4820, 1758, 50, 49, "Output",ExpressionUUID->"30b98ff7-4dd5-43c2-a44b-876f648e18c6"]
}, Open  ]],
Cell[162488, 4873, 241, 7, 35, "Text",ExpressionUUID->"187be339-214b-4b10-a40f-396c310d8b6a"],
Cell[CellGroupData[{
Cell[162754, 4884, 850, 23, 73, "Input",ExpressionUUID->"a6d7a75a-e2d6-489c-a4d0-67f6217085f4"],
Cell[163607, 4909, 1340, 43, 38, "Output",ExpressionUUID->"98d164e1-ef97-4b73-ba12-dc190054e0ae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[164984, 4957, 539, 13, 52, "Input",ExpressionUUID->"0b820882-78fc-4249-8fde-f20dd24dcf7c"],
Cell[165526, 4972, 1507, 45, 38, "Output",ExpressionUUID->"88d546cf-7ed6-4736-b87a-4f4a1ac8cc28"]
}, Open  ]],
Cell[167048, 5020, 368, 8, 35, "Text",ExpressionUUID->"f8067e5d-6583-436c-b66a-29dc78d3c907"],
Cell[CellGroupData[{
Cell[167441, 5032, 951, 27, 52, "Input",ExpressionUUID->"3a303710-2874-4579-94c7-3d7040ed3d00"],
Cell[168395, 5061, 1340, 43, 38, "Output",ExpressionUUID->"a0cbbff7-0710-448a-9973-c04439cc6e6e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169772, 5109, 535, 13, 52, "Input",ExpressionUUID->"4925dc93-e7a5-47a4-9644-ce18d2637c36"],
Cell[170310, 5124, 2160, 70, 50, "Output",ExpressionUUID->"0608bf76-71a1-4093-a76e-71296e52427b"]
}, Open  ]],
Cell[172485, 5197, 328, 7, 35, "Text",ExpressionUUID->"06bc5fd9-b738-421f-9fef-fe5ac09b0b15"],
Cell[CellGroupData[{
Cell[172838, 5208, 607, 17, 52, "Input",ExpressionUUID->"332b5ad0-5897-4d08-8551-5cef7935e2db"],
Cell[173448, 5227, 1012, 30, 38, "Output",ExpressionUUID->"1a66fffa-b6a6-4869-85dc-b457a5bfce36"]
}, Open  ]],
Cell[CellGroupData[{
Cell[174497, 5262, 485, 12, 52, "Input",ExpressionUUID->"4ae5b871-9dd2-4f67-93ec-97aac51c803e"],
Cell[174985, 5276, 1763, 50, 50, "Output",ExpressionUUID->"80dfd2d6-e4f9-4cbb-8153-402e4a1de8be"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[176797, 5332, 375, 8, 59, "MathCaption",ExpressionUUID->"481387f5-bfa4-4280-b916-1fae2b5f50e8"],
Cell[CellGroupData[{
Cell[177197, 5344, 969, 29, 52, "Input",ExpressionUUID->"3fdcd847-482f-42dd-9b95-76e08359d6dc"],
Cell[178169, 5375, 1484, 49, 38, "Output",ExpressionUUID->"3750ea56-967e-4ede-bea0-6d00ab3219f4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[179690, 5429, 607, 16, 52, "Input",ExpressionUUID->"f3b93758-21b9-4bc7-9e30-8860026bcc1f"],
Cell[180300, 5447, 1694, 53, 49, "Output",ExpressionUUID->"fefc0c78-48e4-40ca-8224-8f70139cadfc"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[182043, 5506, 408, 13, 38, "MathCaption",ExpressionUUID->"0d8b75cf-9457-420b-b9e5-488df2abc528"],
Cell[CellGroupData[{
Cell[182476, 5523, 479, 12, 30, "Input",ExpressionUUID->"14222b28-85fe-45d9-b0f2-48e47af399e1"],
Cell[182958, 5537, 568, 15, 50, "Output",ExpressionUUID->"f6997200-6a35-4263-a400-2404ee64e95a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[183563, 5557, 538, 12, 52, "Input",ExpressionUUID->"7d95e307-1dd6-423e-bd6b-3250d949c233"],
Cell[184104, 5571, 772, 25, 59, "Output",ExpressionUUID->"8ee20949-77ea-4256-9461-1a8e75115819"]
}, Open  ]],
Cell[CellGroupData[{
Cell[184913, 5601, 449, 10, 30, "Input",ExpressionUUID->"8b3538b2-96ad-43bd-86b1-e2f2acce12e3"],
Cell[185365, 5613, 958, 31, 67, "Output",ExpressionUUID->"1b1f5465-8aca-4397-bd66-057b2f769a97"]
}, Open  ]],
Cell[CellGroupData[{
Cell[186360, 5649, 608, 15, 52, "Input",ExpressionUUID->"3ff2cd83-be8b-4353-9c81-263c49e5f677"],
Cell[186971, 5666, 772, 25, 59, "Output",ExpressionUUID->"d177a28c-1a38-451c-b4f3-dff9d4c88c20"]
}, Open  ]],
Cell[CellGroupData[{
Cell[187780, 5696, 449, 10, 30, "Input",ExpressionUUID->"33dca60a-39ad-4361-a22f-af0d2d4dbb3e"],
Cell[188232, 5708, 1160, 33, 67, "Output",ExpressionUUID->"92add6b6-60f3-4e5c-abca-7321d2703350"]
}, Open  ]],
Cell[189407, 5744, 351, 7, 35, "Text",ExpressionUUID->"90ed5dba-e4a5-4217-92f8-55e00bb74cd8"],
Cell[CellGroupData[{
Cell[189783, 5755, 1157, 30, 73, "Input",ExpressionUUID->"797e152d-2bb2-45d7-ac76-6091fe6d275f"],
Cell[190943, 5787, 2058, 52, 102, "Output",ExpressionUUID->"b714de67-ceb9-4678-bd71-d54daca4a3d8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[193038, 5844, 649, 16, 52, "Input",ExpressionUUID->"7f3a41c0-c065-4ce4-bb03-b11e500bece2"],
Cell[193690, 5862, 2082, 60, 49, "Output",ExpressionUUID->"fe6a9bc5-5fbc-4694-86e1-4ab0e5c90939"]
}, Open  ]],
Cell[195787, 5925, 228, 4, 35, "Text",ExpressionUUID->"7630d419-080d-44f7-bc5c-aa7805027ff5"],
Cell[CellGroupData[{
Cell[196040, 5933, 1416, 37, 73, "Input",ExpressionUUID->"f9e96e4f-7bc7-4aec-88f8-1dd8732a2670"],
Cell[197459, 5972, 3163, 77, 108, "Output",ExpressionUUID->"59fb157b-8318-470e-8267-674f20557f58"]
}, Open  ]],
Cell[CellGroupData[{
Cell[200659, 6054, 647, 16, 52, "Input",ExpressionUUID->"4204d535-4175-4bd4-8022-5917b762eb05"],
Cell[201309, 6072, 1507, 43, 67, "Output",ExpressionUUID->"d22fc189-9ee5-45e3-b31a-3e9ce3deba74"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[202865, 6121, 396, 9, 38, "MathCaption",ExpressionUUID->"703ce403-13c0-4183-a059-3319fcb432dc"],
Cell[CellGroupData[{
Cell[203286, 6134, 2234, 56, 100, "Input",ExpressionUUID->"a464271f-4d09-47f5-ad91-b3c5e570679a"],
Cell[205523, 6192, 4155, 105, 139, "Output",ExpressionUUID->"41d66c57-b89d-4720-8a4f-342e998a3ca9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[209715, 6302, 1104, 25, 52, "Input",ExpressionUUID->"2f74268b-b98a-457f-bb35-78c483d53ce4"],
Cell[210822, 6329, 2823, 83, 72, "Output",ExpressionUUID->"7ae14ab5-496c-4fb9-8759-60e5845fe1b5"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[213694, 6418, 261, 5, 38, "MathCaption",ExpressionUUID->"35bb3dee-2c1d-46bb-bd1b-b7b7634ab11c"],
Cell[CellGroupData[{
Cell[213980, 6427, 503, 10, 52, "Input",ExpressionUUID->"821935eb-7c47-4517-b0f6-561730b37c4b"],
Cell[214486, 6439, 1256, 33, 60, "Output",ExpressionUUID->"c1f97c3f-eb0b-4994-8941-68b684aaf32d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[215779, 6477, 778, 18, 52, "Input",ExpressionUUID->"3549e6be-0b07-4d3c-abd6-202a9712c3a4"],
Cell[216560, 6497, 1180, 25, 81, "Output",ExpressionUUID->"ab050c73-f7ef-45a7-be05-2d879f1465ab"]
}, Open  ]],
Cell[217755, 6525, 227, 5, 35, "Text",ExpressionUUID->"0350c74e-1d9e-4fab-997d-23bbaf569e0d"],
Cell[CellGroupData[{
Cell[218007, 6534, 650, 18, 73, "Input",ExpressionUUID->"397e4dc8-2900-4e45-a8d9-fe5be97cd6e3"],
Cell[218660, 6554, 649, 12, 34, "Output",ExpressionUUID->"ca5ef62f-5e50-450c-b756-314ad8232776"]
}, Open  ]],
Cell[219324, 6569, 198, 3, 35, "Text",ExpressionUUID->"76f3ffa7-eddf-4476-8949-f31fb5836821"],
Cell[219525, 6574, 1602, 48, 94, "Input",ExpressionUUID->"7468a672-6d94-416a-aa0a-cb58a12e7813"],
Cell[221130, 6624, 200, 3, 35, "Text",ExpressionUUID->"5dc901f5-de25-4fad-8d11-2c928700511a"],
Cell[CellGroupData[{
Cell[221355, 6631, 662, 17, 30, "Input",ExpressionUUID->"9a61e5ab-8d0f-438a-b10a-136d38176ee4"],
Cell[222020, 6650, 2492, 54, 99, "Output",ExpressionUUID->"7bc9399f-c127-4304-a402-4ba1e1fc7fae"]
}, Open  ]],
Cell[224527, 6707, 161, 3, 35, "Text",ExpressionUUID->"a53ebdcd-5fd2-4321-a3c9-f72fadd4e239"],
Cell[CellGroupData[{
Cell[224713, 6714, 317, 7, 30, "Input",ExpressionUUID->"cbe7e41d-febf-43c1-aa67-a0d7f3636387"],
Cell[225033, 6723, 350, 6, 34, "Output",ExpressionUUID->"9fbbfa95-f8d8-42c2-a972-ab29891c5e92"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[225444, 6736, 173, 3, 54, "Subsection",ExpressionUUID->"200f1d43-862b-48e5-b0c4-66e7baf1bfd3"],
Cell[CellGroupData[{
Cell[225642, 6743, 272, 6, 38, "MathCaption",ExpressionUUID->"dc7b920a-b5c6-48c5-88bc-9069675bb175"],
Cell[CellGroupData[{
Cell[225939, 6753, 1022, 25, 73, "Input",ExpressionUUID->"4554c789-7854-4252-a865-cefc4edb0552"],
Cell[226964, 6780, 1733, 46, 36, "Output",ExpressionUUID->"a2aa9b24-56ac-4cd9-9cda-713b2f25d963"],
Cell[228700, 6828, 1694, 39, 94, "Output",ExpressionUUID->"fa3bfaf7-be94-48c6-8891-0319332b2dfe"]
}, Open  ]],
Cell[230409, 6870, 221, 5, 35, "Text",ExpressionUUID->"478bcb87-e014-45dc-8d24-55ebb8a2c205"],
Cell[CellGroupData[{
Cell[230655, 6879, 707, 13, 30, "Input",ExpressionUUID->"059015e2-561f-4f7e-8385-2c3e93b5d8ff"],
Cell[231365, 6894, 1759, 48, 41, "Output",ExpressionUUID->"493744ba-796a-42a2-a7ea-44105a1d40e2"]
}, Open  ]],
Cell[233139, 6945, 249, 7, 35, "Text",ExpressionUUID->"8b881b48-487f-415b-9e7c-c66f22aea752"],
Cell[CellGroupData[{
Cell[233413, 6956, 676, 13, 52, "Input",ExpressionUUID->"9fc4c3d7-3782-4bd8-838d-9b8c9d109b4e"],
Cell[234092, 6971, 3751, 120, 174, "Output",ExpressionUUID->"6dccab85-0b9e-4af4-b735-666558c24787"]
}, Open  ]],
Cell[237858, 7094, 484, 10, 58, "Text",ExpressionUUID->"e63f0239-5499-4844-8f0b-589257e37cd9"],
Cell[CellGroupData[{
Cell[238367, 7108, 455, 11, 52, "Input",ExpressionUUID->"ec9a089a-cdf8-4e25-8f72-5e8bf0d9a6f2"],
Cell[238825, 7121, 2574, 78, 111, "Output",ExpressionUUID->"1a996f5c-49f4-4579-9213-eeeafc93674e"]
}, Open  ]],
Cell[241414, 7202, 390, 10, 35, "Text",ExpressionUUID->"f6fb3f00-cb3c-4283-a6f0-f582195ce967"],
Cell[CellGroupData[{
Cell[241829, 7216, 362, 8, 30, "Input",ExpressionUUID->"ae2271fb-074d-4d33-9583-50ea101169c4"],
Cell[242194, 7226, 4058, 115, 123, "Output",ExpressionUUID->"7d49a363-f048-4aa9-b8da-1540fbbb8d55"]
}, Open  ]],
Cell[246267, 7344, 187, 3, 35, "Text",ExpressionUUID->"0419518a-7b40-42a8-bb90-a709b4a60a73"],
Cell[CellGroupData[{
Cell[246479, 7351, 453, 12, 52, "Input",ExpressionUUID->"44e32c84-7ed3-4fba-b6ba-05d594acf37f"],
Cell[246935, 7365, 867, 23, 94, "Output",ExpressionUUID->"94d1139b-47b1-42c9-bb99-9c53fd04d496"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[247851, 7394, 190, 3, 38, "MathCaption",ExpressionUUID->"4a451544-88b4-4e07-9ac8-ae17c65f7020"],
Cell[CellGroupData[{
Cell[248066, 7401, 679, 18, 94, "Input",ExpressionUUID->"88e897e6-5ca8-4cba-b007-a3e7a786aa5e"],
Cell[248748, 7421, 1231, 37, 114, "Output",ExpressionUUID->"16e62691-f44b-4d78-b9b9-b49f1f077f01"]
}, Open  ]],
Cell[249994, 7461, 189, 3, 35, "Text",ExpressionUUID->"ddcb9fe7-bc17-479a-832c-44297dffed5b"],
Cell[CellGroupData[{
Cell[250208, 7468, 782, 18, 52, "Input",ExpressionUUID->"be696d2e-22b3-40f5-b7a6-da4ba963d421"],
Cell[250993, 7488, 1053, 23, 81, "Output",ExpressionUUID->"55f78346-9468-44ee-9ee6-40f03ebfee7b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[252095, 7517, 190, 3, 38, "MathCaption",ExpressionUUID->"3beeca0a-b1aa-4dc7-a2f1-23c557a061c7"],
Cell[CellGroupData[{
Cell[252310, 7524, 732, 19, 94, "Input",ExpressionUUID->"0a8822e7-cf34-4ad9-ab0d-127993ff6fe6"],
Cell[253045, 7545, 1276, 38, 114, "Output",ExpressionUUID->"efb07a50-b327-4229-967e-b2af4e9f31be"]
}, Open  ]],
Cell[254336, 7586, 241, 6, 35, "Text",ExpressionUUID->"433aecbc-0dee-412c-b2ca-09aca6549ae5"],
Cell[CellGroupData[{
Cell[254602, 7596, 726, 17, 52, "Input",ExpressionUUID->"58de3ff9-ffa3-4f82-be06-0a6d90534ecd"],
Cell[255331, 7615, 1099, 24, 81, "Output",ExpressionUUID->"0adffde2-5422-4c3e-84ec-80f9cb578e16"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[256479, 7645, 190, 3, 38, "MathCaption",ExpressionUUID->"829c9dbe-b262-4ef0-b036-2a89d9234cdd"],
Cell[CellGroupData[{
Cell[256694, 7652, 778, 19, 94, "Input",ExpressionUUID->"77c6ead4-c199-4495-b5a8-539fa3cf5175"],
Cell[257475, 7673, 1371, 39, 114, "Output",ExpressionUUID->"545a6549-ee99-4e53-a0f0-6bfdf314f947"]
}, Open  ]],
Cell[258861, 7715, 235, 6, 35, "Text",ExpressionUUID->"b508c97f-d0b2-44b0-8516-6d81b99e24be"],
Cell[CellGroupData[{
Cell[259121, 7725, 799, 18, 52, "Input",ExpressionUUID->"b8312eb3-4af7-4c72-8aaf-f09510dc4138"],
Cell[259923, 7745, 1704, 33, 90, "Output",ExpressionUUID->"7f41934b-9b21-45b3-b26b-ed6cd7a5428d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[261676, 7784, 190, 3, 38, "MathCaption",ExpressionUUID->"d5529d34-6855-40f5-8e23-6b09c9388f75"],
Cell[CellGroupData[{
Cell[261891, 7791, 778, 19, 94, "Input",ExpressionUUID->"eba3f428-2f21-4cd5-bc0b-7ea8ef112241"],
Cell[262672, 7812, 1324, 38, 114, "Output",ExpressionUUID->"4a413300-1002-4da4-b4dc-db4de79209b3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[264033, 7855, 724, 17, 52, "Input",ExpressionUUID->"26239bcb-03f4-4364-9d17-67709f8d15b9"],
Cell[264760, 7874, 2806, 64, 96, "Output",ExpressionUUID->"424b11e5-40b4-471a-b211-54e72117beb8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[267615, 7944, 319, 6, 38, "MathCaption",ExpressionUUID->"4af47efe-af18-48da-945a-38636bdfd5cb"],
Cell[CellGroupData[{
Cell[267959, 7954, 1231, 31, 73, "Input",ExpressionUUID->"0718cfd3-6795-4fb5-a187-6a81dc9bc0f0"],
Cell[269193, 7987, 1886, 49, 36, "Output",ExpressionUUID->"a4999956-c8f8-4ead-bace-90f6f9cc71be"],
Cell[271082, 8038, 2162, 54, 41, "Output",ExpressionUUID->"a077ac29-4a02-4b6c-ac7b-1c660651c099"]
}, Open  ]],
Cell[273259, 8095, 385, 8, 35, "Text",ExpressionUUID->"3950a998-b0aa-413e-8da5-e18ca1c4a880"],
Cell[CellGroupData[{
Cell[273669, 8107, 618, 15, 52, "Input",ExpressionUUID->"497b32ac-c7d6-4e8a-8941-b8d03016b322"],
Cell[274290, 8124, 4264, 119, 123, "Output",ExpressionUUID->"167f8f6d-fd1b-4bfb-b80b-b45cb751b11a"]
}, Open  ]],
Cell[278569, 8246, 519, 10, 58, "Text",ExpressionUUID->"c762f480-3826-4392-82d0-39cebcd912b0"],
Cell[CellGroupData[{
Cell[279113, 8260, 849, 20, 52, "Input",ExpressionUUID->"0e19644d-eeb5-45bc-b2bd-03ef0283c7ef"],
Cell[279965, 8282, 4718, 143, 155, "Output",ExpressionUUID->"80469a25-c1ae-4afa-a18b-1fffe8a7bbed"]
}, Open  ]],
Cell[284698, 8428, 519, 9, 58, "Text",ExpressionUUID->"a37bc400-a813-4061-8732-8b746194a448"],
Cell[CellGroupData[{
Cell[285242, 8441, 407, 9, 30, "Input",ExpressionUUID->"c7dd61fe-3679-4604-b55e-44fb7bb074c4"],
Cell[285652, 8452, 4687, 101, 107, "Output",ExpressionUUID->"b55cd683-5895-4a2c-a1f7-03da6b9eb89f"]
}, Open  ]],
Cell[290354, 8556, 234, 6, 35, "Text",ExpressionUUID->"9ad5e768-cc99-4d70-bbba-3dab12973a1e"],
Cell[CellGroupData[{
Cell[290613, 8566, 406, 10, 52, "Input",ExpressionUUID->"5c8cfbf7-22e5-4a08-97d5-57c06e1cea61"],
Cell[291022, 8578, 4749, 137, 174, "Output",ExpressionUUID->"bf33c71c-4168-4593-a498-a6d337700f93"]
}, Open  ]],
Cell[CellGroupData[{
Cell[295808, 8720, 270, 7, 30, "Input",ExpressionUUID->"d5da649f-8eaf-4db0-872b-470c4892c285"],
Cell[296081, 8729, 933, 24, 94, "Output",ExpressionUUID->"e444e1a0-c4a6-439b-a9c2-ef45e3992b51"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[297087, 8761, 172, 3, 67, "Section",ExpressionUUID->"e6eee955-95c5-4ff8-b4bc-ab9efcbd3a4c"],
Cell[CellGroupData[{
Cell[297284, 8768, 189, 3, 38, "MathCaption",ExpressionUUID->"96411d32-1277-4d4c-9750-fbb4773e5e49"],
Cell[CellGroupData[{
Cell[297498, 8775, 799, 17, 30, "Input",ExpressionUUID->"647fe4eb-2dab-482e-9360-37659dc64fa6"],
Cell[298300, 8794, 1226, 24, 150, "Output",ExpressionUUID->"d9295236-15ba-42ec-bbef-0b4a76edb025"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[299575, 8824, 157, 3, 54, "Subsection",ExpressionUUID->"7b694882-15a8-4eee-846a-163ea3dcd26d"],
Cell[CellGroupData[{
Cell[299757, 8831, 228, 4, 38, "MathCaption",ExpressionUUID->"7cb3e065-f9ff-4e28-929d-b4d1c5e0ae2c"],
Cell[299988, 8837, 615, 14, 73, "Input",ExpressionUUID->"0d19ce3b-6693-49d4-822f-5a1c1b5140d2",
 CellID->947038696],
Cell[300606, 8853, 190, 3, 35, "Text",ExpressionUUID->"a3f69057-086f-466f-8a98-25a52619789f"],
Cell[CellGroupData[{
Cell[300821, 8860, 639, 16, 52, "Input",ExpressionUUID->"10dd29bc-7c3b-4e0a-a16a-ff97918cc7a0",
 CellID->1878055755],
Cell[301463, 8878, 1296, 25, 54, "Output",ExpressionUUID->"0b546b5a-ebf5-4e81-b14b-4c26abfb9e76"]
}, Open  ]],
Cell[302774, 8906, 369, 8, 58, "Text",ExpressionUUID->"e6067341-e968-4420-b9b1-b0ff59f351ed"],
Cell[CellGroupData[{
Cell[303168, 8918, 675, 14, 30, "Input",ExpressionUUID->"c4bfd11f-1235-4f0f-8848-85472af42874",
 CellID->1697248997],
Cell[303846, 8934, 5402, 147, 131, "Output",ExpressionUUID->"fa5a2a20-7dad-4767-b2a9-062134a284f6"]
}, Open  ]],
Cell[309263, 9084, 196, 3, 35, "Text",ExpressionUUID->"bf813263-6327-493f-9ca7-1e98201d6ba0"],
Cell[CellGroupData[{
Cell[309484, 9091, 330, 6, 30, "Input",ExpressionUUID->"811cc859-6537-44a2-a792-7dce5126894c",
 CellID->2133712687],
Cell[309817, 9099, 5750, 116, 167, "Output",ExpressionUUID->"49775c7c-6b1b-4fb5-9488-96a7e4d81bf8"]
}, Open  ]],
Cell[315582, 9218, 167, 3, 35, "Text",ExpressionUUID->"35d7666c-b5ee-4ad7-9186-e86da9e2e488"],
Cell[CellGroupData[{
Cell[315774, 9225, 740, 16, 73, "Input",ExpressionUUID->"d982bf28-e442-4a62-9e5f-f17c0c83722d",
 CellID->818174054],
Cell[316517, 9243, 1047, 15, 34, "Output",ExpressionUUID->"12728580-98ca-46cb-89d5-29218e3c5445"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[317625, 9265, 175, 3, 54, "Subsection",ExpressionUUID->"27de8466-be73-4d89-b932-1a5586c10007"],
Cell[CellGroupData[{
Cell[317825, 9272, 346, 7, 38, "MathCaption",ExpressionUUID->"f1224d59-0d80-4db0-a22e-0a681a9db365"],
Cell[CellGroupData[{
Cell[318196, 9283, 937, 18, 30, "Input",ExpressionUUID->"837e328e-6e89-4936-b84c-50e6d66b7125"],
Cell[319136, 9303, 1200, 21, 146, "Output",ExpressionUUID->"221aa819-873e-4ca7-b1b0-2fe6d3fe94e7"]
}, Open  ]],
Cell[320351, 9327, 244, 6, 35, "Text",ExpressionUUID->"9ef47557-2912-47bd-bd01-9a885bb44186"],
Cell[CellGroupData[{
Cell[320620, 9337, 415, 8, 30, "Input",ExpressionUUID->"652335da-6553-413c-bdc2-88af6fbb8d7b"],
Cell[321038, 9347, 8117, 283, 93, "Output",ExpressionUUID->"7511e44c-f21f-416d-9e92-7165f2c01c47"]
}, Open  ]],
Cell[329170, 9633, 351, 7, 35, "Text",ExpressionUUID->"cca3c7c0-fc0c-4173-88fd-17b637c58d14"],
Cell[CellGroupData[{
Cell[329546, 9644, 864, 23, 73, "Input",ExpressionUUID->"bb47bb06-d1c1-40c7-ab9b-aaf34f0a3fd5"],
Cell[330413, 9669, 3135, 121, 41, "Output",ExpressionUUID->"541c8318-8155-41c4-92c5-1ba01bf219ea"],
Cell[333551, 9792, 739, 11, 34, "Output",ExpressionUUID->"9b061f98-f259-4408-b4c6-2ecb699af09a"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[334341, 9809, 174, 3, 67, "Section",ExpressionUUID->"16cd1aa2-c57d-441e-b1fa-9dbd1778f8d9"],
Cell[CellGroupData[{
Cell[334540, 9816, 156, 3, 53, "Section",ExpressionUUID->"e33fb164-f8c9-42fa-a016-bc5dd211017e"],
Cell[CellGroupData[{
Cell[334721, 9823, 235, 4, 38, "MathCaption",ExpressionUUID->"1f2f73f0-4729-486e-8d90-c0b19240d74b"],
Cell[CellGroupData[{
Cell[334981, 9831, 1186, 30, 73, "Input",ExpressionUUID->"525aaa6d-aff1-45fe-9942-f14e2d0b11f9"],
Cell[336170, 9863, 1863, 48, 44, "Output",ExpressionUUID->"6b4d1e33-85c2-45df-aa52-fe5ad8b8f77e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[338070, 9916, 1335, 35, 157, "Input",ExpressionUUID->"27d10c96-b339-4ea7-9f51-e224dec993c8"],
Cell[339408, 9953, 2570, 72, 138, "Output",ExpressionUUID->"9c1190ad-a013-4ab1-8993-173da15909e9"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[342027, 10031, 259, 6, 38, "MathCaption",ExpressionUUID->"00d628c7-cc8f-46e9-9789-1c7b7b12390b"],
Cell[CellGroupData[{
Cell[342311, 10041, 1233, 32, 73, "Input",ExpressionUUID->"136c2e79-cf39-4bdf-8561-dfcd73f6f73d"],
Cell[343547, 10075, 1919, 53, 44, "Output",ExpressionUUID->"344779f7-5ccd-4f7f-bb5f-2cdad2a3576f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[345503, 10133, 1290, 34, 157, "Input",ExpressionUUID->"099d9590-ffe1-4201-b2aa-535d06ab54f0"],
Cell[346796, 10169, 276, 5, 34, "Output",ExpressionUUID->"37bc6ba4-e60e-4cba-a0a6-705ff479b8d1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[347121, 10180, 309, 7, 38, "MathCaption",ExpressionUUID->"de83f5e8-7dad-430d-a994-5984dc50c454"],
Cell[CellGroupData[{
Cell[347455, 10191, 627, 15, 30, "Input",ExpressionUUID->"b675937d-3b75-4735-a4b2-3820ed123780"],
Cell[348085, 10208, 1030, 24, 94, "Output",ExpressionUUID->"bf99cbbf-9e56-40b3-a3b4-da57d8deac4c"]
}, Open  ]],
Cell[349130, 10235, 254, 6, 35, "Text",ExpressionUUID->"518aec85-f82e-45c9-9ce5-04fae8b01d4f"],
Cell[CellGroupData[{
Cell[349409, 10245, 769, 21, 73, "Input",ExpressionUUID->"284736ae-09ed-48c5-a65e-e92651ed7079"],
Cell[350181, 10268, 6809, 200, 170, "Output",ExpressionUUID->"eb099590-fcf6-41c1-add9-f9005ec702c5"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[357039, 10474, 199, 3, 38, "MathCaption",ExpressionUUID->"2dc4b1da-a102-4a8b-be27-3c4f649551b3"],
Cell[CellGroupData[{
Cell[357263, 10481, 639, 17, 52, "Input",ExpressionUUID->"6a5ba9cf-57a7-4743-8a42-89690406b2ec"],
Cell[357905, 10500, 1437, 43, 38, "Output",ExpressionUUID->"8900b797-7425-4ca6-802d-cc62835bcefd"]
}, Open  ]],
Cell[359357, 10546, 252, 6, 35, "Text",ExpressionUUID->"ace106c4-ecdc-4351-85e3-7be4b8f20cad"],
Cell[CellGroupData[{
Cell[359634, 10556, 673, 18, 30, "Input",ExpressionUUID->"d403f668-2cb6-4cb0-9777-ed394f8fc9d4"],
Cell[360310, 10576, 2432, 56, 70, "Output",ExpressionUUID->"82822b1d-28e2-44c1-becf-8dedcbdad7b7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[362779, 10637, 1033, 26, 52, "Input",ExpressionUUID->"35c86dd4-d3e7-4fe2-a980-e12f3782c5b0"],
Cell[363815, 10665, 4033, 116, 140, "Output",ExpressionUUID->"d5f59617-31f8-40b3-897d-e6accbc13bb3"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

