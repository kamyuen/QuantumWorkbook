(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    457539,      12163]
NotebookOptionsPosition[    435827,      11684]
NotebookOutlinePosition[    436351,      11702]
CellTagsIndexPosition[    436308,      11699]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Entanglement Distillation", "Title",
 CellID->1980526771,ExpressionUUID->"e3335ae1-3816-4b0a-ac1a-259ca89dd70f"],

Cell[TextData[{
 "See also Section 7.3 of the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Quantum Workbook (Springer, 2022)"]], 
    "https://doi.org/10.1007/978-3-030-91214-7"},
   "WebLink",
   BaseStyle->{"Text"}]],ExpressionUUID->
  "6648762d-56e2-458a-bc38-569401efc123"],
 "."
}], "Text",
 CellChangeTimes->{{3.850949404528584*^9, 3.8509494045768213`*^9}, {
  3.85097300684938*^9, 3.850973008015355*^9}, {3.852926047963835*^9, 
  3.852926050054385*^9}, {3.8752460830525627`*^9, 3.8752460850662327`*^9}},
 TextAlignment->"Right",
 CellID->1308734266,ExpressionUUID->"60fe75fc-9244-469e-9e07-e8b1d661bdfd"],

Cell[TextData[{
 "Here, we start with a number of ",
 StyleBox["partially",
  FontSlant->"Italic"],
 " entangled pairs and \
\[OpenCurlyDoubleQuote]distills\[CloseCurlyDoubleQuote] a smaller number of \
",
 StyleBox["maximally",
  FontSlant->"Italic"],
 " entangled pairs. This is illustrated in the quantum circuit model."
}], "Text",
 CellChangeTimes->{{3.876912516101638*^9, 3.876912528215394*^9}},
 CellID->444601366,ExpressionUUID->"1c91212a-cb27-4a49-a2e0-caaf7a40a765"],

Cell[BoxData[GridBox[{
   {
    ButtonBox["VonNeumannEntropy",
     BaseStyle->"Link",
     ButtonData->"paclet:Q3/ref/VonNeumannEntropy"], Cell[
    "VonNeumann entropy of a mixed state", "TableText",ExpressionUUID->
     "edb04415-527a-488f-bc87-26cf536cd3dc"]},
   {
    ButtonBox["PartialTrace",
     BaseStyle->"Link",
     ButtonData->"paclet:Q3/ref/PartialTrace"], Cell[
    "Partial trace over some subsystems", "TableText",ExpressionUUID->
     "3dfef7b8-445d-4369-abf4-1e0dc9c9556c"]},
   {
    ButtonBox["Dyad",
     BaseStyle->"Link",
     ButtonData->"paclet:Q3/ref/Dyad"], Cell[
    "Dyadic product of two vectors", "TableText",ExpressionUUID->
     "a42dc33d-7165-4ab1-8cfa-bb15b4fa6f2f"]}
  }]], "DefinitionBox",
 CellChangeTimes->{{3.875245913898039*^9, 3.8752459510469427`*^9}, {
  3.875246193969157*^9, 3.875246269439661*^9}},
 CellID->1410604422,ExpressionUUID->"36dce4c0-3b60-4b8b-bb7a-648a7d616204"],

Cell["Functions used in this document.", "Caption",
 CellChangeTimes->{{3.8752461994779053`*^9, 3.875246209864244*^9}},
 CellID->1956541321,ExpressionUUID->"03c06594-0719-45e4-bd4f-139b405618da"],

Cell[CellGroupData[{

Cell["Make sure that Q3 is loaded.", "MathCaption",
 CellChangeTimes->{{3.876912626253722*^9, 3.876912634327948*^9}},
 CellID->1329022598,ExpressionUUID->"e626cdff-edee-405c-9619-fd3186ec257b"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[9]:=",
 CellID->172539488,ExpressionUUID->"5c3cdfba-d3e5-4be2-8be5-e654424db65f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
We have two parties Alice (A) and Bob (B). Teddy (T)  is an ancillary \
register to perform a measurement of the total Pauli Z.\
\>", "MathCaption",
 CellChangeTimes->{{3.876912645026947*^9, 3.876912699130384*^9}, {
  3.876912901870419*^9, 3.876912940895978*^9}},
 CellID->1573161274,ExpressionUUID->"f8b90b09-75fd-41d3-b787-db4ae55bcfa2"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "A", ",", "B", ",", "T"}], "]"}]], "Input",
 CellLabel->"In[10]:=",
 CellID->768251366,ExpressionUUID->"26dfcfe6-26c0-4548-a0c2-ae2be1681d41"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "We will start with ",
 StyleBox["n",
  FontSlant->"Italic"],
 " partially entangled pairs."
}], "MathCaption",
 CellChangeTimes->{{3.876913066708404*^9, 3.876913078504644*^9}, {
  3.8769131176279287`*^9, 3.876913118233914*^9}},
 CellID->1676761233,ExpressionUUID->"0f4181d3-092f-4fd3-ace1-f7e04b7ffa73"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kk", "=", 
   RowBox[{"Range", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AA", "=", 
   RowBox[{"A", "[", 
    RowBox[{"kk", ",", "$"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BB", "=", 
   RowBox[{"B", "[", 
    RowBox[{"kk", ",", "$"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.87691295413769*^9, 3.8769129562909327`*^9}, {
  3.885093515990793*^9, 3.8850935166140842`*^9}},
 CellLabel->"In[11]:=",
 CellID->363452503,ExpressionUUID->"f194e1a4-d4f1-4185-adf5-f329e1d25e04"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "You need fewer qubits for T, just enough to store a number up to maximum ",
 StyleBox["n",
  FontSlant->"Italic"],
 ". "
}], "MathCaption",
 CellChangeTimes->{{3.87691297630866*^9, 3.876913055055799*^9}, {
  3.8803928868579483`*^9, 3.88039289997036*^9}},
 CellID->1432690958,ExpressionUUID->"269f75b3-05f0-4f3b-8f4a-0877703dd84e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ln", "=", 
   RowBox[{"Ceiling", "@", 
    RowBox[{"Log", "[", 
     RowBox[{"2", ",", 
      RowBox[{"$n", "+", "1"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TT", "=", 
   RowBox[{"T", "[", 
    RowBox[{
     RowBox[{"Range", "@", "ln"}], ",", "$"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.87691295413769*^9, 3.876912957430442*^9}, 
   3.885093517633275*^9},
 CellLabel->"In[15]:=",
 CellID->1164469075,ExpressionUUID->"d399fc7a-8f68-41b8-890c-1914542401c6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["To Generate Partially Entangled Pairs", "Section",
 CellChangeTimes->{{3.876913131574313*^9, 3.876913138423706*^9}},
 CellID->9608243,ExpressionUUID->"67eace02-e406-44a8-ac18-deb8074e746b"],

Cell[CellGroupData[{

Cell["A Single Pair", "Subsection",
 CellChangeTimes->{{3.880395942433304*^9, 3.880395948999704*^9}},
 CellID->895983480,ExpressionUUID->"58b778a6-05e8-4fc3-9347-97575fdfbaec"],

Cell["\<\
Let us first examine a single pair of partially entangled qubits.\
\>", "Text",
 CellChangeTimes->{{3.880393032403728*^9, 3.8803930497061157`*^9}, 
   3.880393176456087*^9},
 CellID->963914888,ExpressionUUID->"ee0d4f6b-5310-42de-a349-486686a0f204"],

Cell[CellGroupData[{

Cell["\<\
First, construct a superposition of the two computational basis states  with \
different amplitudes.\
\>", "MathCaption",
 CellChangeTimes->{{3.87691319054813*^9, 3.876913249867708*^9}, 
   3.8803930237286987`*^9, {3.880393184310034*^9, 3.880393330226303*^9}, {
   3.880393399335023*^9, 3.880393399748217*^9}, {3.8813532193543873`*^9, 
   3.8813532239584618`*^9}},
 CellID->1326468628,ExpressionUUID->"4455ccba-7011-4cdd-a3c0-3de7d5557c44"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"A", "[", "1", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Rotation", "[", 
     RowBox[{"\[Phi]", ",", 
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "2"}], "]"}]}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.878643894488801*^9, 3.878643896179913*^9}, {
  3.878643959109674*^9, 3.8786439820817213`*^9}, {3.880393685700775*^9, 
  3.880393713855493*^9}},
 CellLabel->"In[17]:=",
 CellID->424466576,ExpressionUUID->"ff095bbe-fdef-474c-b90c-de4fe7dbf16a"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, LineBox[{{{0, -1}, {2, -1}}}], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -1}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-3, 2], 
       Rational[-1, 2]}}, {Full, {-1.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
    Ket[<|$CellContext`A[1, Q3`$] -> 0|>]], 
   Q3`Rotation[$CellContext`\[Phi], 
    $CellContext`A[1, 2]]]]], "Output",
 CellChangeTimes->{{3.876913140801437*^9, 3.8769131798396683`*^9}, 
   3.8769132520638514`*^9, 3.8786407577396507`*^9, 3.878642294850952*^9, 
   3.878643344052194*^9, 3.8786438975737133`*^9, {3.8786439533414907`*^9, 
   3.878643983037034*^9}, 3.879074907009501*^9, 3.879075586126815*^9, {
   3.880393064135133*^9, 3.880393075958736*^9}, {3.880393160540992*^9, 
   3.8803931641449947`*^9}, 3.880393334301059*^9, 3.8803936208831797`*^9, {
   3.88039368728836*^9, 3.8803937142406187`*^9}, 3.885093532284507*^9},
 CellLabel->"Out[18]=",
 CellID->1048517870,ExpressionUUID->"ec3bef3b-8e61-403e-83db-e7545d208033"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Parameter \[Phi] tunes the two amplitudes, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["c", "0"], "=", 
    RowBox[{"cos", "(", 
     RowBox[{"\[Phi]", "/", "2"}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "c3de4684-dd58-4b2b-885b-a2fb615a8a72"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["c", "1"], "=", 
    RowBox[{"sin", "(", 
     RowBox[{"\[Phi]", "/", "2"}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "c2b7fbee-ee68-44f3-86b7-f6ade549eede"],
 ", in the superposition."
}], "MathCaption",
 CellID->1200711519,ExpressionUUID->"b775cd35-77ca-43a9-8064-bb4eb73e9f22"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Elaborate", "[", "qc", "]"}], "//", "ExpandAll"}], "//", 
  "LogicalForm"}]], "Input",
 CellLabel->"In[19]:=",
 CellID->1176269506,ExpressionUUID->"c7be65ad-a30d-4db6-bee1-1f860f9a9dd9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cos", "[", 
    FractionBox["\[Phi]", "2"], "]"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1|>]], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.8769131688566933`*^9, 3.876913180501377*^9}, 
   3.8769132528407*^9, 3.8786407586495447`*^9, 3.878642295499794*^9, 
   3.878643898613244*^9, 3.87864398562213*^9, 3.8790749077595043`*^9, 
   3.879075587853265*^9, 3.880393335215925*^9, 3.8803934072108727`*^9, {
   3.880393618004657*^9, 3.880393622047637*^9}, {3.880393689031229*^9, 
   3.880393715745269*^9}, 3.885093533569775*^9},
 CellLabel->"Out[19]=",
 CellID->1173514270,ExpressionUUID->"5fd3ed5c-8177-49b7-82e6-de1f065a7ce4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Then, by applying the CNOT gate, you can create a partially entangled pair.\
\>", "MathCaption",
 CellChangeTimes->{{3.8769133051661263`*^9, 3.87691332837848*^9}},
 CellID->1153639981,ExpressionUUID->"3edfed6c-bf50-4ecd-9084-d10869c27e54"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", "[", "1", "]"}], ",", 
       RowBox[{"B", "[", "1", "]"}]}], "}"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Rotation", "[", 
     RowBox[{"\[Phi]", ",", 
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "2"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ",", 
      RowBox[{"B", "[", "1", "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.876913342721538*^9, 3.876913349385829*^9}, {
  3.878643814462079*^9, 3.87864382900854*^9}, {3.8786439908667927`*^9, 
  3.878643991075796*^9}, {3.881353378271912*^9, 3.8813533939220247`*^9}},
 CellLabel->"In[20]:=",
 CellID->1509698055,ExpressionUUID->"06706e9a-b84e-4e6f-87c1-7011523ced6e"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.10666666666666667`],
       FontWeight->"Light"], {-0.1, -1}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.10666666666666667`],
       FontWeight->"Light"], {-0.1, -2}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->154.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
    Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`B[1, Q3`$] -> 0|>]], 
   Q3`Rotation[$CellContext`\[Phi], 
    $CellContext`A[1, 2]], 
   Q3`CNOT[{
      $CellContext`A[1, Q3`$]} -> {1}, {
     $CellContext`B[1, Q3`$]}]]]], "Output",
 CellChangeTimes->{
  3.8769133498441896`*^9, 3.8786407596817837`*^9, 3.878642296644698*^9, 
   3.878643347417542*^9, {3.878643815871079*^9, 3.878643829491767*^9}, 
   3.878643991595294*^9, 3.879074908835929*^9, 3.879075589505248*^9, 
   3.880393411086998*^9, 3.8803936234689417`*^9, {3.880393701231266*^9, 
   3.8803937170320787`*^9}, {3.8813533944021893`*^9, 3.8813533970369053`*^9}, 
   3.885093534981434*^9},
 CellLabel->"Out[20]=",
 CellID->1737262035,ExpressionUUID->"a8b1f587-e995-4c96-9ba8-9bdf38f58a7c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Eventually, we see that the parameter \[Phi] tunes the extent of \
entanglement (with ",
 Cell[BoxData[
  RowBox[{"\[Phi]", "=", 
   RowBox[{"\[Pi]", "/", "2"}]}]], "InlineFormula",ExpressionUUID->
  "7aa2bbed-5173-46ab-bdc5-9d38cc394a89"],
 " corresponds to the maximal entanglement)."
}], "MathCaption",
 CellChangeTimes->{{3.88039343821378*^9, 3.88039353375525*^9}, 
   3.8803936315407553`*^9, {3.881353493598611*^9, 3.88135349622465*^9}},
 CellID->424047388,ExpressionUUID->"70773f4c-3264-40dc-8059-b8b90e1b9b1a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Elaborate", "[", "qc", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", "out", "]"}]}], "Input",
 CellChangeTimes->{{3.876913353301922*^9, 3.876913361197649*^9}},
 CellLabel->"In[21]:=",
 CellID->2084847387,ExpressionUUID->"dc12f677-158d-4246-9557-c7893481ec36"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cos", "[", 
    FractionBox["\[Phi]", "2"], "]"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`B[1, Q3`$] -> 0|>]]}], 
  "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`B[1, Q3`$] -> 1|>]], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.8769133614994*^9, 3.8769133646660337`*^9}, 
   3.878640760463359*^9, 3.878642298045225*^9, 3.8786433492266703`*^9, {
   3.8786438170793962`*^9, 3.8786438306077347`*^9}, 3.878643994925807*^9, 
   3.879074910158477*^9, 3.879075591132504*^9, 3.880393412346282*^9, 
   3.880393634761771*^9, 3.880393719850718*^9, 3.885093536483519*^9},
 CellLabel->"Out[22]=",
 CellID->1217109847,ExpressionUUID->"bf97d76e-e968-414b-9b89-4111dfc51628"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Examine the reduced density matrix for the first qubit to check that the \
above state is partial entangled.\
\>", "MathCaption",
 CellChangeTimes->{{3.8786408412853193`*^9, 3.87864088124024*^9}},
 CellID->1376812949,ExpressionUUID->"f3934c61-3e97-4ba8-bf03-dfb369a8a3df"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rho", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"PartialTrace", "[", 
      RowBox[{"out", ",", 
       RowBox[{"B", "[", "1", "]"}]}], "]"}], "//", "ExpToTrig"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Matrix", "[", "rho", "]"}], "//", "ExpToTrig"}], "//", 
   "SimplifyThrough"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8786407734333897`*^9, 3.8786408314509993`*^9}, {
  3.880393727659211*^9, 3.880393880419697*^9}, {3.880394392000411*^9, 
  3.880394408300583*^9}, {3.880394494373603*^9, 3.880394495102461*^9}, {
  3.880395556284378*^9, 3.880395578530567*^9}},
 CellLabel->"In[23]:=",
 CellID->1003824959,ExpressionUUID->"a26928a2-7adf-4dfc-b6af-d1b73235e24d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        FractionBox["\[Phi]", "2"], "]"}], "2"], "0"},
     {"0", 
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        FractionBox["\[Phi]", "2"], "]"}], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 1, 2}, {{1}, {2}}}, {
      Cos[Rational[1, 2] $CellContext`\[Phi]]^2, 
       Sin[Rational[1, 2] $CellContext`\[Phi]]^2}}]]]]], "Output",
 CellChangeTimes->{{3.8786407932773743`*^9, 3.878640831693551*^9}, 
   3.878640883437249*^9, 3.878643997594508*^9, 3.879074911446179*^9, 
   3.879075593093429*^9, 3.880393639283321*^9, {3.8803937235801897`*^9, 
   3.880393888705467*^9}, 3.8803944093772383`*^9, {3.88039448855083*^9, 
   3.880394499523086*^9}, {3.88039555259525*^9, 3.8803955807013493`*^9}, 
   3.88039588094311*^9, 3.8850935379934607`*^9},
 CellLabel->"Out[24]//MatrixForm=",
 CellID->1842251042,ExpressionUUID->"12358009-f987-45a8-b9ee-fe4066600fb5"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Multiple Pairs", "Subsection",
 CellChangeTimes->{{3.8803959623174257`*^9, 3.8803959681567297`*^9}},
 CellID->443447814,ExpressionUUID->"5b28959a-a2ff-4e73-bec9-da1693954f99"],

Cell[TextData[{
 "Now, we consider ",
 StyleBox["n",
  FontSlant->"Italic"],
 " partially entangled pairs with each pair in the state described above. Let \
us take a look at the explicit expression for the ",
 StyleBox["n",
  FontSlant->"Italic"],
 " partially entangled pairs. Here, ",
 ButtonBox["OTimes",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/OTimes"],
 "  is used just for better readability, and you can replace it with ",
 ButtonBox["CircleTimes",
  BaseStyle->"Link",
  ButtonData->"paclet:ref/CircleTimes"],
 " (\[CircleTimes]) or ",
 ButtonBox["Multiply",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/multiply"],
 " to get exactly the same result."
}], "Text",
 CellChangeTimes->{{3.881353570092461*^9, 3.881353576713169*^9}, 
   3.881353636270911*^9, {3.881353680191763*^9, 3.881353681626239*^9}, 
   3.881353728812323*^9},
 CellID->2081747837,ExpressionUUID->"f3d9c9d2-149a-43bc-b609-cd9dd58fef1c"],

Cell[CellGroupData[{

Cell["\<\
Repeating the above procedure for other pairs, generate as many partially \
entangled pairs as  you like. In this particular example, we prepare four \
pairs.\
\>", "MathCaption",
 CellChangeTimes->{{3.8769133722392273`*^9, 3.8769134369362707`*^9}, {
  3.878640907368731*^9, 3.878640908865217*^9}},
 CellID->70875601,ExpressionUUID->"20301db3-9431-4eb6-80db-fdfe37b269e5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc0", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", "AA"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", "BB"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Rotation", "[", 
     RowBox[{"\[Phi]", ",", 
      RowBox[{"A", "[", 
       RowBox[{"kk", ",", "2"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"ReleaseHold", "@", 
      RowBox[{"Thread", "@", 
       RowBox[{
        RowBox[{"Hold", "[", "CNOT", "]"}], "[", 
        RowBox[{"AA", ",", "BB"}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"A", "[", 
      RowBox[{"$n", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.878644005434927*^9, 3.878644008118101*^9}, {
  3.879075565830962*^9, 3.879075574139718*^9}},
 CellLabel->"In[25]:=",
 CellID->170713811,ExpressionUUID->"49597941-f7d9-4a17-a29d-113d9875318c"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}, {{
     0, -4}, {6, -4}}, {{0, -6}, {6, -6}}, {{0, -7}, {6, -7}}, {{0, -8}, {
     6, -8}}, {{0, -9}, {6, -9}}}], {{InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.05333333333333334],
        FontWeight->"Light"], {-0.1, -1}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.05333333333333334],
        FontWeight->"Light"], {-0.1, -2}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.05333333333333334],
        FontWeight->"Light"], {-0.1, -3}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.05333333333333334],
        FontWeight->"Light"], {-0.1, -4}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.05333333333333334],
        FontWeight->"Light"], {-0.1, -6}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.05333333333333334],
        FontWeight->"Light"], {-0.1, -7}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.05333333333333334],
        FontWeight->"Light"], {-0.1, -8}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.05333333333333334],
        FontWeight->"Light"], {-0.1, -9}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
      LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
       0.6, -1.4}}], InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.06666666666666667],
        FontWeight->"Light",
        FontSlant->Italic], {1, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
      LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
       0.6, -2.4}}], InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.06666666666666667],
        FontWeight->"Light",
        FontSlant->Italic], {1, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, 
      LineBox[{{0.6, -3.4}, {1.4, -3.4}, {1.4, -2.6}, {0.6, -2.6}, {
       0.6, -3.4}}], InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.06666666666666667],
        FontWeight->"Light",
        FontSlant->Italic], {1, -3}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, 
      LineBox[{{0.6, -4.4}, {1.4, -4.4}, {1.4, -3.6}, {0.6, -3.6}, {
       0.6, -4.4}}], InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.06666666666666667],
        FontWeight->"Light",
        FontSlant->Italic], {1, -4}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}, {LineBox[{{2, -1}, {2, -6}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -6}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -6}, {2.2666666666666666`, -6}}, {{
         2, -6.266666666666667}, {2, -5.733333333333333}}}]}}, {
     LineBox[{{3, -2}, {3, -7}}], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -7}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -7}, {3.2666666666666666`, -7}}, {{
         3, -7.266666666666667}, {3, -6.733333333333333}}}]}}, {
     LineBox[{{4, -3}, {4, -8}}], 
     DiskBox[{4, -3}, 0.09], {CircleBox[{4, -8}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -8}, {4.266666666666667, -8}}, {{
         4, -8.266666666666667}, {4, -7.733333333333333}}}]}}, {
     LineBox[{{5, -4}, {5, -9}}], 
     DiskBox[{5, -4}, 0.09], {CircleBox[{5, -9}, 0.26666666666666666], 
      LineBox[{{{4.733333333333333, -9}, {5.266666666666667, -9}}, {{
         5, -9.266666666666667}, {5, -8.733333333333333}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->262.8,
   PlotRange->NCache[{Full, {
       Rational[-19, 2], 
       Rational[-1, 2]}}, {Full, {-9.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
    Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
      0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>], 
    Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
      0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]], {
    Q3`Rotation[$CellContext`\[Phi], 
     $CellContext`A[1, 2]], 
    Q3`Rotation[$CellContext`\[Phi], 
     $CellContext`A[2, 2]], 
    Q3`Rotation[$CellContext`\[Phi], 
     $CellContext`A[3, 2]], 
    Q3`Rotation[$CellContext`\[Phi], 
     $CellContext`A[4, 2]]}, 
   Q3`CNOT[{
      $CellContext`A[1, Q3`$]} -> {1}, {
     $CellContext`B[1, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`A[2, Q3`$]} -> {1}, {
     $CellContext`B[2, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`A[3, Q3`$]} -> {1}, {
     $CellContext`B[3, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`A[4, Q3`$]} -> {1}, {
     $CellContext`B[4, Q3`$]}], "Invisible" -> $CellContext`A[
     Rational[9, 2]]]]], "Output",
 CellChangeTimes->{{3.87691343168961*^9, 3.876913439112975*^9}, 
   3.878640960402698*^9, 3.8786423022000237`*^9, 3.878643354022149*^9, 
   3.8786440086508512`*^9, 3.8790749128874397`*^9, {3.8790755759841137`*^9, 
   3.879075595019438*^9}, 3.880395974204973*^9, 3.8803960127988653`*^9, 
   3.88509354139666*^9},
 CellLabel->"Out[25]=",
 CellID->330621890,ExpressionUUID->"6832796e-5577-45ee-9873-225e1051ce4e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Expanding it, one gets various terms, each with identical parts on Alice\
\[CloseCurlyQuote]s and Bob\[CloseCurlyQuote]s side.\
\>", "MathCaption",
 CellChangeTimes->{{3.880396128133203*^9, 3.880396129232284*^9}, 
   3.881353834810112*^9},
 CellID->1017693123,ExpressionUUID->"115db23e-3de8-43d4-93b5-3d0b58b21815"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Elaborate", "[", "qc0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ProductForm", "[", 
  RowBox[{"out", ",", 
   RowBox[{"{", 
    RowBox[{"AA", ",", "BB"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.880396016750554*^9, 3.880396047144247*^9}},
 CellLabel->"In[26]:=",
 CellID->1372770070,ExpressionUUID->"3d9c0a09-4f34-426d-a193-2139db7333ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"0", "0", "0", "0"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"0", "0", "0", "0"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<||>]]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "3"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"0", "0", "0", "1"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"0", "0", "0", "1"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[4, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}], "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"1", "1", "1", "1"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"1", "1", "1", "1"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
      1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 
      1, $CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
      1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], " ", 
   
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "4"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"0", "1", "0", "0"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"0", "1", "0", "0"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[2, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 1|>]], " ", 
   RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"1", "0", "0", "0"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"1", "0", "0", "0"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`B[1, Q3`$] -> 1|>]], " ", 
   RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"0", "1", "1", "1"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"0", "1", "1", "1"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[2, Q3`$] -> 1, $CellContext`A[3, Q3`$] -> 
      1, $CellContext`A[4, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
      1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], " ", 
   
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"1", "0", "1", "1"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"1", "0", "1", "1"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[3, Q3`$] -> 
      1, $CellContext`A[4, Q3`$] -> 1, $CellContext`B[1, Q3`$] -> 
      1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], " ", 
   
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"1", "1", "0", "1"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"1", "1", "0", "1"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
      1, $CellContext`A[4, Q3`$] -> 1, $CellContext`B[1, Q3`$] -> 
      1, $CellContext`B[2, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], " ", 
   
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"1", "1", "1", "0"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"1", "1", "1", "0"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
      1, $CellContext`A[3, Q3`$] -> 1, $CellContext`B[1, Q3`$] -> 
      1, $CellContext`B[2, Q3`$] -> 1, $CellContext`B[3, Q3`$] -> 1|>]], " ", 
   
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"Cot", "[", 
    FractionBox["\[Phi]", "2"], "]"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"0", "0", "1", "0"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"0", "0", "1", "0"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[3, Q3`$] -> 1, $CellContext`B[3, Q3`$] -> 1|>]], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"0", "0", "1", "1"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"0", "0", "1", "1"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 
      1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], " ", 
   
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"0", "1", "0", "1"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"0", "1", "0", "1"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[2, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 
      1, $CellContext`B[2, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], " ", 
   
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"0", "1", "1", "0"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"0", "1", "1", "0"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[2, Q3`$] -> 1, $CellContext`A[3, Q3`$] -> 
      1, $CellContext`B[2, Q3`$] -> 1, $CellContext`B[3, Q3`$] -> 1|>]], " ", 
   
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"1", "0", "0", "1"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"1", "0", "0", "1"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 
      1, $CellContext`B[1, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], " ", 
   
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"1", "0", "1", "0"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"1", "0", "1", "0"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[3, Q3`$] -> 
      1, $CellContext`B[1, Q3`$] -> 1, $CellContext`B[3, Q3`$] -> 1|>]], " ", 
   
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"1", "1", "0", "0"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"1", "1", "0", "0"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
      1, $CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 1|>]], " ", 
   
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{{3.880396022685285*^9, 3.880396047536476*^9}, 
   3.885093542820745*^9},
 CellLabel->"Out[27]=",
 CellID->1457333493,ExpressionUUID->"5a2fb2be-7ed6-4ba9-927b-7fe7d5b542cc"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "If Alice (or Bob) measures the total ",
 Cell[BoxData[
  FormBox["Z", TraditionalForm]],ExpressionUUID->
  "017f7821-c342-4df3-982d-d6d0bd7d47bb"],
 ", i.e., ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Z", "=", 
    RowBox[{
     SubscriptBox["Z", "1"], "+", 
     SubscriptBox["Z", "2"], "+", "\[Ellipsis]", "+", 
     SubscriptBox["Z", "n"]}]}], TraditionalForm]],ExpressionUUID->
  "84941348-b9b7-4609-83cd-e2d2981c0c8f"],
 " on her qubits (see below), then the possible outcomes are  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"m", "=", "0"}], ",", "1", ",", "\[Ellipsis]", ",", "n"}], 
   TraditionalForm]],ExpressionUUID->"67ffbfc3-1609-4fc6-96b2-42b244c8364f"],
 " and the corresponding probabilities are given by the following formula."
}], "Text",
 CellChangeTimes->{{3.880396147807066*^9, 3.8803961489106283`*^9}, {
  3.880396264129702*^9, 3.880396318243441*^9}},
 CellID->1171545641,ExpressionUUID->"aadce766-e449-4160-83e8-dfd4254d70d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"prb", "[", 
   RowBox[{"\[Phi]_", ",", "m_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p", "=", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Phi]", "/", "2"}], "]"}], "^", "2"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"Binomial", "[", 
      RowBox[{"$n", ",", "m"}], "]"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"$n", "-", "m"}], ")"}]}], 
     RowBox[{"p", "^", "m"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8803961926081944`*^9, 3.880396234759754*^9}},
 CellLabel->"In[29]:=",
 CellID->225912086,ExpressionUUID->"70e2f9d9-c8a9-4ec3-b730-fc7f9b5be262"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "For fixed ",
 Cell[BoxData[
  FormBox["\[Phi]", TraditionalForm]],ExpressionUUID->
  "554d793c-a187-40c8-8cc8-64bd78c62e0e"],
 ", the probability distribution looks like the following plot. The highest \
probability is for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "=", 
    RowBox[{"n", "\[VeryThinSpace]", 
     RowBox[{
      SuperscriptBox["sin", "2"], "(", 
      RowBox[{"\[Phi]", "/", "2"}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"cd570e65-4039-42d1-b090-85903385f781"],
 " (",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "=", "3"}], TraditionalForm]],ExpressionUUID->
  "5f1b987d-3402-4729-9ff8-4e71bb04fadb"],
 " for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Phi]", "=", 
    RowBox[{"2", 
     RowBox[{"\[Pi]", "/", "3"}]}]}], TraditionalForm]],ExpressionUUID->
  "bc8bc1d7-9967-456d-81a6-6bdc06c2d038"],
 ")."
}], "Text",
 CellChangeTimes->{{3.88039615675043*^9, 3.880396170001844*^9}, {
  3.880396359399383*^9, 3.8803963913132877`*^9}},
 CellID->428998052,ExpressionUUID->"2c4b1d54-f870-458a-afbf-8eaad838da15"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BarChart", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"prb", "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"Pi", "/", "3"}]}], ",", "m"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "$n"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ChartLabels", "->", 
    RowBox[{"Range", "[", "$n", "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"Axes", "->", "None"}], ",", 
   RowBox[{"Frame", "->", "True"}], ",", "\[IndentingNewLine]", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<m\>\"", ",", "\"\<Probability\>\""}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.880396224123349*^9, 3.880396228441606*^9}},
 CellLabel->"In[30]:=",
 CellID->153341506,ExpressionUUID->"f9b6efeb-5191-4ff5-afc2-4239e623f4ea"],

Cell[BoxData[
 GraphicsBox[{
   {Opacity[0], 
    PointBox[{{0.0195484340859432, 0.}, {4.902403495994173, 0.}}]}, {{}, 
    {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
     0.6719999999999999], Thickness[Small]}], 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.6719999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{0.5487982520029133, 0.}, {1.4512017479970867`, 
             0.046875}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{60.87090284241427, 97.29808835111335}, {
            30.691406212324726`, 44.40188272185373}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 
          Rational[3, 64]]& ,
         TagBoxNote->"3/64"],
        StyleBox[
         FractionBox["3", "64"], {}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Rational[3, 64], {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.6719999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{1.5487982520029133`, 0.}, {2.4512017479970867`, 
             0.2109375}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{100.68367580725999`, 
            137.11086131595906`}, {-15.545261571026792`, 44.40188272185373}}],
          
          "DelayedMouseEffectStyle"],
         StatusArea[#, 
          Rational[27, 128]]& ,
         TagBoxNote->"27/128"],
        StyleBox[
         FractionBox["27", "128"], {}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Rational[27, 128], {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.6719999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{2.5487982520029133`, 0.}, {3.4512017479970867`, 
             0.421875}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{140.49644877210568`, 
            176.92363428080478`}, {-74.99240586390732, 44.401882721853724`}}],
          
          "DelayedMouseEffectStyle"],
         StatusArea[#, 
          Rational[27, 64]]& ,
         TagBoxNote->"27/64"],
        StyleBox[
         FractionBox["27", "64"], {}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Rational[27, 64], {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.6719999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{3.5487982520029133`, 0.}, {4.451201747997087, 
             0.31640625}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{180.3092217369514, 
            216.7364072456505}, {-45.268833717467054`, 44.40188272185373}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 
          Rational[81, 256]]& ,
         TagBoxNote->"81/256"],
        StyleBox[
         FractionBox["81", "256"], {}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Rational[81, 256], {}], "Tooltip"]& ]}}, {}, {}}, {}, {}, {}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0.0195484340859432, 0.},
  AxesStyle->{},
  CoordinatesToolOptions:>{"DisplayFunction" -> ({
      Identity[
       Part[#, 1]], 
      Identity[
       Part[#, 2]]}& ), "CopiedValueFunction" -> ({
      Identity[
       Part[#, 1]], 
      Identity[
       Part[#, 2]]}& )},
  DisplayFunction->Identity,
  Frame->True,
  FrameLabel->{{
     FormBox[
      TagBox["\"Probability\"", HoldForm], TraditionalForm], None}, {
     FormBox[
      TagBox["\"m\"", HoldForm], TraditionalForm], None}},
  FrameStyle->{},
  FrameTicks->{{Automatic, Automatic}, {{{1., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {1., 
       FormBox["1", TraditionalForm], 0}, {2., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {2., 
       FormBox["2", TraditionalForm], 0}, {3., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {3., 
       FormBox["3", TraditionalForm], 0}, {4., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {4., 
       FormBox["4", TraditionalForm], 0}}, {{1., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {2., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {3., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {4., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}}}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Automatic,
  PlotRange->{{All, All}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {None, 
     Scaled[0.05]}},
  Ticks->{None, Automatic}]], "Output",
 CellChangeTimes->{{3.880396183069512*^9, 3.8803962420130453`*^9}, 
   3.8803962911924477`*^9, 3.880396402440311*^9, {3.885093545817794*^9, 
   3.885093555009*^9}},
 CellLabel->"Out[30]=",
 CellID->559857069,ExpressionUUID->"8a924f71-713a-4a81-9c93-e5fa7fadac1f"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Measurement of Total Pauli Z", "Section",
 CellID->224262840,ExpressionUUID->"2a853ae2-2058-412a-894e-7d95da384bfb"],

Cell[TextData[{
 "How can we actually measure ",
 Cell[BoxData[Cell[TextData[Cell[BoxData[
   FormBox[
    RowBox[{
     SubscriptBox["Z", "tot"], ":=", 
     RowBox[{
      SubscriptBox["Z", "1"], "+", 
      SubscriptBox["Z", "2"], "+", "\[Ellipsis]", "+", 
      SubscriptBox["Z", "n"]}]}], TraditionalForm]],ExpressionUUID->
   "7bbcced6-851c-44a9-9be8-484a27dc4540"]],ExpressionUUID->
   "69787956-9626-4928-a81f-683e7deac14b"]],ExpressionUUID->
  "83d30246-6808-479b-a079-93c3675b04f1"],
 "on Bob's (or, equivalently, Alice's) qubits."
}], "Text",
 CellChangeTimes->{{3.876913449951779*^9, 3.876913455682701*^9}, {
  3.876913504724951*^9, 3.8769135283212643`*^9}, {3.881354036837327*^9, 
  3.881354044654537*^9}},
 CellID->1184887274,ExpressionUUID->"48fc5445-ae2b-4f18-b082-3fca0c66c976"],

Cell[CellGroupData[{

Cell[TextData[{
 "To specific, we assume ",
 Cell[BoxData[
  RowBox[{"\[Phi]", "=", 
   RowBox[{"2", 
    RowBox[{"\[Pi]", "/", "3"}]}]}]], "InlineFormula",ExpressionUUID->
  "aff57575-790e-4529-943e-b677419f013d"],
 " from now on."
}], "MathCaption",
 CellChangeTimes->{{3.880396427729391*^9, 3.8803964484871683`*^9}},
 CellID->1611641769,ExpressionUUID->"2190b60b-1c08-44ad-91b6-6d3198502349"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Phi]", "=", 
  RowBox[{"2", 
   RowBox[{"Pi", "/", "3"}]}]}]], "Input",
 CellChangeTimes->{{3.880396462893618*^9, 3.8803964651479607`*^9}},
 CellLabel->"In[31]:=",
 CellID->984885170,ExpressionUUID->"e30d9019-04c2-4dd3-a672-bc7be9efeebf"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", "\[Pi]"}], "3"]], "Output",
 CellChangeTimes->{{3.880396465641108*^9, 3.8803964671748953`*^9}, 
   3.885093557101038*^9},
 CellLabel->"Out[31]=",
 CellID->65799194,ExpressionUUID->"66463e51-1a29-43e6-9803-4c4bb7bae3c3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["This is a tiny utility function for convenience.", "MathCaption",
 CellChangeTimes->{{3.880396476602742*^9, 3.8803964921432753`*^9}},
 CellID->145578351,ExpressionUUID->"080e79ed-ca53-459c-b818-d710af35f15c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bundle", "[", "]"}], ":=", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"bundle", "[", "c", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "$n"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bundle", "[", "c_", "]"}], ":=", 
  RowBox[{"With", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"log", "=", 
      RowBox[{"Ceiling", "@", 
       RowBox[{"Log", "[", 
        RowBox[{"2", ",", 
         RowBox[{"c", "+", "1"}]}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CNOT", "[", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{
          RowBox[{"T", "@", 
           RowBox[{"Range", "[", 
            RowBox[{"k", "-", "1"}], "]"}]}], ",", 
          RowBox[{"B", "[", "c", "]"}]}], "]"}], ",", 
        RowBox[{"T", "[", "k", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"k", ",", "log", ",", "1", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.880396527505249*^9, 3.88039657717556*^9}, {
  3.880396642525466*^9, 3.880396642862652*^9}, {3.880396783685821*^9, 
  3.880396808018189*^9}, {3.8803971325040207`*^9, 3.8803971463961678`*^9}},
 CellLabel->"In[32]:=",
 CellID->1429019289,ExpressionUUID->"6cc38884-16f5-4c2e-bb3e-51700d3b779e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The value of ",
 Cell[BoxData[Cell[TextData[Cell[BoxData[
   FormBox[
    SubscriptBox["Z", "tot"], TraditionalForm]],ExpressionUUID->
   "8e95616a-a134-4201-96bb-ec4c490eab26"]],ExpressionUUID->
   "7410e034-03a5-456f-85a8-e2c04028fdaf"]],ExpressionUUID->
  "516334db-a950-41ea-8345-2cd7700a78c6"],
 " is stored on Teddy's register."
}], "MathCaption",
 CellChangeTimes->{{3.876913556837555*^9, 3.8769136287401648`*^9}},
 CellID->2075092591,ExpressionUUID->"83e8397c-67e1-4283-8dfe-900d952b47a9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ket", "[", "TT", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"bundle", "[", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"B", "[", 
      RowBox[{"$n", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8803969417077627`*^9, 3.880396946412813*^9}},
 CellLabel->"In[34]:=",
 CellID->2010699221,ExpressionUUID->"d5f55e09-e0dd-4c39-ba05-d16295e1b36a"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {9, -1}}, {{0, -2}, {9, -2}}, {{0, -3}, {9, -3}}, {{
     0, -4}, {9, -4}}, {{0, -6}, {9, -6}}, {{0, -7}, {9, -7}}, {{0, -8}, {
     9, -8}}}], {InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.035555555555555556`],
       FontWeight->"Light"], {-0.1, -6}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.035555555555555556`],
       FontWeight->"Light"], {-0.1, -7}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.035555555555555556`],
       FontWeight->"Light"], {-0.1, -8}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {
     LineBox[{{1, -1}, {1, -6}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -6}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -6}, {1.2666666666666666`, -6}}, {{
         1, -6.266666666666667}, {1, -5.733333333333333}}}]}}, {
     LineBox[{{2, -2}, {2, -6}, {2, -7}}], DiskBox[{2, -2}, 0.09], 
     DiskBox[{2, -6}, 0.09], {CircleBox[{2, -7}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -7}, {2.2666666666666666`, -7}}, {{
         2, -7.266666666666667}, {2, -6.733333333333333}}}]}}, {
     LineBox[{{3, -2}, {3, -6}}], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -6}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -6}, {3.2666666666666666`, -6}}, {{
         3, -6.266666666666667}, {3, -5.733333333333333}}}]}}, {
     LineBox[{{4, -3}, {4, -6}, {4, -7}}], DiskBox[{4, -3}, 0.09], 
     DiskBox[{4, -6}, 0.09], {CircleBox[{4, -7}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -7}, {4.266666666666667, -7}}, {{
         4, -7.266666666666667}, {4, -6.733333333333333}}}]}}, {
     LineBox[{{5, -3}, {5, -6}}], 
     DiskBox[{5, -3}, 0.09], {CircleBox[{5, -6}, 0.26666666666666666], 
      LineBox[{{{4.733333333333333, -6}, {5.266666666666667, -6}}, {{
         5, -6.266666666666667}, {5, -5.733333333333333}}}]}}, {
     LineBox[{{6, -4}, {6, -6}, {6, -7}, {6, -8}}], DiskBox[{6, -4}, 0.09], 
     DiskBox[{6, -6}, 0.09], 
     DiskBox[{6, -7}, 0.09], {CircleBox[{6, -8}, 0.26666666666666666], 
      LineBox[{{{5.733333333333333, -8}, {6.266666666666667, -8}}, {{
         6, -8.266666666666667}, {6, -7.733333333333333}}}]}}, {
     LineBox[{{7, -4}, {7, -6}, {7, -7}}], DiskBox[{7, -4}, 0.09], 
     DiskBox[{7, -6}, 0.09], {CircleBox[{7, -7}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -7}, {7.266666666666667, -7}}, {{
         7, -7.266666666666667}, {7, -6.733333333333333}}}]}}, {
     LineBox[{{8, -4}, {8, -6}}], 
     DiskBox[{8, -4}, 0.09], {CircleBox[{8, -6}, 0.26666666666666666], 
      LineBox[{{{7.733333333333333, -6}, {8.266666666666667, -6}}, {{
         8, -6.266666666666667}, {8, -5.733333333333333}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->370.8,
   PlotRange->NCache[{Full, {
       Rational[-17, 2], 
       Rational[-1, 2]}}, {Full, {-8.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
    Ket[<|$CellContext`T[1, Q3`$] -> 0, $CellContext`T[2, Q3`$] -> 
      0, $CellContext`T[3, Q3`$] -> 0|>]], 
   Q3`CNOT[{
      $CellContext`B[1, Q3`$]} -> {1}, {
     $CellContext`T[1, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`B[2, Q3`$], 
      $CellContext`T[1, Q3`$]} -> {1, 1}, {
     $CellContext`T[2, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`B[2, Q3`$]} -> {1}, {
     $CellContext`T[1, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`B[3, Q3`$], 
      $CellContext`T[1, Q3`$]} -> {1, 1}, {
     $CellContext`T[2, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`B[3, Q3`$]} -> {1}, {
     $CellContext`T[1, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`B[4, Q3`$], 
      $CellContext`T[1, Q3`$], 
      $CellContext`T[2, Q3`$]} -> {1, 1, 1}, {
     $CellContext`T[3, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`B[4, Q3`$], 
      $CellContext`T[1, Q3`$]} -> {1, 1}, {
     $CellContext`T[2, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`B[4, Q3`$]} -> {1}, {
     $CellContext`T[1, Q3`$]}], "Invisible" -> $CellContext`B[
     Rational[9, 2]]]]], "Output",
 CellChangeTimes->{
  3.876913542454103*^9, {3.876913630152197*^9, 3.876913643892964*^9}, 
   3.8786409468970757`*^9, 3.878642305537879*^9, 3.878643358392415*^9, 
   3.878644019090724*^9, 3.879074916850519*^9, 3.8790755985815563`*^9, 
   3.880396417741639*^9, {3.880396803245503*^9, 3.880396810910219*^9}, {
   3.880396927838338*^9, 3.8803969468636703`*^9}, {3.880397139185645*^9, 
   3.880397148073209*^9}, 3.885093559545609*^9},
 CellLabel->"Out[34]=",
 CellID->1129316502,ExpressionUUID->"2b59c2e9-b093-431f-bb3c-3461198f41e9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Let us check that the above quantum circuit indeed gives the sum of the bit \
values of the Bob\[CloseCurlyQuote]s qubits.\
\>", "Text",
 CellID->325402613,ExpressionUUID->"2fdeadd1-433c-4ef3-b77b-9dfeab324f57"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", "BB", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qc1", "**", "in"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.8769136475299664`*^9},
 CellLabel->"In[35]:=",
 CellID->1548351429,ExpressionUUID->"0c482a0e-e3b6-4886-a0bd-728c06f40347"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sum", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"FromDigits", "[", 
      RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", 
    RowBox[{"Reverse", "/@", 
     RowBox[{"Through", "[", 
      RowBox[{"out", "[", "TT", "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"SimpleForm", "[", "in", "]"}], "->", "sum"}], "]"}], "//", 
  "TableForm"}]}], "Input",
 CellLabel->"In[37]:=",
 CellID->2083116504,ExpressionUUID->"53394859-0040-40fb-8179-e73fc1c198d7"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"0", "0", "0", "0"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<||>]], "\[Rule]", "0"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"0", "0", "0", "1"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[4, Q3`$] -> 1|>]], "\[Rule]", "1"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"0", "0", "1", "0"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[3, Q3`$] -> 1|>]], "\[Rule]", "1"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"0", "0", "1", "1"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], 
       "\[Rule]", "2"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"0", "1", "0", "0"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[2, Q3`$] -> 1|>]], "\[Rule]", "1"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"0", "1", "0", "1"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[2, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], 
       "\[Rule]", "2"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"0", "1", "1", "0"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[2, Q3`$] -> 1, $CellContext`B[3, Q3`$] -> 1|>]], 
       "\[Rule]", "2"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"0", "1", "1", "1"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[2, Q3`$] -> 1, $CellContext`B[3, Q3`$] -> 
          1, $CellContext`B[4, Q3`$] -> 1|>]], "\[Rule]", "3"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"1", "0", "0", "0"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 1|>]], "\[Rule]", "1"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"1", "0", "0", "1"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], 
       "\[Rule]", "2"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"1", "0", "1", "0"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[3, Q3`$] -> 1|>]], 
       "\[Rule]", "2"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"1", "0", "1", "1"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[3, Q3`$] -> 
          1, $CellContext`B[4, Q3`$] -> 1|>]], "\[Rule]", "3"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"1", "1", "0", "0"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 1|>]], 
       "\[Rule]", "2"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"1", "1", "0", "1"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
          1, $CellContext`B[4, Q3`$] -> 1|>]], "\[Rule]", "3"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"1", "1", "1", "0"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
          1, $CellContext`B[3, Q3`$] -> 1|>]], "\[Rule]", "3"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"1", "1", "1", "1"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
          1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], 
       "\[Rule]", "4"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.876913636697982*^9, 3.876913649601081*^9}, 
   3.8786409503132257`*^9, 3.8786423109123297`*^9, 3.878643362200212*^9, 
   3.878644022810253*^9, 3.8790749191744833`*^9, 3.879075601483398*^9, 
   3.880396421935891*^9, 3.880397150584592*^9, 3.885093562408098*^9},
 CellLabel->"Out[38]//TableForm=",
 CellID->1459609892,ExpressionUUID->"c9d988c4-1d07-408a-8e8e-1afac69015f1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "In actual situation, one must perform the measurement on Teddy's register \
in the computational basis. The measurement outcome refers to the value of ",
 Cell[BoxData[
  SubscriptBox[
   StyleBox["Z",
    FontSlant->"Italic"], "tot"]], "InlineFormula",ExpressionUUID->
  "e5d11078-7437-4a42-aacf-d2a38b562134"],
 "."
}], "MathCaption",
 CellChangeTimes->{{3.87691366594163*^9, 3.8769137506548767`*^9}},
 CellID->1803890242,ExpressionUUID->"a9e378e2-6d5a-415c-9f6f-20ddb36eb0f3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"$n", "+", 
         RowBox[{"1", "/", "2"}]}], "]"}], ",", 
       RowBox[{"B", "[", 
        RowBox[{"$n", "+", 
         RowBox[{"1", "/", "2"}]}], "]"}], ",", 
       RowBox[{"T", "[", "5", "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
    "qc0", ",", "\"\<Separator\>\"", ",", "qc1", ",", "\"\<Spacer\>\"", ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"T", "[", 
      RowBox[{
       RowBox[{"Range", "@", "ln"}], ",", "3"}], "]"}], "]"}]}], 
   "]"}]}]], "Input",
 CellLabel->"In[39]:=",
 CellID->817515057,ExpressionUUID->"79ed82a4-2741-41e7-9d18-bd88e99cf41d"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], 
     LineBox[{{{16, -11}, {17, -11}}, {{16, -12}, {17, -12}}, {{16, -13}, {
      17, -13}}}]}, 
    LineBox[{{{0, -1}, {17, -1}}, {{0, -2}, {17, -2}}, {{0, -3}, {17, -3}}, {{
     0, -4}, {17, -4}}, {{0, -6}, {17, -6}}, {{0, -7}, {17, -7}}, {{0, -8}, {
     17, -8}}, {{0, -9}, {17, -9}}, {{0, -11}, {16, -11}}, {{0, -12}, {
     16, -12}}, {{0, -13}, {16, -13}}}], {{InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.018823529411764708`],
        FontWeight->"Light"], {-0.1, -11}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.018823529411764708`],
        FontWeight->"Light"], {-0.1, -12}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.018823529411764708`],
        FontWeight->"Light"], {-0.1, -13}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.018823529411764708`],
        FontWeight->"Light"], {-0.1, -1}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.018823529411764708`],
        FontWeight->"Light"], {-0.1, -2}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.018823529411764708`],
        FontWeight->"Light"], {-0.1, -3}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.018823529411764708`],
        FontWeight->"Light"], {-0.1, -4}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.018823529411764708`],
        FontWeight->"Light"], {-0.1, -6}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.018823529411764708`],
        FontWeight->"Light"], {-0.1, -7}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.018823529411764708`],
        FontWeight->"Light"], {-0.1, -8}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.018823529411764708`],
        FontWeight->"Light"], {-0.1, -9}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
      LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
       0.6, -1.4}}], InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.023529411764705882`],
        FontWeight->"Light",
        FontSlant->Italic], {1, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
      LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
       0.6, -2.4}}], InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.023529411764705882`],
        FontWeight->"Light",
        FontSlant->Italic], {1, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, 
      LineBox[{{0.6, -3.4}, {1.4, -3.4}, {1.4, -2.6}, {0.6, -2.6}, {
       0.6, -3.4}}], InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.023529411764705882`],
        FontWeight->"Light",
        FontSlant->Italic], {1, -3}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, 
      LineBox[{{0.6, -4.4}, {1.4, -4.4}, {1.4, -3.6}, {0.6, -3.6}, {
       0.6, -4.4}}], InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.023529411764705882`],
        FontWeight->"Light",
        FontSlant->Italic], {1, -4}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}, {LineBox[{{2, -1}, {2, -6}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -6}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -6}, {2.2666666666666666`, -6}}, {{
         2, -6.266666666666667}, {2, -5.733333333333333}}}]}}, {
     LineBox[{{3, -2}, {3, -7}}], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -7}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -7}, {3.2666666666666666`, -7}}, {{
         3, -7.266666666666667}, {3, -6.733333333333333}}}]}}, {
     LineBox[{{4, -3}, {4, -8}}], 
     DiskBox[{4, -3}, 0.09], {CircleBox[{4, -8}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -8}, {4.266666666666667, -8}}, {{
         4, -8.266666666666667}, {4, -7.733333333333333}}}]}}, {
     LineBox[{{5, -4}, {5, -9}}], 
     DiskBox[{5, -4}, 0.09], {CircleBox[{5, -9}, 0.26666666666666666], 
      LineBox[{{{4.733333333333333, -9}, {5.266666666666667, -9}}, {{
         5, -9.266666666666667}, {5, -8.733333333333333}}}]}}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{6, Rational[-29, 2]}, {6, Rational[-1, 2]}}, {{
        6, -14.5}, {6, -0.5}}]]}, {LineBox[{{7, -6}, {7, -11}}], 
     DiskBox[{7, -6}, 0.09], {CircleBox[{7, -11}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -11}, {7.266666666666667, -11}}, {{
         7, -11.266666666666667`}, {7, -10.733333333333333`}}}]}}, {
     LineBox[{{8, -7}, {8, -11}, {8, -12}}], DiskBox[{8, -7}, 0.09], 
     DiskBox[{8, -11}, 0.09], {CircleBox[{8, -12}, 0.26666666666666666], 
      LineBox[{{{7.733333333333333, -12}, {8.266666666666667, -12}}, {{
         8, -12.266666666666667`}, {8, -11.733333333333333`}}}]}}, {
     LineBox[{{9, -7}, {9, -11}}], 
     DiskBox[{9, -7}, 0.09], {CircleBox[{9, -11}, 0.26666666666666666], 
      LineBox[{{{8.733333333333333, -11}, {9.266666666666667, -11}}, {{
         9, -11.266666666666667`}, {9, -10.733333333333333`}}}]}}, {
     LineBox[{{10, -8}, {10, -11}, {10, -12}}], DiskBox[{10, -8}, 0.09], 
     DiskBox[{10, -11}, 0.09], {CircleBox[{10, -12}, 0.26666666666666666], 
      LineBox[{{{9.733333333333333, -12}, {10.266666666666667`, -12}}, {{
         10, -12.266666666666667`}, {10, -11.733333333333333`}}}]}}, {
     LineBox[{{11, -8}, {11, -11}}], 
     DiskBox[{11, -8}, 0.09], {CircleBox[{11, -11}, 0.26666666666666666], 
      LineBox[{{{10.733333333333333`, -11}, {11.266666666666667`, -11}}, {{
         11, -11.266666666666667`}, {11, -10.733333333333333`}}}]}}, {
     LineBox[{{12, -9}, {12, -11}, {12, -12}, {12, -13}}], 
     DiskBox[{12, -9}, 0.09], DiskBox[{12, -11}, 0.09], 
     DiskBox[{12, -12}, 0.09], {CircleBox[{12, -13}, 0.26666666666666666], 
      LineBox[{{{11.733333333333333`, -13}, {12.266666666666667`, -13}}, {{
         12, -13.266666666666667`}, {12, -12.733333333333333`}}}]}}, {
     LineBox[{{13, -9}, {13, -11}, {13, -12}}], DiskBox[{13, -9}, 0.09], 
     DiskBox[{13, -11}, 0.09], {CircleBox[{13, -12}, 0.26666666666666666], 
      LineBox[{{{12.733333333333333`, -12}, {13.266666666666667`, -12}}, {{
         13, -12.266666666666667`}, {13, -11.733333333333333`}}}]}}, {
     LineBox[{{14, -9}, {14, -11}}], 
     DiskBox[{14, -9}, 0.09], {CircleBox[{14, -11}, 0.26666666666666666], 
      LineBox[{{{13.733333333333333`, -11}, {14.266666666666667`, -11}}, {{
         14, -11.266666666666667`}, {14, -10.733333333333333`}}}]}}, {{{
       {GrayLevel[1], EdgeForm[None], 
        RectangleBox[{15.6, -11.4}, {16.4, -10.6}]}, 
       LineBox[{{15.6, -11.4}, {16.4, -11.4}, {16.4, -10.6}, {15.6, -10.6}, {
        15.6, -11.4}}]}, 
      CircleBox[{16, -11.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{16, -11.2}, {16.24, -10.76}}]}, {{
       {GrayLevel[1], EdgeForm[None], 
        RectangleBox[{15.6, -12.4}, {16.4, -11.6}]}, 
       LineBox[{{15.6, -12.4}, {16.4, -12.4}, {16.4, -11.6}, {15.6, -11.6}, {
        15.6, -12.4}}]}, 
      CircleBox[{16, -12.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{16, -12.2}, {16.24, -11.76}}]}, {{
       {GrayLevel[1], EdgeForm[None], 
        RectangleBox[{15.6, -13.4}, {16.4, -12.6}]}, 
       LineBox[{{15.6, -13.4}, {16.4, -13.4}, {16.4, -12.6}, {15.6, -12.6}, {
        15.6, -13.4}}]}, 
      CircleBox[{16, -13.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{16, -13.2}, {16.24, -12.76}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->658.8000000000001,
   PlotRange->NCache[{Full, {
       Rational[-29, 2], 
       Rational[-1, 2]}}, {Full, {-14.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
    Ket[<|$CellContext`T[1, Q3`$] -> 0, $CellContext`T[2, Q3`$] -> 
      0, $CellContext`T[3, Q3`$] -> 0|>], 
    Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
      0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>], 
    Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
      0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]], {
    Q3`Rotation[Rational[2, 3] Pi, 
     $CellContext`A[1, 2]], 
    Q3`Rotation[Rational[2, 3] Pi, 
     $CellContext`A[2, 2]], 
    Q3`Rotation[Rational[2, 3] Pi, 
     $CellContext`A[3, 2]], 
    Q3`Rotation[Rational[2, 3] Pi, 
     $CellContext`A[4, 2]]}, 
   Q3`CNOT[{
      $CellContext`A[1, Q3`$]} -> {1}, {
     $CellContext`B[1, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`A[2, Q3`$]} -> {1}, {
     $CellContext`B[2, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`A[3, Q3`$]} -> {1}, {
     $CellContext`B[3, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`A[4, Q3`$]} -> {1}, {
     $CellContext`B[4, Q3`$]}], "Separator", 
   Q3`CNOT[{
      $CellContext`B[1, Q3`$]} -> {1}, {
     $CellContext`T[1, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`B[2, Q3`$], 
      $CellContext`T[1, Q3`$]} -> {1, 1}, {
     $CellContext`T[2, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`B[2, Q3`$]} -> {1}, {
     $CellContext`T[1, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`B[3, Q3`$], 
      $CellContext`T[1, Q3`$]} -> {1, 1}, {
     $CellContext`T[2, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`B[3, Q3`$]} -> {1}, {
     $CellContext`T[1, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`B[4, Q3`$], 
      $CellContext`T[1, Q3`$], 
      $CellContext`T[2, Q3`$]} -> {1, 1, 1}, {
     $CellContext`T[3, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`B[4, Q3`$], 
      $CellContext`T[1, Q3`$]} -> {1, 1}, {
     $CellContext`T[2, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`B[4, Q3`$]} -> {1}, {
     $CellContext`T[1, Q3`$]}], "Spacer", 
   Q3`Measurement[{
     $CellContext`T[1, 3], 
     $CellContext`T[2, 3], 
     $CellContext`T[3, 3]}], "Invisible" -> {
     $CellContext`A[
      Rational[9, 2]], 
     $CellContext`B[
      Rational[9, 2]], 
     $CellContext`T[5]}, "Invisible" -> $CellContext`A[
     Rational[9, 2]], "Invisible" -> $CellContext`B[
     Rational[9, 2]]]]], "Output",
 CellChangeTimes->{
  3.876913758350912*^9, {3.8786409526055737`*^9, 3.878640964991321*^9}, 
   3.8786416512587748`*^9, 3.87864188374806*^9, 3.878642313000828*^9, 
   3.8786433642805347`*^9, 3.878644029035779*^9, 3.879074921204577*^9, 
   3.879075603613171*^9, 3.880397176098893*^9, 3.8850935642184267`*^9},
 CellLabel->"Out[39]=",
 CellID->1947229505,ExpressionUUID->"0ef076ca-a14b-44eb-890f-923cd70d1dbe"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transformation", "Section",
 CellChangeTimes->{{3.876913773943345*^9, 3.8769137775015087`*^9}},
 CellID->797821259,ExpressionUUID->"0f894b3d-c2fd-4322-867c-318ebbf73e83"],

Cell[TextData[{
 "The post-measurement state is spread over the four qubits of Alice's and \
Bob's registers, respectively. One has to transform it into a smaller number \
of pairs. Here, we assume that the measurement outcome is ",
 Cell[BoxData[Cell[TextData[Cell[BoxData[
   FormBox[
    RowBox[{
     SubscriptBox["Z", "tot"], "=", "3"}], TraditionalForm]],ExpressionUUID->
   "72baf89f-33d0-460c-acf5-c2a7015f20ba"]],ExpressionUUID->
   "632d69de-81c9-4edd-96a7-4c1babad198f"]],ExpressionUUID->
  "218e5a54-79ea-467a-b69a-a57d59b2b2af"],
 ", corresponding to two maximally entangled pairs. Note that  measurement \
outcome ",
 Cell[BoxData[Cell[TextData[Cell[BoxData[
   FormBox[
    RowBox[{
     SubscriptBox["Z", "tot"], "=", "1"}], TraditionalForm]],ExpressionUUID->
   "9abc87de-4426-4b24-b12c-ded2687d2702"]],ExpressionUUID->
   "49dd4280-2715-476f-b8f5-956e7dfd0af7"]],ExpressionUUID->
  "baeb783c-7575-4851-b014-40a1f4b48f75"],
 "also leads to two maximally entangled pairs since ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    ButtonBox["Binomial",
     BaseStyle->"Link"], "[", 
    RowBox[{"4", ",", "1"}], "]"}], "==", 
   RowBox[{
    ButtonBox["Binomial",
     BaseStyle->"Link"], "[", 
    RowBox[{"4", ",", "3"}], "]"}], "==", "4"}]], "InlineFormula",
  ExpressionUUID->"3e5f089e-fb83-4aba-b73a-a8b4705d9be5"],
 "."
}], "Text",
 CellChangeTimes->{{3.87691378303883*^9, 3.8769138199412518`*^9}, {
  3.876913850654917*^9, 3.876913869014278*^9}, {3.8769139448650513`*^9, 
  3.876914124620406*^9}, {3.8786387991035757`*^9, 3.8786389053330717`*^9}, {
  3.878640261877316*^9, 3.878640345786149*^9}, {3.878640522678537*^9, 
  3.878640528662224*^9}},
 CellID->695573627,ExpressionUUID->"43916a76-a876-4e48-ad11-1940ad29c6b3"],

Cell["\<\
To get the unitary transformation on Alice's side, we first rearrange the \
computational basis to get a new basis  \
\>", "Text",
 CellChangeTimes->{{3.87863919960596*^9, 3.8786392026568336`*^9}},
 CellID->1699338655,ExpressionUUID->"33f1b9a2-d4ed-4ee1-8b0b-0b65a7865bde"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalA]", ":=", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{"0111"},
       "Ket"], ",", 
      TemplateBox[{"1011"},
       "Ket"], ",", 
      TemplateBox[{"1101"},
       "Ket"], ",", 
      TemplateBox[{"1110"},
       "Ket"], ",", 
      TemplateBox[{
        SubscriptBox["\[Alpha]", "5"]},
       "Ket"], ",", "\[Ellipsis]", ",", 
      TemplateBox[{
        SubscriptBox["\[Alpha]", "16"]},
       "Ket"]}], "}"}]}], TraditionalForm]],ExpressionUUID->
  "0575b6b1-6272-4b68-836f-6ee56a50e16c"],
 ","
}], "Text",
 CellChangeTimes->{{3.878639083143145*^9, 3.878639096776886*^9}},
 CellID->1399753132,ExpressionUUID->"be691043-e547-4f15-8e06-076fc92110c8"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     SubscriptBox["\[Alpha]", "k"]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "c1f84491-5da5-457e-9c46-218a70abd252"],
 " (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"k", "=", "5"}], ",", "\[Ellipsis]", ",", "16"}], 
   TraditionalForm]],ExpressionUUID->"e1c1b579-e443-40ef-8517-29c30a6ae8c2"],
 ") are the computational basis states with total spin not equal to 3. Next, \
consider still another basis\[LineSeparator]\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[ScriptCapitalA]", "'"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        RowBox[{"00", ";", "00"}]},
       "Ket"], ",", 
      TemplateBox[{
        RowBox[{"01", ";", "00"}]},
       "Ket"], ",", 
      TemplateBox[{
        RowBox[{"10", ";", "00"}]},
       "Ket"], ",", 
      TemplateBox[{
        RowBox[{"11", ";", "00"}]},
       "Ket"], ",", 
      TemplateBox[{
        SubsuperscriptBox["\[Alpha]", "5", "\[Prime]"]},
       "Ket"], ",", "\[Ellipsis]", ",", 
      TemplateBox[{
        SubsuperscriptBox["\[Alpha]", "16", "\[Prime]"]},
       "Ket"]}], "}"}]}], TraditionalForm]],ExpressionUUID->
  "a86f7946-580c-4849-a46c-efc49e376300"],
 ","
}], "Text",
 CellID->2115020286,ExpressionUUID->"2921f348-905f-443f-acb8-2bd0d40c2538"],

Cell[TextData[{
 "where we have put a semicolon ';' to indicate the first two qubits to which \
encode Alice\[CloseCurlyQuote]s part of the maximally entangled states. Then, \
the required unitary transformation corresponds to the basis change from ",
 Cell[BoxData[
  FormBox["\[ScriptCapitalA]", TraditionalForm]],ExpressionUUID->
  "015bfae9-be74-4c6b-b696-6f186408339e"],
 " to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalA]", "'"}], TraditionalForm]],ExpressionUUID->
  "b84a5cbc-9ee0-4cb9-b29f-3253c7650534"],
 ". That is to say, the unitary transformation is given by "
}], "Text",
 CellChangeTimes->{{3.878648125191802*^9, 3.8786481264168673`*^9}},
 CellID->1996621658,ExpressionUUID->"13dcc265-2807-410d-b51c-0886469ac26a"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", ":=", 
    RowBox[{
     RowBox[{
      TemplateBox[{
        RowBox[{"00", ";", "00"}]},
       "Ket"], 
      TemplateBox[{"0111"},
       "Bra"]}], "+", 
     RowBox[{
      TemplateBox[{
        RowBox[{"01", ";", "00"}]},
       "Ket"], 
      TemplateBox[{"1011"},
       "Bra"]}], "+", 
     RowBox[{
      TemplateBox[{
        RowBox[{"10", ";", "00"}]},
       "Ket"], 
      TemplateBox[{"1101"},
       "Bra"]}], "+", 
     RowBox[{
      TemplateBox[{
        RowBox[{"11", ";", "00"}]},
       "Ket"], 
      TemplateBox[{"1110"},
       "Bra"]}], "+", 
     RowBox[{
      UnderoverscriptBox["\[CapitalSigma]", 
       RowBox[{"k", "=", "5"}], "16"], 
      TemplateBox[{
        SubsuperscriptBox["a", "k", "\[Prime]"]},
       "Ket"], 
      TemplateBox[{
        SubscriptBox["\[Alpha]", "k"]},
       "Bra"]}]}]}], TraditionalForm]],ExpressionUUID->
  "87c6ec4a-9ab1-4901-91e5-e79b83299c56"],
 "."
}], "Text",
 CellID->640737984,ExpressionUUID->"f6e66ca7-5ad0-448d-9b05-837f2f8b0565"],

Cell[TextData[{
 "The unitary transformation on Bob's register may be obtained in the same \
manner, where we denote the rearranged bases by ",
 Cell[BoxData[
  FormBox["\[ScriptCapitalB]", TraditionalForm]],ExpressionUUID->
  "4130a2b7-34a8-4112-95e4-2c130bfd0acb"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalB]", "'"}], TraditionalForm]],ExpressionUUID->
  "485c69e4-a797-4631-9f76-ad2cf6108f14"]
}], "Text",
 CellChangeTimes->{{3.87863944115376*^9, 3.8786395100818367`*^9}},
 CellID->1266994926,ExpressionUUID->"39fb159e-2f1c-4b9d-b3d7-4545e63fee32"],

Cell[CellGroupData[{

Cell["Method 1: Using Dyad", "Subsection",
 CellChangeTimes->{{3.879074735718967*^9, 3.879074747350543*^9}, {
  3.879074780382093*^9, 3.879074786492793*^9}},
 CellID->1145574102,ExpressionUUID->"3e29fedb-a31e-47cd-9806-5e721284d533"],

Cell[CellGroupData[{

Cell["\<\
These are the computational bases for Alice's and Bob's registers, \
respectively.\
\>", "MathCaption",
 CellChangeTimes->{{3.878639003803286*^9, 3.878639042214031*^9}},
 CellID->920704413,ExpressionUUID->"b628ac1d-6b05-4590-bf55-0ea77b2b73eb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"bsA", "=", 
  RowBox[{"Basis", "[", "AA", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"bsB", "=", 
  RowBox[{"Basis", "[", "BB", "]"}]}]}], "Input",
 CellLabel->"In[40]:=",
 CellID->989436024,ExpressionUUID->"68fbf39b-d569-4d6e-bf37-5129d1f01af0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"\"\[SpaceIndicator]\""},
     "Ket"],
    Ket[<||>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[4, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[3, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[2, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[2, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[2, Q3`$] -> 1, $CellContext`A[3, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[2, Q3`$] -> 1, $CellContext`A[3, Q3`$] -> 
      1, $CellContext`A[4, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[3, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[3, Q3`$] -> 
      1, $CellContext`A[4, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
      1, $CellContext`A[4, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
      1, $CellContext`A[3, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
      1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.876914126760735*^9, 3.876914130254706*^9}, 
   3.878639145032412*^9, 3.8786409739636717`*^9, 3.878643387372377*^9, 
   3.878644044311337*^9, 3.885093569328596*^9},
 CellLabel->"Out[40]=",
 CellID->1042200327,ExpressionUUID->"eb9d5e07-cfc3-4b71-bd44-ebf196d00fd0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"\"\[SpaceIndicator]\""},
     "Ket"],
    Ket[<||>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[4, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[3, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[2, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[2, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[2, Q3`$] -> 1, $CellContext`B[3, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[2, Q3`$] -> 1, $CellContext`B[3, Q3`$] -> 
      1, $CellContext`B[4, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[3, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[3, Q3`$] -> 
      1, $CellContext`B[4, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
      1, $CellContext`B[4, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
      1, $CellContext`B[3, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
      1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.876914126760735*^9, 3.876914130254706*^9}, 
   3.878639145032412*^9, 3.8786409739636717`*^9, 3.878643387372377*^9, 
   3.878644044311337*^9, 3.885093569337433*^9},
 CellLabel->"Out[41]=",
 CellID->1384270957,ExpressionUUID->"40c11361-70a3-4540-a697-d952da4eecd4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "These are the bases ",
 Cell[BoxData[
  FormBox["\[ScriptCapitalA]", TraditionalForm]],ExpressionUUID->
  "b8e0af21-77d0-4e28-a7b1-20ad5f9f567e"],
 " and ",
 Cell[BoxData[
  FormBox["\[ScriptCapitalB]", TraditionalForm]],ExpressionUUID->
  "a6577184-6759-4344-b8b2-7fcc452275a1"],
 " for Alice's and Bob's registers, respectively."
}], "MathCaption",
 CellChangeTimes->{{3.878639526682781*^9, 3.878639578506969*^9}},
 CellID->284257392,ExpressionUUID->"f3616645-327d-4284-9237-a987b918be6a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{"Permutations", "[", 
    RowBox[{"PadLeft", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"1", ",", "3"}], "]"}], ",", "$n"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sppA", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"AA", "->", "#"}], "]"}], "&"}], "/@", "bb"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sppB", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"BB", "->", "#"}], "]"}], "&"}], "/@", "bb"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sppA", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"sppA", ",", 
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{"Complement", "[", 
        RowBox[{"bsA", ",", "sppA"}], "]"}], ",", 
       RowBox[{
        RowBox[{"LogicalForm", "[", 
         RowBox[{"#", ",", "AA"}], "]"}], "&"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sppB", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"sppB", ",", 
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{"Complement", "[", 
        RowBox[{"bsB", ",", "sppB"}], "]"}], ",", 
       RowBox[{
        RowBox[{"LogicalForm", "[", 
         RowBox[{"#", ",", "BB"}], "]"}], "&"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.876914156272278*^9, 3.876914201781519*^9}, {
  3.876914251549748*^9, 3.876914251943233*^9}, {3.878639139294224*^9, 
  3.878639140823812*^9}},
 CellLabel->"In[42]:=",
 CellID->576306453,ExpressionUUID->"c84f116c-1d33-4084-8a4f-47e4eba37184"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"sppA", "//", "LogicalForm"}], "\[IndentingNewLine]", 
 RowBox[{"sppB", "//", "LogicalForm"}]}], "Input",
 CellLabel->"In[47]:=",
 CellID->2013079378,ExpressionUUID->"9e830136-510d-48d5-aea5-180f42fb4c81"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
      1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
      0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
      1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 1|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
      1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
      0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
      0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 1|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
      0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
      0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
      1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
      1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 1|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
      1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
      0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
      0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 1|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
      0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
      1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
      1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.876914140589252*^9, 3.8769142535451927`*^9, 
  3.878639148192396*^9, 3.878639588017441*^9, 3.8786409767755003`*^9, 
  3.878643392284111*^9, 3.878644047319332*^9, 3.885093572048612*^9},
 CellLabel->"Out[47]=",
 CellID->400644739,ExpressionUUID->"2a9eb8b7-1351-4d5a-94dc-35e5d76fcf34"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
      1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
      0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
      1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 1|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
      1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
      0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
      0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 1|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
      0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
      0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
      1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
      1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 1|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
      1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
      0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
      0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 1|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
      0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
      1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
      1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.876914140589252*^9, 3.8769142535451927`*^9, 
  3.878639148192396*^9, 3.878639588017441*^9, 3.8786409767755003`*^9, 
  3.878643392284111*^9, 3.878644047319332*^9, 3.8850935720632477`*^9},
 CellLabel->"Out[48]=",
 CellID->1274895028,ExpressionUUID->"d93c718f-034b-4de1-bc24-fc1985077b96"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "These are the bases ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalA]", "'"}], TraditionalForm]],ExpressionUUID->
  "5671d54f-e4c8-4db0-8cc0-46fbb620be12"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalB]", "'"}], TraditionalForm]],ExpressionUUID->
  "2ec593f4-ee41-4645-9025-db89c3b29d3e"],
 " for Alice's and Bob's registers, respectively."
}], "MathCaption",
 CellChangeTimes->{{3.878639592636016*^9, 3.8786396220165567`*^9}},
 CellID->1601110815,ExpressionUUID->"79fbf475-2029-4962-a1a3-a04d211c2587"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"newA", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"A", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"newB", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"B", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"newA", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"newA", ",", 
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{"Complement", "[", 
        RowBox[{"bsA", ",", "newA"}], "]"}], ",", 
       RowBox[{
        RowBox[{"LogicalForm", "[", 
         RowBox[{"#", ",", "AA"}], "]"}], "&"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"newB", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"newB", ",", 
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{"Complement", "[", 
        RowBox[{"bsB", ",", "newB"}], "]"}], ",", 
       RowBox[{
        RowBox[{"LogicalForm", "[", 
         RowBox[{"#", ",", "BB"}], "]"}], "&"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellLabel->"In[49]:=",
 CellID->38369270,ExpressionUUID->"c223bfaa-a713-4f39-add4-bfc4d937e57c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"LogicalForm", "[", "newA", "]"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", "newB", "]"}]}], "Input",
 CellLabel->"In[53]:=",
 CellID->627226790,ExpressionUUID->"508366b2-d0f8-4ec3-acb0-71e60eeec672"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
      0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
      1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
      0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
      1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
      0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 1|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
      0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
      0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
      1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 1|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
      1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
      1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
      0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 1|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
      0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
      0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
      1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 1|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
      1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
      1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8769142559426603`*^9, 3.878639628553987*^9, 
  3.878640978942972*^9, 3.878643394554551*^9, 3.8786440496860943`*^9, 
  3.88509357453585*^9},
 CellLabel->"Out[53]=",
 CellID->1518304752,ExpressionUUID->"0604ec9e-4dcf-4f2a-b7bb-e494e85f0651"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
      0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
      1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
      0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
      1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
      0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 1|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
      0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
      0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
      1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 1|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
      1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
      1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
      0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 1|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
      0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
      0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
      1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 1|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
      1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 0|>]], ",", 
   
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
      1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8769142559426603`*^9, 3.878639628553987*^9, 
  3.878640978942972*^9, 3.878643394554551*^9, 3.8786440496860943`*^9, 
  3.885093574547558*^9},
 CellLabel->"Out[54]=",
 CellID->1747273210,ExpressionUUID->"d8c00705-532f-43b9-a606-441c74f211d3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Finally, the unitary transformation is constructed as prescribed above.\
\>", "MathCaption",
 CellChangeTimes->{{3.878639633894989*^9, 3.8786396615278*^9}},
 CellID->2067394127,ExpressionUUID->"ff3cc3dd-de55-4b67-bc2d-c7770b20f6fb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"trsA", "=", 
  RowBox[{"Total", "@", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Dyad", "[", 
       RowBox[{"#1", ",", "#2", ",", "AA"}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"newA", ",", "sppA"}], "}"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"trsB", "=", 
  RowBox[{"Total", "@", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Dyad", "[", 
       RowBox[{"#1", ",", "#2", ",", "BB"}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"newB", ",", "sppB"}], "}"}]}], "]"}]}]}]}], "Input",
 CellLabel->"In[55]:=",
 CellID->1604828370,ExpressionUUID->"adf25153-dba1-4e5a-9980-9ff5af18aa23"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
        0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
        1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
     0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 
     0|>, <|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
     1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
        0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
        0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
     0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 
     1|>, <|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
     0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
        0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
        0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 1|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
     0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 
     0|>, <|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
     0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
        0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
        0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 0|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
     0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 
     1|>, <|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
     0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
        1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
        0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
     1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 
     0|>, <|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
     0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
        1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
        0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
     1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 
     1|>, <|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
     0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
        1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
        1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
     1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 
     0|>, <|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
     1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
        1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
        1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 1|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
     1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 
     1|>, <|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
     1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
        0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
        1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 1|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
     0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 
     0|>, <|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
     1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
        0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
        1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 0|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
     0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 
     1|>, <|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
     1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
        0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
        0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
     0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 
     0|>, <|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
     0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
        0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
        0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 1|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
     0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 
     1|>, <|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
     0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
        1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
        1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 0|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
     1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 
     0|>, <|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
     1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
        1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
        0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 0|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
     1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 
     1|>, <|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
     0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
        1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
        1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
     1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 
     0|>, <|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
     1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
        1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
        1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
     1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 
     1|>, <|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
     1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 
     1|>]]}]], "Output",
 CellChangeTimes->{3.876914257729908*^9, 3.878639663737379*^9, 
  3.8786409804789047`*^9, 3.878643395842422*^9, 3.878644051149948*^9, 
  3.885093575856909*^9},
 CellLabel->"Out[55]=",
 CellID->1218911913,ExpressionUUID->"d3fbee6c-70a4-47ab-8a61-3aaa3a916021"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
        0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
        1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
     0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 
     0|>, <|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
     1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
        0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
        0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
     0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 
     1|>, <|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
     0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
        0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
        0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 1|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
     0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 
     0|>, <|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
     0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
        0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
        0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 0|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
     0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 
     1|>, <|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
     0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
        1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
        0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
     1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 
     0|>, <|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
     0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
        1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
        0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
     1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 
     1|>, <|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
     0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
        1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
        1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
     1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 
     0|>, <|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
     1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
        1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
        1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 1|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
     1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 
     1|>, <|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
     1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
        0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
        1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 1|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
     0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 
     0|>, <|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
     1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
        0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
        1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 0|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
     0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 
     1|>, <|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
     1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
        0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
        0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
     0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 
     0|>, <|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
     0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
        0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
        0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 1|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
     0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 
     1|>, <|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
     0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
        1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
        1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 0|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
     1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 
     0|>, <|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
     1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
        1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
        0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 0|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
     1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 
     1|>, <|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
     0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
        1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
        1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
     1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 
     0|>, <|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
     1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
        1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
        1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]]},
    "RowDefault"],
   Q3`Dyad[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
     1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 
     1|>, <|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
     1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 
     1|>]]}]], "Output",
 CellChangeTimes->{3.876914257729908*^9, 3.878639663737379*^9, 
  3.8786409804789047`*^9, 3.878643395842422*^9, 3.878644051149948*^9, 
  3.8850935758819933`*^9},
 CellLabel->"Out[56]=",
 CellID->1406013058,ExpressionUUID->"d5940c59-9cad-460e-b972-b995a5712b9e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
By construction, the unitary transformations are just permutation, which is \
clear from their matrix representations.\
\>", "MathCaption",
 CellChangeTimes->{{3.878639896990817*^9, 3.878639948664967*^9}},
 CellID->861429414,ExpressionUUID->"42668ab2-0ce1-4ab3-b5f6-061c7588e921"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Matrix", "[", "trsA", "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Matrix", "[", "trsB", "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8786398170551987`*^9, 3.878639835910283*^9}},
 CellLabel->"In[57]:=",
 CellID->1196447817,ExpressionUUID->"777e32d5-3edf-4731-b190-690cd8a34244"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {16, 16}, 0, {
     1, {{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16}, {{8}, {
       1}, {2}, {3}, {12}, {4}, {5}, {6}, {14}, {7}, {9}, {10}, {15}, {11}, {
       13}, {16}}}, {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
      1}}]]]]], "Output",
 CellChangeTimes->{{3.87863982286447*^9, 3.878639836306118*^9}, 
   3.878639953331623*^9, 3.878640982205122*^9, 3.8786433973030577`*^9, 
   3.878644052876862*^9, 3.885093577340234*^9},
 CellLabel->"Out[57]//MatrixForm=",
 CellID->1548057104,ExpressionUUID->"11d449c4-72af-4927-bafa-3cbf7af43ca5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {16, 16}, 0, {
     1, {{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16}, {{8}, {
       1}, {2}, {3}, {12}, {4}, {5}, {6}, {14}, {7}, {9}, {10}, {15}, {11}, {
       13}, {16}}}, {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
      1}}]]]]], "Output",
 CellChangeTimes->{{3.87863982286447*^9, 3.878639836306118*^9}, 
   3.878639953331623*^9, 3.878640982205122*^9, 3.8786433973030577`*^9, 
   3.878644052876862*^9, 3.8850935773469687`*^9},
 CellLabel->"Out[58]//MatrixForm=",
 CellID->1431363523,ExpressionUUID->"1909bd07-9e5e-4f4a-b4a2-d0c169215c11"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check that they are indeed unitary transformations.", "MathCaption",
 CellChangeTimes->{{3.878639845472068*^9, 3.878639871680887*^9}},
 CellID->93724021,ExpressionUUID->"b7f29345-bc7f-4261-910a-ac3bed0a7340"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Dagger", "[", "trsA", "]"}], "**", "trsA"}], "//", 
  "Elaborate"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Dagger", "[", "trsB", "]"}], "**", "trsB"}], "//", 
  "Elaborate"}]}], "Input",
 CellChangeTimes->{{3.878639671747467*^9, 3.878639690332704*^9}},
 CellLabel->"In[59]:=",
 CellID->428846345,ExpressionUUID->"4f8c63bd-9d60-47e7-b117-79a4a00cc407"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.878639680904757*^9, 3.878639690844173*^9}, 
   3.878639794470941*^9, 3.878639840578518*^9, 3.878639960515897*^9, 
   3.8786409839521027`*^9, 3.878643398799519*^9, 3.885093578811142*^9},
 CellLabel->"Out[59]=",
 CellID->1330432617,ExpressionUUID->"dcc3d698-c2d4-4ac8-be12-0bb50d746776"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.878639680904757*^9, 3.878639690844173*^9}, 
   3.878639794470941*^9, 3.878639840578518*^9, 3.878639960515897*^9, 
   3.8786409839521027`*^9, 3.878643398799519*^9, 3.885093578928817*^9},
 CellLabel->"Out[60]=",
 CellID->981261355,ExpressionUUID->"d13ae8ce-0b4b-471f-85d2-b82c956765a0"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Method 2: Using Permutation", "Subsection",
 CellChangeTimes->{{3.879074735718967*^9, 3.879074747350543*^9}, {
  3.879074780382093*^9, 3.8790748084924393`*^9}},
 CellID->1197910904,ExpressionUUID->"5b51fd21-1a8e-40db-9ca4-2d97b1505571"],

Cell[CellGroupData[{

Cell["\<\
Here, we find the permutation corresponding to the required basis change and \
use it to construct the unitary matrix.\
\>", "Text",
 CellChangeTimes->{{3.87907499343908*^9, 3.879075040124888*^9}, {
  3.879100437725726*^9, 3.879100440957271*^9}},
 CellID->368440934,ExpressionUUID->"545d1c56-5920-45a4-8008-f1a397582884"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"conststructUnitary", "::", "usage"}], "=", 
   "\"\<contructUnitary[m, n] finds the permutation of computational basis \
states of n qubits, where states with total spin m are mapped to the standard \
computational basis states of the first k qubits with other qubits set to \
zero. Here, k=Log[2,Binomial[n,m]]. It returns the matrix representing the \
permutation.\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.879100456175544*^9, 3.879100712555913*^9}},
 CellLabel->"In[66]:=",
 CellID->51525796,ExpressionUUID->"4b958e15-d987-41e0-abc5-b9185f63b5e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"constructUnitary", "::", "bad"}], "=", 
   "\"\<States with `` non-zero qubits in a register of `` qubits cannot be \
encoded in a finite number of qubits.\>\""}], ";"}]], "Input",
 CellChangeTimes->{
  3.879099346870466*^9, {3.879100302714672*^9, 3.8791003058163643`*^9}},
 CellLabel->"In[67]:=",
 CellID->519669879,ExpressionUUID->"b1a0849a-e0e4-4110-9379-03572ca61286"],

Cell[BoxData[
 RowBox[{
  RowBox[{"constructUnitary", "[", 
   RowBox[{"m_Integer", ",", "n_Integer"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"org", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", "n"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"bin", "=", 
       RowBox[{"Log", "[", 
        RowBox[{"2", ",", 
         RowBox[{"Binomial", "[", 
          RowBox[{"n", ",", "m"}], "]"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", "src", ",", "dst"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "@", 
        RowBox[{"IntegerQ", "@", "bin"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"constructUnitary", "::", "bad"}], ",", "m", ",", "n"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"One", "@", 
          RowBox[{"Power", "[", 
           RowBox[{"2", ",", "n"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]",
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"src", "=", 
      RowBox[{"Permutations", "@", 
       RowBox[{"PadLeft", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"1", ",", "m"}], "]"}], ",", "n"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"src", "=", 
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"Join", "[", 
        RowBox[{"src", ",", "org"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dst", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"PadRight", "[", 
         RowBox[{"#", ",", "n"}], "]"}], "&"}], "/@", 
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", "bin"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dst", "=", 
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"Join", "[", 
        RowBox[{"dst", ",", "org"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tau", "=", 
      RowBox[{"FindPermutation", "[", 
       RowBox[{"src", ",", "org"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tau", "=", 
      RowBox[{"FindPermutation", "@", 
       RowBox[{"Permute", "[", 
        RowBox[{"dst", ",", "tau"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"PermutationMatrix", "[", 
      RowBox[{"tau", ",", 
       RowBox[{"Power", "[", 
        RowBox[{"2", ",", "n"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{3.879099346870466*^9},
 CellLabel->"In[68]:=",
 CellID->1699974289,ExpressionUUID->"764b5ce3-5ce9-42f1-b3be-131a954406db"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Take an example for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "=", "3"}], TraditionalForm]],ExpressionUUID->
  "2dade0aa-4c4c-49ad-b70e-930828d95a12"],
 ". Each row or column contains exactly one element of value 1 and all other \
elements are zero, indicating the matrix represents a permutation."
}], "MathCaption",
 CellChangeTimes->{{3.879099600475712*^9, 3.87909977590691*^9}},
 CellID->415624317,ExpressionUUID->"d42139df-0aa3-4a77-b6fe-81442593f640"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"constructUnitary", "[", 
    RowBox[{"3", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.879074826077909*^9, 3.879074850733683*^9}},
 CellLabel->"In[69]:=",
 CellID->584821147,ExpressionUUID->"9f81e7d2-a5a8-4b80-b0cc-79a435492494"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
    PermutationMatrix[
     StructuredArray`StructuredData[{16, 16}, {
       Cycles[{{1, 8, 6, 4, 3, 2}, {5, 12, 10, 7}, {9, 14, 11}, {13, 15}}], 
       DirectedInfinity[1]}]]]]]], "Output",
 CellChangeTimes->{{3.879074846078863*^9, 3.879074850987529*^9}, 
   3.8790749379429283`*^9, 3.8790756140742903`*^9, 3.879099493110332*^9, 
   3.879099622116633*^9, 3.879099777333651*^9, 3.885093669863328*^9},
 CellLabel->"Out[70]//MatrixForm=",
 CellID->1698740896,ExpressionUUID->"b3077bb2-e7e9-4816-b8fc-27a0622864c2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Construct the operators corresponding to the above matrix.", \
"MathCaption",
 CellChangeTimes->{{3.879099780805171*^9, 3.879099799609997*^9}},
 CellID->914831718,ExpressionUUID->"8c5e052e-4a8e-44fb-b73a-ce8d6c784e30"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"trsA", "=", 
   RowBox[{
    RowBox[{"ExpressionFor", "[", 
     RowBox[{"mat", ",", "AA"}], "]"}], "//", "Elaborate"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trsB", "=", 
   RowBox[{
    RowBox[{"ExpressionFor", "[", 
     RowBox[{"mat", ",", "BB"}], "]"}], "//", "Elaborate"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.879074853948283*^9, 3.879074888077031*^9}},
 CellLabel->"In[71]:=",
 CellID->21183722,ExpressionUUID->"c932492d-99be-41c1-9919-3de001f27796"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Examine if the operator properly maps the computational basis states for \
Alice's qubits.\
\>", "MathCaption",
 CellChangeTimes->{{3.879099867416917*^9, 3.8790998886430073`*^9}, {
  3.87910012447628*^9, 3.8791001520425167`*^9}},
 CellID->643016337,ExpressionUUID->"8ec11b73-d238-48f9-a270-0f97be90f10e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", "AA", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"trsA", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"in", "->", "out"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.8790998039362307`*^9, 3.8790998250132723`*^9}},
 CellLabel->"In[73]:=",
 CellID->2108504836,ExpressionUUID->"04ef3573-49c8-4b84-ae4a-2dd687116721"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
          0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
          0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
          0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
          0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
          0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
          0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
          0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
          1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
          1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
          1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
          1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
          1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
          1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
          0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
          1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
          0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
          0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
          0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
          0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
          0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
          0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
          1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
          0, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
          1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
          1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
          1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
          1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
          0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
          1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
          1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
          1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
          1, $CellContext`A[3, Q3`$] -> 1, $CellContext`A[4, Q3`$] -> 
          1|>]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.879099825842897*^9, 3.879099895709815*^9, 
  3.885093673864949*^9},
 CellLabel->"Out[75]//TableForm=",
 CellID->222894278,ExpressionUUID->"3eeac8b3-cf12-422c-a377-a985ac153129"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Also examine if the operator properly maps the computational basis states for \
Bob's qubits.\
\>", "MathCaption",
 CellChangeTimes->{{3.879099867416917*^9, 3.8790998886430073`*^9}, {
  3.87910012447628*^9, 3.879100197991976*^9}},
 CellID->608333358,ExpressionUUID->"f5202df5-afe9-47fa-b064-9a4436567940"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", "BB", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"trsB", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"in", "->", "out"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.8790998039362307`*^9, 3.879099844999795*^9}},
 CellLabel->"In[76]:=",
 CellID->2051353892,ExpressionUUID->"86fd9729-c9a9-4e2b-9a24-819d51c6fe42"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
          0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
          0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
          0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
          0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
          0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
          0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
          0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
          1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
          1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
          1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
          1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
          1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
          1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
          0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
          1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
          0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
          0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
          0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
          0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
          0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
          0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
          1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
          0, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
          1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
          1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
          1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
          1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
          0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
          1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
          1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
          1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
          1, $CellContext`B[3, Q3`$] -> 1, $CellContext`B[4, Q3`$] -> 
          1|>]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.879099846403257*^9, 3.879099897846258*^9, 
  3.885093675883994*^9},
 CellLabel->"Out[78]//TableForm=",
 CellID->1446549874,ExpressionUUID->"18e29e09-5755-4c67-a51a-31dec4af59ee"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Overall", "Section",
 CellID->1248933531,ExpressionUUID->"543e3914-c7ba-444b-85b0-e367e6251f35"],

Cell[CellGroupData[{

Cell["\<\
Now, we have all components. Our desired quantum circuit is as follows. The \
first part generates four partially entangled pairs, the second measures the \
total Pauli Z on Bob's register, and the last transforms the post-measurement \
state a fixed pair of qubits from Alice's and Bob's registers.\
\>", "Text",
 CellChangeTimes->{{3.87691430082067*^9, 3.876914482921028*^9}},
 CellID->1308352194,ExpressionUUID->"c50697db-8ea8-4dae-9698-e81518c8fd9c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"all", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"qc2", ",", "\"\<Separator\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"T", "@", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "->", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], ",", "trsA", ",", 
      RowBox[{"\"\<Label\>\"", "->", "\"\<U\>\""}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"T", "@", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "->", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], ",", "trsB", ",", 
      RowBox[{"\"\<Label\>\"", "->", "\"\<U\>\""}]}], "]"}], ","}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8769142777103167`*^9, 3.8769142891733227`*^9}, {
  3.878641004703807*^9, 3.878641040133664*^9}, {3.878641080041786*^9, 
  3.878641117974493*^9}, {3.8786414580109453`*^9, 3.878641483607373*^9}, {
  3.878643407947455*^9, 3.8786434231704187`*^9}, {3.879075620907549*^9, 
  3.879075637771105*^9}},
 CellLabel->"In[79]:=",
 CellID->1320689739,ExpressionUUID->"bd78c7db-4888-4f7d-9d8d-d3e80a11d1f8"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], 
     LineBox[{{{16, -11}, {20, -11}}, {{16, -12}, {20, -12}}, {{16, -13}, {
      20, -13}}}]}, 
    LineBox[{{{0, -1}, {20, -1}}, {{0, -2}, {20, -2}}, {{0, -3}, {20, -3}}, {{
     0, -4}, {20, -4}}, {{0, -6}, {20, -6}}, {{0, -7}, {20, -7}}, {{0, -8}, {
     20, -8}}, {{0, -9}, {20, -9}}, {{0, -11}, {16, -11}}, {{0, -12}, {
     16, -12}}, {{0, -13}, {16, -13}}}], {{InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.016000000000000004`],
        FontWeight->"Light"], {-0.1, -11}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.016000000000000004`],
        FontWeight->"Light"], {-0.1, -12}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.016000000000000004`],
        FontWeight->"Light"], {-0.1, -13}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.016000000000000004`],
        FontWeight->"Light"], {-0.1, -1}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.016000000000000004`],
        FontWeight->"Light"], {-0.1, -2}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.016000000000000004`],
        FontWeight->"Light"], {-0.1, -3}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.016000000000000004`],
        FontWeight->"Light"], {-0.1, -4}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.016000000000000004`],
        FontWeight->"Light"], {-0.1, -6}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.016000000000000004`],
        FontWeight->"Light"], {-0.1, -7}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.016000000000000004`],
        FontWeight->"Light"], {-0.1, -8}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.016000000000000004`],
        FontWeight->"Light"], {-0.1, -9}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
      LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
       0.6, -1.4}}], InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.020000000000000004`],
        FontWeight->"Light",
        FontSlant->Italic], {1, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
      LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
       0.6, -2.4}}], InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.020000000000000004`],
        FontWeight->"Light",
        FontSlant->Italic], {1, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, 
      LineBox[{{0.6, -3.4}, {1.4, -3.4}, {1.4, -2.6}, {0.6, -2.6}, {
       0.6, -3.4}}], InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.020000000000000004`],
        FontWeight->"Light",
        FontSlant->Italic], {1, -3}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, 
      LineBox[{{0.6, -4.4}, {1.4, -4.4}, {1.4, -3.6}, {0.6, -3.6}, {
       0.6, -4.4}}], InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.020000000000000004`],
        FontWeight->"Light",
        FontSlant->Italic], {1, -4}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}, {LineBox[{{2, -1}, {2, -6}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -6}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -6}, {2.2666666666666666`, -6}}, {{
         2, -6.266666666666667}, {2, -5.733333333333333}}}]}}, {
     LineBox[{{3, -2}, {3, -7}}], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -7}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -7}, {3.2666666666666666`, -7}}, {{
         3, -7.266666666666667}, {3, -6.733333333333333}}}]}}, {
     LineBox[{{4, -3}, {4, -8}}], 
     DiskBox[{4, -3}, 0.09], {CircleBox[{4, -8}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -8}, {4.266666666666667, -8}}, {{
         4, -8.266666666666667}, {4, -7.733333333333333}}}]}}, {
     LineBox[{{5, -4}, {5, -9}}], 
     DiskBox[{5, -4}, 0.09], {CircleBox[{5, -9}, 0.26666666666666666], 
      LineBox[{{{4.733333333333333, -9}, {5.266666666666667, -9}}, {{
         5, -9.266666666666667}, {5, -8.733333333333333}}}]}}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{6, Rational[-29, 2]}, {6, Rational[-1, 2]}}, {{
        6, -14.5}, {6, -0.5}}]]}, {LineBox[{{7, -6}, {7, -11}}], 
     DiskBox[{7, -6}, 0.09], {CircleBox[{7, -11}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -11}, {7.266666666666667, -11}}, {{
         7, -11.266666666666667`}, {7, -10.733333333333333`}}}]}}, {
     LineBox[{{8, -7}, {8, -11}, {8, -12}}], DiskBox[{8, -7}, 0.09], 
     DiskBox[{8, -11}, 0.09], {CircleBox[{8, -12}, 0.26666666666666666], 
      LineBox[{{{7.733333333333333, -12}, {8.266666666666667, -12}}, {{
         8, -12.266666666666667`}, {8, -11.733333333333333`}}}]}}, {
     LineBox[{{9, -7}, {9, -11}}], 
     DiskBox[{9, -7}, 0.09], {CircleBox[{9, -11}, 0.26666666666666666], 
      LineBox[{{{8.733333333333333, -11}, {9.266666666666667, -11}}, {{
         9, -11.266666666666667`}, {9, -10.733333333333333`}}}]}}, {
     LineBox[{{10, -8}, {10, -11}, {10, -12}}], DiskBox[{10, -8}, 0.09], 
     DiskBox[{10, -11}, 0.09], {CircleBox[{10, -12}, 0.26666666666666666], 
      LineBox[{{{9.733333333333333, -12}, {10.266666666666667`, -12}}, {{
         10, -12.266666666666667`}, {10, -11.733333333333333`}}}]}}, {
     LineBox[{{11, -8}, {11, -11}}], 
     DiskBox[{11, -8}, 0.09], {CircleBox[{11, -11}, 0.26666666666666666], 
      LineBox[{{{10.733333333333333`, -11}, {11.266666666666667`, -11}}, {{
         11, -11.266666666666667`}, {11, -10.733333333333333`}}}]}}, {
     LineBox[{{12, -9}, {12, -11}, {12, -12}, {12, -13}}], 
     DiskBox[{12, -9}, 0.09], DiskBox[{12, -11}, 0.09], 
     DiskBox[{12, -12}, 0.09], {CircleBox[{12, -13}, 0.26666666666666666], 
      LineBox[{{{11.733333333333333`, -13}, {12.266666666666667`, -13}}, {{
         12, -13.266666666666667`}, {12, -12.733333333333333`}}}]}}, {
     LineBox[{{13, -9}, {13, -11}, {13, -12}}], DiskBox[{13, -9}, 0.09], 
     DiskBox[{13, -11}, 0.09], {CircleBox[{13, -12}, 0.26666666666666666], 
      LineBox[{{{12.733333333333333`, -12}, {13.266666666666667`, -12}}, {{
         13, -12.266666666666667`}, {13, -11.733333333333333`}}}]}}, {
     LineBox[{{14, -9}, {14, -11}}], 
     DiskBox[{14, -9}, 0.09], {CircleBox[{14, -11}, 0.26666666666666666], 
      LineBox[{{{13.733333333333333`, -11}, {14.266666666666667`, -11}}, {{
         14, -11.266666666666667`}, {14, -10.733333333333333`}}}]}}, {{{
       {GrayLevel[1], EdgeForm[None], 
        RectangleBox[{15.6, -11.4}, {16.4, -10.6}]}, 
       LineBox[{{15.6, -11.4}, {16.4, -11.4}, {16.4, -10.6}, {15.6, -10.6}, {
        15.6, -11.4}}]}, 
      CircleBox[{16, -11.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{16, -11.2}, {16.24, -10.76}}]}, {{
       {GrayLevel[1], EdgeForm[None], 
        RectangleBox[{15.6, -12.4}, {16.4, -11.6}]}, 
       LineBox[{{15.6, -12.4}, {16.4, -12.4}, {16.4, -11.6}, {15.6, -11.6}, {
        15.6, -12.4}}]}, 
      CircleBox[{16, -12.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{16, -12.2}, {16.24, -11.76}}]}, {{
       {GrayLevel[1], EdgeForm[None], 
        RectangleBox[{15.6, -13.4}, {16.4, -12.6}]}, 
       LineBox[{{15.6, -13.4}, {16.4, -13.4}, {16.4, -12.6}, {15.6, -12.6}, {
        15.6, -13.4}}]}, 
      CircleBox[{16, -13.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{16, -13.2}, {16.24, -12.76}}]}}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{17, Rational[-29, 2]}, {17, Rational[-1, 2]}}, {{
        17, -14.5}, {17, -0.5}}]]}, {
     LineBox[{{18, -11}, {18, -12}, {18, -13}, {18, -1}, {18, -2}, {18, -3}, {
      18, -4}}], DiskBox[{18, -11}, 0.09], DiskBox[{18, -12}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{18, -13}, 0.09]}, 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{17.6, -4.4}, {18.4, -0.6}]},
      LineBox[{{17.6, -4.4}, {18.4, -4.4}, {18.4, -0.6}, {17.6, -0.6}, {
      17.6, -4.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.020000000000000004`],
       FontWeight->"Light",
       FontSlant->Italic], NCache[{18, Rational[-5, 2]}, {18, -2.5}], NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     LineBox[{{19, -11}, {19, -12}, {19, -13}, {19, -6}, {19, -7}, {19, -8}, {
      19, -9}}], DiskBox[{19, -11}, 0.09], DiskBox[{19, -12}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{19, -13}, 0.09]}, 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{18.6, -9.4}, {19.4, -5.6}]},
      LineBox[{{18.6, -9.4}, {19.4, -9.4}, {19.4, -5.6}, {18.6, -5.6}, {
      18.6, -9.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.020000000000000004`],
       FontWeight->"Light",
       FontSlant->Italic], NCache[{19, Rational[-15, 2]}, {19, -7.5}], NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->766.8000000000001,
   PlotRange->NCache[{Full, {
       Rational[-29, 2], 
       Rational[-1, 2]}}, {Full, {-14.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
    Ket[<|$CellContext`T[1, Q3`$] -> 0, $CellContext`T[2, Q3`$] -> 
      0, $CellContext`T[3, Q3`$] -> 0|>], 
    Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
      0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 0|>], 
    Ket[<|$CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
      0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 0|>]], {
    Q3`Rotation[Rational[2, 3] Pi, 
     $CellContext`A[1, 2]], 
    Q3`Rotation[Rational[2, 3] Pi, 
     $CellContext`A[2, 2]], 
    Q3`Rotation[Rational[2, 3] Pi, 
     $CellContext`A[3, 2]], 
    Q3`Rotation[Rational[2, 3] Pi, 
     $CellContext`A[4, 2]]}, 
   Q3`CNOT[{
      $CellContext`A[1, Q3`$]} -> {1}, {
     $CellContext`B[1, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`A[2, Q3`$]} -> {1}, {
     $CellContext`B[2, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`A[3, Q3`$]} -> {1}, {
     $CellContext`B[3, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`A[4, Q3`$]} -> {1}, {
     $CellContext`B[4, Q3`$]}], "Separator", 
   Q3`CNOT[{
      $CellContext`B[1, Q3`$]} -> {1}, {
     $CellContext`T[1, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`B[2, Q3`$], 
      $CellContext`T[1, Q3`$]} -> {1, 1}, {
     $CellContext`T[2, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`B[2, Q3`$]} -> {1}, {
     $CellContext`T[1, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`B[3, Q3`$], 
      $CellContext`T[1, Q3`$]} -> {1, 1}, {
     $CellContext`T[2, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`B[3, Q3`$]} -> {1}, {
     $CellContext`T[1, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`B[4, Q3`$], 
      $CellContext`T[1, Q3`$], 
      $CellContext`T[2, Q3`$]} -> {1, 1, 1}, {
     $CellContext`T[3, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`B[4, Q3`$], 
      $CellContext`T[1, Q3`$]} -> {1, 1}, {
     $CellContext`T[2, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`B[4, Q3`$]} -> {1}, {
     $CellContext`T[1, Q3`$]}], "Spacer", 
   Q3`Measurement[{
     $CellContext`T[1, 3], 
     $CellContext`T[2, 3], 
     $CellContext`T[3, 3]}], "Separator", 
   Q3`ControlledU[{
      $CellContext`T[1, Q3`$], 
      $CellContext`T[2, Q3`$], 
      $CellContext`T[3, Q3`$]} -> {1, 1, 0}, Rational[1, 16] + 
    Rational[-1, 16] $CellContext`A[1, 3] + 
    Rational[-1, 16] $CellContext`A[2, 3] + 
    Rational[3, 8] $CellContext`A[3, 1] + Complex[0, 
       Rational[-1, 4]] $CellContext`A[3, 2] + 
    Rational[-1, 16] $CellContext`A[3, 3] + 
    Rational[1, 8] $CellContext`A[4, 1] + Complex[0, 
       Rational[-1, 8]] $CellContext`A[4, 2] + 
    Rational[-1, 16] $CellContext`A[4, 3] + Rational[1, 16] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 3]] + Rational[-1, 8] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[3, 1]] + Rational[1, 16] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[3, 3]] + Rational[1, 8] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[4, 1]] + Complex[0, 
       Rational[-1, 8]] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[4, 2]] + Rational[1, 16] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[4, 3]] + Rational[1, 16] Q3`Multiply[
       $CellContext`A[2, 1], 
       $CellContext`A[3, 1]] + Complex[0, 
       Rational[1, 16]] Q3`Multiply[
       $CellContext`A[2, 1], 
       $CellContext`A[3, 2]] + Rational[1, 16] Q3`Multiply[
       $CellContext`A[2, 1], 
       $CellContext`A[4, 1]] + Complex[0, 
       Rational[1, 16]] Q3`Multiply[
       $CellContext`A[2, 1], 
       $CellContext`A[4, 2]] + Complex[0, 
       Rational[-1, 16]] Q3`Multiply[
       $CellContext`A[2, 2], 
       $CellContext`A[3, 1]] + Rational[1, 16] Q3`Multiply[
       $CellContext`A[2, 2], 
       $CellContext`A[3, 2]] + Complex[0, 
       Rational[1, 16]] Q3`Multiply[
       $CellContext`A[2, 2], 
       $CellContext`A[4, 1]] + Rational[-1, 16] Q3`Multiply[
       $CellContext`A[2, 2], 
       $CellContext`A[4, 2]] + Rational[-1, 8] Q3`Multiply[
       $CellContext`A[2, 3], 
       $CellContext`A[3, 1]] + Rational[1, 16] Q3`Multiply[
       $CellContext`A[2, 3], 
       $CellContext`A[3, 3]] + Rational[1, 8] Q3`Multiply[
       $CellContext`A[2, 3], 
       $CellContext`A[4, 1]] + Complex[0, 
       Rational[-1, 8]] Q3`Multiply[
       $CellContext`A[2, 3], 
       $CellContext`A[4, 2]] + Rational[1, 16] Q3`Multiply[
       $CellContext`A[2, 3], 
       $CellContext`A[4, 3]] + Rational[1, 16] Q3`Multiply[
       $CellContext`A[3, 1], 
       $CellContext`A[4, 1]] + Complex[0, 
       Rational[1, 16]] Q3`Multiply[
       $CellContext`A[3, 1], 
       $CellContext`A[4, 2]] + Rational[1, 8] Q3`Multiply[
       $CellContext`A[3, 1], 
       $CellContext`A[4, 3]] + Complex[0, 
       Rational[-1, 16]] Q3`Multiply[
       $CellContext`A[3, 2], 
       $CellContext`A[4, 1]] + Rational[1, 16] Q3`Multiply[
       $CellContext`A[3, 2], 
       $CellContext`A[4, 2]] + Rational[1, 16] Q3`Multiply[
       $CellContext`A[3, 3], 
       $CellContext`A[4, 3]] + Rational[1, 16] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 1], 
       $CellContext`A[3, 1]] + Complex[0, 
       Rational[1, 16]] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 1], 
       $CellContext`A[3, 2]] + Rational[-1, 16] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 1], 
       $CellContext`A[4, 1]] + Complex[0, 
       Rational[-1, 16]] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 1], 
       $CellContext`A[4, 2]] + Complex[0, 
       Rational[-1, 16]] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 2], 
       $CellContext`A[3, 1]] + Rational[1, 16] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 2], 
       $CellContext`A[3, 2]] + Complex[0, 
       Rational[-1, 16]] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 2], 
       $CellContext`A[4, 1]] + Rational[1, 16] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 2], 
       $CellContext`A[4, 2]] + Rational[-1, 8] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 3], 
       $CellContext`A[3, 1]] + Complex[0, 
       Rational[1, 4]] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 3], 
       $CellContext`A[3, 2]] + Rational[-1, 16] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 3], 
       $CellContext`A[3, 3]] + Rational[1, 8] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 3], 
       $CellContext`A[4, 1]] + Complex[0, 
       Rational[-1, 8]] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 3], 
       $CellContext`A[4, 2]] + Rational[-1, 16] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 3], 
       $CellContext`A[4, 3]] + Rational[1, 16] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[3, 1], 
       $CellContext`A[4, 1]] + Complex[0, 
       Rational[1, 16]] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[3, 1], 
       $CellContext`A[4, 2]] + Rational[-1, 8] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[3, 1], 
       $CellContext`A[4, 3]] + Complex[0, 
       Rational[-1, 16]] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[3, 2], 
       $CellContext`A[4, 1]] + Rational[1, 16] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[3, 2], 
       $CellContext`A[4, 2]] + Rational[-1, 16] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[3, 3], 
       $CellContext`A[4, 3]] + Rational[1, 8] Q3`Multiply[
       $CellContext`A[2, 1], 
       $CellContext`A[3, 1], 
       $CellContext`A[4, 1]] + Rational[-1, 16] Q3`Multiply[
       $CellContext`A[2, 1], 
       $CellContext`A[3, 1], 
       $CellContext`A[4, 3]] + Complex[0, 
       Rational[1, 8]] Q3`Multiply[
       $CellContext`A[2, 1], 
       $CellContext`A[3, 2], 
       $CellContext`A[4, 1]] + Complex[0, 
       Rational[-1, 16]] Q3`Multiply[
       $CellContext`A[2, 1], 
       $CellContext`A[3, 2], 
       $CellContext`A[4, 3]] + Rational[1, 16] Q3`Multiply[
       $CellContext`A[2, 1], 
       $CellContext`A[3, 3], 
       $CellContext`A[4, 1]] + Complex[0, 
       Rational[1, 16]] Q3`Multiply[
       $CellContext`A[2, 1], 
       $CellContext`A[3, 3], 
       $CellContext`A[4, 2]] + Rational[-1, 8] Q3`Multiply[
       $CellContext`A[2, 2], 
       $CellContext`A[3, 1], 
       $CellContext`A[4, 2]] + Complex[0, 
       Rational[1, 16]] Q3`Multiply[
       $CellContext`A[2, 2], 
       $CellContext`A[3, 1], 
       $CellContext`A[4, 3]] + Complex[0, 
       Rational[-1, 8]] Q3`Multiply[
       $CellContext`A[2, 2], 
       $CellContext`A[3, 2], 
       $CellContext`A[4, 2]] + Rational[-1, 16] Q3`Multiply[
       $CellContext`A[2, 2], 
       $CellContext`A[3, 2], 
       $CellContext`A[4, 3]] + Complex[0, 
       Rational[1, 16]] Q3`Multiply[
       $CellContext`A[2, 2], 
       $CellContext`A[3, 3], 
       $CellContext`A[4, 1]] + Rational[-1, 16] Q3`Multiply[
       $CellContext`A[2, 2], 
       $CellContext`A[3, 3], 
       $CellContext`A[4, 2]] + Rational[1, 16] Q3`Multiply[
       $CellContext`A[2, 3], 
       $CellContext`A[3, 1], 
       $CellContext`A[4, 1]] + Complex[0, 
       Rational[1, 16]] Q3`Multiply[
       $CellContext`A[2, 3], 
       $CellContext`A[3, 1], 
       $CellContext`A[4, 2]] + Rational[-1, 8] Q3`Multiply[
       $CellContext`A[2, 3], 
       $CellContext`A[3, 1], 
       $CellContext`A[4, 3]] + Complex[0, 
       Rational[-1, 16]] Q3`Multiply[
       $CellContext`A[2, 3], 
       $CellContext`A[3, 2], 
       $CellContext`A[4, 1]] + Rational[1, 16] Q3`Multiply[
       $CellContext`A[2, 3], 
       $CellContext`A[3, 2], 
       $CellContext`A[4, 2]] + Rational[-1, 16] Q3`Multiply[
       $CellContext`A[2, 3], 
       $CellContext`A[3, 3], 
       $CellContext`A[4, 3]] + Rational[1, 8] Q3`Multiply[
       $CellContext`A[1, 1], 
       $CellContext`A[2, 1], 
       $CellContext`A[3, 1], 
       $CellContext`A[4, 1]] + Complex[0, 
       Rational[1, 8]] Q3`Multiply[
       $CellContext`A[1, 1], 
       $CellContext`A[2, 1], 
       $CellContext`A[3, 2], 
       $CellContext`A[4, 1]] + Rational[1, 8] Q3`Multiply[
       $CellContext`A[1, 1], 
       $CellContext`A[2, 2], 
       $CellContext`A[3, 1], 
       $CellContext`A[4, 2]] + Complex[0, 
       Rational[1, 8]] Q3`Multiply[
       $CellContext`A[1, 1], 
       $CellContext`A[2, 2], 
       $CellContext`A[3, 2], 
       $CellContext`A[4, 2]] + Rational[-1, 8] Q3`Multiply[
       $CellContext`A[1, 2], 
       $CellContext`A[2, 1], 
       $CellContext`A[3, 1], 
       $CellContext`A[4, 2]] + Complex[0, 
       Rational[-1, 8]] Q3`Multiply[
       $CellContext`A[1, 2], 
       $CellContext`A[2, 1], 
       $CellContext`A[3, 2], 
       $CellContext`A[4, 2]] + Rational[1, 8] Q3`Multiply[
       $CellContext`A[1, 2], 
       $CellContext`A[2, 2], 
       $CellContext`A[3, 1], 
       $CellContext`A[4, 1]] + Complex[0, 
       Rational[1, 8]] Q3`Multiply[
       $CellContext`A[1, 2], 
       $CellContext`A[2, 2], 
       $CellContext`A[3, 2], 
       $CellContext`A[4, 1]] + Complex[0, 
       Rational[1, 8]] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 1], 
       $CellContext`A[3, 1], 
       $CellContext`A[4, 2]] + Rational[-1, 16] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 1], 
       $CellContext`A[3, 1], 
       $CellContext`A[4, 3]] + Rational[-1, 8] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 1], 
       $CellContext`A[3, 2], 
       $CellContext`A[4, 2]] + Complex[0, 
       Rational[-1, 16]] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 1], 
       $CellContext`A[3, 2], 
       $CellContext`A[4, 3]] + Rational[-1, 16] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 1], 
       $CellContext`A[3, 3], 
       $CellContext`A[4, 1]] + Complex[0, 
       Rational[-1, 16]] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 1], 
       $CellContext`A[3, 3], 
       $CellContext`A[4, 2]] + Complex[0, 
       Rational[1, 8]] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 2], 
       $CellContext`A[3, 1], 
       $CellContext`A[4, 1]] + Complex[0, 
       Rational[1, 16]] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 2], 
       $CellContext`A[3, 1], 
       $CellContext`A[4, 3]] + Rational[-1, 8] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 2], 
       $CellContext`A[3, 2], 
       $CellContext`A[4, 1]] + Rational[-1, 16] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 2], 
       $CellContext`A[3, 2], 
       $CellContext`A[4, 3]] + Complex[0, 
       Rational[-1, 16]] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 2], 
       $CellContext`A[3, 3], 
       $CellContext`A[4, 1]] + Rational[1, 16] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 2], 
       $CellContext`A[3, 3], 
       $CellContext`A[4, 2]] + Rational[1, 16] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 3], 
       $CellContext`A[3, 1], 
       $CellContext`A[4, 1]] + Complex[0, 
       Rational[1, 16]] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 3], 
       $CellContext`A[3, 1], 
       $CellContext`A[4, 2]] + Rational[1, 8] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 3], 
       $CellContext`A[3, 1], 
       $CellContext`A[4, 3]] + Complex[0, 
       Rational[-1, 16]] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 3], 
       $CellContext`A[3, 2], 
       $CellContext`A[4, 1]] + Rational[1, 16] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 3], 
       $CellContext`A[3, 2], 
       $CellContext`A[4, 2]] + Rational[1, 16] Q3`Multiply[
       $CellContext`A[1, 3], 
       $CellContext`A[2, 3], 
       $CellContext`A[3, 3], 
       $CellContext`A[4, 3]], "Label" -> "U"], 
   Q3`ControlledU[{
      $CellContext`T[1, Q3`$], 
      $CellContext`T[2, Q3`$], 
      $CellContext`T[3, Q3`$]} -> {1, 1, 0}, Rational[1, 16] + 
    Rational[-1, 16] $CellContext`B[1, 3] + 
    Rational[-1, 16] $CellContext`B[2, 3] + 
    Rational[3, 8] $CellContext`B[3, 1] + Complex[0, 
       Rational[-1, 4]] $CellContext`B[3, 2] + 
    Rational[-1, 16] $CellContext`B[3, 3] + 
    Rational[1, 8] $CellContext`B[4, 1] + Complex[0, 
       Rational[-1, 8]] $CellContext`B[4, 2] + 
    Rational[-1, 16] $CellContext`B[4, 3] + Rational[1, 16] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 3]] + Rational[-1, 8] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[3, 1]] + Rational[1, 16] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[3, 3]] + Rational[1, 8] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[4, 1]] + Complex[0, 
       Rational[-1, 8]] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[4, 2]] + Rational[1, 16] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[4, 3]] + Rational[1, 16] Q3`Multiply[
       $CellContext`B[2, 1], 
       $CellContext`B[3, 1]] + Complex[0, 
       Rational[1, 16]] Q3`Multiply[
       $CellContext`B[2, 1], 
       $CellContext`B[3, 2]] + Rational[1, 16] Q3`Multiply[
       $CellContext`B[2, 1], 
       $CellContext`B[4, 1]] + Complex[0, 
       Rational[1, 16]] Q3`Multiply[
       $CellContext`B[2, 1], 
       $CellContext`B[4, 2]] + Complex[0, 
       Rational[-1, 16]] Q3`Multiply[
       $CellContext`B[2, 2], 
       $CellContext`B[3, 1]] + Rational[1, 16] Q3`Multiply[
       $CellContext`B[2, 2], 
       $CellContext`B[3, 2]] + Complex[0, 
       Rational[1, 16]] Q3`Multiply[
       $CellContext`B[2, 2], 
       $CellContext`B[4, 1]] + Rational[-1, 16] Q3`Multiply[
       $CellContext`B[2, 2], 
       $CellContext`B[4, 2]] + Rational[-1, 8] Q3`Multiply[
       $CellContext`B[2, 3], 
       $CellContext`B[3, 1]] + Rational[1, 16] Q3`Multiply[
       $CellContext`B[2, 3], 
       $CellContext`B[3, 3]] + Rational[1, 8] Q3`Multiply[
       $CellContext`B[2, 3], 
       $CellContext`B[4, 1]] + Complex[0, 
       Rational[-1, 8]] Q3`Multiply[
       $CellContext`B[2, 3], 
       $CellContext`B[4, 2]] + Rational[1, 16] Q3`Multiply[
       $CellContext`B[2, 3], 
       $CellContext`B[4, 3]] + Rational[1, 16] Q3`Multiply[
       $CellContext`B[3, 1], 
       $CellContext`B[4, 1]] + Complex[0, 
       Rational[1, 16]] Q3`Multiply[
       $CellContext`B[3, 1], 
       $CellContext`B[4, 2]] + Rational[1, 8] Q3`Multiply[
       $CellContext`B[3, 1], 
       $CellContext`B[4, 3]] + Complex[0, 
       Rational[-1, 16]] Q3`Multiply[
       $CellContext`B[3, 2], 
       $CellContext`B[4, 1]] + Rational[1, 16] Q3`Multiply[
       $CellContext`B[3, 2], 
       $CellContext`B[4, 2]] + Rational[1, 16] Q3`Multiply[
       $CellContext`B[3, 3], 
       $CellContext`B[4, 3]] + Rational[1, 16] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 1], 
       $CellContext`B[3, 1]] + Complex[0, 
       Rational[1, 16]] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 1], 
       $CellContext`B[3, 2]] + Rational[-1, 16] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 1], 
       $CellContext`B[4, 1]] + Complex[0, 
       Rational[-1, 16]] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 1], 
       $CellContext`B[4, 2]] + Complex[0, 
       Rational[-1, 16]] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 2], 
       $CellContext`B[3, 1]] + Rational[1, 16] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 2], 
       $CellContext`B[3, 2]] + Complex[0, 
       Rational[-1, 16]] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 2], 
       $CellContext`B[4, 1]] + Rational[1, 16] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 2], 
       $CellContext`B[4, 2]] + Rational[-1, 8] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 3], 
       $CellContext`B[3, 1]] + Complex[0, 
       Rational[1, 4]] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 3], 
       $CellContext`B[3, 2]] + Rational[-1, 16] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 3], 
       $CellContext`B[3, 3]] + Rational[1, 8] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 3], 
       $CellContext`B[4, 1]] + Complex[0, 
       Rational[-1, 8]] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 3], 
       $CellContext`B[4, 2]] + Rational[-1, 16] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 3], 
       $CellContext`B[4, 3]] + Rational[1, 16] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[3, 1], 
       $CellContext`B[4, 1]] + Complex[0, 
       Rational[1, 16]] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[3, 1], 
       $CellContext`B[4, 2]] + Rational[-1, 8] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[3, 1], 
       $CellContext`B[4, 3]] + Complex[0, 
       Rational[-1, 16]] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[3, 2], 
       $CellContext`B[4, 1]] + Rational[1, 16] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[3, 2], 
       $CellContext`B[4, 2]] + Rational[-1, 16] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[3, 3], 
       $CellContext`B[4, 3]] + Rational[1, 8] Q3`Multiply[
       $CellContext`B[2, 1], 
       $CellContext`B[3, 1], 
       $CellContext`B[4, 1]] + Rational[-1, 16] Q3`Multiply[
       $CellContext`B[2, 1], 
       $CellContext`B[3, 1], 
       $CellContext`B[4, 3]] + Complex[0, 
       Rational[1, 8]] Q3`Multiply[
       $CellContext`B[2, 1], 
       $CellContext`B[3, 2], 
       $CellContext`B[4, 1]] + Complex[0, 
       Rational[-1, 16]] Q3`Multiply[
       $CellContext`B[2, 1], 
       $CellContext`B[3, 2], 
       $CellContext`B[4, 3]] + Rational[1, 16] Q3`Multiply[
       $CellContext`B[2, 1], 
       $CellContext`B[3, 3], 
       $CellContext`B[4, 1]] + Complex[0, 
       Rational[1, 16]] Q3`Multiply[
       $CellContext`B[2, 1], 
       $CellContext`B[3, 3], 
       $CellContext`B[4, 2]] + Rational[-1, 8] Q3`Multiply[
       $CellContext`B[2, 2], 
       $CellContext`B[3, 1], 
       $CellContext`B[4, 2]] + Complex[0, 
       Rational[1, 16]] Q3`Multiply[
       $CellContext`B[2, 2], 
       $CellContext`B[3, 1], 
       $CellContext`B[4, 3]] + Complex[0, 
       Rational[-1, 8]] Q3`Multiply[
       $CellContext`B[2, 2], 
       $CellContext`B[3, 2], 
       $CellContext`B[4, 2]] + Rational[-1, 16] Q3`Multiply[
       $CellContext`B[2, 2], 
       $CellContext`B[3, 2], 
       $CellContext`B[4, 3]] + Complex[0, 
       Rational[1, 16]] Q3`Multiply[
       $CellContext`B[2, 2], 
       $CellContext`B[3, 3], 
       $CellContext`B[4, 1]] + Rational[-1, 16] Q3`Multiply[
       $CellContext`B[2, 2], 
       $CellContext`B[3, 3], 
       $CellContext`B[4, 2]] + Rational[1, 16] Q3`Multiply[
       $CellContext`B[2, 3], 
       $CellContext`B[3, 1], 
       $CellContext`B[4, 1]] + Complex[0, 
       Rational[1, 16]] Q3`Multiply[
       $CellContext`B[2, 3], 
       $CellContext`B[3, 1], 
       $CellContext`B[4, 2]] + Rational[-1, 8] Q3`Multiply[
       $CellContext`B[2, 3], 
       $CellContext`B[3, 1], 
       $CellContext`B[4, 3]] + Complex[0, 
       Rational[-1, 16]] Q3`Multiply[
       $CellContext`B[2, 3], 
       $CellContext`B[3, 2], 
       $CellContext`B[4, 1]] + Rational[1, 16] Q3`Multiply[
       $CellContext`B[2, 3], 
       $CellContext`B[3, 2], 
       $CellContext`B[4, 2]] + Rational[-1, 16] Q3`Multiply[
       $CellContext`B[2, 3], 
       $CellContext`B[3, 3], 
       $CellContext`B[4, 3]] + Rational[1, 8] Q3`Multiply[
       $CellContext`B[1, 1], 
       $CellContext`B[2, 1], 
       $CellContext`B[3, 1], 
       $CellContext`B[4, 1]] + Complex[0, 
       Rational[1, 8]] Q3`Multiply[
       $CellContext`B[1, 1], 
       $CellContext`B[2, 1], 
       $CellContext`B[3, 2], 
       $CellContext`B[4, 1]] + Rational[1, 8] Q3`Multiply[
       $CellContext`B[1, 1], 
       $CellContext`B[2, 2], 
       $CellContext`B[3, 1], 
       $CellContext`B[4, 2]] + Complex[0, 
       Rational[1, 8]] Q3`Multiply[
       $CellContext`B[1, 1], 
       $CellContext`B[2, 2], 
       $CellContext`B[3, 2], 
       $CellContext`B[4, 2]] + Rational[-1, 8] Q3`Multiply[
       $CellContext`B[1, 2], 
       $CellContext`B[2, 1], 
       $CellContext`B[3, 1], 
       $CellContext`B[4, 2]] + Complex[0, 
       Rational[-1, 8]] Q3`Multiply[
       $CellContext`B[1, 2], 
       $CellContext`B[2, 1], 
       $CellContext`B[3, 2], 
       $CellContext`B[4, 2]] + Rational[1, 8] Q3`Multiply[
       $CellContext`B[1, 2], 
       $CellContext`B[2, 2], 
       $CellContext`B[3, 1], 
       $CellContext`B[4, 1]] + Complex[0, 
       Rational[1, 8]] Q3`Multiply[
       $CellContext`B[1, 2], 
       $CellContext`B[2, 2], 
       $CellContext`B[3, 2], 
       $CellContext`B[4, 1]] + Complex[0, 
       Rational[1, 8]] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 1], 
       $CellContext`B[3, 1], 
       $CellContext`B[4, 2]] + Rational[-1, 16] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 1], 
       $CellContext`B[3, 1], 
       $CellContext`B[4, 3]] + Rational[-1, 8] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 1], 
       $CellContext`B[3, 2], 
       $CellContext`B[4, 2]] + Complex[0, 
       Rational[-1, 16]] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 1], 
       $CellContext`B[3, 2], 
       $CellContext`B[4, 3]] + Rational[-1, 16] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 1], 
       $CellContext`B[3, 3], 
       $CellContext`B[4, 1]] + Complex[0, 
       Rational[-1, 16]] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 1], 
       $CellContext`B[3, 3], 
       $CellContext`B[4, 2]] + Complex[0, 
       Rational[1, 8]] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 2], 
       $CellContext`B[3, 1], 
       $CellContext`B[4, 1]] + Complex[0, 
       Rational[1, 16]] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 2], 
       $CellContext`B[3, 1], 
       $CellContext`B[4, 3]] + Rational[-1, 8] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 2], 
       $CellContext`B[3, 2], 
       $CellContext`B[4, 1]] + Rational[-1, 16] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 2], 
       $CellContext`B[3, 2], 
       $CellContext`B[4, 3]] + Complex[0, 
       Rational[-1, 16]] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 2], 
       $CellContext`B[3, 3], 
       $CellContext`B[4, 1]] + Rational[1, 16] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 2], 
       $CellContext`B[3, 3], 
       $CellContext`B[4, 2]] + Rational[1, 16] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 3], 
       $CellContext`B[3, 1], 
       $CellContext`B[4, 1]] + Complex[0, 
       Rational[1, 16]] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 3], 
       $CellContext`B[3, 1], 
       $CellContext`B[4, 2]] + Rational[1, 8] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 3], 
       $CellContext`B[3, 1], 
       $CellContext`B[4, 3]] + Complex[0, 
       Rational[-1, 16]] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 3], 
       $CellContext`B[3, 2], 
       $CellContext`B[4, 1]] + Rational[1, 16] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 3], 
       $CellContext`B[3, 2], 
       $CellContext`B[4, 2]] + Rational[1, 16] Q3`Multiply[
       $CellContext`B[1, 3], 
       $CellContext`B[2, 3], 
       $CellContext`B[3, 3], 
       $CellContext`B[4, 3]], "Label" -> "U"], Null, "Invisible" -> {
     $CellContext`A[
      Rational[9, 2]], 
     $CellContext`B[
      Rational[9, 2]], 
     $CellContext`T[5]}, "Invisible" -> $CellContext`A[
     Rational[9, 2]], "Invisible" -> $CellContext`B[
     Rational[9, 2]]]]], "Output",
 CellChangeTimes->{{3.87691426095925*^9, 3.876914290112782*^9}, 
   3.876914487131399*^9, 3.878641043521603*^9, {3.8786411129022303`*^9, 
   3.8786411325539923`*^9}, 3.878641485864048*^9, 3.878643425361786*^9, 
   3.8786440596176577`*^9, 3.8790756389934883`*^9, 3.8850935882603827`*^9, 
   3.8850936780584517`*^9},
 CellLabel->"Out[79]=",
 CellID->2087595566,ExpressionUUID->"a1c0e6ff-0b59-4445-9e5a-7fe096fb07ef"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Because the transformation on Alice\[CloseCurlyQuote]s and Bob\
\[CloseCurlyQuote]s sides are designed for the measurement outcome of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Z", "tot"], "=", "3"}], TraditionalForm]],ExpressionUUID->
  "dc39250d-3b55-4171-884d-083a187d5835"],
 ", we just run the quantum circuit until we get the desired outcome."
}], "Text",
 CellID->196356282,ExpressionUUID->"2c56d7fa-37c4-4ff3-bc38-624540bcf713"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Until", "[", 
   RowBox[{
    RowBox[{"ztot", "==", "3"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"out", "=", 
      RowBox[{"Elaborate", "[", "all", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ztot", "=", 
      RowBox[{"FromDigits", "[", 
       RowBox[{
        RowBox[{"Reverse", "@", 
         RowBox[{"Readout", "[", 
          RowBox[{"Through", "[", 
           RowBox[{"TT", "[", "3", "]"}], "]"}], "]"}]}], ",", "2"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"\"\<\!\(\*SubscriptBox[\(Z\), \(tot\)]\)=\>\"", ",", "ztot"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.878643473715075*^9, 3.8786434875264587`*^9}},
 CellLabel->"In[80]:=",
 CellID->1625149782,ExpressionUUID->"8c92cb94-c212-4b23-9574-a551be752d7d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Here is the output state of the total system. Obviously, the whole register \
",
 StyleBox["T",
  FontSlant->"Italic"],
 " is separated from the other two registers. So are the last two registers \
of the respective registers A and B."
}], "Text",
 CellID->47879881,ExpressionUUID->"27cd6758-4e9a-4ab9-a03a-5d32b41fb8f2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LogicalForm", "[", 
  RowBox[{"out", ",", 
   RowBox[{"Join", "[", 
    RowBox[{"AA", ",", "BB", ",", "TT"}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[81]:=",
 CellID->1558275989,ExpressionUUID->"525db037-2a05-40e8-8608-34b8eac855e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"T"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`T[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"T"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`T[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"T"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`T[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
      0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 
      0, $CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
      0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 
      0, $CellContext`T[1, Q3`$] -> 1, $CellContext`T[2, Q3`$] -> 
      1, $CellContext`T[3, Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"T"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`T[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"T"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`T[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"T"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`T[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
      1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 
      0, $CellContext`B[1, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 
      1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 
      0, $CellContext`T[1, Q3`$] -> 1, $CellContext`T[2, Q3`$] -> 
      1, $CellContext`T[3, Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"T"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`T[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"T"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`T[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"T"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`T[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
      0, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 
      0, $CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
      0, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 
      0, $CellContext`T[1, Q3`$] -> 1, $CellContext`T[2, Q3`$] -> 
      1, $CellContext`T[3, Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"T"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`T[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"T"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`T[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"T"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`T[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
      1, $CellContext`A[3, Q3`$] -> 0, $CellContext`A[4, Q3`$] -> 
      0, $CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
      1, $CellContext`B[3, Q3`$] -> 0, $CellContext`B[4, Q3`$] -> 
      0, $CellContext`T[1, Q3`$] -> 1, $CellContext`T[2, Q3`$] -> 
      1, $CellContext`T[3, Q3`$] -> 0|>]]}]}]], "Output",
 CellChangeTimes->{3.876914497478353*^9, 3.878644102755144*^9, 
  3.87907565046697*^9, 3.8850936125975122`*^9, 3.8850936887744627`*^9},
 CellLabel->"Out[81]=",
 CellID->28373530,ExpressionUUID->"77d98272-a7ac-46f2-9312-62eb6d80d7c0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Focusing on the first two qubits of registers A and B, we see that there are \
two maximally entangled pairs.\
\>", "Text",
 CellChangeTimes->{{3.8803972604383087`*^9, 3.880397261610248*^9}},
 CellID->1953490389,ExpressionUUID->"8a2222a2-dadb-4ac1-918b-a1d277ec715e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SimpleForm", "[", 
  RowBox[{"out", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], ",", 
     RowBox[{"B", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}]}], "}"}]}], "]"}]], "Input",
 CellLabel->"In[82]:=",
 CellID->1582972587,ExpressionUUID->"2dd2b211-3e22-4090-b6e3-470af69d8ed0"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"0", "0"}, "RowDefault"], "\";\"", 
        TemplateBox[{"0", "0"}, "RowDefault"]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`T[1, Q3`$] -> 1, $CellContext`T[2, Q3`$] -> 1|>]], 
   "2"], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"0", "1"}, "RowDefault"], "\";\"", 
        TemplateBox[{"0", "1"}, "RowDefault"]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[2, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
      1, $CellContext`T[1, Q3`$] -> 1, $CellContext`T[2, Q3`$] -> 1|>]], "2"],
   "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"1", "0"}, "RowDefault"], "\";\"", 
        TemplateBox[{"1", "0"}, "RowDefault"]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`B[1, Q3`$] -> 
      1, $CellContext`T[1, Q3`$] -> 1, $CellContext`T[2, Q3`$] -> 1|>]], "2"],
   "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"1", "1"}, "RowDefault"], "\";\"", 
        TemplateBox[{"1", "1"}, "RowDefault"]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
      1, $CellContext`B[1, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
      1, $CellContext`T[1, Q3`$] -> 1, $CellContext`T[2, Q3`$] -> 1|>]], 
   "2"]}]], "Output",
 CellChangeTimes->{3.8769144990607243`*^9, 3.878644106593828*^9, 
  3.8790756519580727`*^9, 3.8850936140414762`*^9, 3.885093690160919*^9},
 CellLabel->"Out[82]=",
 CellID->1983767978,ExpressionUUID->"f9108907-8329-428d-a866-d094ddd81036"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KetFactor", "@", 
  RowBox[{"KetDrop", "[", 
   RowBox[{"out", ",", "TT"}], "]"}]}]], "Input",
 CellLabel->"In[83]:=",
 CellID->1686302499,ExpressionUUID->"6432b5d2-2ea7-4af3-844a-27333810bcf5"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  InterpretationBox[
   TagBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`B[1, Q3`$] -> 0|>]], 
       "+", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`B[1, Q3`$] -> 
          1|>]]}], ")"}], "\[CircleTimes]", 
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[2, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 0|>]], 
       "+", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[2, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
          1|>]]}], ")"}]}],
    HoldForm],
   Q3`OTimes[
   Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`B[1, Q3`$] -> 0|>] + 
    Ket[<|$CellContext`A[1, Q3`$] -> 1, $CellContext`B[1, Q3`$] -> 1|>], 
    Ket[<|$CellContext`A[2, Q3`$] -> 0, $CellContext`B[2, Q3`$] -> 0|>] + 
    Ket[<|$CellContext`A[2, Q3`$] -> 1, $CellContext`B[2, Q3`$] -> 
       1|>]]]}]], "Output",
 CellChangeTimes->{3.876914500877365*^9, 3.878644108050598*^9, 
  3.8790756526759357`*^9, 3.885093615827732*^9, 3.88509369120572*^9},
 CellLabel->"Out[83]=",
 CellID->394271891,ExpressionUUID->"4f999e01-521d-4fa3-8c52-8d5a2dc62821"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Remark", "Subsection",
 CellChangeTimes->{{3.8803972821289043`*^9, 3.880397285020754*^9}},
 CellID->1711953502,ExpressionUUID->"5c2b93ae-be33-40b7-b8ef-ff87a493a2fe"],

Cell[TextData[{
 "So, we have successfully generated two maximally entangled pairs from four \
partially entangled pairs. Note that this was possible because we assumed \
that the measurement outcome was ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "=", "3"}], TraditionalForm]],ExpressionUUID->
  "bd5cbb57-6676-47c8-a756-8a7d67ac9bd9"],
 ". The case with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "=", "1"}], TraditionalForm]],ExpressionUUID->
  "e34fe256-4a81-46b0-a12a-6b30f191ae4e"],
 " is also handled following a similar procedure."
}], "Text",
 CellChangeTimes->{{3.880397310158421*^9, 3.8803973126356916`*^9}},
 CellID->862841207,ExpressionUUID->"c7e7b19a-c245-42b9-afc6-94e338438ede"],

Cell[CellGroupData[{

Cell[TextData[{
 "However, if the measurement outcome is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "=", "2"}], TraditionalForm]],ExpressionUUID->
  "20a9fc09-2474-42eb-8210-d951aed89d91"],
 ", resulting in the post-measurement state"
}], "Text",
 CellChangeTimes->{3.880397310158421*^9},
 CellID->719303896,ExpressionUUID->"b4416a65-1b9d-4504-8192-c4e67a1852e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "6"], " ", 
   TemplateBox[{
     TemplateBox[{
       TemplateBox[{"0", "0", "1", "1"}, "RowDefault"]}, "Ket"], 
     "\"\[CircleTimes]\"", 
     TemplateBox[{
       TemplateBox[{"0", "0", "1", "1"}, "RowDefault"]}, "Ket"]},
    "RowDefault"]}], "+", 
  RowBox[{
   FractionBox["1", "6"], " ", 
   TemplateBox[{
     TemplateBox[{
       TemplateBox[{"0", "1", "0", "1"}, "RowDefault"]}, "Ket"], 
     "\"\[CircleTimes]\"", 
     TemplateBox[{
       TemplateBox[{"0", "1", "0", "1"}, "RowDefault"]}, "Ket"]},
    "RowDefault"]}], "+", 
  RowBox[{
   FractionBox["1", "6"], " ", 
   TemplateBox[{
     TemplateBox[{
       TemplateBox[{"0", "1", "1", "0"}, "RowDefault"]}, "Ket"], 
     "\"\[CircleTimes]\"", 
     TemplateBox[{
       TemplateBox[{"0", "1", "1", "0"}, "RowDefault"]}, "Ket"]},
    "RowDefault"]}], "+", 
  RowBox[{
   FractionBox["1", "6"], " ", 
   TemplateBox[{
     TemplateBox[{
       TemplateBox[{"1", "0", "0", "1"}, "RowDefault"]}, "Ket"], 
     "\"\[CircleTimes]\"", 
     TemplateBox[{
       TemplateBox[{"1", "0", "0", "1"}, "RowDefault"]}, "Ket"]},
    "RowDefault"]}], "+", 
  RowBox[{
   FractionBox["1", "6"], " ", 
   TemplateBox[{
     TemplateBox[{
       TemplateBox[{"1", "0", "1", "0"}, "RowDefault"]}, "Ket"], 
     "\"\[CircleTimes]\"", 
     TemplateBox[{
       TemplateBox[{"1", "0", "1", "0"}, "RowDefault"]}, "Ket"]},
    "RowDefault"]}], "+", 
  RowBox[{
   FractionBox["1", "6"], " ", 
   TemplateBox[{
     TemplateBox[{
       TemplateBox[{"1", "1", "0", "0"}, "RowDefault"]}, "Ket"], 
     "\"\[CircleTimes]\"", 
     TemplateBox[{
       TemplateBox[{"1", "1", "0", "0"}, "RowDefault"]}, "Ket"]},
    "RowDefault"]}]}]], "Output",
 CellID->2025483658,ExpressionUUID->"7f50fa65-79c4-4207-a529-353b4b07cfaa"]
}, Open  ]],

Cell["\<\
then there is no way to turn this state into a product state on a system of \
qubits.\
\>", "Text",
 CellID->994499068,ExpressionUUID->"ff58addb-5baa-44ef-bf49-bac6abdf8a72"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Related Guides", "TutorialMoreAboutSection",
 CellChangeTimes->{{3.843042384656711*^9, 3.843042386024461*^9}},
 CellID->1812928137,ExpressionUUID->"8b2ccaf6-8cab-43e2-bdc8-c590499182a0"],

Cell[TextData[ButtonBox["Quantum Information Systems",
 BaseStyle->"Link",
 ButtonData->
  "paclet:Q3/guide/QuantumInformationSystems"]], "TutorialMoreAbout",
 CellChangeTimes->{{3.85240783449739*^9, 3.8524078434504623`*^9}},
 CellID->1490297060,ExpressionUUID->"12953a1e-cd45-4feb-a834-84510cc5a5da"],

Cell[TextData[ButtonBox["Quantum Many-Body Systems",
 BaseStyle->"Link",
 ButtonData->"paclet:Q3/guide/QuantumManyBodySystems"]], "TutorialMoreAbout",
 CellChangeTimes->{{3.881697463855186*^9, 3.881697484969919*^9}},
 CellID->2008440499,ExpressionUUID->"69499c83-e992-4ce4-aa1f-ec742262268b"],

Cell[TextData[ButtonBox["Quantum Spin Systems",
 BaseStyle->"Link",
 ButtonData->"paclet:Q3/guide/QuantumSpinSystems"]], "TutorialMoreAbout",
 CellChangeTimes->{{3.881697469489766*^9, 3.881697477809999*^9}},
 CellID->1841390299,ExpressionUUID->"26794b5e-2316-4a4d-9394-6d966bdc1ad8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Related Tech Notes", "RelatedTutorialsSection",
 CellID->436993734,ExpressionUUID->"625ae735-7219-4661-b0d1-8323e57fe844"],

Cell[TextData[ButtonBox["A Quantum Playbook",
 BaseStyle->"Link",
 ButtonData->
  "paclet:QuantumPlaybook/tutorial/QuantumPlaybook"]], "TutorialMoreAbout",
 CellChangeTimes->{{3.850722694237966*^9, 3.850722720928739*^9}},
 CellID->250823754,ExpressionUUID->"edc9fe84-7d53-4f6b-b973-35f6f6169405"],

Cell[TextData[ButtonBox["Entanglement Distillation",
 BaseStyle->"Link",
 ButtonData->
  "paclet:QuantumPlaybook/tutorial/EntanglementDistillation"]], \
"RelatedTutorials",
 CellChangeTimes->{{3.876912470169544*^9, 3.876912480094108*^9}},
 CellID->159614598,ExpressionUUID->"de55eb4d-0b28-4dc4-8ba9-1c4f1884eeb8"],

Cell[TextData[ButtonBox["Quantum Information Theory",
 BaseStyle->"Link",
 ButtonData->
  "paclet:Q3/tutorial/QuantumInformationTheory"]], "RelatedTutorials",
 CellChangeTimes->{{3.8752464248056583`*^9, 3.8752464349647293`*^9}},
 CellID->728547302,ExpressionUUID->"61b46736-1ad7-4837-b3c8-62bf16de2d9c"],

Cell[TextData[ButtonBox["Quantum Information Systems with Q3",
 BaseStyle->"Link",
 ButtonData->
  "paclet:Q3/tutorial/QuantumInformationSystems"]], "RelatedTutorials",
 CellChangeTimes->{{3.852407795508053*^9, 3.852407815109619*^9}},
 CellID->533614654,ExpressionUUID->"9efb07f7-0154-4339-ad00-5e07c0e254fc"],

Cell[TextData[ButtonBox["Quantum Many-Body Systems with Q3",
 BaseStyle->"Link",
 ButtonData->"paclet:Q3/tutorial/QuantumManyBodySystems"]], "RelatedTutorials",\

 CellChangeTimes->{{3.813416463478786*^9, 3.813416463803636*^9}, {
  3.8134165312965517`*^9, 3.8134165313618937`*^9}},
 CellID->756459821,ExpressionUUID->"f3d9fc6a-1ff4-4f1e-9add-4d8fdff592b7"],

Cell[TextData[ButtonBox["Quantum Spin Systems with Q3",
 BaseStyle->"Link",
 ButtonData->"paclet:Q3/tutorial/QuantumSpinSystems"]], "RelatedTutorials",
 CellChangeTimes->{{3.8134164651098337`*^9, 3.813416465850943*^9}, {
  3.81341653526635*^9, 3.813416535331787*^9}},
 CellID->2062924057,ExpressionUUID->"a844265d-8753-4a48-b6d2-70c2897cc3d8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Related Links", "TutorialRelatedLinksSection",
 CellChangeTimes->{{3.850597361716105*^9, 3.850597362195363*^9}},
 CellID->847161968,ExpressionUUID->"4640f67b-3cfb-43e7-a7d2-c1f8928e1c70"],

Cell[TextData[{
 ButtonBox["J. Preskill (1998)",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://theory.caltech.edu/~preskill/ph229/"], None}],
 ", Lecture Notes for Physics 229: Quantum Information and Computation."
}], "TutorialRelatedLinks",
 CellChangeTimes->{{3.838416666529841*^9, 3.8384167198471823`*^9}, {
  3.875246577338297*^9, 3.8752466017711143`*^9}},
 CellID->90212659,ExpressionUUID->"bfef24ae-266b-4952-adb1-3f880d882881"],

Cell[TextData[{
 StyleBox[ButtonBox["M. Nielsen and I. L. Chuang (2022)",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1017/CBO9780511976667"], None},
  ButtonNote->"https://doi.org/10.1017/CBO9780511976667"],
  FontSlant->"Plain"],
 StyleBox[", Quantum Computation and Quantum Information (Cambridge \
University Press, 2011).",
  FontSlant->"Plain"]
}], "TutorialRelatedLinks",
 CellChangeTimes->{{3.850961013179529*^9, 3.8509610304423647`*^9}, {
  3.856689068353026*^9, 3.856689111943965*^9}},
 CellID->1612042109,ExpressionUUID->"57202c2e-1a2d-491f-b66d-1bc8e6794516"],

Cell[TextData[{
 ButtonBox["Mahn-Soo Choi (2022)",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1007/978-3-030-91214-7"], None}],
 ", A Quantum Computation Workbook (Springer, 2022)."
}], "TutorialRelatedLinks",
 CellChangeTimes->{
  3.8505890170531683`*^9, {3.85668899380037*^9, 3.856689046766375*^9}, {
   3.8566891672259073`*^9, 3.85668919109593*^9}},
 CellID->1997366095,ExpressionUUID->"4740f4eb-d4a7-4547-a903-2b78e4a1ed8f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Metadata", "MetadataSection",
 CellID->435473483,ExpressionUUID->"57723b63-0f70-40f9-82e5-a2a920be4c70"],

Cell[TextData[{
 "New in: ",
 Cell["13.1", "HistoryData",
  CellTags->"New",ExpressionUUID->"99a99901-487b-45ad-953f-7d60aa0680cd"],
 " | Modified in: ",
 Cell[" ", "HistoryData",
  CellTags->"Modified",ExpressionUUID->"04fd9efc-882f-42fd-a0ca-c97eb43f6309"],
 " | Obsolete in: ",
 Cell[" ", "HistoryData",
  CellTags->"Obsolete",ExpressionUUID->"87ca3475-c829-4f72-a649-d7fa91745927"],
 " | Excised in: ",
 Cell[" ", "HistoryData",
  CellTags->"Excised",ExpressionUUID->"06229eb1-ad7c-4950-87db-23ff5a4f3df5"]
}], "History",
 CellChangeTimes->{{3.852925529388873*^9, 3.85292552956523*^9}, {
  3.875246359692999*^9, 3.8752463598293247`*^9}},
 CellID->675385998,ExpressionUUID->"0d8a6edb-27ca-44bf-9fc9-692d232dda08"],

Cell[CellGroupData[{

Cell["Categorization", "CategorizationSection",
 CellID->1608080221,ExpressionUUID->"4bcc2f0b-3803-47a5-a273-267c913437f9"],

Cell["Tech Note", "Categorization",
 CellLabel->"Entity Type",
 CellID->922576852,ExpressionUUID->"7042fe64-a20a-4df0-b785-6652247a506d"],

Cell["QuantumPlaybook", "Categorization",
 CellLabel->"Paclet Name",
 CellID->917220224,ExpressionUUID->"7d3318b9-96ff-4672-9279-2d497b142241"],

Cell["QuantumPlaybook`", "Categorization",
 CellLabel->"Context",
 CellID->1082686602,ExpressionUUID->"eac397f4-c0a9-49ea-82f6-95a2a469affc"],

Cell["QuantumPlaybook/tutorial/EntanglementDistillation", "Categorization",
 CellLabel->"URI",
 CellID->1084778783,ExpressionUUID->"b41aae16-508d-44a5-a776-9cce7caec9ed"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Keywords", "KeywordsSection",
 CellID->1888326498,ExpressionUUID->"d28114cb-8478-4213-958b-143ebb77ea6c"],

Cell["quantum entanglement", "Keywords",
 CellChangeTimes->{{3.875246350297999*^9, 3.8752463543099833`*^9}},
 CellID->4154011,ExpressionUUID->"9488c803-aa06-40d8-b014-f2609e6c78ad"],

Cell["entanglement distillation", "Keywords",
 CellChangeTimes->{{3.876912562625557*^9, 3.876912566734517*^9}},
 CellID->1392519909,ExpressionUUID->"6a99109c-d29d-49be-9877-82780997f883"],

Cell["entanglement purification", "Keywords",
 CellChangeTimes->{{3.876912567758479*^9, 3.876912571557537*^9}},
 CellID->1876418771,ExpressionUUID->"e6e9998e-9aa5-4c1c-9cff-87f8e038000d"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{748, 891},
WindowMargins->{{259, Automatic}, {Automatic, 0}},
TaggingRules-><|"Paclet" -> "QuantumPlaybook"|>,
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (January 30, 2023)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "TechNotePageStylesExt.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"cb945e51-4e0d-41af-baba-19ef7134ea36"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 118, 1, 114, "Title",ExpressionUUID->"e3335ae1-3816-4b0a-ac1a-259ca89dd70f",
 CellID->1980526771],
Cell[701, 25, 625, 16, 27, "Text",ExpressionUUID->"60fe75fc-9244-469e-9e07-e8b1d661bdfd",
 CellID->1308734266],
Cell[1329, 43, 476, 12, 44, "Text",ExpressionUUID->"1c91212a-cb27-4a49-a2e0-caaf7a40a765",
 CellID->444601366],
Cell[1808, 57, 921, 22, 104, "DefinitionBox",ExpressionUUID->"36dce4c0-3b60-4b8b-bb7a-648a7d616204",
 CellID->1410604422],
Cell[2732, 81, 195, 2, 30, "Caption",ExpressionUUID->"03c06594-0719-45e4-bd4f-139b405618da",
 CellID->1956541321],
Cell[CellGroupData[{
Cell[2952, 87, 193, 2, 41, "MathCaption",ExpressionUUID->"e626cdff-edee-405c-9619-fd3186ec257b",
 CellID->1329022598],
Cell[3148, 91, 145, 3, 27, "Input",ExpressionUUID->"5c3cdfba-d3e5-4be2-8be5-e654424db65f",
 CellID->172539488]
}, Open  ]],
Cell[CellGroupData[{
Cell[3330, 99, 349, 6, 58, "MathCaption",ExpressionUUID->"f8b90b09-75fd-41d3-b787-db4ae55bcfa2",
 CellID->1573161274],
Cell[3682, 107, 202, 4, 27, "Input",ExpressionUUID->"26dfcfe6-26c0-4548-a0c2-ae2be1681d41",
 CellID->768251366]
}, Open  ]],
Cell[CellGroupData[{
Cell[3921, 116, 321, 8, 41, "MathCaption",ExpressionUUID->"0f4181d3-092f-4fd3-ace1-f7e04b7ffa73",
 CellID->1676761233],
Cell[4245, 126, 638, 17, 85, "Input",ExpressionUUID->"f194e1a4-d4f1-4185-adf5-f329e1d25e04",
 CellID->363452503]
}, Open  ]],
Cell[CellGroupData[{
Cell[4920, 148, 348, 8, 41, "MathCaption",ExpressionUUID->"269f75b3-05f0-4f3b-8f4a-0877703dd84e",
 CellID->1432690958],
Cell[5271, 158, 531, 15, 47, "Input",ExpressionUUID->"d399fc7a-8f68-41b8-890c-1914542401c6",
 CellID->1164469075]
}, Open  ]],
Cell[CellGroupData[{
Cell[5839, 178, 195, 2, 45, "Section",ExpressionUUID->"67eace02-e406-44a8-ac18-deb8074e746b",
 CellID->9608243],
Cell[CellGroupData[{
Cell[6059, 184, 176, 2, 42, "Subsection",ExpressionUUID->"58b778a6-05e8-4fc3-9347-97575fdfbaec",
 CellID->895983480],
Cell[6238, 188, 258, 5, 25, "Text",ExpressionUUID->"ee0d4f6b-5310-42de-a349-486686a0f204",
 CellID->963914888],
Cell[CellGroupData[{
Cell[6521, 197, 450, 8, 58, "MathCaption",ExpressionUUID->"4455ccba-7011-4cdd-a3c0-3de7d5557c44",
 CellID->1326468628],
Cell[CellGroupData[{
Cell[6996, 209, 771, 18, 85, "Input",ExpressionUUID->"ff095bbe-fdef-474c-b90c-de4fe7dbf16a",
 CellID->424466576],
Cell[7770, 229, 1892, 44, 46, "Output",ExpressionUUID->"ec3bef3b-8e61-403e-83db-e7545d208033",
 CellID->1048517870]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9711, 279, 633, 19, 41, "MathCaption",ExpressionUUID->"b775cd35-77ca-43a9-8064-bb4eb73e9f22",
 CellID->1200711519],
Cell[CellGroupData[{
Cell[10369, 302, 233, 6, 27, "Input",ExpressionUUID->"c7be65ad-a30d-4db6-bee1-1f860f9a9dd9",
 CellID->1176269506],
Cell[10605, 310, 1395, 37, 41, "Output",ExpressionUUID->"5fd3ed5c-8177-49b7-82e6-de1f065a7ce4",
 CellID->1173514270]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[12049, 353, 249, 4, 41, "MathCaption",ExpressionUUID->"3edfed6c-bf50-4ecd-9084-d10869c27e54",
 CellID->1153639981],
Cell[CellGroupData[{
Cell[12323, 361, 914, 22, 85, "Input",ExpressionUUID->"06706e9a-b84e-4e6f-87c1-7011523ced6e",
 CellID->1509698055],
Cell[13240, 385, 2474, 57, 82, "Output",ExpressionUUID->"a8b1f587-e995-4c96-9ba8-9bdf38f58a7c",
 CellID->1737262035]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[15763, 448, 535, 11, 60, "MathCaption",ExpressionUUID->"70773f4c-3264-40dc-8059-b8b90e1b9b1a",
 CellID->424047388],
Cell[CellGroupData[{
Cell[16323, 463, 342, 7, 47, "Input",ExpressionUUID->"dc12f677-158d-4246-9557-c7893481ec36",
 CellID->2084847387],
Cell[16668, 472, 1829, 49, 41, "Output",ExpressionUUID->"bf97d76e-e968-414b-9b89-4111dfc51628",
 CellID->1217109847]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18546, 527, 282, 5, 58, "MathCaption",ExpressionUUID->"f3934c61-3e97-4ba8-bf03-dfb369a8a3df",
 CellID->1376812949],
Cell[CellGroupData[{
Cell[18853, 536, 781, 19, 47, "Input",ExpressionUUID->"a26928a2-7adf-4dfc-b6af-d1b73235e24d",
 CellID->1003824959],
Cell[19637, 557, 1362, 34, 62, "Output",ExpressionUUID->"12358009-f987-45a8-b9ee-fe4066600fb5",
 CellID->1842251042]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[21060, 598, 181, 2, 42, "Subsection",ExpressionUUID->"5b28959a-a2ff-4e73-bec9-da1693954f99",
 CellID->443447814],
Cell[21244, 602, 927, 25, 63, "Text",ExpressionUUID->"f3d9c9d2-149a-43bc-b609-cd9dd58fef1c",
 CellID->2081747837],
Cell[CellGroupData[{
Cell[22196, 631, 382, 7, 58, "MathCaption",ExpressionUUID->"20301db3-9431-4eb6-80db-fdfe37b269e5",
 CellID->70875601],
Cell[CellGroupData[{
Cell[22603, 642, 1167, 30, 142, "Input",ExpressionUUID->"49597941-f7d9-4a17-a29d-113d9875318c",
 CellID->170713811],
Cell[23773, 674, 7013, 163, 331, "Output",ExpressionUUID->"6832796e-5577-45ee-9873-225e1051ce4e",
 CellID->330621890]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[30835, 843, 325, 6, 41, "MathCaption",ExpressionUUID->"115db23e-3de8-43d4-93b5-3d0b58b21815",
 CellID->1017693123],
Cell[CellGroupData[{
Cell[31185, 853, 417, 10, 47, "Input",ExpressionUUID->"3d9c0a09-4f34-426d-a193-2139db7333ae",
 CellID->1372770070],
Cell[31605, 865, 9241, 257, 263, "Output",ExpressionUUID->"5a2fb2be-7ed6-4ba9-927b-7fe7d5b542cc",
 CellID->1457333493]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[40895, 1128, 974, 24, 44, "Text",ExpressionUUID->"aadce766-e449-4160-83e8-dfd4254d70d8",
 CellID->1171545641],
Cell[41872, 1154, 739, 22, 27, "Input",ExpressionUUID->"70e2f9d9-c8a9-4ec3-b730-fc7f9b5be262",
 CellID->225912086]
}, Open  ]],
Cell[CellGroupData[{
Cell[42648, 1181, 1053, 31, 44, "Text",ExpressionUUID->"2c4b1d54-f870-458a-afbf-8eaad838da15",
 CellID->428998052],
Cell[CellGroupData[{
Cell[43726, 1216, 866, 21, 123, "Input",ExpressionUUID->"f9b6efeb-5191-4ff5-afc2-4239e623f4ea",
 CellID->153341506],
Cell[44595, 1239, 6333, 177, 174, "Output",ExpressionUUID->"8a924f71-713a-4a81-9c93-e5fa7fadac1f",
 CellID->559857069]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[51001, 1424, 122, 1, 45, "Section",ExpressionUUID->"2a853ae2-2058-412a-894e-7d95da384bfb",
 CellID->224262840],
Cell[51126, 1427, 795, 18, 27, "Text",ExpressionUUID->"48fc5445-ae2b-4f18-b082-3fca0c66c976",
 CellID->1184887274],
Cell[CellGroupData[{
Cell[51946, 1449, 395, 10, 43, "MathCaption",ExpressionUUID->"2190b60b-1c08-44ad-91b6-6d3198502349",
 CellID->1611641769],
Cell[CellGroupData[{
Cell[52366, 1463, 264, 6, 27, "Input",ExpressionUUID->"e30d9019-04c2-4dd3-a672-bc7be9efeebf",
 CellID->984885170],
Cell[52633, 1471, 267, 6, 41, "Output",ExpressionUUID->"66463e51-1a29-43e6-9803-4c4bb7bae3c3",
 CellID->65799194]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[52949, 1483, 214, 2, 41, "MathCaption",ExpressionUUID->"080e79ed-ca53-459c-b818-d710af35f15c",
 CellID->145578351],
Cell[53166, 1487, 1506, 39, 161, "Input",ExpressionUUID->"6cc38884-16f5-4c2e-bb3e-51700d3b779e",
 CellID->1429019289]
}, Open  ]],
Cell[CellGroupData[{
Cell[54709, 1531, 515, 11, 43, "MathCaption",ExpressionUUID->"83e8397c-67e1-4283-8dfe-900d952b47a9",
 CellID->2075092591],
Cell[CellGroupData[{
Cell[55249, 1546, 589, 13, 85, "Input",ExpressionUUID->"d5f55e09-e0dd-4c39-ba05-d16295e1b36a",
 CellID->2010699221],
Cell[55841, 1561, 5059, 111, 297, "Output",ExpressionUUID->"2b59c2e9-b093-431f-bb3c-3461198f41e9",
 CellID->1129316502]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[60949, 1678, 221, 4, 25, "Text",ExpressionUUID->"2fdeadd1-433c-4ef3-b77b-9dfeab324f57",
 CellID->325402613],
Cell[61173, 1684, 346, 9, 47, "Input",ExpressionUUID->"0c482a0e-e3b6-4886-a0bd-728c06f40347",
 CellID->1548351429],
Cell[CellGroupData[{
Cell[61544, 1697, 552, 17, 47, "Input",ExpressionUUID->"53394859-0040-40fb-8179-e73fc1c198d7",
 CellID->2083116504],
Cell[62099, 1716, 5513, 160, 360, "Output",ExpressionUUID->"c9d988c4-1d07-408a-8e8e-1afac69015f1",
 CellID->1459609892]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[67661, 1882, 497, 11, 60, "MathCaption",ExpressionUUID->"a9e378e2-6d5a-415c-9f6f-20ddb36eb0f3",
 CellID->1803890242],
Cell[CellGroupData[{
Cell[68183, 1897, 798, 21, 66, "Input",ExpressionUUID->"79ed82a4-2741-41e7-9d18-bd88e99cf41d",
 CellID->817515057],
Cell[68984, 1920, 12821, 284, 513, "Output",ExpressionUUID->"0ef076ca-a14b-44eb-890f-923cd70d1dbe",
 CellID->1947229505]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[81866, 2211, 176, 2, 45, "Section",ExpressionUUID->"0f894b3d-c2fd-4322-867c-318ebbf73e83",
 CellID->797821259],
Cell[82045, 2215, 1735, 39, 88, "Text",ExpressionUUID->"43916a76-a876-4e48-ad11-1940ad29c6b3",
 CellID->695573627],
Cell[83783, 2256, 283, 5, 44, "Text",ExpressionUUID->"33f1b9a2-d4ed-4ee1-8b0b-0b65a7865bde",
 CellID->1699338655],
Cell[84069, 2263, 740, 25, 31, "Text",ExpressionUUID->"be691043-e547-4f15-8e06-076fc92110c8",
 CellID->1399753132],
Cell[84812, 2290, 1328, 43, 75, "Text",ExpressionUUID->"2921f348-905f-443f-acb8-2bd0d40c2538",
 CellID->2115020286],
Cell[86143, 2335, 744, 15, 63, "Text",ExpressionUUID->"13dcc265-2807-410d-b51c-0886469ac26a",
 CellID->1996621658],
Cell[86890, 2352, 1068, 42, 40, "Text",ExpressionUUID->"f6e66ca7-5ad0-448d-9b05-837f2f8b0565",
 CellID->640737984],
Cell[87961, 2396, 574, 13, 44, "Text",ExpressionUUID->"39fb159e-2f1c-4b9d-b3d7-4545e63fee32",
 CellID->1266994926],
Cell[CellGroupData[{
Cell[88560, 2413, 233, 3, 42, "Subsection",ExpressionUUID->"3e29fedb-a31e-47cd-9806-5e721284d533",
 CellID->1145574102],
Cell[CellGroupData[{
Cell[88818, 2420, 254, 5, 41, "MathCaption",ExpressionUUID->"b628ac1d-6b05-4590-bf55-0ea77b2b73eb",
 CellID->920704413],
Cell[CellGroupData[{
Cell[89097, 2429, 270, 6, 47, "Input",ExpressionUUID->"68fbf39b-d569-4d6e-bf37-5129d1f01af0",
 CellID->989436024],
Cell[89370, 2437, 9792, 284, 53, "Output",ExpressionUUID->"eb9d5e07-cfc3-4b71-bd44-ebf196d00fd0",
 CellID->1042200327],
Cell[99165, 2723, 9792, 284, 53, "Output",ExpressionUUID->"40c11361-70a3-4540-a697-d952da4eecd4",
 CellID->1384270957]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[109006, 3013, 509, 12, 41, "MathCaption",ExpressionUUID->"f3616645-327d-4284-9237-a987b918be6a",
 CellID->284257392],
Cell[109518, 3027, 1609, 51, 104, "Input",ExpressionUUID->"c84f116c-1d33-4084-8a4f-47e4eba37184",
 CellID->576306453],
Cell[CellGroupData[{
Cell[111152, 3082, 229, 4, 47, "Input",ExpressionUUID->"9e830136-510d-48d5-aea5-180f42fb4c81",
 CellID->2013079378],
Cell[111384, 3088, 17637, 503, 99, "Output",ExpressionUUID->"2a9eb8b7-1351-4d5a-94dc-35e5d76fcf34",
 CellID->400644739],
Cell[129024, 3593, 17640, 503, 99, "Output",ExpressionUUID->"d93c718f-034b-4de1-bc24-fc1985077b96",
 CellID->1274895028]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[146713, 4102, 550, 14, 41, "MathCaption",ExpressionUUID->"79fbf475-2029-4962-a1a3-a04d211c2587",
 CellID->1601110815],
Cell[147266, 4118, 1205, 38, 85, "Input",ExpressionUUID->"c223bfaa-a713-4f39-add4-bfc4d937e57c",
 CellID->38369270],
Cell[CellGroupData[{
Cell[148496, 4160, 236, 4, 47, "Input",ExpressionUUID->"508366b2-d0f8-4ec3-acb0-71e60eeec672",
 CellID->627226790],
Cell[148735, 4166, 17593, 503, 99, "Output",ExpressionUUID->"0604ec9e-4dcf-4f2a-b7bb-e494e85f0651",
 CellID->1518304752],
Cell[166331, 4671, 17594, 503, 99, "Output",ExpressionUUID->"d8c00705-532f-43b9-a606-441c74f211d3",
 CellID->1747273210]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[183974, 5180, 242, 4, 41, "MathCaption",ExpressionUUID->"ff3cc3dd-de55-4b67-bc2d-c7770b20f6fb",
 CellID->2067394127],
Cell[CellGroupData[{
Cell[184241, 5188, 702, 21, 47, "Input",ExpressionUUID->"adf25153-dba1-4e5a-9980-9ff5af18aa23",
 CellID->1604828370],
Cell[184946, 5211, 41768, 1047, 191, "Output",ExpressionUUID->"d3fbee6c-70a4-47ab-8a61-3aaa3a916021",
 CellID->1218911913],
Cell[226717, 6260, 41770, 1047, 191, "Output",ExpressionUUID->"d5940c59-9cad-460e-b972-b995a5712b9e",
 CellID->1406013058]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[268536, 7313, 290, 5, 58, "MathCaption",ExpressionUUID->"42668ab2-0ce1-4ab3-b5f6-061c7588e921",
 CellID->861429414],
Cell[CellGroupData[{
Cell[268851, 7322, 364, 8, 47, "Input",ExpressionUUID->"777e32d5-3edf-4731-b190-690cd8a34244",
 CellID->1196447817],
Cell[269218, 7332, 2518, 56, 280, "Output",ExpressionUUID->"11d449c4-72af-4927-bafa-3cbf7af43ca5",
 CellID->1548057104],
Cell[271739, 7390, 2520, 56, 280, "Output",ExpressionUUID->"1909bd07-9e5e-4f4a-b4a2-d0c169215c11",
 CellID->1431363523]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[274308, 7452, 214, 2, 41, "MathCaption",ExpressionUUID->"b7f29345-bc7f-4261-910a-ac3bed0a7340",
 CellID->93724021],
Cell[CellGroupData[{
Cell[274547, 7458, 418, 11, 47, "Input",ExpressionUUID->"4f8c63bd-9d60-47e7-b117-79a4a00cc407",
 CellID->428846345],
Cell[274968, 7471, 336, 5, 26, "Output",ExpressionUUID->"dcc3d698-c2d4-4ac8-be12-0bb50d746776",
 CellID->1330432617],
Cell[275307, 7478, 335, 5, 26, "Output",ExpressionUUID->"d13ae8ce-0b4b-471f-85d2-b82c956765a0",
 CellID->981261355]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[275703, 7490, 242, 3, 42, "Subsection",ExpressionUUID->"5b51fd21-1a8e-40db-9ca4-2d97b1505571",
 CellID->1197910904],
Cell[CellGroupData[{
Cell[275970, 7497, 331, 6, 44, "Text",ExpressionUUID->"545d1c56-5920-45a4-8008-f1a397582884",
 CellID->368440934],
Cell[276304, 7505, 602, 11, 123, "Input",ExpressionUUID->"4b958e15-d987-41e0-abc5-b9185f63b5e4",
 CellID->51525796],
Cell[276909, 7518, 419, 9, 66, "Input",ExpressionUUID->"b1a0849a-e0e4-4110-9379-03572ca61286",
 CellID->519669879],
Cell[277331, 7529, 2790, 75, 313, "Input",ExpressionUUID->"764b5ce3-5ce9-42f1-b3be-131a954406db",
 CellID->1699974289]
}, Open  ]],
Cell[CellGroupData[{
Cell[280158, 7609, 478, 10, 58, "MathCaption",ExpressionUUID->"d42139df-0aa3-4a77-b6fe-81442593f640",
 CellID->415624317],
Cell[CellGroupData[{
Cell[280661, 7623, 367, 8, 47, "Input",ExpressionUUID->"9f81e7d2-a5a8-4b80-b0cc-79a435492494",
 CellID->584821147],
Cell[281031, 7633, 2442, 54, 280, "Output",ExpressionUUID->"b3077bb2-e7e9-4816-b8fc-27a0622864c2",
 CellID->1698740896]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[283522, 7693, 224, 3, 41, "MathCaption",ExpressionUUID->"8c5e052e-4a8e-44fb-b73a-ce8d6c784e30",
 CellID->914831718],
Cell[283749, 7698, 521, 15, 47, "Input",ExpressionUUID->"c932492d-99be-41c1-9919-3de001f27796",
 CellID->21183722]
}, Open  ]],
Cell[CellGroupData[{
Cell[284307, 7718, 314, 6, 41, "MathCaption",ExpressionUUID->"8ec11b73-d238-48f9-a270-0f97be90f10e",
 CellID->643016337],
Cell[CellGroupData[{
Cell[284646, 7728, 532, 14, 66, "Input",ExpressionUUID->"04ef3573-49c8-4b84-ae4a-2dd687116721",
 CellID->2108504836],
Cell[285181, 7744, 39441, 1027, 360, "Output",ExpressionUUID->"3eeac8b3-cf12-422c-a377-a985ac153129",
 CellID->222894278]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[324671, 8777, 315, 6, 41, "MathCaption",ExpressionUUID->"f5202df5-afe9-47fa-b064-9a4436567940",
 CellID->608333358],
Cell[CellGroupData[{
Cell[325011, 8787, 530, 14, 66, "Input",ExpressionUUID->"86fd9729-c9a9-4e2b-9a24-819d51c6fe42",
 CellID->2051353892],
Cell[325544, 8803, 39442, 1027, 360, "Output",ExpressionUUID->"18e29e09-5755-4c67-a51a-31dec4af59ee",
 CellID->1446549874]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[365059, 9838, 102, 1, 45, "Section",ExpressionUUID->"543e3914-c7ba-444b-85b0-e367e6251f35",
 CellID->1248933531],
Cell[CellGroupData[{
Cell[365186, 9843, 464, 7, 63, "Text",ExpressionUUID->"c50697db-8ea8-4dae-9698-e81518c8fd9c",
 CellID->1308352194],
Cell[CellGroupData[{
Cell[365675, 9854, 1291, 30, 85, "Input",ExpressionUUID->"bd78c7db-4888-4f7d-9d8d-d3e80a11d1f8",
 CellID->1320689739],
Cell[366969, 9886, 38366, 945, 513, "Output",ExpressionUUID->"a1c0e6ff-0b59-4445-9e5a-7fe096fb07ef",
 CellID->2087595566]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[405384, 10837, 470, 10, 44, "Text",ExpressionUUID->"2c56d7fa-37c4-4ff3-bc38-624540bcf713",
 CellID->196356282],
Cell[405857, 10849, 879, 21, 104, "Input",ExpressionUUID->"8c92cb94-c212-4b23-9574-a551be752d7d",
 CellID->1625149782]
}, Open  ]],
Cell[CellGroupData[{
Cell[406773, 10875, 339, 8, 44, "Text",ExpressionUUID->"27cd6758-4e9a-4ab9-a03a-5d32b41fb8f2",
 CellID->47879881],
Cell[CellGroupData[{
Cell[407137, 10887, 259, 6, 27, "Input",ExpressionUUID->"525db037-2a05-40e8-8608-34b8eac855e0",
 CellID->1558275989],
Cell[407399, 10895, 11580, 317, 78, "Output",ExpressionUUID->"77d98272-a7ac-46f2-9312-62eb6d80d7c0",
 CellID->28373530]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[419028, 11218, 277, 5, 25, "Text",ExpressionUUID->"8a2222a2-dadb-4ac1-918b-a1d277ec715e",
 CellID->1953490389],
Cell[CellGroupData[{
Cell[419330, 11227, 399, 12, 27, "Input",ExpressionUUID->"2dd2b211-3e22-4090-b6e3-470af69d8ed0",
 CellID->1582972587],
Cell[419732, 11241, 1731, 45, 47, "Output",ExpressionUUID->"f9108907-8329-428d-a866-d094ddd81036",
 CellID->1983767978]
}, Open  ]],
Cell[CellGroupData[{
Cell[421500, 11291, 218, 5, 27, "Input",ExpressionUUID->"6432b5d2-2ea7-4af3-844a-27333810bcf5",
 CellID->1686302499],
Cell[421721, 11298, 3441, 92, 41, "Output",ExpressionUUID->"4f999e01-521d-4fa3-8c52-8d5a2dc62821",
 CellID->394271891]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[425211, 11396, 172, 2, 42, "Subsection",ExpressionUUID->"5c2b93ae-be33-40b7-b8ef-ff87a493a2fe",
 CellID->1711953502],
Cell[425386, 11400, 697, 16, 63, "Text",ExpressionUUID->"c7e7b19a-c245-42b9-afc6-94e338438ede",
 CellID->862841207],
Cell[CellGroupData[{
Cell[426108, 11420, 365, 9, 25, "Text",ExpressionUUID->"b4416a65-1b9d-4504-8192-c4e67a1852e6",
 CellID->719303896],
Cell[426476, 11431, 1816, 56, 78, "Output",ExpressionUUID->"7f50fa65-79c4-4207-a529-353b4b07cfaa",
 CellID->2025483658]
}, Open  ]],
Cell[428307, 11490, 184, 4, 25, "Text",ExpressionUUID->"ff58addb-5baa-44ef-bf49-bac6abdf8a72",
 CellID->994499068]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[428540, 11500, 192, 2, 74, "TutorialMoreAboutSection",ExpressionUUID->"8b2ccaf6-8cab-43e2-bdc8-c590499182a0",
 CellID->1812928137],
Cell[428735, 11504, 301, 5, 24, "TutorialMoreAbout",ExpressionUUID->"12953a1e-cd45-4feb-a834-84510cc5a5da",
 CellID->1490297060],
Cell[429039, 11511, 292, 4, 24, "TutorialMoreAbout",ExpressionUUID->"69499c83-e992-4ce4-aa1f-ec742262268b",
 CellID->2008440499],
Cell[429334, 11517, 283, 4, 24, "TutorialMoreAbout",ExpressionUUID->"26794b5e-2316-4a4d-9394-6d966bdc1ad8",
 CellID->1841390299]
}, Open  ]],
Cell[CellGroupData[{
Cell[429654, 11526, 128, 1, 74, "RelatedTutorialsSection",ExpressionUUID->"625ae735-7219-4661-b0d1-8323e57fe844",
 CellID->436993734],
Cell[429785, 11529, 296, 5, 24, "TutorialMoreAbout",ExpressionUUID->"edc9fe84-7d53-4f6b-b973-35f6f6169405",
 CellID->250823754],
Cell[430084, 11536, 313, 6, 24, "RelatedTutorials",ExpressionUUID->"de55eb4d-0b28-4dc4-8ba9-1c4f1884eeb8",
 CellID->159614598],
Cell[430400, 11544, 303, 5, 24, "RelatedTutorials",ExpressionUUID->"61b46736-1ad7-4837-b3c8-62bf16de2d9c",
 CellID->728547302],
Cell[430706, 11551, 309, 5, 24, "RelatedTutorials",ExpressionUUID->"9efb07f7-0154-4339-ad00-5e07c0e254fc",
 CellID->533614654],
Cell[431018, 11558, 356, 6, 24, "RelatedTutorials",ExpressionUUID->"f3d9fc6a-1ff4-4f1e-9add-4d8fdff592b7",
 CellID->756459821],
Cell[431377, 11566, 343, 5, 24, "RelatedTutorials",ExpressionUUID->"a844265d-8753-4a48-b6d2-70c2897cc3d8",
 CellID->2062924057]
}, Open  ]],
Cell[CellGroupData[{
Cell[431757, 11576, 193, 2, 74, "TutorialRelatedLinksSection",ExpressionUUID->"4640f67b-3cfb-43e7-a7d2-c1f8928e1c70",
 CellID->847161968],
Cell[431953, 11580, 447, 9, 24, "TutorialRelatedLinks",ExpressionUUID->"bfef24ae-266b-4952-adb1-3f880d882881",
 CellID->90212659],
Cell[432403, 11591, 597, 13, 42, "TutorialRelatedLinks",ExpressionUUID->"57202c2e-1a2d-491f-b66d-1bc8e6794516",
 CellID->1612042109],
Cell[433003, 11606, 455, 10, 24, "TutorialRelatedLinks",ExpressionUUID->"4740f4eb-d4a7-4547-a903-2b78e4a1ed8f",
 CellID->1997366095]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[433507, 11622, 110, 1, 72, "MetadataSection",ExpressionUUID->"57723b63-0f70-40f9-82e5-a2a920be4c70",
 CellID->435473483],
Cell[433620, 11625, 716, 16, 26, "History",ExpressionUUID->"0d8a6edb-27ca-44bf-9fc9-692d232dda08",
 CellID->675385998],
Cell[CellGroupData[{
Cell[434361, 11645, 123, 1, 21, "CategorizationSection",ExpressionUUID->"4bcc2f0b-3803-47a5-a273-267c913437f9",
 CellID->1608080221],
Cell[434487, 11648, 137, 2, 34, "Categorization",ExpressionUUID->"7042fe64-a20a-4df0-b785-6652247a506d",
 CellID->922576852],
Cell[434627, 11652, 143, 2, 34, "Categorization",ExpressionUUID->"7d3318b9-96ff-4672-9279-2d497b142241",
 CellID->917220224],
Cell[434773, 11656, 141, 2, 34, "Categorization",ExpressionUUID->"eac397f4-c0a9-49ea-82f6-95a2a469affc",
 CellID->1082686602],
Cell[434917, 11660, 170, 2, 34, "Categorization",ExpressionUUID->"b41aae16-508d-44a5-a776-9cce7caec9ed",
 CellID->1084778783]
}, Open  ]],
Cell[CellGroupData[{
Cell[435124, 11667, 111, 1, 31, "KeywordsSection",ExpressionUUID->"d28114cb-8478-4213-958b-143ebb77ea6c",
 CellID->1888326498],
Cell[435238, 11670, 181, 2, 20, "Keywords",ExpressionUUID->"9488c803-aa06-40d8-b014-f2609e6c78ad",
 CellID->4154011],
Cell[435422, 11674, 187, 2, 20, "Keywords",ExpressionUUID->"6a99109c-d29d-49be-9877-82780997f883",
 CellID->1392519909],
Cell[435612, 11678, 187, 2, 20, "Keywords",ExpressionUUID->"e6e9998e-9aa5-4c1c-9cff-87f8e038000d",
 CellID->1876418771]
}, Open  ]]
}, Open  ]]
}
]
*)

