(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    227450,       6355]
NotebookOptionsPosition[    210620,       5982]
NotebookOutlinePosition[    211141,       6000]
CellTagsIndexPosition[    211098,       5997]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Entanglement Distillation: Quantum Circuit", "Title",
 CellID->1980526771,ExpressionUUID->"e3335ae1-3816-4b0a-ac1a-259ca89dd70f"],

Cell[TextData[{
 "See also Section 7.3 of the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Quantum Workbook (Springer, 2022)"]], 
    "https://doi.org/10.1007/978-3-030-91214-7"},
   "WebLink",
   BaseStyle->{"Text"}]],ExpressionUUID->
  "6648762d-56e2-458a-bc38-569401efc123"],
 "."
}], "Text",
 CellChangeTimes->{{3.850949404528584*^9, 3.8509494045768213`*^9}, {
  3.85097300684938*^9, 3.850973008015355*^9}, {3.852926047963835*^9, 
  3.852926050054385*^9}, {3.8752460830525627`*^9, 3.8752460850662327`*^9}},
 TextAlignment->"Right",
 CellID->1308734266,ExpressionUUID->"60fe75fc-9244-469e-9e07-e8b1d661bdfd"],

Cell["\<\
Here, we start with a number of partially entangled pairs and \
\[OpenCurlyDoubleQuote]distills\[CloseCurlyDoubleQuote] a smaller number of \
maximally entangled pairs. This is illustrated in the quantum circuit model.\
\>", "Text",
 CellChangeTimes->{{3.876912516101638*^9, 3.876912528215394*^9}},
 CellID->444601366,ExpressionUUID->"1c91212a-cb27-4a49-a2e0-caaf7a40a765"],

Cell[BoxData[GridBox[{
   {
    ButtonBox["VonNeumannEntropy",
     BaseStyle->"Link",
     ButtonData->"paclet:Q3/ref/VonNeumannEntropy"], Cell[
    "VonNeumann entropy of a mixed state", "TableText",ExpressionUUID->
     "edb04415-527a-488f-bc87-26cf536cd3dc"]},
   {
    ButtonBox["PartialTrace",
     BaseStyle->"Link",
     ButtonData->"paclet:Q3/ref/PartialTrace"], Cell[
    "Partial trace over some subsystems", "TableText",ExpressionUUID->
     "3dfef7b8-445d-4369-abf4-1e0dc9c9556c"]},
   {
    ButtonBox["Dyad",
     BaseStyle->"Link",
     ButtonData->"paclet:Q3/ref/Dyad"], Cell[
    "Dyadic product of two vectors", "TableText",ExpressionUUID->
     "a42dc33d-7165-4ab1-8cfa-bb15b4fa6f2f"]}
  }]], "DefinitionBox",
 CellChangeTimes->{{3.875245913898039*^9, 3.8752459510469427`*^9}, {
  3.875246193969157*^9, 3.875246269439661*^9}},
 CellID->1410604422,ExpressionUUID->"36dce4c0-3b60-4b8b-bb7a-648a7d616204"],

Cell["Functions used in this document.", "Caption",
 CellChangeTimes->{{3.8752461994779053`*^9, 3.875246209864244*^9}},
 CellID->1956541321,ExpressionUUID->"03c06594-0719-45e4-bd4f-139b405618da"],

Cell[CellGroupData[{

Cell["Make sure that Q3 is loaded.", "MathCaption",
 CellChangeTimes->{{3.876912626253722*^9, 3.876912634327948*^9}},
 CellID->1329022598,ExpressionUUID->"e626cdff-edee-405c-9619-fd3186ec257b"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[205]:=",
 CellID->172539488,ExpressionUUID->"5c3cdfba-d3e5-4be2-8be5-e654424db65f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
We have two parties Alice (A) and Bob (B). Teddy (T)  is an ancillary \
register to perform a measurement of the total Pauli Z.\
\>", "MathCaption",
 CellChangeTimes->{{3.876912645026947*^9, 3.876912699130384*^9}, {
  3.876912901870419*^9, 3.876912940895978*^9}},
 CellID->1573161274,ExpressionUUID->"f8b90b09-75fd-41d3-b787-db4ae55bcfa2"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "A", ",", "B", ",", "T"}], "]"}]], "Input",
 CellLabel->"In[206]:=",
 CellID->768251366,ExpressionUUID->"26dfcfe6-26c0-4548-a0c2-ae2be1681d41"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "We will start with ",
 StyleBox["n",
  FontSlant->"Italic"],
 " partially entangled pairs."
}], "MathCaption",
 CellChangeTimes->{{3.876913066708404*^9, 3.876913078504644*^9}, {
  3.8769131176279287`*^9, 3.876913118233914*^9}},
 CellID->1676761233,ExpressionUUID->"0f4181d3-092f-4fd3-ace1-f7e04b7ffa73"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kk", "=", 
   RowBox[{"Range", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AA", "=", 
   RowBox[{"A", "[", 
    RowBox[{"kk", ",", "None"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BB", "=", 
   RowBox[{"B", "[", 
    RowBox[{"kk", ",", "None"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.87691295413769*^9, 3.8769129562909327`*^9}},
 CellLabel->"In[207]:=",
 CellID->363452503,ExpressionUUID->"f194e1a4-d4f1-4185-adf5-f329e1d25e04"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "You need fewer qubits for T, just enough to store the maximum number ",
 StyleBox["n",
  FontSlant->"Italic"],
 ". "
}], "MathCaption",
 CellChangeTimes->{{3.87691297630866*^9, 3.876913055055799*^9}},
 CellID->1432690958,ExpressionUUID->"269f75b3-05f0-4f3b-8f4a-0877703dd84e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ln", "=", 
   RowBox[{"Ceiling", "@", 
    RowBox[{"Log", "[", 
     RowBox[{"2", ",", 
      RowBox[{"$n", "+", "1"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TT", "=", 
   RowBox[{"T", "[", 
    RowBox[{
     RowBox[{"Range", "@", "ln"}], ",", "None"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.87691295413769*^9, 3.876912957430442*^9}},
 CellLabel->"In[211]:=",
 CellID->1164469075,ExpressionUUID->"d399fc7a-8f68-41b8-890c-1914542401c6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["To Generate Partially Entangled Pairs", "Section",
 CellChangeTimes->{{3.876913131574313*^9, 3.876913138423706*^9}},
 CellID->9608243,ExpressionUUID->"67eace02-e406-44a8-ac18-deb8074e746b"],

Cell[CellGroupData[{

Cell["\<\
First construct a superposition with different amplitudes for the two \
computational basis states.\
\>", "MathCaption",
 CellChangeTimes->{{3.87691319054813*^9, 3.876913249867708*^9}},
 CellID->1326468628,ExpressionUUID->"4455ccba-7011-4cdd-a3c0-3de7d5557c44"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Phi]", "=", 
   RowBox[{"2", "*", 
    RowBox[{"Pi", "/", "3"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"A", "[", "1", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Rotation", "[", 
     RowBox[{"\[Phi]", ",", 
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "2"}], "]"}]}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.878643894488801*^9, 3.878643896179913*^9}, {
  3.878643959109674*^9, 3.8786439820817213`*^9}},
 CellLabel->"In[213]:=",
 CellID->424466576,ExpressionUUID->"ff095bbe-fdef-474c-b90c-de4fe7dbf16a"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, LineBox[{{{0, -1}, {2, -1}}}], 
   InsetBox[
    StyleBox[
     TemplateBox[{"0"},
      "Ket"],
     StripOnInput->False,
     FontSize->Scaled[0.16000000000000003`],
     FontWeight->"Light"], {-0.1, -1}, NCache[
    ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], {
    {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
    LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
     0.6, -1.4}}], InsetBox[
     StyleBox[
      SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
      StripOnInput->False,
      FontSize->Scaled[0.2],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
  ImageSize->118.8,
  PlotRange->NCache[{Full, {
      Rational[-3, 2], 
      Rational[-1, 2]}}, {Full, {-1.5, -0.5}}],
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.876913140801437*^9, 3.8769131798396683`*^9}, 
   3.8769132520638514`*^9, 3.8786407577396507`*^9, 3.878642294850952*^9, 
   3.878643344052194*^9, 3.8786438975737133`*^9, {3.8786439533414907`*^9, 
   3.878643983037034*^9}, 3.879074907009501*^9},
 CellLabel->"Out[214]=",
 CellID->2048936959,ExpressionUUID->"daf155d9-f25c-483a-af19-e44bc2715a1b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Elaborate", "[", "qc", "]"}], "//", "ExpandAll"}], "//", 
  "LogicalForm"}]], "Input",
 CellLabel->"In[215]:=",
 CellID->1176269506,ExpressionUUID->"c7be65ad-a30d-4db6-bee1-1f860f9a9dd9"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], "2"], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SqrtBox["3"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{{3.8769131688566933`*^9, 3.876913180501377*^9}, 
   3.8769132528407*^9, 3.8786407586495447`*^9, 3.878642295499794*^9, 
   3.878643898613244*^9, 3.87864398562213*^9, 3.8790749077595043`*^9},
 CellLabel->"Out[215]=",
 CellID->597260369,ExpressionUUID->"2a71bf32-f073-4f31-a112-db69c8bac3fd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Then, by applying the CNOT gate, you can create a partially entangled pair.\
\>", "MathCaption",
 CellChangeTimes->{{3.8769133051661263`*^9, 3.87691332837848*^9}},
 CellID->1153639981,ExpressionUUID->"3edfed6c-bf50-4ecd-9084-d10869c27e54"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"A", "[", "1", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Rotation", "[", 
     RowBox[{"\[Phi]", ",", 
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "2"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ",", 
      RowBox[{"B", "[", "1", "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.876913342721538*^9, 3.876913349385829*^9}, {
  3.878643814462079*^9, 3.87864382900854*^9}, {3.8786439908667927`*^9, 
  3.878643991075796*^9}},
 CellLabel->"In[216]:=",
 CellID->1509698055,ExpressionUUID->"06706e9a-b84e-4e6f-87c1-7011523ced6e"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], InsetBox[
    StyleBox[
     TemplateBox[{"0"},
      "Ket"],
     StripOnInput->False,
     FontSize->Scaled[0.10666666666666667`],
     FontWeight->"Light"], {-0.1, -1}, NCache[
    ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], {
    {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
    LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
     0.6, -1.4}}], InsetBox[
     StyleBox[
      SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
  ImageSize->154.79999999999998`,
  PlotRange->NCache[{Full, {
      Rational[-5, 2], 
      Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{
  3.8769133498441896`*^9, 3.8786407596817837`*^9, 3.878642296644698*^9, 
   3.878643347417542*^9, {3.878643815871079*^9, 3.878643829491767*^9}, 
   3.878643991595294*^9, 3.879074908835929*^9},
 CellLabel->"Out[216]=",
 CellID->22223753,ExpressionUUID->"96419a10-6a47-403a-b029-c109eee0300e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Elaborate", "[", "qc", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", "out", "]"}]}], "Input",
 CellChangeTimes->{{3.876913353301922*^9, 3.876913361197649*^9}},
 CellLabel->"In[217]:=",
 CellID->2084847387,ExpressionUUID->"dc12f677-158d-4246-9557-c7893481ec36"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SqrtBox["3"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{{3.8769133614994*^9, 3.8769133646660337`*^9}, 
   3.878640760463359*^9, 3.878642298045225*^9, 3.8786433492266703`*^9, {
   3.8786438170793962`*^9, 3.8786438306077347`*^9}, 3.878643994925807*^9, 
   3.879074910158477*^9},
 CellLabel->"Out[218]=",
 CellID->1998728603,ExpressionUUID->"720d8840-32cf-4e49-bc1a-ca01ea4bec26"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Examine the reduced density matrix for the first qubit to check that the \
above state is partial entangled.\
\>", "MathCaption",
 CellChangeTimes->{{3.8786408412853193`*^9, 3.87864088124024*^9}},
 CellID->1376812949,ExpressionUUID->"f3934c61-3e97-4ba8-bf03-dfb369a8a3df"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rho", "=", 
   RowBox[{"PartialTrace", "[", 
    RowBox[{"out", ",", 
     RowBox[{"B", "[", "1", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Matrix", "[", "rho", "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8786407734333897`*^9, 3.8786408314509993`*^9}},
 CellLabel->"In[219]:=",
 CellID->1003824959,ExpressionUUID->"a26928a2-7adf-4dfc-b6af-d1b73235e24d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "4"], "0"},
     {"0", 
      FractionBox["3", "4"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 1, 2}, {{1}, {2}}}, {
      Rational[1, 4], Rational[3, 4]}}]]]]], "Output",
 CellChangeTimes->{{3.8786407932773743`*^9, 3.878640831693551*^9}, 
   3.878640883437249*^9, 3.878643997594508*^9, 3.879074911446179*^9},
 CellLabel->"Out[220]//MatrixForm=",
 CellID->1264662883,ExpressionUUID->"a8c20272-05f6-469a-8f4f-ce9e22ad23b6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Repeating the above procedure for other pairs, generate as many partially \
entangled pairs as  you like. In this particular example, we prepare four \
pairs.\
\>", "MathCaption",
 CellChangeTimes->{{3.8769133722392273`*^9, 3.8769134369362707`*^9}, {
  3.878640907368731*^9, 3.878640908865217*^9}},
 CellID->70875601,ExpressionUUID->"20301db3-9431-4eb6-80db-fdfe37b269e5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc0", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", "AA"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", "BB"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Rotation", "[", 
     RowBox[{"\[Phi]", ",", 
      RowBox[{"A", "[", 
       RowBox[{"kk", ",", "2"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"Thread", "@", 
      RowBox[{"CNOT", "[", 
       RowBox[{"AA", ",", "BB"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"A", "[", 
      RowBox[{"$n", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.878644005434927*^9, 3.878644008118101*^9}},
 CellLabel->"In[221]:=",
 CellID->170713811,ExpressionUUID->"49597941-f7d9-4a17-a29d-113d9875318c"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}, {{
    0, -4}, {6, -4}}, {{0, -6}, {6, -6}}, {{0, -7}, {6, -7}}, {{0, -8}, {
    6, -8}}, {{0, -9}, {6, -9}}}], {{InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.05333333333333334],
       FontWeight->"Light"], {-0.1, -1}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.05333333333333334],
       FontWeight->"Light"], {-0.1, -2}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.05333333333333334],
       FontWeight->"Light"], {-0.1, -3}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.05333333333333334],
       FontWeight->"Light"], {-0.1, -4}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.05333333333333334],
       FontWeight->"Light"], {-0.1, -6}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.05333333333333334],
       FontWeight->"Light"], {-0.1, -7}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.05333333333333334],
       FontWeight->"Light"], {-0.1, -8}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.05333333333333334],
       FontWeight->"Light"], {-0.1, -9}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}}, {{
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, 
     LineBox[{{0.6, -3.4}, {1.4, -3.4}, {1.4, -2.6}, {0.6, -2.6}, {
      0.6, -3.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, 
     LineBox[{{0.6, -4.4}, {1.4, -4.4}, {1.4, -3.6}, {0.6, -3.6}, {
      0.6, -4.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}}, {
    LineBox[{{2, -1}, {2, -2}, {2, -3}, {2, -4}, {2, -6}}], 
    DiskBox[{2, -1}, 0.09], DiskBox[{2, -2}, 0.09], DiskBox[{2, -3}, 0.09], 
    DiskBox[{2, -4}, 0.09], {CircleBox[{2, -6}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -6}, {2.2666666666666666`, -6}}, {{
        2, -6.266666666666667}, {2, -5.733333333333333}}}]}}, {
    LineBox[{{3, -1}, {3, -2}, {3, -3}, {3, -4}, {3, -7}}], 
    DiskBox[{3, -1}, 0.09], DiskBox[{3, -2}, 0.09], DiskBox[{3, -3}, 0.09], 
    DiskBox[{3, -4}, 0.09], {CircleBox[{3, -7}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -7}, {3.2666666666666666`, -7}}, {{
        3, -7.266666666666667}, {3, -6.733333333333333}}}]}}, {
    LineBox[{{4, -1}, {4, -2}, {4, -3}, {4, -4}, {4, -8}}], 
    DiskBox[{4, -1}, 0.09], DiskBox[{4, -2}, 0.09], DiskBox[{4, -3}, 0.09], 
    DiskBox[{4, -4}, 0.09], {CircleBox[{4, -8}, 0.26666666666666666], 
     LineBox[{{{3.7333333333333334`, -8}, {4.266666666666667, -8}}, {{
        4, -8.266666666666667}, {4, -7.733333333333333}}}]}}, {
    LineBox[{{5, -1}, {5, -2}, {5, -3}, {5, -4}, {5, -9}}], 
    DiskBox[{5, -1}, 0.09], DiskBox[{5, -2}, 0.09], DiskBox[{5, -3}, 0.09], 
    DiskBox[{5, -4}, 0.09], {CircleBox[{5, -9}, 0.26666666666666666], 
     LineBox[{{{4.733333333333333, -9}, {5.266666666666667, -9}}, {{
        5, -9.266666666666667}, {5, -8.733333333333333}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
  ImageSize->262.8,
  PlotRange->NCache[{Full, {
      Rational[-19, 2], 
      Rational[-1, 2]}}, {Full, {-9.5, -0.5}}],
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.87691343168961*^9, 3.876913439112975*^9}, 
   3.878640960402698*^9, 3.8786423022000237`*^9, 3.878643354022149*^9, 
   3.8786440086508512`*^9, 3.8790749128874397`*^9},
 CellLabel->"Out[221]=",
 CellID->2050449746,ExpressionUUID->"e08aa2dc-cedb-41a7-843b-13c393ee55b2"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Measurement of Total Pauli Z", "Section",
 CellID->224262840,ExpressionUUID->"2a853ae2-2058-412a-894e-7d95da384bfb"],

Cell[CellGroupData[{

Cell[TextData[{
 "We need to measure ",
 Cell[BoxData[Cell[TextData[Cell[BoxData[
   FormBox[
    RowBox[{
     SubscriptBox["Z", "tot"], ":=", 
     RowBox[{
      SubscriptBox["Z", "1"], "+", 
      SubscriptBox["Z", "2"], "+", "\[Ellipsis]", "+", 
      SubscriptBox["Z", "n"]}]}], TraditionalForm]],ExpressionUUID->
   "7bbcced6-851c-44a9-9be8-484a27dc4540"]],ExpressionUUID->
   "69787956-9626-4928-a81f-683e7deac14b"]],ExpressionUUID->
  "83d30246-6808-479b-a079-93c3675b04f1"],
 "on Bob's (or, equivalently, Alice's) qubits."
}], "Text",
 CellChangeTimes->{{3.876913449951779*^9, 3.876913455682701*^9}, {
  3.876913504724951*^9, 3.8769135283212643`*^9}},
 CellID->1184887274,ExpressionUUID->"48fc5445-ae2b-4f18-b082-3fca0c66c976"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bundle", "[", "]"}], ":=", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"bundle", "[", "p", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", "$n"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bundle", "[", "p_", "]"}], ":=", 
  RowBox[{"With", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"logp", "=", 
      RowBox[{"Ceiling", "@", 
       RowBox[{"Log", "[", 
        RowBox[{"2", ",", 
         RowBox[{"p", "+", "1"}]}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CNOT", "[", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{
          RowBox[{"T", "@", 
           RowBox[{"Range", "[", 
            RowBox[{"k", "-", "1"}], "]"}]}], ",", 
          RowBox[{"B", "[", "p", "]"}]}], "]"}], ",", 
        RowBox[{"T", "[", "k", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"k", ",", "logp", ",", "1", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->"In[222]:=",
 CellID->351751395,ExpressionUUID->"63d691f4-2331-4cc2-b31d-46d27df0de25"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The value of ",
 Cell[BoxData[Cell[TextData[Cell[BoxData[
   FormBox[
    SubscriptBox["Z", "tot"], TraditionalForm]],ExpressionUUID->
   "8e95616a-a134-4201-96bb-ec4c490eab26"]],ExpressionUUID->
   "7410e034-03a5-456f-85a8-e2c04028fdaf"]],ExpressionUUID->
  "516334db-a950-41ea-8345-2cd7700a78c6"],
 " is stored on Teddy's register."
}], "MathCaption",
 CellChangeTimes->{{3.876913556837555*^9, 3.8769136287401648`*^9}},
 CellID->2075092591,ExpressionUUID->"83e8397c-67e1-4283-8dfe-900d952b47a9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", "TT"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"bundle", "[", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"B", "[", 
      RowBox[{"$n", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellLabel->"In[224]:=",
 CellID->2010699221,ExpressionUUID->"d5f55e09-e0dd-4c39-ba05-d16295e1b36a"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {9, -1}}, {{0, -2}, {9, -2}}, {{0, -3}, {9, -3}}, {{
    0, -4}, {9, -4}}, {{0, -6}, {9, -6}}, {{0, -7}, {9, -7}}, {{0, -8}, {
    9, -8}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.035555555555555556`],
      FontWeight->"Light"], {-0.1, -6}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.035555555555555556`],
      FontWeight->"Light"], {-0.1, -7}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.035555555555555556`],
      FontWeight->"Light"], {-0.1, -8}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {
    LineBox[{{1, -1}, {1, -6}}], 
    DiskBox[{1, -1}, 0.09], {CircleBox[{1, -6}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -6}, {1.2666666666666666`, -6}}, {{
        1, -6.266666666666667}, {1, -5.733333333333333}}}]}}, {
    LineBox[{{2, -2}, {2, -6}, {2, -7}}], DiskBox[{2, -2}, 0.09], 
    DiskBox[{2, -6}, 0.09], {CircleBox[{2, -7}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -7}, {2.2666666666666666`, -7}}, {{
        2, -7.266666666666667}, {2, -6.733333333333333}}}]}}, {
    LineBox[{{3, -2}, {3, -6}}], 
    DiskBox[{3, -2}, 0.09], {CircleBox[{3, -6}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -6}, {3.2666666666666666`, -6}}, {{
        3, -6.266666666666667}, {3, -5.733333333333333}}}]}}, {
    LineBox[{{4, -3}, {4, -6}, {4, -7}}], DiskBox[{4, -3}, 0.09], 
    DiskBox[{4, -6}, 0.09], {CircleBox[{4, -7}, 0.26666666666666666], 
     LineBox[{{{3.7333333333333334`, -7}, {4.266666666666667, -7}}, {{
        4, -7.266666666666667}, {4, -6.733333333333333}}}]}}, {
    LineBox[{{5, -3}, {5, -6}}], 
    DiskBox[{5, -3}, 0.09], {CircleBox[{5, -6}, 0.26666666666666666], 
     LineBox[{{{4.733333333333333, -6}, {5.266666666666667, -6}}, {{
        5, -6.266666666666667}, {5, -5.733333333333333}}}]}}, {
    LineBox[{{6, -4}, {6, -6}, {6, -7}, {6, -8}}], DiskBox[{6, -4}, 0.09], 
    DiskBox[{6, -6}, 0.09], 
    DiskBox[{6, -7}, 0.09], {CircleBox[{6, -8}, 0.26666666666666666], 
     LineBox[{{{5.733333333333333, -8}, {6.266666666666667, -8}}, {{
        6, -8.266666666666667}, {6, -7.733333333333333}}}]}}, {
    LineBox[{{7, -4}, {7, -6}, {7, -7}}], DiskBox[{7, -4}, 0.09], 
    DiskBox[{7, -6}, 0.09], {CircleBox[{7, -7}, 0.26666666666666666], 
     LineBox[{{{6.733333333333333, -7}, {7.266666666666667, -7}}, {{
        7, -7.266666666666667}, {7, -6.733333333333333}}}]}}, {
    LineBox[{{8, -4}, {8, -6}}], 
    DiskBox[{8, -4}, 0.09], {CircleBox[{8, -6}, 0.26666666666666666], 
     LineBox[{{{7.733333333333333, -6}, {8.266666666666667, -6}}, {{
        8, -6.266666666666667}, {8, -5.733333333333333}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
  ImageSize->370.8,
  PlotRange->NCache[{Full, {
      Rational[-17, 2], 
      Rational[-1, 2]}}, {Full, {-8.5, -0.5}}],
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{
  3.876913542454103*^9, {3.876913630152197*^9, 3.876913643892964*^9}, 
   3.8786409468970757`*^9, 3.878642305537879*^9, 3.878643358392415*^9, 
   3.878644019090724*^9, 3.879074916850519*^9},
 CellLabel->"Out[224]=",
 CellID->1601417385,ExpressionUUID->"f6f40875-3106-4a39-a096-19a86de51ee5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Let us check that the above quantum circuit indeed gives the sum of the bit \
values of the Bob\[CloseCurlyQuote]s qubits.\
\>", "Text",
 CellID->325402613,ExpressionUUID->"2fdeadd1-433c-4ef3-b77b-9dfeab324f57"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", "BB", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qc1", "**", "in"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.8769136475299664`*^9},
 CellLabel->"In[225]:=",
 CellID->1548351429,ExpressionUUID->"0c482a0e-e3b6-4886-a0bd-728c06f40347"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sum", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"FromDigits", "[", 
      RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", 
    RowBox[{"Reverse", "/@", 
     RowBox[{"Through", "[", 
      RowBox[{"out", "[", "TT", "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"SimpleForm", "[", "in", "]"}], "->", "sum"}], "]"}], "//", 
  "TableForm"}]}], "Input",
 CellLabel->"In[227]:=",
 CellID->2083116504,ExpressionUUID->"53394859-0040-40fb-8179-e73fc1c198d7"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"0", "0", "0", "0"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "0"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"0", "0", "0", "1"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "1"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"0", "0", "1", "0"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "1"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"0", "0", "1", "1"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "2"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"0", "1", "0", "0"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "1"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"0", "1", "0", "1"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "2"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"0", "1", "1", "0"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "2"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"0", "1", "1", "1"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "3"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"1", "0", "0", "0"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "1"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"1", "0", "0", "1"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "2"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"1", "0", "1", "0"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "2"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"1", "0", "1", "1"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "3"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"1", "1", "0", "0"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "2"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"1", "1", "0", "1"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "3"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"1", "1", "1", "0"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "3"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"1", "1", "1", "1"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "4"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.876913636697982*^9, 3.876913649601081*^9}, 
   3.8786409503132257`*^9, 3.8786423109123297`*^9, 3.878643362200212*^9, 
   3.878644022810253*^9, 3.8790749191744833`*^9},
 CellLabel->"Out[228]//TableForm=",
 CellID->1281799323,ExpressionUUID->"7fcb9d78-26c6-4add-b51f-729ca5f67a39"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "In actual situation, one must perform the measurement on Teddy's register \
in the computational basis. The measurement outcome refers to the value of ",
 Cell[BoxData[
  SubscriptBox[
   StyleBox["Z",
    FontSlant->"Italic"], "tot"]], "InlineFormula",ExpressionUUID->
  "e5d11078-7437-4a42-aacf-d2a38b562134"],
 "."
}], "MathCaption",
 CellChangeTimes->{{3.87691366594163*^9, 3.8769137506548767`*^9}},
 CellID->1803890242,ExpressionUUID->"a9e378e2-6d5a-415c-9f6f-20ddb36eb0f3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"$n", "+", 
         RowBox[{"1", "/", "2"}]}], "]"}], ",", 
       RowBox[{"B", "[", 
        RowBox[{"$n", "+", 
         RowBox[{"1", "/", "2"}]}], "]"}], ",", 
       RowBox[{"T", "[", "5", "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
    "qc0", ",", "\"\<Separator\>\"", ",", "qc1", ",", "\"\<Spacer\>\"", ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"T", "[", 
      RowBox[{
       RowBox[{"Range", "@", "ln"}], ",", "3"}], "]"}], "]"}]}], 
   "]"}]}]], "Input",
 CellLabel->"In[229]:=",
 CellID->817515057,ExpressionUUID->"79ed82a4-2741-41e7-9d18-bd88e99cf41d"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{16, -11}, {17, -11}}, {{16, -12}, {17, -12}}, {{16, -13}, {
     17, -13}}}]}, 
   LineBox[{{{0, -1}, {17, -1}}, {{0, -2}, {17, -2}}, {{0, -3}, {17, -3}}, {{
    0, -4}, {17, -4}}, {{0, -6}, {17, -6}}, {{0, -7}, {17, -7}}, {{0, -8}, {
    17, -8}}, {{0, -9}, {17, -9}}, {{0, -11}, {16, -11}}, {{0, -12}, {
    16, -12}}, {{0, -13}, {16, -13}}}], {{InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.018823529411764708`],
       FontWeight->"Light"], {-0.1, -11}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.018823529411764708`],
       FontWeight->"Light"], {-0.1, -12}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.018823529411764708`],
       FontWeight->"Light"], {-0.1, -13}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.018823529411764708`],
       FontWeight->"Light"], {-0.1, -1}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.018823529411764708`],
       FontWeight->"Light"], {-0.1, -2}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.018823529411764708`],
       FontWeight->"Light"], {-0.1, -3}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.018823529411764708`],
       FontWeight->"Light"], {-0.1, -4}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.018823529411764708`],
       FontWeight->"Light"], {-0.1, -6}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.018823529411764708`],
       FontWeight->"Light"], {-0.1, -7}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.018823529411764708`],
       FontWeight->"Light"], {-0.1, -8}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.018823529411764708`],
       FontWeight->"Light"], {-0.1, -9}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}}, {{
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, 
     LineBox[{{0.6, -3.4}, {1.4, -3.4}, {1.4, -2.6}, {0.6, -2.6}, {
      0.6, -3.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, 
     LineBox[{{0.6, -4.4}, {1.4, -4.4}, {1.4, -3.6}, {0.6, -3.6}, {
      0.6, -4.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}}, {
    LineBox[{{2, -1}, {2, -2}, {2, -3}, {2, -4}, {2, -6}}], 
    DiskBox[{2, -1}, 0.09], DiskBox[{2, -2}, 0.09], DiskBox[{2, -3}, 0.09], 
    DiskBox[{2, -4}, 0.09], {CircleBox[{2, -6}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -6}, {2.2666666666666666`, -6}}, {{
        2, -6.266666666666667}, {2, -5.733333333333333}}}]}}, {
    LineBox[{{3, -1}, {3, -2}, {3, -3}, {3, -4}, {3, -7}}], 
    DiskBox[{3, -1}, 0.09], DiskBox[{3, -2}, 0.09], DiskBox[{3, -3}, 0.09], 
    DiskBox[{3, -4}, 0.09], {CircleBox[{3, -7}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -7}, {3.2666666666666666`, -7}}, {{
        3, -7.266666666666667}, {3, -6.733333333333333}}}]}}, {
    LineBox[{{4, -1}, {4, -2}, {4, -3}, {4, -4}, {4, -8}}], 
    DiskBox[{4, -1}, 0.09], DiskBox[{4, -2}, 0.09], DiskBox[{4, -3}, 0.09], 
    DiskBox[{4, -4}, 0.09], {CircleBox[{4, -8}, 0.26666666666666666], 
     LineBox[{{{3.7333333333333334`, -8}, {4.266666666666667, -8}}, {{
        4, -8.266666666666667}, {4, -7.733333333333333}}}]}}, {
    LineBox[{{5, -1}, {5, -2}, {5, -3}, {5, -4}, {5, -9}}], 
    DiskBox[{5, -1}, 0.09], DiskBox[{5, -2}, 0.09], DiskBox[{5, -3}, 0.09], 
    DiskBox[{5, -4}, 0.09], {CircleBox[{5, -9}, 0.26666666666666666], 
     LineBox[{{{4.733333333333333, -9}, {5.266666666666667, -9}}, {{
        5, -9.266666666666667}, {5, -8.733333333333333}}}]}}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{6, Rational[-29, 2]}, {6, Rational[-1, 2]}}, {{
       6, -14.5}, {6, -0.5}}]]}, {LineBox[{{7, -6}, {7, -11}}], 
    DiskBox[{7, -6}, 0.09], {CircleBox[{7, -11}, 0.26666666666666666], 
     LineBox[{{{6.733333333333333, -11}, {7.266666666666667, -11}}, {{
        7, -11.266666666666667`}, {7, -10.733333333333333`}}}]}}, {
    LineBox[{{8, -7}, {8, -11}, {8, -12}}], DiskBox[{8, -7}, 0.09], 
    DiskBox[{8, -11}, 0.09], {CircleBox[{8, -12}, 0.26666666666666666], 
     LineBox[{{{7.733333333333333, -12}, {8.266666666666667, -12}}, {{
        8, -12.266666666666667`}, {8, -11.733333333333333`}}}]}}, {
    LineBox[{{9, -7}, {9, -11}}], 
    DiskBox[{9, -7}, 0.09], {CircleBox[{9, -11}, 0.26666666666666666], 
     LineBox[{{{8.733333333333333, -11}, {9.266666666666667, -11}}, {{
        9, -11.266666666666667`}, {9, -10.733333333333333`}}}]}}, {
    LineBox[{{10, -8}, {10, -11}, {10, -12}}], DiskBox[{10, -8}, 0.09], 
    DiskBox[{10, -11}, 0.09], {CircleBox[{10, -12}, 0.26666666666666666], 
     LineBox[{{{9.733333333333333, -12}, {10.266666666666667`, -12}}, {{
        10, -12.266666666666667`}, {10, -11.733333333333333`}}}]}}, {
    LineBox[{{11, -8}, {11, -11}}], 
    DiskBox[{11, -8}, 0.09], {CircleBox[{11, -11}, 0.26666666666666666], 
     LineBox[{{{10.733333333333333`, -11}, {11.266666666666667`, -11}}, {{
        11, -11.266666666666667`}, {11, -10.733333333333333`}}}]}}, {
    LineBox[{{12, -9}, {12, -11}, {12, -12}, {12, -13}}], 
    DiskBox[{12, -9}, 0.09], DiskBox[{12, -11}, 0.09], 
    DiskBox[{12, -12}, 0.09], {CircleBox[{12, -13}, 0.26666666666666666], 
     LineBox[{{{11.733333333333333`, -13}, {12.266666666666667`, -13}}, {{
        12, -13.266666666666667`}, {12, -12.733333333333333`}}}]}}, {
    LineBox[{{13, -9}, {13, -11}, {13, -12}}], DiskBox[{13, -9}, 0.09], 
    DiskBox[{13, -11}, 0.09], {CircleBox[{13, -12}, 0.26666666666666666], 
     LineBox[{{{12.733333333333333`, -12}, {13.266666666666667`, -12}}, {{
        13, -12.266666666666667`}, {13, -11.733333333333333`}}}]}}, {
    LineBox[{{14, -9}, {14, -11}}], 
    DiskBox[{14, -9}, 0.09], {CircleBox[{14, -11}, 0.26666666666666666], 
     LineBox[{{{13.733333333333333`, -11}, {14.266666666666667`, -11}}, {{
        14, -11.266666666666667`}, {14, -10.733333333333333`}}}]}}, {{{
      {GrayLevel[1], EdgeForm[None], 
       RectangleBox[{15.6, -11.4}, {16.4, -10.6}]}, 
      LineBox[{{15.6, -11.4}, {16.4, -11.4}, {16.4, -10.6}, {15.6, -10.6}, {
       15.6, -11.4}}]}, 
     CircleBox[{16, -11.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{16, -11.2}, {16.24, -10.76}}]}, {{
      {GrayLevel[1], EdgeForm[None], 
       RectangleBox[{15.6, -12.4}, {16.4, -11.6}]}, 
      LineBox[{{15.6, -12.4}, {16.4, -12.4}, {16.4, -11.6}, {15.6, -11.6}, {
       15.6, -12.4}}]}, 
     CircleBox[{16, -12.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{16, -12.2}, {16.24, -11.76}}]}, {{
      {GrayLevel[1], EdgeForm[None], 
       RectangleBox[{15.6, -13.4}, {16.4, -12.6}]}, 
      LineBox[{{15.6, -13.4}, {16.4, -13.4}, {16.4, -12.6}, {15.6, -12.6}, {
       15.6, -13.4}}]}, 
     CircleBox[{16, -13.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{16, -13.2}, {16.24, -12.76}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
  ImageSize->658.8000000000001,
  PlotRange->NCache[{Full, {
      Rational[-29, 2], 
      Rational[-1, 2]}}, {Full, {-14.5, -0.5}}],
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{
  3.876913758350912*^9, {3.8786409526055737`*^9, 3.878640964991321*^9}, 
   3.8786416512587748`*^9, 3.87864188374806*^9, 3.878642313000828*^9, 
   3.8786433642805347`*^9, 3.878644029035779*^9, 3.879074921204577*^9},
 CellLabel->"Out[229]=",
 CellID->634786279,ExpressionUUID->"da797127-1bf6-4e74-9900-eb1831e10ad5"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transformation", "Section",
 CellChangeTimes->{{3.876913773943345*^9, 3.8769137775015087`*^9}},
 CellID->797821259,ExpressionUUID->"0f894b3d-c2fd-4322-867c-318ebbf73e83"],

Cell[TextData[{
 "The post-measurement state is spread over the four qubits of Alice's and \
Bob's registers, respectively. One has to transform it into a smaller number \
of pairs. Here, we assume that the measurement outcome is ",
 Cell[BoxData[Cell[TextData[Cell[BoxData[
   FormBox[
    RowBox[{
     SubscriptBox["Z", "tot"], "=", "3"}], TraditionalForm]],ExpressionUUID->
   "72baf89f-33d0-460c-acf5-c2a7015f20ba"]],ExpressionUUID->
   "632d69de-81c9-4edd-96a7-4c1babad198f"]],ExpressionUUID->
  "218e5a54-79ea-467a-b69a-a57d59b2b2af"],
 ", corresponding to two maximally entangled pairs. Note that  measurement \
outcome ",
 Cell[BoxData[Cell[TextData[Cell[BoxData[
   FormBox[
    RowBox[{
     SubscriptBox["Z", "tot"], "=", "1"}], TraditionalForm]],ExpressionUUID->
   "9abc87de-4426-4b24-b12c-ded2687d2702"]],ExpressionUUID->
   "49dd4280-2715-476f-b8f5-956e7dfd0af7"]],ExpressionUUID->
  "baeb783c-7575-4851-b014-40a1f4b48f75"],
 "also leads to two maximally entangled pairs since ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    ButtonBox["Binomial",
     BaseStyle->"Link"], "[", 
    RowBox[{"4", ",", "1"}], "]"}], "==", 
   RowBox[{
    ButtonBox["Binomial",
     BaseStyle->"Link"], "[", 
    RowBox[{"4", ",", "3"}], "]"}], "==", "4"}]], "InlineFormula",
  ExpressionUUID->"3e5f089e-fb83-4aba-b73a-a8b4705d9be5"],
 "."
}], "Text",
 CellChangeTimes->{{3.87691378303883*^9, 3.8769138199412518`*^9}, {
  3.876913850654917*^9, 3.876913869014278*^9}, {3.8769139448650513`*^9, 
  3.876914124620406*^9}, {3.8786387991035757`*^9, 3.8786389053330717`*^9}, {
  3.878640261877316*^9, 3.878640345786149*^9}, {3.878640522678537*^9, 
  3.878640528662224*^9}},
 CellID->695573627,ExpressionUUID->"43916a76-a876-4e48-ad11-1940ad29c6b3"],

Cell["\<\
To get the unitary transformation on Alice's side, we first rearrange the \
computational basis to get a new basis  \
\>", "Text",
 CellChangeTimes->{{3.87863919960596*^9, 3.8786392026568336`*^9}},
 CellID->1699338655,ExpressionUUID->"33f1b9a2-d4ed-4ee1-8b0b-0b65a7865bde"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalA]", ":=", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{"0111"},
       "Ket"], ",", 
      TemplateBox[{"1011"},
       "Ket"], ",", 
      TemplateBox[{"1101"},
       "Ket"], ",", 
      TemplateBox[{"1110"},
       "Ket"], ",", 
      TemplateBox[{
        SubscriptBox["\[Alpha]", "5"]},
       "Ket"], ",", "\[Ellipsis]", ",", 
      TemplateBox[{
        SubscriptBox["\[Alpha]", "16"]},
       "Ket"]}], "}"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "0575b6b1-6272-4b68-836f-6ee56a50e16c"],
 ","
}], "Text",
 CellChangeTimes->{{3.878639083143145*^9, 3.878639096776886*^9}},
 CellID->1399753132,ExpressionUUID->"be691043-e547-4f15-8e06-076fc92110c8"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     SubscriptBox["\[Alpha]", "k"]},
    "Ket"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "c1f84491-5da5-457e-9c46-218a70abd252"],
 " (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"k", "=", "5"}], ",", "\[Ellipsis]", ",", "16"}], 
   TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "e1c1b579-e443-40ef-8517-29c30a6ae8c2"],
 ") are the computational basis states with total spin not equal to 3. Next, \
consider still another basis\[LineSeparator]\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[ScriptCapitalA]", "'"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        RowBox[{"00", ";", "00"}]},
       "Ket"], ",", 
      TemplateBox[{
        RowBox[{"01", ";", "00"}]},
       "Ket"], ",", 
      TemplateBox[{
        RowBox[{"10", ";", "00"}]},
       "Ket"], ",", 
      TemplateBox[{
        RowBox[{"11", ";", "00"}]},
       "Ket"], ",", 
      TemplateBox[{
        SubsuperscriptBox["\[Alpha]", "5", "\[Prime]"]},
       "Ket"], ",", "\[Ellipsis]", ",", 
      TemplateBox[{
        SubsuperscriptBox["\[Alpha]", "16", "\[Prime]"]},
       "Ket"]}], "}"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a86f7946-580c-4849-a46c-efc49e376300"],
 ","
}], "Text",
 CellID->2115020286,ExpressionUUID->"2921f348-905f-443f-acb8-2bd0d40c2538"],

Cell[TextData[{
 "where we have put a semicolon ';' to indicate the first two qubits to which \
encode Alice\[CloseCurlyQuote]s part of the maximally entangled states. Then, \
the required unitary transformation corresponds to the basis change from ",
 Cell[BoxData[
  FormBox["\[ScriptCapitalA]", TraditionalForm]],ExpressionUUID->
  "015bfae9-be74-4c6b-b696-6f186408339e"],
 " to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalA]", "'"}], TraditionalForm]],ExpressionUUID->
  "b84a5cbc-9ee0-4cb9-b29f-3253c7650534"],
 ". That is to say, the unitary transformation is given by "
}], "Text",
 CellChangeTimes->{{3.878648125191802*^9, 3.8786481264168673`*^9}},
 CellID->1996621658,ExpressionUUID->"13dcc265-2807-410d-b51c-0886469ac26a"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", ":=", 
    RowBox[{
     RowBox[{
      TemplateBox[{
        RowBox[{"00", ";", "00"}]},
       "Ket"], 
      TemplateBox[{"0111"},
       "Bra"]}], "+", 
     RowBox[{
      TemplateBox[{
        RowBox[{"01", ";", "00"}]},
       "Ket"], 
      TemplateBox[{"1011"},
       "Bra"]}], "+", 
     RowBox[{
      TemplateBox[{
        RowBox[{"10", ";", "00"}]},
       "Ket"], 
      TemplateBox[{"1101"},
       "Bra"]}], "+", 
     RowBox[{
      TemplateBox[{
        RowBox[{"11", ";", "00"}]},
       "Ket"], 
      TemplateBox[{"1110"},
       "Bra"]}], "+", 
     RowBox[{
      UnderoverscriptBox["\[CapitalSigma]", 
       RowBox[{"k", "=", "5"}], "16"], 
      TemplateBox[{
        SubsuperscriptBox["a", "k", "\[Prime]"]},
       "Ket"], 
      TemplateBox[{
        SubscriptBox["\[Alpha]", "k"]},
       "Bra"]}]}]}], TraditionalForm]],ExpressionUUID->
  "87c6ec4a-9ab1-4901-91e5-e79b83299c56"],
 "."
}], "Text",
 CellID->640737984,ExpressionUUID->"f6e66ca7-5ad0-448d-9b05-837f2f8b0565"],

Cell[TextData[{
 "The unitary transformation on Bob's register may be obtained in the same \
manner, where we denote the rearranged bases by ",
 Cell[BoxData[
  FormBox["\[ScriptCapitalB]", TraditionalForm]],ExpressionUUID->
  "4130a2b7-34a8-4112-95e4-2c130bfd0acb"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalB]", "'"}], TraditionalForm]],ExpressionUUID->
  "485c69e4-a797-4631-9f76-ad2cf6108f14"]
}], "Text",
 CellChangeTimes->{{3.87863944115376*^9, 3.8786395100818367`*^9}},
 CellID->1266994926,ExpressionUUID->"39fb159e-2f1c-4b9d-b3d7-4545e63fee32"],

Cell[CellGroupData[{

Cell["Method 1: Using Dyad", "Subsection",
 CellChangeTimes->{{3.879074735718967*^9, 3.879074747350543*^9}, {
  3.879074780382093*^9, 3.879074786492793*^9}},
 CellID->1145574102,ExpressionUUID->"3e29fedb-a31e-47cd-9806-5e721284d533"],

Cell[CellGroupData[{

Cell["\<\
These are the computational bases for Alice's and Bob's registers, \
respectively.\
\>", "MathCaption",
 CellChangeTimes->{{3.878639003803286*^9, 3.878639042214031*^9}},
 CellID->920704413,ExpressionUUID->"b628ac1d-6b05-4590-bf55-0ea77b2b73eb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"bsA", "=", 
  RowBox[{"Basis", "[", "AA", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"bsB", "=", 
  RowBox[{"Basis", "[", "BB", "]"}]}]}], "Input",
 CellLabel->"In[80]:=",
 CellID->989436024,ExpressionUUID->"68fbf39b-d569-4d6e-bf37-5129d1f01af0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"\[SpaceIndicator]\""},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "}"}]], "Output",
 CellChangeTimes->{{3.876914126760735*^9, 3.876914130254706*^9}, 
   3.878639145032412*^9, 3.8786409739636717`*^9, 3.878643387372377*^9, 
   3.878644044311337*^9},
 CellLabel->"Out[80]=",
 CellID->1321746014,ExpressionUUID->"3facc1ac-7d5e-4556-b9a3-4d895b961e8c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"\[SpaceIndicator]\""},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "}"}]], "Output",
 CellChangeTimes->{{3.876914126760735*^9, 3.876914130254706*^9}, 
   3.878639145032412*^9, 3.8786409739636717`*^9, 3.878643387372377*^9, 
   3.878644044327239*^9},
 CellLabel->"Out[81]=",
 CellID->1014412730,ExpressionUUID->"e2c21c1e-1613-4794-a98e-ae7e8279c28e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "These are the bases ",
 Cell[BoxData[
  FormBox["\[ScriptCapitalA]", TraditionalForm]],ExpressionUUID->
  "b8e0af21-77d0-4e28-a7b1-20ad5f9f567e"],
 " and ",
 Cell[BoxData[
  FormBox["\[ScriptCapitalB]", TraditionalForm]],ExpressionUUID->
  "a6577184-6759-4344-b8b2-7fcc452275a1"],
 " for Alice's and Bob's registers, respectively."
}], "MathCaption",
 CellChangeTimes->{{3.878639526682781*^9, 3.878639578506969*^9}},
 CellID->284257392,ExpressionUUID->"f3616645-327d-4284-9237-a987b918be6a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{"Permutations", "[", 
    RowBox[{"PadLeft", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"1", ",", "3"}], "]"}], ",", "$n"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sppA", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"AA", "->", "#"}], "]"}], "&"}], "/@", "bb"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sppB", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"BB", "->", "#"}], "]"}], "&"}], "/@", "bb"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sppA", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"sppA", ",", 
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{"Complement", "[", 
        RowBox[{"bsA", ",", "sppA"}], "]"}], ",", 
       RowBox[{
        RowBox[{"LogicalForm", "[", 
         RowBox[{"#", ",", "AA"}], "]"}], "&"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sppB", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"sppB", ",", 
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{"Complement", "[", 
        RowBox[{"bsB", ",", "sppB"}], "]"}], ",", 
       RowBox[{
        RowBox[{"LogicalForm", "[", 
         RowBox[{"#", ",", "BB"}], "]"}], "&"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.876914156272278*^9, 3.876914201781519*^9}, {
  3.876914251549748*^9, 3.876914251943233*^9}, {3.878639139294224*^9, 
  3.878639140823812*^9}},
 CellLabel->"In[82]:=",
 CellID->576306453,ExpressionUUID->"c84f116c-1d33-4084-8a4f-47e4eba37184"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"sppA", "//", "LogicalForm"}], "\[IndentingNewLine]", 
 RowBox[{"sppB", "//", "LogicalForm"}]}], "Input",
 CellLabel->"In[87]:=",
 CellID->2013079378,ExpressionUUID->"9e830136-510d-48d5-aea5-180f42fb4c81"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "}"}]], "Output",
 CellChangeTimes->{3.876914140589252*^9, 3.8769142535451927`*^9, 
  3.878639148192396*^9, 3.878639588017441*^9, 3.8786409767755003`*^9, 
  3.878643392284111*^9, 3.878644047319332*^9},
 CellLabel->"Out[87]=",
 CellID->1375489208,ExpressionUUID->"f80fc0bb-e04d-4d1b-a496-a04f2a46ef98"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "}"}]], "Output",
 CellChangeTimes->{3.876914140589252*^9, 3.8769142535451927`*^9, 
  3.878639148192396*^9, 3.878639588017441*^9, 3.8786409767755003`*^9, 
  3.878643392284111*^9, 3.878644047348589*^9},
 CellLabel->"Out[88]=",
 CellID->185658901,ExpressionUUID->"82ebf9d1-d138-4e71-bfa8-e1a04334f093"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "These are the bases ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalA]", "'"}], TraditionalForm]],ExpressionUUID->
  "5671d54f-e4c8-4db0-8cc0-46fbb620be12"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalB]", "'"}], TraditionalForm]],ExpressionUUID->
  "2ec593f4-ee41-4645-9025-db89c3b29d3e"],
 " for Alice's and Bob's registers, respectively."
}], "MathCaption",
 CellChangeTimes->{{3.878639592636016*^9, 3.8786396220165567`*^9}},
 CellID->1601110815,ExpressionUUID->"79fbf475-2029-4962-a1a3-a04d211c2587"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"newA", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"A", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"newB", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"B", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"newA", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"newA", ",", 
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{"Complement", "[", 
        RowBox[{"bsA", ",", "newA"}], "]"}], ",", 
       RowBox[{
        RowBox[{"LogicalForm", "[", 
         RowBox[{"#", ",", "AA"}], "]"}], "&"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"newB", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"newB", ",", 
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{"Complement", "[", 
        RowBox[{"bsB", ",", "newB"}], "]"}], ",", 
       RowBox[{
        RowBox[{"LogicalForm", "[", 
         RowBox[{"#", ",", "BB"}], "]"}], "&"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellLabel->"In[89]:=",
 CellID->38369270,ExpressionUUID->"c223bfaa-a713-4f39-add4-bfc4d937e57c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"LogicalForm", "[", "newA", "]"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", "newB", "]"}]}], "Input",
 CellLabel->"In[93]:=",
 CellID->627226790,ExpressionUUID->"508366b2-d0f8-4ec3-acb0-71e60eeec672"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "}"}]], "Output",
 CellChangeTimes->{3.8769142559426603`*^9, 3.878639628553987*^9, 
  3.878640978942972*^9, 3.878643394554551*^9, 3.8786440496860943`*^9},
 CellLabel->"Out[93]=",
 CellID->1700066137,ExpressionUUID->"48118471-8b01-438b-8afa-5c9c7cdfe4c8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "}"}]], "Output",
 CellChangeTimes->{3.8769142559426603`*^9, 3.878639628553987*^9, 
  3.878640978942972*^9, 3.878643394554551*^9, 3.878644049709855*^9},
 CellLabel->"Out[94]=",
 CellID->741641224,ExpressionUUID->"ebb5b223-3f6b-4085-80c4-9d84f8956419"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Finally, the unitary transformation is constructed as prescribed above.\
\>", "MathCaption",
 CellChangeTimes->{{3.878639633894989*^9, 3.8786396615278*^9}},
 CellID->2067394127,ExpressionUUID->"ff3cc3dd-de55-4b67-bc2d-c7770b20f6fb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"trsA", "=", 
  RowBox[{"Total", "@", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Dyad", "[", 
       RowBox[{"#1", ",", "#2", ",", "AA"}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"newA", ",", "sppA"}], "}"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"trsB", "=", 
  RowBox[{"Total", "@", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Dyad", "[", 
       RowBox[{"#1", ",", "#2", ",", "BB"}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"newB", ",", "sppB"}], "}"}]}], "]"}]}]}]}], "Input",
 CellLabel->"In[95]:=",
 CellID->1604828370,ExpressionUUID->"adf25153-dba1-4e5a-9980-9ff5af18aa23"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"]}]], "Output",
 CellChangeTimes->{3.876914257729908*^9, 3.878639663737379*^9, 
  3.8786409804789047`*^9, 3.878643395842422*^9, 3.878644051149948*^9},
 CellLabel->"Out[95]=",
 CellID->879738215,ExpressionUUID->"f826b036-815d-4c65-b58f-11fd6f418985"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"]}]], "Output",
 CellChangeTimes->{3.876914257729908*^9, 3.878639663737379*^9, 
  3.8786409804789047`*^9, 3.878643395842422*^9, 3.8786440512018147`*^9},
 CellLabel->"Out[96]=",
 CellID->335269910,ExpressionUUID->"0590e13c-ab1a-4793-b24f-d9276c4b0f0c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
By construction, the unitary transformations are just permutation, which is \
clear from their matrix representations.\
\>", "MathCaption",
 CellChangeTimes->{{3.878639896990817*^9, 3.878639948664967*^9}},
 CellID->861429414,ExpressionUUID->"42668ab2-0ce1-4ab3-b5f6-061c7588e921"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Matrix", "[", "trsA", "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Matrix", "[", "trsB", "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8786398170551987`*^9, 3.878639835910283*^9}},
 CellLabel->"In[97]:=",
 CellID->1196447817,ExpressionUUID->"777e32d5-3edf-4731-b190-690cd8a34244"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {16, 16}, 0, {
     1, {{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16}, {{8}, {
       1}, {2}, {3}, {12}, {4}, {5}, {6}, {14}, {7}, {9}, {10}, {15}, {11}, {
       13}, {16}}}, {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
      1}}]]]]], "Output",
 CellChangeTimes->{{3.87863982286447*^9, 3.878639836306118*^9}, 
   3.878639953331623*^9, 3.878640982205122*^9, 3.8786433973030577`*^9, 
   3.878644052876862*^9},
 CellLabel->"Out[97]//MatrixForm=",
 CellID->826892984,ExpressionUUID->"e970d4c2-a1cf-43d0-8cc1-27e66c5642aa"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {16, 16}, 0, {
     1, {{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16}, {{8}, {
       1}, {2}, {3}, {12}, {4}, {5}, {6}, {14}, {7}, {9}, {10}, {15}, {11}, {
       13}, {16}}}, {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
      1}}]]]]], "Output",
 CellChangeTimes->{{3.87863982286447*^9, 3.878639836306118*^9}, 
   3.878639953331623*^9, 3.878640982205122*^9, 3.8786433973030577`*^9, 
   3.878644052897532*^9},
 CellLabel->"Out[98]//MatrixForm=",
 CellID->1223702351,ExpressionUUID->"bd05f265-781b-4eec-b567-2e07d79c8513"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check that they are indeed unitary transformations.", "MathCaption",
 CellChangeTimes->{{3.878639845472068*^9, 3.878639871680887*^9}},
 CellID->93724021,ExpressionUUID->"b7f29345-bc7f-4261-910a-ac3bed0a7340"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Dagger", "[", "trsA", "]"}], "**", "trsA"}], "//", 
  "Elaborate"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Dagger", "[", "trsB", "]"}], "**", "trsB"}], "//", 
  "Elaborate"}]}], "Input",
 CellChangeTimes->{{3.878639671747467*^9, 3.878639690332704*^9}},
 CellLabel->"In[47]:=",
 CellID->428846345,ExpressionUUID->"4f8c63bd-9d60-47e7-b117-79a4a00cc407"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.878639680904757*^9, 3.878639690844173*^9}, 
   3.878639794470941*^9, 3.878639840578518*^9, 3.878639960515897*^9, 
   3.8786409839521027`*^9, 3.878643398799519*^9},
 CellLabel->"Out[47]=",
 CellID->55928912,ExpressionUUID->"0d74de1c-535b-413c-b3bb-99b55e3a61d1"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.878639680904757*^9, 3.878639690844173*^9}, 
   3.878639794470941*^9, 3.878639840578518*^9, 3.878639960515897*^9, 
   3.8786409839521027`*^9, 3.87864339892836*^9},
 CellLabel->"Out[48]=",
 CellID->1227883175,ExpressionUUID->"cf52f5d2-bfd5-44c8-85e1-1b34fbc8c051"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Method 2: Using Permutation", "Subsection",
 CellChangeTimes->{{3.879074735718967*^9, 3.879074747350543*^9}, {
  3.879074780382093*^9, 3.8790748084924393`*^9}},
 CellID->1197910904,ExpressionUUID->"5b51fd21-1a8e-40db-9ca4-2d97b1505571"],

Cell[CellGroupData[{

Cell["\<\
Here, we find the permutation corresponding to the basis change and use it to \
construct the unitary matrix.\
\>", "Text",
 CellChangeTimes->{{3.87907499343908*^9, 3.879075040124888*^9}},
 CellID->368440934,ExpressionUUID->"545d1c56-5920-45a4-8008-f1a397582884"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"constructUnitary", "::", "bad"}], "=", 
   "\"\<States with `` non-zero qubits in total `` qubits cannot be encoded \
in a finite number of qubits.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"constructUnitary", "[", 
   RowBox[{"m_Integer", ",", "n_Integer"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"org", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", "n"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"bin", "=", 
       RowBox[{"Log", "[", 
        RowBox[{"2", ",", 
         RowBox[{"Binomial", "[", 
          RowBox[{"n", ",", "m"}], "]"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", "src", ",", "dst"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "@", 
        RowBox[{"IntegerQ", "@", "bin"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"constructUnitary", "::", "bad"}], ",", "m", ",", "n"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"One", "@", 
          RowBox[{"Power", "[", 
           RowBox[{"2", ",", "n"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]",
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"src", "=", 
      RowBox[{"Permutations", "@", 
       RowBox[{"PadLeft", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"1", ",", "m"}], "]"}], ",", "n"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"src", "=", 
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"Join", "[", 
        RowBox[{"src", ",", "org"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dst", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"PadRight", "[", 
         RowBox[{"#", ",", "n"}], "]"}], "&"}], "/@", 
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", "bin"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dst", "=", 
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"Join", "[", 
        RowBox[{"dst", ",", "org"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tau", "=", 
      RowBox[{"FindPermutation", "[", 
       RowBox[{"src", ",", "org"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tau", "=", 
      RowBox[{"FindPermutation", "@", 
       RowBox[{"Permute", "[", 
        RowBox[{"dst", ",", "tau"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"PermutationMatrix", "[", 
      RowBox[{"tau", ",", 
       RowBox[{"Power", "[", 
        RowBox[{"2", ",", "n"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->"In[230]:=",
 CellID->519669879,ExpressionUUID->"70803beb-8608-48d9-ae1c-6b511526471c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"constructUnitary", "[", 
    RowBox[{"3", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.879074826077909*^9, 3.879074850733683*^9}},
 CellLabel->"In[232]:=",
 CellID->584821147,ExpressionUUID->"9f81e7d2-a5a8-4b80-b0cc-79a435492494"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
    PermutationMatrix[
     StructuredArray`StructuredData[{16, 16}, {
       Cycles[{{1, 8, 6, 4, 3, 2}, {5, 12, 10, 7}, {9, 14, 11}, {13, 15}}], 
       DirectedInfinity[1]}]]]]]], "Output",
 CellChangeTimes->{{3.879074846078863*^9, 3.879074850987529*^9}, 
   3.8790749379429283`*^9},
 CellLabel->"Out[233]//MatrixForm=",
 CellID->1153195534,ExpressionUUID->"c7a93294-e02a-4f1d-a7d1-398c970d047e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"trsA", "=", 
   RowBox[{
    RowBox[{"ExpressionFor", "[", 
     RowBox[{"mat", ",", "AA"}], "]"}], "//", "Elaborate"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trsB", "=", 
   RowBox[{
    RowBox[{"ExpressionFor", "[", 
     RowBox[{"mat", ",", "BB"}], "]"}], "//", "Elaborate"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.879074853948283*^9, 3.879074888077031*^9}},
 CellLabel->"In[234]:=",
 CellID->21183722,ExpressionUUID->"c932492d-99be-41c1-9919-3de001f27796"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Dagger", "[", "trsA", "]"}], "**", "trsA"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dagger", "[", "trsB", "]"}], "**", "trsB"}]}], "Input",
 CellChangeTimes->{{3.8790749417180557`*^9, 3.879074967366188*^9}},
 CellLabel->"In[237]:=",
 CellID->1721911763,ExpressionUUID->"96d6d170-0c74-4b9d-9127-3953d6b87f32"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.8790749592580957`*^9, 3.8790749754123507`*^9}},
 CellLabel->"Out[237]=",
 CellID->274988639,ExpressionUUID->"bc0295ad-1596-4c5b-8d2a-32e63ac68b33"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.8790749592580957`*^9, 3.8790749832139997`*^9}},
 CellLabel->"Out[238]=",
 CellID->349247329,ExpressionUUID->"ebfe2d88-c6f4-4eab-8b68-9cd4aff08612"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Overall", "Section",
 CellID->1248933531,ExpressionUUID->"543e3914-c7ba-444b-85b0-e367e6251f35"],

Cell[CellGroupData[{

Cell["\<\
Now, we have all components. Our desired quantum circuit is as follows. The \
first part generates four partially entangled pairs, the second measures the \
total Pauli Z on Bob's register, and the last transforms the post-measurement \
state a fixed pair of qubits from Alice's and Bob's registers.\
\>", "Text",
 CellChangeTimes->{{3.87691430082067*^9, 3.876914482921028*^9}},
 CellID->1308352194,ExpressionUUID->"c50697db-8ea8-4dae-9698-e81518c8fd9c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"all", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"qc2", ",", "\"\<Separator\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{"T", "[", 
     RowBox[{"3", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"T", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ",", "trsA", ",", 
      RowBox[{"\"\<Label\>\"", "->", "\"\<U\>\""}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"T", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ",", "trsB", ",", 
      RowBox[{"\"\<Label\>\"", "->", "\"\<U\>\""}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"T", "[", 
     RowBox[{"3", ",", "1"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8769142777103167`*^9, 3.8769142891733227`*^9}, {
  3.878641004703807*^9, 3.878641040133664*^9}, {3.878641080041786*^9, 
  3.878641117974493*^9}, {3.8786414580109453`*^9, 3.878641483607373*^9}, {
  3.878643407947455*^9, 3.8786434231704187`*^9}},
 CellLabel->"In[100]:=",
 CellID->1320689739,ExpressionUUID->"bd78c7db-4888-4f7d-9d8d-d3e80a11d1f8"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{16, -11}, {22, -11}}, {{16, -12}, {22, -12}}, {{16, -13}, {
     22, -13}}}]}, 
   LineBox[{{{0, -1}, {22, -1}}, {{0, -2}, {22, -2}}, {{0, -3}, {22, -3}}, {{
    0, -4}, {22, -4}}, {{0, -6}, {22, -6}}, {{0, -7}, {22, -7}}, {{0, -8}, {
    22, -8}}, {{0, -9}, {22, -9}}, {{0, -11}, {16, -11}}, {{0, -12}, {
    16, -12}}, {{0, -13}, {16, -13}}}], {{InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.014545454545454549`],
       FontWeight->"Light"], {-0.1, -11}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.014545454545454549`],
       FontWeight->"Light"], {-0.1, -12}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.014545454545454549`],
       FontWeight->"Light"], {-0.1, -13}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.014545454545454549`],
       FontWeight->"Light"], {-0.1, -1}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.014545454545454549`],
       FontWeight->"Light"], {-0.1, -2}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.014545454545454549`],
       FontWeight->"Light"], {-0.1, -3}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.014545454545454549`],
       FontWeight->"Light"], {-0.1, -4}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.014545454545454549`],
       FontWeight->"Light"], {-0.1, -6}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.014545454545454549`],
       FontWeight->"Light"], {-0.1, -7}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.014545454545454549`],
       FontWeight->"Light"], {-0.1, -8}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.014545454545454549`],
       FontWeight->"Light"], {-0.1, -9}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}}, {{
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.018181818181818184`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.018181818181818184`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, 
     LineBox[{{0.6, -3.4}, {1.4, -3.4}, {1.4, -2.6}, {0.6, -2.6}, {
      0.6, -3.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.018181818181818184`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, 
     LineBox[{{0.6, -4.4}, {1.4, -4.4}, {1.4, -3.6}, {0.6, -3.6}, {
      0.6, -4.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.018181818181818184`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}}, {LineBox[{{2, -1}, {2, -6}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -6}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -6}, {2.2666666666666666`, -6}}, {{
        2, -6.266666666666667}, {2, -5.733333333333333}}}]}}, {
    LineBox[{{3, -2}, {3, -7}}], 
    DiskBox[{3, -2}, 0.09], {CircleBox[{3, -7}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -7}, {3.2666666666666666`, -7}}, {{
        3, -7.266666666666667}, {3, -6.733333333333333}}}]}}, {
    LineBox[{{4, -3}, {4, -8}}], 
    DiskBox[{4, -3}, 0.09], {CircleBox[{4, -8}, 0.26666666666666666], 
     LineBox[{{{3.7333333333333334`, -8}, {4.266666666666667, -8}}, {{
        4, -8.266666666666667}, {4, -7.733333333333333}}}]}}, {
    LineBox[{{5, -4}, {5, -9}}], 
    DiskBox[{5, -4}, 0.09], {CircleBox[{5, -9}, 0.26666666666666666], 
     LineBox[{{{4.733333333333333, -9}, {5.266666666666667, -9}}, {{
        5, -9.266666666666667}, {5, -8.733333333333333}}}]}}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{6, Rational[-29, 2]}, {6, Rational[-1, 2]}}, {{
       6, -14.5}, {6, -0.5}}]]}, {LineBox[{{7, -6}, {7, -11}}], 
    DiskBox[{7, -6}, 0.09], {CircleBox[{7, -11}, 0.26666666666666666], 
     LineBox[{{{6.733333333333333, -11}, {7.266666666666667, -11}}, {{
        7, -11.266666666666667`}, {7, -10.733333333333333`}}}]}}, {
    LineBox[{{8, -7}, {8, -11}, {8, -12}}], DiskBox[{8, -7}, 0.09], 
    DiskBox[{8, -11}, 0.09], {CircleBox[{8, -12}, 0.26666666666666666], 
     LineBox[{{{7.733333333333333, -12}, {8.266666666666667, -12}}, {{
        8, -12.266666666666667`}, {8, -11.733333333333333`}}}]}}, {
    LineBox[{{9, -7}, {9, -11}}], 
    DiskBox[{9, -7}, 0.09], {CircleBox[{9, -11}, 0.26666666666666666], 
     LineBox[{{{8.733333333333333, -11}, {9.266666666666667, -11}}, {{
        9, -11.266666666666667`}, {9, -10.733333333333333`}}}]}}, {
    LineBox[{{10, -8}, {10, -11}, {10, -12}}], DiskBox[{10, -8}, 0.09], 
    DiskBox[{10, -11}, 0.09], {CircleBox[{10, -12}, 0.26666666666666666], 
     LineBox[{{{9.733333333333333, -12}, {10.266666666666667`, -12}}, {{
        10, -12.266666666666667`}, {10, -11.733333333333333`}}}]}}, {
    LineBox[{{11, -8}, {11, -11}}], 
    DiskBox[{11, -8}, 0.09], {CircleBox[{11, -11}, 0.26666666666666666], 
     LineBox[{{{10.733333333333333`, -11}, {11.266666666666667`, -11}}, {{
        11, -11.266666666666667`}, {11, -10.733333333333333`}}}]}}, {
    LineBox[{{12, -9}, {12, -11}, {12, -12}, {12, -13}}], 
    DiskBox[{12, -9}, 0.09], DiskBox[{12, -11}, 0.09], 
    DiskBox[{12, -12}, 0.09], {CircleBox[{12, -13}, 0.26666666666666666], 
     LineBox[{{{11.733333333333333`, -13}, {12.266666666666667`, -13}}, {{
        12, -13.266666666666667`}, {12, -12.733333333333333`}}}]}}, {
    LineBox[{{13, -9}, {13, -11}, {13, -12}}], DiskBox[{13, -9}, 0.09], 
    DiskBox[{13, -11}, 0.09], {CircleBox[{13, -12}, 0.26666666666666666], 
     LineBox[{{{12.733333333333333`, -12}, {13.266666666666667`, -12}}, {{
        13, -12.266666666666667`}, {13, -11.733333333333333`}}}]}}, {
    LineBox[{{14, -9}, {14, -11}}], 
    DiskBox[{14, -9}, 0.09], {CircleBox[{14, -11}, 0.26666666666666666], 
     LineBox[{{{13.733333333333333`, -11}, {14.266666666666667`, -11}}, {{
        14, -11.266666666666667`}, {14, -10.733333333333333`}}}]}}, {{{
      {GrayLevel[1], EdgeForm[None], 
       RectangleBox[{15.6, -11.4}, {16.4, -10.6}]}, 
      LineBox[{{15.6, -11.4}, {16.4, -11.4}, {16.4, -10.6}, {15.6, -10.6}, {
       15.6, -11.4}}]}, 
     CircleBox[{16, -11.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{16, -11.2}, {16.24, -10.76}}]}, {{
      {GrayLevel[1], EdgeForm[None], 
       RectangleBox[{15.6, -12.4}, {16.4, -11.6}]}, 
      LineBox[{{15.6, -12.4}, {16.4, -12.4}, {16.4, -11.6}, {15.6, -11.6}, {
       15.6, -12.4}}]}, 
     CircleBox[{16, -12.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{16, -12.2}, {16.24, -11.76}}]}, {{
      {GrayLevel[1], EdgeForm[None], 
       RectangleBox[{15.6, -13.4}, {16.4, -12.6}]}, 
      LineBox[{{15.6, -13.4}, {16.4, -13.4}, {16.4, -12.6}, {15.6, -12.6}, {
       15.6, -13.4}}]}, 
     CircleBox[{16, -13.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{16, -13.2}, {16.24, -12.76}}]}}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{17, Rational[-29, 2]}, {17, Rational[-1, 2]}}, {{
       17, -14.5}, {17, -0.5}}]]}, {
    {GrayLevel[1], EdgeForm[None], 
     RectangleBox[{17.6, -13.4}, {18.4, -12.6}]}, 
    LineBox[{{17.6, -13.4}, {18.4, -13.4}, {18.4, -12.6}, {17.6, -12.6}, {
     17.6, -13.4}}], InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.018181818181818184`],
      FontWeight->"Light",
      FontSlant->Italic], {18, -13}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {
    LineBox[{{19, -11}, {19, -12}, {19, -13}, {19, -1}, {19, -2}, {19, -3}, {
     19, -4}}], DiskBox[{19, -11}, 0.09], DiskBox[{19, -12}, 0.09], 
    DiskBox[{19, -13}, 0.09], 
    {GrayLevel[1], EdgeForm[None], RectangleBox[{18.6, -4.4}, {19.4, -0.6}]}, 
    LineBox[{{18.6, -4.4}, {19.4, -4.4}, {19.4, -0.6}, {18.6, -0.6}, {
     18.6, -4.4}}], InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.018181818181818184`],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{19, Rational[-5, 2]}, {19, -2.5}], NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {
    LineBox[{{20, -11}, {20, -12}, {20, -13}, {20, -6}, {20, -7}, {20, -8}, {
     20, -9}}], DiskBox[{20, -11}, 0.09], DiskBox[{20, -12}, 0.09], 
    DiskBox[{20, -13}, 0.09], 
    {GrayLevel[1], EdgeForm[None], RectangleBox[{19.6, -9.4}, {20.4, -5.6}]}, 
    LineBox[{{19.6, -9.4}, {20.4, -9.4}, {20.4, -5.6}, {19.6, -5.6}, {
     19.6, -9.4}}], InsetBox[
     StyleBox["\<\"U\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.018181818181818184`],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{20, Rational[-15, 2]}, {20, -7.5}], NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {
    {GrayLevel[1], EdgeForm[None], 
     RectangleBox[{20.6, -13.4}, {21.4, -12.6}]}, 
    LineBox[{{20.6, -13.4}, {21.4, -13.4}, {21.4, -12.6}, {20.6, -12.6}, {
     20.6, -13.4}}], InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.018181818181818184`],
      FontWeight->"Light",
      FontSlant->Italic], {21, -13}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
  ImageSize->838.8000000000001,
  PlotRange->NCache[{Full, {
      Rational[-29, 2], 
      Rational[-1, 2]}}, {Full, {-14.5, -0.5}}],
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.87691426095925*^9, 3.876914290112782*^9}, 
   3.876914487131399*^9, 3.878641043521603*^9, {3.8786411129022303`*^9, 
   3.8786411325539923`*^9}, 3.878641485864048*^9, 3.878643425361786*^9, 
   3.8786440596176577`*^9},
 CellLabel->"Out[100]=",
 CellID->424264871,ExpressionUUID->"37d0f407-084b-44d8-847f-71a4bd54813e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Because the transformation on Alice\[CloseCurlyQuote]s and Bob\
\[CloseCurlyQuote]s sides are designed for the measurement outcome of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Z", "tot"], "=", "3"}], TraditionalForm]],ExpressionUUID->
  "dc39250d-3b55-4171-884d-083a187d5835"],
 ", we just run the quantum circuit until we get the desired outcome."
}], "Text",
 CellID->196356282,ExpressionUUID->"2c56d7fa-37c4-4ff3-bc38-624540bcf713"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Until", "[", 
   RowBox[{
    RowBox[{"ztot", "==", "3"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"out", "=", 
      RowBox[{"Elaborate", "[", "all", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ztot", "=", 
      RowBox[{"FromDigits", "[", 
       RowBox[{
        RowBox[{"Reverse", "@", 
         RowBox[{"Readout", "[", 
          RowBox[{"Through", "[", 
           RowBox[{"TT", "[", "3", "]"}], "]"}], "]"}]}], ",", "2"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"\"\<\!\(\*SubscriptBox[\(Z\), \(tot\)]\)=\>\"", ",", "ztot"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.878643473715075*^9, 3.8786434875264587`*^9}},
 CellLabel->"In[101]:=",
 CellID->1625149782,ExpressionUUID->"8c92cb94-c212-4b23-9574-a551be752d7d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Here is the output state of the total system. Obviously, the whole register \
",
 StyleBox["T",
  FontSlant->"Italic"],
 " is separated from the other two registers. So are the last two registers \
of the respective registers A and B."
}], "Text",
 CellID->47879881,ExpressionUUID->"27cd6758-4e9a-4ab9-a03a-5d32b41fb8f2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LogicalForm", "[", 
  RowBox[{"out", ",", 
   RowBox[{"Join", "[", 
    RowBox[{"AA", ",", "BB", ",", "TT"}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[103]:=",
 CellID->1558275989,ExpressionUUID->"525db037-2a05-40e8-8608-34b8eac855e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"T"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"T"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"T"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"T"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"T"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"T"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"T"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"T"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"T"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"T"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"T"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"T"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{3.876914497478353*^9, 3.878644102755144*^9},
 CellLabel->"Out[103]=",
 CellID->1048442931,ExpressionUUID->"04f4898f-266b-4a6d-b3e1-3ba176f5d33d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Focusing on the two first two qubits of registers A and B, we see that there \
are two maximally entangled pairs.\
\>", "Text",
 CellID->1953490389,ExpressionUUID->"8a2222a2-dadb-4ac1-918b-a1d277ec715e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SimpleForm", "[", 
  RowBox[{"out", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], ",", 
     RowBox[{"B", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}]}], "}"}]}], "]"}]], "Input",
 CellLabel->"In[104]:=",
 CellID->1582972587,ExpressionUUID->"2dd2b211-3e22-4090-b6e3-470af69d8ed0"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{
     TemplateBox[{
       TemplateBox[{"0", "0"}, "RowDefault"], "\";\"", 
       TemplateBox[{"0", "0"}, "RowDefault"]}, "RowDefault"]},
    "Ket"], "2"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{
       TemplateBox[{"0", "1"}, "RowDefault"], "\";\"", 
       TemplateBox[{"0", "1"}, "RowDefault"]}, "RowDefault"]},
    "Ket"], "2"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{
       TemplateBox[{"1", "0"}, "RowDefault"], "\";\"", 
       TemplateBox[{"1", "0"}, "RowDefault"]}, "RowDefault"]},
    "Ket"], "2"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{
       TemplateBox[{"1", "1"}, "RowDefault"], "\";\"", 
       TemplateBox[{"1", "1"}, "RowDefault"]}, "RowDefault"]},
    "Ket"], "2"]}]], "Output",
 CellChangeTimes->{3.8769144990607243`*^9, 3.878644106593828*^9},
 CellLabel->"Out[104]=",
 CellID->1617276755,ExpressionUUID->"9c439ae8-a6be-4eaa-a56b-24be315b7d18"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KetFactor", "@", 
  RowBox[{"KetDrop", "[", 
   RowBox[{"out", ",", "TT"}], "]"}]}]], "Input",
 CellLabel->"In[105]:=",
 CellID->1686302499,ExpressionUUID->"6432b5d2-2ea7-4af3-844a-27333810bcf5"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], "+", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], ")"}], "\[CircleTimes]", 
    RowBox[{"(", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]], 
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], "+", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]], 
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], ")"}]}],
   HoldForm]}]], "Output",
 CellChangeTimes->{3.876914500877365*^9, 3.878644108050598*^9},
 CellLabel->"Out[105]=",
 CellID->1916130154,ExpressionUUID->"7bef717e-1efd-4fc5-94f9-bb919461093f"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Related Guides", "TutorialMoreAboutSection",
 CellChangeTimes->{{3.843042384656711*^9, 3.843042386024461*^9}},
 CellID->1812928137,ExpressionUUID->"8b2ccaf6-8cab-43e2-bdc8-c590499182a0"],

Cell[TextData[ButtonBox["Quantum Computation and Information",
 BaseStyle->"Link",
 ButtonData->
  "paclet:Q3/guide/QuantumComputationAndInformation"]], "TutorialMoreAbout",
 CellChangeTimes->{{3.850943061537991*^9, 3.8509430815007553`*^9}},
 CellID->1551876817,ExpressionUUID->"8a770104-c5be-4890-a94e-63b989dc0720"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Related Tech Notes", "RelatedTutorialsSection",
 CellID->436993734,ExpressionUUID->"625ae735-7219-4661-b0d1-8323e57fe844"],

Cell[TextData[ButtonBox["Entanglement Distillation",
 BaseStyle->"Link",
 ButtonData->
  "paclet:QuantumWorkbook/tutorial/EntanglementDistillation"]], \
"RelatedTutorials",
 CellChangeTimes->{{3.876912470169544*^9, 3.876912480094108*^9}},
 CellID->159614598,ExpressionUUID->"de55eb4d-0b28-4dc4-8ba9-1c4f1884eeb8"],

Cell[TextData[ButtonBox["Quantum Information Theory",
 BaseStyle->"Link",
 ButtonData->
  "paclet:Q3/tutorial/QuantumInformationTheory"]], "RelatedTutorials",
 CellChangeTimes->{{3.8752464248056583`*^9, 3.8752464349647293`*^9}},
 CellID->728547302,ExpressionUUID->"61b46736-1ad7-4837-b3c8-62bf16de2d9c"],

Cell[TextData[ButtonBox["Quantum Computation and Information: Overview",
 BaseStyle->"Link",
 ButtonData->
  "paclet:Q3/tutorial/QuantumComputationAndInformationOverview"]], \
"RelatedTutorials",
 CellChangeTimes->{{3.850943050994355*^9, 3.850943087505946*^9}},
 CellID->2102036812,ExpressionUUID->"ef77ce92-dfeb-4426-834f-4a59b4da4f5a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Related Links", "TutorialRelatedLinksSection",
 CellChangeTimes->{{3.850597361716105*^9, 3.850597362195363*^9}},
 CellID->847161968,ExpressionUUID->"4640f67b-3cfb-43e7-a7d2-c1f8928e1c70"],

Cell[TextData[{
 ButtonBox["J. Preskill (1998)",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://theory.caltech.edu/~preskill/ph229/"], None}],
 ", Lecture Notes for Physics 229: Quantum Information and Computation."
}], "TutorialRelatedLinks",
 CellChangeTimes->{{3.838416666529841*^9, 3.8384167198471823`*^9}, {
  3.875246577338297*^9, 3.8752466017711143`*^9}},
 CellID->90212659,ExpressionUUID->"bfef24ae-266b-4952-adb1-3f880d882881"],

Cell[TextData[{
 StyleBox[ButtonBox["M. Nielsen and I. L. Chuang (2022)",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1017/CBO9780511976667"], None},
  ButtonNote->"https://doi.org/10.1017/CBO9780511976667"],
  FontSlant->"Plain"],
 StyleBox[", Quantum Computation and Quantum Information (Cambridge \
University Press, 2011).",
  FontSlant->"Plain"]
}], "TutorialRelatedLinks",
 CellChangeTimes->{{3.850961013179529*^9, 3.8509610304423647`*^9}, {
  3.856689068353026*^9, 3.856689111943965*^9}},
 CellID->1612042109,ExpressionUUID->"57202c2e-1a2d-491f-b66d-1bc8e6794516"],

Cell[TextData[{
 ButtonBox["Mahn-Soo Choi (2022)",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1007/978-3-030-91214-7"], None}],
 ", A Quantum Computation Workbook (Springer, 2022)."
}], "TutorialRelatedLinks",
 CellChangeTimes->{
  3.8505890170531683`*^9, {3.85668899380037*^9, 3.856689046766375*^9}, {
   3.8566891672259073`*^9, 3.85668919109593*^9}},
 CellID->1997366095,ExpressionUUID->"4740f4eb-d4a7-4547-a903-2b78e4a1ed8f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Metadata", "MetadataSection",
 CellID->435473483,ExpressionUUID->"57723b63-0f70-40f9-82e5-a2a920be4c70"],

Cell[TextData[{
 "New in: ",
 Cell["13.1", "HistoryData",
  CellTags->"New",ExpressionUUID->"99a99901-487b-45ad-953f-7d60aa0680cd"],
 " | Modified in: ",
 Cell[" ", "HistoryData",
  CellTags->"Modified",ExpressionUUID->"04fd9efc-882f-42fd-a0ca-c97eb43f6309"],
 " | Obsolete in: ",
 Cell[" ", "HistoryData",
  CellTags->"Obsolete",ExpressionUUID->"87ca3475-c829-4f72-a649-d7fa91745927"],
 " | Excised in: ",
 Cell[" ", "HistoryData",
  CellTags->"Excised",ExpressionUUID->"06229eb1-ad7c-4950-87db-23ff5a4f3df5"]
}], "History",
 CellChangeTimes->{{3.852925529388873*^9, 3.85292552956523*^9}, {
  3.875246359692999*^9, 3.8752463598293247`*^9}},
 CellID->675385998,ExpressionUUID->"0d8a6edb-27ca-44bf-9fc9-692d232dda08"],

Cell[CellGroupData[{

Cell["Categorization", "CategorizationSection",
 CellID->1608080221,ExpressionUUID->"4bcc2f0b-3803-47a5-a273-267c913437f9"],

Cell["Tech Note", "Categorization",
 CellLabel->"Entity Type",
 CellID->922576852,ExpressionUUID->"7042fe64-a20a-4df0-b785-6652247a506d"],

Cell["QuantumWorkbook", "Categorization",
 CellLabel->"Paclet Name",
 CellID->917220224,ExpressionUUID->"7d3318b9-96ff-4672-9279-2d497b142241"],

Cell["QuantumWorkbook`", "Categorization",
 CellLabel->"Context",
 CellID->1082686602,ExpressionUUID->"eac397f4-c0a9-49ea-82f6-95a2a469affc"],

Cell["\<\
QuantumWorkbook/tutorial/EntanglementDistillationQuantumCircuit\
\>", "Categorization",
 CellLabel->"URI",
 CellID->1084778783,ExpressionUUID->"b41aae16-508d-44a5-a776-9cce7caec9ed"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Keywords", "KeywordsSection",
 CellID->1888326498,ExpressionUUID->"d28114cb-8478-4213-958b-143ebb77ea6c"],

Cell["quantum entanglement", "Keywords",
 CellChangeTimes->{{3.875246350297999*^9, 3.8752463543099833`*^9}},
 CellID->4154011,ExpressionUUID->"9488c803-aa06-40d8-b014-f2609e6c78ad"],

Cell["entanglement distillation", "Keywords",
 CellChangeTimes->{{3.876912562625557*^9, 3.876912566734517*^9}},
 CellID->1392519909,ExpressionUUID->"6a99109c-d29d-49be-9877-82780997f883"],

Cell["entanglement purification", "Keywords",
 CellChangeTimes->{{3.876912567758479*^9, 3.876912571557537*^9}},
 CellID->1876418771,ExpressionUUID->"e6e9998e-9aa5-4c1c-9cff-87f8e038000d"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{735, 891},
WindowMargins->{{Automatic, 234}, {Automatic, 0}},
TaggingRules-><|"Paclet" -> "QuantumWorkbook"|>,
FrontEndVersion->"13.1 for Mac OS X ARM (64-bit) (June 16, 2022)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "TechNotePageStylesExt.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"cb945e51-4e0d-41af-baba-19ef7134ea36"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 135, 1, 114, "Title",ExpressionUUID->"e3335ae1-3816-4b0a-ac1a-259ca89dd70f",
 CellID->1980526771],
Cell[718, 25, 625, 16, 27, "Text",ExpressionUUID->"60fe75fc-9244-469e-9e07-e8b1d661bdfd",
 CellID->1308734266],
Cell[1346, 43, 383, 6, 44, "Text",ExpressionUUID->"1c91212a-cb27-4a49-a2e0-caaf7a40a765",
 CellID->444601366],
Cell[1732, 51, 921, 22, 104, "DefinitionBox",ExpressionUUID->"36dce4c0-3b60-4b8b-bb7a-648a7d616204",
 CellID->1410604422],
Cell[2656, 75, 195, 2, 30, "Caption",ExpressionUUID->"03c06594-0719-45e4-bd4f-139b405618da",
 CellID->1956541321],
Cell[CellGroupData[{
Cell[2876, 81, 193, 2, 41, "MathCaption",ExpressionUUID->"e626cdff-edee-405c-9619-fd3186ec257b",
 CellID->1329022598],
Cell[3072, 85, 147, 3, 27, "Input",ExpressionUUID->"5c3cdfba-d3e5-4be2-8be5-e654424db65f",
 CellID->172539488]
}, Open  ]],
Cell[CellGroupData[{
Cell[3256, 93, 349, 6, 58, "MathCaption",ExpressionUUID->"f8b90b09-75fd-41d3-b787-db4ae55bcfa2",
 CellID->1573161274],
Cell[3608, 101, 203, 4, 27, "Input",ExpressionUUID->"26dfcfe6-26c0-4548-a0c2-ae2be1681d41",
 CellID->768251366]
}, Open  ]],
Cell[CellGroupData[{
Cell[3848, 110, 321, 8, 41, "MathCaption",ExpressionUUID->"0f4181d3-092f-4fd3-ace1-f7e04b7ffa73",
 CellID->1676761233],
Cell[4172, 120, 594, 16, 85, "Input",ExpressionUUID->"f194e1a4-d4f1-4185-adf5-f329e1d25e04",
 CellID->363452503]
}, Open  ]],
Cell[CellGroupData[{
Cell[4803, 141, 294, 7, 41, "MathCaption",ExpressionUUID->"269f75b3-05f0-4f3b-8f4a-0877703dd84e",
 CellID->1432690958],
Cell[5100, 150, 509, 14, 47, "Input",ExpressionUUID->"d399fc7a-8f68-41b8-890c-1914542401c6",
 CellID->1164469075]
}, Open  ]],
Cell[CellGroupData[{
Cell[5646, 169, 195, 2, 45, "Section",ExpressionUUID->"67eace02-e406-44a8-ac18-deb8074e746b",
 CellID->9608243],
Cell[CellGroupData[{
Cell[5866, 175, 271, 5, 58, "MathCaption",ExpressionUUID->"4455ccba-7011-4cdd-a3c0-3de7d5557c44",
 CellID->1326468628],
Cell[CellGroupData[{
Cell[6162, 184, 758, 19, 85, "Input",ExpressionUUID->"ff095bbe-fdef-474c-b90c-de4fe7dbf16a",
 CellID->424466576],
Cell[6923, 205, 1445, 35, 46, "Output",ExpressionUUID->"daf155d9-f25c-483a-af19-e44bc2715a1b",
 CellID->2048936959]
}, Open  ]],
Cell[CellGroupData[{
Cell[8405, 245, 234, 6, 27, "Input",ExpressionUUID->"c7be65ad-a30d-4db6-bee1-1f860f9a9dd9",
 CellID->1176269506],
Cell[8642, 253, 908, 26, 47, "Output",ExpressionUUID->"2a71bf32-f073-4f31-a112-db69c8bac3fd",
 CellID->597260369]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9599, 285, 249, 4, 41, "MathCaption",ExpressionUUID->"3edfed6c-bf50-4ecd-9084-d10869c27e54",
 CellID->1153639981],
Cell[CellGroupData[{
Cell[9873, 293, 838, 20, 85, "Input",ExpressionUUID->"06706e9a-b84e-4e6f-87c1-7011523ced6e",
 CellID->1509698055],
Cell[10714, 315, 1682, 38, 82, "Output",ExpressionUUID->"96419a10-6a47-403a-b029-c109eee0300e",
 CellID->22223753]
}, Open  ]],
Cell[CellGroupData[{
Cell[12433, 358, 343, 7, 47, "Input",ExpressionUUID->"dc12f677-158d-4246-9557-c7893481ec36",
 CellID->2084847387],
Cell[12779, 367, 1248, 36, 41, "Output",ExpressionUUID->"720d8840-32cf-4e49-bc1a-ca01ea4bec26",
 CellID->1998728603]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[14076, 409, 282, 5, 58, "MathCaption",ExpressionUUID->"f3934c61-3e97-4ba8-bf03-dfb369a8a3df",
 CellID->1376812949],
Cell[CellGroupData[{
Cell[14383, 418, 435, 10, 47, "Input",ExpressionUUID->"a26928a2-7adf-4dfc-b6af-d1b73235e24d",
 CellID->1003824959],
Cell[14821, 430, 892, 25, 58, "Output",ExpressionUUID->"a8c20272-05f6-469a-8f4f-ce9e22ad23b6",
 CellID->1264662883]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[15762, 461, 382, 7, 58, "MathCaption",ExpressionUUID->"20301db3-9431-4eb6-80db-fdfe37b269e5",
 CellID->70875601],
Cell[CellGroupData[{
Cell[16169, 472, 1043, 27, 142, "Input",ExpressionUUID->"49597941-f7d9-4a17-a29d-113d9875318c",
 CellID->170713811],
Cell[17215, 501, 6165, 138, 331, "Output",ExpressionUUID->"e08aa2dc-cedb-41a7-843b-13c393ee55b2",
 CellID->2050449746]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23441, 646, 122, 1, 45, "Section",ExpressionUUID->"2a853ae2-2058-412a-894e-7d95da384bfb",
 CellID->224262840],
Cell[CellGroupData[{
Cell[23588, 651, 737, 17, 27, "Text",ExpressionUUID->"48fc5445-ae2b-4f18-b082-3fca0c66c976",
 CellID->1184887274],
Cell[24328, 670, 1295, 36, 161, "Input",ExpressionUUID->"63d691f4-2331-4cc2-b31d-46d27df0de25",
 CellID->351751395]
}, Open  ]],
Cell[CellGroupData[{
Cell[25660, 711, 515, 11, 43, "MathCaption",ExpressionUUID->"83e8397c-67e1-4283-8dfe-900d952b47a9",
 CellID->2075092591],
Cell[CellGroupData[{
Cell[26200, 726, 590, 15, 85, "Input",ExpressionUUID->"d5f55e09-e0dd-4c39-ba05-d16295e1b36a",
 CellID->2010699221],
Cell[26793, 743, 3671, 73, 297, "Output",ExpressionUUID->"f6f40875-3106-4a39-a096-19a86de51ee5",
 CellID->1601417385]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[30513, 822, 221, 4, 25, "Text",ExpressionUUID->"2fdeadd1-433c-4ef3-b77b-9dfeab324f57",
 CellID->325402613],
Cell[30737, 828, 347, 9, 47, "Input",ExpressionUUID->"0c482a0e-e3b6-4886-a0bd-728c06f40347",
 CellID->1548351429],
Cell[CellGroupData[{
Cell[31109, 841, 553, 17, 47, "Input",ExpressionUUID->"53394859-0040-40fb-8179-e73fc1c198d7",
 CellID->2083116504],
Cell[31665, 860, 3581, 115, 360, "Output",ExpressionUUID->"7fcb9d78-26c6-4add-b51f-729ca5f67a39",
 CellID->1281799323]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[35295, 981, 497, 11, 60, "MathCaption",ExpressionUUID->"a9e378e2-6d5a-415c-9f6f-20ddb36eb0f3",
 CellID->1803890242],
Cell[CellGroupData[{
Cell[35817, 996, 799, 21, 66, "Input",ExpressionUUID->"79ed82a4-2741-41e7-9d18-bd88e99cf41d",
 CellID->817515057],
Cell[36619, 1019, 10654, 219, 513, "Output",ExpressionUUID->"da797127-1bf6-4e74-9900-eb1831e10ad5",
 CellID->634786279]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[47334, 1245, 176, 2, 45, "Section",ExpressionUUID->"0f894b3d-c2fd-4322-867c-318ebbf73e83",
 CellID->797821259],
Cell[47513, 1249, 1735, 39, 88, "Text",ExpressionUUID->"43916a76-a876-4e48-ad11-1940ad29c6b3",
 CellID->695573627],
Cell[49251, 1290, 283, 5, 44, "Text",ExpressionUUID->"33f1b9a2-d4ed-4ee1-8b0b-0b65a7865bde",
 CellID->1699338655],
Cell[49537, 1297, 771, 26, 31, "Text",ExpressionUUID->"be691043-e547-4f15-8e06-076fc92110c8",
 CellID->1399753132],
Cell[50311, 1325, 1424, 47, 75, "Text",ExpressionUUID->"2921f348-905f-443f-acb8-2bd0d40c2538",
 CellID->2115020286],
Cell[51738, 1374, 744, 15, 63, "Text",ExpressionUUID->"13dcc265-2807-410d-b51c-0886469ac26a",
 CellID->1996621658],
Cell[52485, 1391, 1068, 42, 40, "Text",ExpressionUUID->"f6e66ca7-5ad0-448d-9b05-837f2f8b0565",
 CellID->640737984],
Cell[53556, 1435, 574, 13, 44, "Text",ExpressionUUID->"39fb159e-2f1c-4b9d-b3d7-4545e63fee32",
 CellID->1266994926],
Cell[CellGroupData[{
Cell[54155, 1452, 233, 3, 42, "Subsection",ExpressionUUID->"3e29fedb-a31e-47cd-9806-5e721284d533",
 CellID->1145574102],
Cell[CellGroupData[{
Cell[54413, 1459, 254, 5, 41, "MathCaption",ExpressionUUID->"b628ac1d-6b05-4590-bf55-0ea77b2b73eb",
 CellID->920704413],
Cell[CellGroupData[{
Cell[54692, 1468, 270, 6, 47, "Input",ExpressionUUID->"68fbf39b-d569-4d6e-bf37-5129d1f01af0",
 CellID->989436024],
Cell[54965, 1476, 6391, 197, 53, "Output",ExpressionUUID->"3facc1ac-7d5e-4556-b9a3-4d895b961e8c",
 CellID->1321746014],
Cell[61359, 1675, 6391, 197, 53, "Output",ExpressionUUID->"e2c21c1e-1613-4794-a98e-ae7e8279c28e",
 CellID->1014412730]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[67799, 1878, 509, 12, 41, "MathCaption",ExpressionUUID->"f3616645-327d-4284-9237-a987b918be6a",
 CellID->284257392],
Cell[68311, 1892, 1609, 51, 104, "Input",ExpressionUUID->"c84f116c-1d33-4084-8a4f-47e4eba37184",
 CellID->576306453],
Cell[CellGroupData[{
Cell[69945, 1947, 229, 4, 47, "Input",ExpressionUUID->"9e830136-510d-48d5-aea5-180f42fb4c81",
 CellID->2013079378],
Cell[70177, 1953, 10993, 327, 99, "Output",ExpressionUUID->"f80fc0bb-e04d-4d1b-a496-a04f2a46ef98",
 CellID->1375489208],
Cell[81173, 2282, 10992, 327, 99, "Output",ExpressionUUID->"82ebf9d1-d138-4e71-bfa8-e1a04334f093",
 CellID->185658901]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[92214, 2615, 550, 14, 41, "MathCaption",ExpressionUUID->"79fbf475-2029-4962-a1a3-a04d211c2587",
 CellID->1601110815],
Cell[92767, 2631, 1205, 38, 85, "Input",ExpressionUUID->"c223bfaa-a713-4f39-add4-bfc4d937e57c",
 CellID->38369270],
Cell[CellGroupData[{
Cell[93997, 2673, 236, 4, 47, "Input",ExpressionUUID->"508366b2-d0f8-4ec3-acb0-71e60eeec672",
 CellID->627226790],
Cell[94236, 2679, 10946, 326, 99, "Output",ExpressionUUID->"48118471-8b01-438b-8afa-5c9c7cdfe4c8",
 CellID->1700066137],
Cell[105185, 3007, 10943, 326, 99, "Output",ExpressionUUID->"ebb5b223-3f6b-4085-80c4-9d84f8956419",
 CellID->741641224]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[116177, 3339, 242, 4, 41, "MathCaption",ExpressionUUID->"ff3cc3dd-de55-4b67-bc2d-c7770b20f6fb",
 CellID->2067394127],
Cell[CellGroupData[{
Cell[116444, 3347, 702, 21, 47, "Input",ExpressionUUID->"adf25153-dba1-4e5a-9980-9ff5af18aa23",
 CellID->1604828370],
Cell[117149, 3370, 22728, 677, 191, "Output",ExpressionUUID->"f826b036-815d-4c65-b58f-11fd6f418985",
 CellID->879738215],
Cell[139880, 4049, 22730, 677, 191, "Output",ExpressionUUID->"0590e13c-ab1a-4793-b24f-d9276c4b0f0c",
 CellID->335269910]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[162659, 4732, 290, 5, 58, "MathCaption",ExpressionUUID->"42668ab2-0ce1-4ab3-b5f6-061c7588e921",
 CellID->861429414],
Cell[CellGroupData[{
Cell[162974, 4741, 364, 8, 47, "Input",ExpressionUUID->"777e32d5-3edf-4731-b190-690cd8a34244",
 CellID->1196447817],
Cell[163341, 4751, 2495, 56, 280, "Output",ExpressionUUID->"e970d4c2-a1cf-43d0-8cc1-27e66c5642aa",
 CellID->826892984],
Cell[165839, 4809, 2496, 56, 280, "Output",ExpressionUUID->"bd05f265-781b-4eec-b567-2e07d79c8513",
 CellID->1223702351]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[168384, 4871, 214, 2, 41, "MathCaption",ExpressionUUID->"b7f29345-bc7f-4261-910a-ac3bed0a7340",
 CellID->93724021],
Cell[CellGroupData[{
Cell[168623, 4877, 418, 11, 47, "Input",ExpressionUUID->"4f8c63bd-9d60-47e7-b117-79a4a00cc407",
 CellID->428846345],
Cell[169044, 4890, 312, 5, 26, "Output",ExpressionUUID->"0d74de1c-535b-413c-b3bb-99b55e3a61d1",
 CellID->55928912],
Cell[169359, 4897, 313, 5, 26, "Output",ExpressionUUID->"cf52f5d2-bfd5-44c8-85e1-1b34fbc8c051",
 CellID->1227883175]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[169733, 4909, 242, 3, 42, "Subsection",ExpressionUUID->"5b51fd21-1a8e-40db-9ca4-2d97b1505571",
 CellID->1197910904],
Cell[CellGroupData[{
Cell[170000, 4916, 273, 5, 25, "Text",ExpressionUUID->"545d1c56-5920-45a4-8008-f1a397582884",
 CellID->368440934],
Cell[170276, 4923, 2970, 79, 370, "Input",ExpressionUUID->"70803beb-8608-48d9-ae1c-6b511526471c",
 CellID->519669879],
Cell[CellGroupData[{
Cell[173271, 5006, 368, 8, 47, "Input",ExpressionUUID->"9f81e7d2-a5a8-4b80-b0cc-79a435492494",
 CellID->584821147],
Cell[173642, 5016, 2327, 53, 280, "Output",ExpressionUUID->"c7a93294-e02a-4f1d-a7d1-398c970d047e",
 CellID->1153195534]
}, Open  ]],
Cell[175984, 5072, 522, 15, 47, "Input",ExpressionUUID->"c932492d-99be-41c1-9919-3de001f27796",
 CellID->21183722],
Cell[CellGroupData[{
Cell[176531, 5091, 350, 7, 47, "Input",ExpressionUUID->"96d6d170-0c74-4b9d-9127-3953d6b87f32",
 CellID->1721911763],
Cell[176884, 5100, 198, 3, 26, "Output",ExpressionUUID->"bc0295ad-1596-4c5b-8d2a-32e63ac68b33",
 CellID->274988639],
Cell[177085, 5105, 198, 3, 26, "Output",ExpressionUUID->"ebfe2d88-c6f4-4eab-8b68-9cd4aff08612",
 CellID->349247329]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[177356, 5116, 102, 1, 45, "Section",ExpressionUUID->"543e3914-c7ba-444b-85b0-e367e6251f35",
 CellID->1248933531],
Cell[CellGroupData[{
Cell[177483, 5121, 464, 7, 63, "Text",ExpressionUUID->"c50697db-8ea8-4dae-9698-e81518c8fd9c",
 CellID->1308352194],
Cell[CellGroupData[{
Cell[177972, 5132, 1198, 27, 104, "Input",ExpressionUUID->"bd78c7db-4888-4f7d-9d8d-d3e80a11d1f8",
 CellID->1320689739],
Cell[179173, 5161, 12584, 265, 514, "Output",ExpressionUUID->"37d0f407-084b-44d8-847f-71a4bd54813e",
 CellID->424264871]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[191806, 5432, 470, 10, 44, "Text",ExpressionUUID->"2c56d7fa-37c4-4ff3-bc38-624540bcf713",
 CellID->196356282],
Cell[192279, 5444, 880, 21, 104, "Input",ExpressionUUID->"8c92cb94-c212-4b23-9574-a551be752d7d",
 CellID->1625149782]
}, Open  ]],
Cell[CellGroupData[{
Cell[193196, 5470, 339, 8, 44, "Text",ExpressionUUID->"27cd6758-4e9a-4ab9-a03a-5d32b41fb8f2",
 CellID->47879881],
Cell[CellGroupData[{
Cell[193560, 5482, 260, 6, 27, "Input",ExpressionUUID->"525db037-2a05-40e8-8608-34b8eac855e0",
 CellID->1558275989],
Cell[193823, 5490, 7015, 204, 78, "Output",ExpressionUUID->"04f4898f-266b-4a6d-b3e1-3ba176f5d33d",
 CellID->1048442931]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[200887, 5700, 213, 4, 25, "Text",ExpressionUUID->"8a2222a2-dadb-4ac1-918b-a1d277ec715e",
 CellID->1953490389],
Cell[CellGroupData[{
Cell[201125, 5708, 400, 12, 27, "Input",ExpressionUUID->"2dd2b211-3e22-4090-b6e3-470af69d8ed0",
 CellID->1582972587],
Cell[201528, 5722, 973, 28, 47, "Output",ExpressionUUID->"9c439ae8-a6be-4eaa-a56b-24be315b7d18",
 CellID->1617276755]
}, Open  ]],
Cell[CellGroupData[{
Cell[202538, 5755, 219, 5, 27, "Input",ExpressionUUID->"6432b5d2-2ea7-4af3-844a-27333810bcf5",
 CellID->1686302499],
Cell[202760, 5762, 2031, 60, 41, "Output",ExpressionUUID->"7bef717e-1efd-4fc5-94f9-bb919461093f",
 CellID->1916130154]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[204852, 5829, 192, 2, 74, "TutorialMoreAboutSection",ExpressionUUID->"8b2ccaf6-8cab-43e2-bdc8-c590499182a0",
 CellID->1812928137],
Cell[205047, 5833, 317, 5, 24, "TutorialMoreAbout",ExpressionUUID->"8a770104-c5be-4890-a94e-63b989dc0720",
 CellID->1551876817]
}, Open  ]],
Cell[CellGroupData[{
Cell[205401, 5843, 128, 1, 74, "RelatedTutorialsSection",ExpressionUUID->"625ae735-7219-4661-b0d1-8323e57fe844",
 CellID->436993734],
Cell[205532, 5846, 313, 6, 24, "RelatedTutorials",ExpressionUUID->"de55eb4d-0b28-4dc4-8ba9-1c4f1884eeb8",
 CellID->159614598],
Cell[205848, 5854, 303, 5, 24, "RelatedTutorials",ExpressionUUID->"61b46736-1ad7-4837-b3c8-62bf16de2d9c",
 CellID->728547302],
Cell[206154, 5861, 337, 6, 24, "RelatedTutorials",ExpressionUUID->"ef77ce92-dfeb-4426-834f-4a59b4da4f5a",
 CellID->2102036812]
}, Open  ]],
Cell[CellGroupData[{
Cell[206528, 5872, 193, 2, 74, "TutorialRelatedLinksSection",ExpressionUUID->"4640f67b-3cfb-43e7-a7d2-c1f8928e1c70",
 CellID->847161968],
Cell[206724, 5876, 447, 9, 24, "TutorialRelatedLinks",ExpressionUUID->"bfef24ae-266b-4952-adb1-3f880d882881",
 CellID->90212659],
Cell[207174, 5887, 597, 13, 42, "TutorialRelatedLinks",ExpressionUUID->"57202c2e-1a2d-491f-b66d-1bc8e6794516",
 CellID->1612042109],
Cell[207774, 5902, 455, 10, 24, "TutorialRelatedLinks",ExpressionUUID->"4740f4eb-d4a7-4547-a903-2b78e4a1ed8f",
 CellID->1997366095]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[208278, 5918, 110, 1, 72, "MetadataSection",ExpressionUUID->"57723b63-0f70-40f9-82e5-a2a920be4c70",
 CellID->435473483],
Cell[208391, 5921, 716, 16, 26, "History",ExpressionUUID->"0d8a6edb-27ca-44bf-9fc9-692d232dda08",
 CellID->675385998],
Cell[CellGroupData[{
Cell[209132, 5941, 123, 1, 21, "CategorizationSection",ExpressionUUID->"4bcc2f0b-3803-47a5-a273-267c913437f9",
 CellID->1608080221],
Cell[209258, 5944, 137, 2, 34, "Categorization",ExpressionUUID->"7042fe64-a20a-4df0-b785-6652247a506d",
 CellID->922576852],
Cell[209398, 5948, 143, 2, 34, "Categorization",ExpressionUUID->"7d3318b9-96ff-4672-9279-2d497b142241",
 CellID->917220224],
Cell[209544, 5952, 141, 2, 34, "Categorization",ExpressionUUID->"eac397f4-c0a9-49ea-82f6-95a2a469affc",
 CellID->1082686602],
Cell[209688, 5956, 192, 4, 34, "Categorization",ExpressionUUID->"b41aae16-508d-44a5-a776-9cce7caec9ed",
 CellID->1084778783]
}, Open  ]],
Cell[CellGroupData[{
Cell[209917, 5965, 111, 1, 31, "KeywordsSection",ExpressionUUID->"d28114cb-8478-4213-958b-143ebb77ea6c",
 CellID->1888326498],
Cell[210031, 5968, 181, 2, 20, "Keywords",ExpressionUUID->"9488c803-aa06-40d8-b014-f2609e6c78ad",
 CellID->4154011],
Cell[210215, 5972, 187, 2, 20, "Keywords",ExpressionUUID->"6a99109c-d29d-49be-9877-82780997f883",
 CellID->1392519909],
Cell[210405, 5976, 187, 2, 20, "Keywords",ExpressionUUID->"e6e9998e-9aa5-4c1c-9cff-87f8e038000d",
 CellID->1876418771]
}, Open  ]]
}, Open  ]]
}
]
*)

