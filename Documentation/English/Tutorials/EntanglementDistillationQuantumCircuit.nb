(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    193755,       5495]
NotebookOptionsPosition[    181064,       5212]
NotebookOutlinePosition[    181585,       5230]
CellTagsIndexPosition[    181542,       5227]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Entanglement Distillation: Quantum Circuit", "Title",
 CellID->1980526771,ExpressionUUID->"e3335ae1-3816-4b0a-ac1a-259ca89dd70f"],

Cell[TextData[{
 "See also Section 7.3 of the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Quantum Workbook (Springer, 2022)"]], 
    "https://doi.org/10.1007/978-3-030-91214-7"},
   "WebLink",
   BaseStyle->{"Text"}]],ExpressionUUID->
  "6648762d-56e2-458a-bc38-569401efc123"],
 "."
}], "Text",
 CellChangeTimes->{{3.850949404528584*^9, 3.8509494045768213`*^9}, {
  3.85097300684938*^9, 3.850973008015355*^9}, {3.852926047963835*^9, 
  3.852926050054385*^9}, {3.8752460830525627`*^9, 3.8752460850662327`*^9}},
 TextAlignment->"Right",
 CellID->1308734266,ExpressionUUID->"60fe75fc-9244-469e-9e07-e8b1d661bdfd"],

Cell["\<\
Here, we start with a number of partially entangled pairs and \
\[OpenCurlyDoubleQuote]distills\[CloseCurlyDoubleQuote] a smaller number of \
maximally entangled pairs. This is illustrated in the quantum circuit model.\
\>", "Text",
 CellChangeTimes->{{3.876912516101638*^9, 3.876912528215394*^9}},
 CellID->444601366,ExpressionUUID->"1c91212a-cb27-4a49-a2e0-caaf7a40a765"],

Cell[BoxData[GridBox[{
   {
    ButtonBox["VonNeumannEntropy",
     BaseStyle->"Link",
     ButtonData->"paclet:Q3/ref/VonNeumannEntropy"], Cell[
    "VonNeumann entropy of a mixed state", "TableText",ExpressionUUID->
     "edb04415-527a-488f-bc87-26cf536cd3dc"]},
   {
    ButtonBox["PartialTrace",
     BaseStyle->"Link",
     ButtonData->"paclet:Q3/ref/PartialTrace"], Cell[
    "Partial trace over some subsystems", "TableText",ExpressionUUID->
     "3dfef7b8-445d-4369-abf4-1e0dc9c9556c"]},
   {
    ButtonBox["Dyad",
     BaseStyle->"Link",
     ButtonData->"paclet:Q3/ref/Dyad"], Cell[
    "Dyadic product of two vectors", "TableText",ExpressionUUID->
     "a42dc33d-7165-4ab1-8cfa-bb15b4fa6f2f"]}
  }]], "DefinitionBox",
 CellChangeTimes->{{3.875245913898039*^9, 3.8752459510469427`*^9}, {
  3.875246193969157*^9, 3.875246269439661*^9}},
 CellID->1410604422,ExpressionUUID->"36dce4c0-3b60-4b8b-bb7a-648a7d616204"],

Cell["Functions used in this document.", "Caption",
 CellChangeTimes->{{3.8752461994779053`*^9, 3.875246209864244*^9}},
 CellID->1956541321,ExpressionUUID->"03c06594-0719-45e4-bd4f-139b405618da"],

Cell[CellGroupData[{

Cell["Make sure that Q3 is loaded.", "MathCaption",
 CellChangeTimes->{{3.876912626253722*^9, 3.876912634327948*^9}},
 CellID->1329022598,ExpressionUUID->"e626cdff-edee-405c-9619-fd3186ec257b"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[342]:=",
 CellID->172539488,ExpressionUUID->"5c3cdfba-d3e5-4be2-8be5-e654424db65f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
We have two parties Alice (A) and Bob (B). Teddy (T)  is an ancillary \
register to perform a measurement of the total Pauli Z.\
\>", "MathCaption",
 CellChangeTimes->{{3.876912645026947*^9, 3.876912699130384*^9}, {
  3.876912901870419*^9, 3.876912940895978*^9}},
 CellID->1573161274,ExpressionUUID->"f8b90b09-75fd-41d3-b787-db4ae55bcfa2"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "A", ",", "B", ",", "T"}], "]"}]], "Input",
 CellLabel->"In[360]:=",
 CellID->768251366,ExpressionUUID->"26dfcfe6-26c0-4548-a0c2-ae2be1681d41"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "We will start with ",
 StyleBox["n",
  FontSlant->"Italic"],
 " partially entangled pairs."
}], "MathCaption",
 CellChangeTimes->{{3.876913066708404*^9, 3.876913078504644*^9}, {
  3.8769131176279287`*^9, 3.876913118233914*^9}},
 CellID->1676761233,ExpressionUUID->"0f4181d3-092f-4fd3-ace1-f7e04b7ffa73"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kk", "=", 
   RowBox[{"Range", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AA", "=", 
   RowBox[{"A", "[", 
    RowBox[{"kk", ",", "None"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BB", "=", 
   RowBox[{"B", "[", 
    RowBox[{"kk", ",", "None"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.87691295413769*^9, 3.8769129562909327`*^9}},
 CellLabel->"In[367]:=",
 CellID->363452503,ExpressionUUID->"f194e1a4-d4f1-4185-adf5-f329e1d25e04"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "You need fewer qubits for T, just enough to store the maximum number ",
 StyleBox["n",
  FontSlant->"Italic"],
 ". "
}], "MathCaption",
 CellChangeTimes->{{3.87691297630866*^9, 3.876913055055799*^9}},
 CellID->1432690958,ExpressionUUID->"269f75b3-05f0-4f3b-8f4a-0877703dd84e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ln", "=", 
   RowBox[{"Ceiling", "@", 
    RowBox[{"Log", "[", 
     RowBox[{"2", ",", 
      RowBox[{"$n", "+", "1"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TT", "=", 
   RowBox[{"T", "[", 
    RowBox[{
     RowBox[{"Range", "@", "ln"}], ",", "None"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.87691295413769*^9, 3.876912957430442*^9}},
 CellLabel->"In[371]:=",
 CellID->1164469075,ExpressionUUID->"d399fc7a-8f68-41b8-890c-1914542401c6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["To Generate Partially Entangled Pairs", "Section",
 CellChangeTimes->{{3.876913131574313*^9, 3.876913138423706*^9}},
 CellID->9608243,ExpressionUUID->"67eace02-e406-44a8-ac18-deb8074e746b"],

Cell[CellGroupData[{

Cell["\<\
First construct a superposition with different amplitudes for the two \
computational basis states.\
\>", "MathCaption",
 CellChangeTimes->{{3.87691319054813*^9, 3.876913249867708*^9}},
 CellID->1326468628,ExpressionUUID->"4455ccba-7011-4cdd-a3c0-3de7d5557c44"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"A", "[", "1", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Rotation", "[", 
     RowBox[{
      RowBox[{"Pi", "/", "3"}], ",", 
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "2"}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[378]:=",
 CellID->424466576,ExpressionUUID->"ff095bbe-fdef-474c-b90c-de4fe7dbf16a"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, LineBox[{{{0, -1}, {2, -1}}}], 
   InsetBox[
    StyleBox[
     TemplateBox[{"0"},
      "Ket"],
     StripOnInput->False,
     FontSize->Scaled[0.16000000000000003`],
     FontWeight->"Light"], {-0.1, -1}, NCache[
    ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], {
    {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
    LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
     0.6, -1.4}}], InsetBox[
     StyleBox[
      SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
      StripOnInput->False,
      FontSize->Scaled[0.2],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
  ImageSize->118.8,
  PlotRange->NCache[{Full, {
      Rational[-3, 2], 
      Rational[-1, 2]}}, {Full, {-1.5, -0.5}}],
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.876913140801437*^9, 3.8769131798396683`*^9}, 
   3.8769132520638514`*^9},
 CellLabel->"Out[378]=",
 CellID->1508632545,ExpressionUUID->"1a6fc3a0-153c-41da-9ce5-6d3488323bf1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Elaborate", "[", "qc", "]"}], "//", "ExpandAll"}], "//", 
  "LogicalForm"}]], "Input",
 CellLabel->"In[379]:=",
 CellID->1176269506,ExpressionUUID->"c7be65ad-a30d-4db6-bee1-1f860f9a9dd9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   SqrtBox["3"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], "2"]}]], "Output",
 CellChangeTimes->{{3.8769131688566933`*^9, 3.876913180501377*^9}, 
   3.8769132528407*^9},
 CellLabel->"Out[379]=",
 CellID->579262379,ExpressionUUID->"16ac89bb-3594-4e02-bb0c-3912b2445a3a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Then, by applying the CNOT gate, you can create a partially entangled pair.\
\>", "MathCaption",
 CellChangeTimes->{{3.8769133051661263`*^9, 3.87691332837848*^9}},
 CellID->1153639981,ExpressionUUID->"3edfed6c-bf50-4ecd-9084-d10869c27e54"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"A", "[", "1", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Rotation", "[", 
     RowBox[{
      RowBox[{"Pi", "/", "3"}], ",", 
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "2"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ",", 
      RowBox[{"B", "[", "1", "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.876913342721538*^9, 3.876913349385829*^9}},
 CellLabel->"In[380]:=",
 CellID->1509698055,ExpressionUUID->"06706e9a-b84e-4e6f-87c1-7011523ced6e"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], InsetBox[
    StyleBox[
     TemplateBox[{"0"},
      "Ket"],
     StripOnInput->False,
     FontSize->Scaled[0.10666666666666667`],
     FontWeight->"Light"], {-0.1, -1}, NCache[
    ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], {
    {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
    LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
     0.6, -1.4}}], InsetBox[
     StyleBox[
      SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
  ImageSize->154.79999999999998`,
  PlotRange->NCache[{Full, {
      Rational[-5, 2], 
      Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{3.8769133498441896`*^9},
 CellLabel->"Out[380]=",
 CellID->702936330,ExpressionUUID->"6f480c8b-0f95-4ff5-9b42-bdc36a7c825c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Elaborate", "[", "qc", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", "out", "]"}]}], "Input",
 CellChangeTimes->{{3.876913353301922*^9, 3.876913361197649*^9}},
 CellLabel->"In[383]:=",
 CellID->2084847387,ExpressionUUID->"dc12f677-158d-4246-9557-c7893481ec36"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   SqrtBox["3"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{{3.8769133614994*^9, 3.8769133646660337`*^9}},
 CellLabel->"Out[384]=",
 CellID->2042969412,ExpressionUUID->"9b55fd01-33ee-400f-b19b-7f802d4a1eca"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Repeating the above procedure for other pairs, generate as many partially \
entangled pairs as  you like. In this example, we prepare four pairs.\
\>", "MathCaption",
 CellChangeTimes->{{3.8769133722392273`*^9, 3.8769134369362707`*^9}},
 CellID->70875601,ExpressionUUID->"20301db3-9431-4eb6-80db-fdfe37b269e5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc0", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", "AA"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", "BB"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Rotation", "[", 
     RowBox[{
      RowBox[{"Pi", "/", "3"}], ",", 
      RowBox[{"A", "[", 
       RowBox[{"kk", ",", "2"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"Thread", "@", 
      RowBox[{"CNOT", "[", 
       RowBox[{"AA", ",", "BB"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"A", "[", 
      RowBox[{"$n", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[386]:=",
 CellID->170713811,ExpressionUUID->"49597941-f7d9-4a17-a29d-113d9875318c"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}, {{
    0, -4}, {6, -4}}, {{0, -6}, {6, -6}}, {{0, -7}, {6, -7}}, {{0, -8}, {
    6, -8}}, {{0, -9}, {6, -9}}}], {{InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.05333333333333334],
       FontWeight->"Light"], {-0.1, -1}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.05333333333333334],
       FontWeight->"Light"], {-0.1, -2}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.05333333333333334],
       FontWeight->"Light"], {-0.1, -3}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.05333333333333334],
       FontWeight->"Light"], {-0.1, -4}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.05333333333333334],
       FontWeight->"Light"], {-0.1, -6}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.05333333333333334],
       FontWeight->"Light"], {-0.1, -7}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.05333333333333334],
       FontWeight->"Light"], {-0.1, -8}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.05333333333333334],
       FontWeight->"Light"], {-0.1, -9}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}}, {{
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, 
     LineBox[{{0.6, -3.4}, {1.4, -3.4}, {1.4, -2.6}, {0.6, -2.6}, {
      0.6, -3.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, 
     LineBox[{{0.6, -4.4}, {1.4, -4.4}, {1.4, -3.6}, {0.6, -3.6}, {
      0.6, -4.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}}, {LineBox[{{2, -1}, {2, -6}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -6}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -6}, {2.2666666666666666`, -6}}, {{
        2, -6.266666666666667}, {2, -5.733333333333333}}}]}}, {
    LineBox[{{3, -2}, {3, -7}}], 
    DiskBox[{3, -2}, 0.09], {CircleBox[{3, -7}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -7}, {3.2666666666666666`, -7}}, {{
        3, -7.266666666666667}, {3, -6.733333333333333}}}]}}, {
    LineBox[{{4, -3}, {4, -8}}], 
    DiskBox[{4, -3}, 0.09], {CircleBox[{4, -8}, 0.26666666666666666], 
     LineBox[{{{3.7333333333333334`, -8}, {4.266666666666667, -8}}, {{
        4, -8.266666666666667}, {4, -7.733333333333333}}}]}}, {
    LineBox[{{5, -4}, {5, -9}}], 
    DiskBox[{5, -4}, 0.09], {CircleBox[{5, -9}, 0.26666666666666666], 
     LineBox[{{{4.733333333333333, -9}, {5.266666666666667, -9}}, {{
        5, -9.266666666666667}, {5, -8.733333333333333}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
  ImageSize->262.8,
  PlotRange->NCache[{Full, {
      Rational[-19, 2], 
      Rational[-1, 2]}}, {Full, {-9.5, -0.5}}],
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.87691343168961*^9, 3.876913439112975*^9}},
 CellLabel->"Out[386]=",
 CellID->771749506,ExpressionUUID->"2f60e055-8ca8-47f5-a444-3ea48767e56f"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Measurement of Total Pauli Z", "Section",
 CellID->224262840,ExpressionUUID->"2a853ae2-2058-412a-894e-7d95da384bfb"],

Cell[CellGroupData[{

Cell[TextData[{
 "We need to measure ",
 Cell[BoxData[Cell[TextData[Cell[BoxData[
   FormBox[
    RowBox[{
     SubscriptBox["Z", "tot"], ":=", 
     RowBox[{
      SubscriptBox["Z", "1"], "+", 
      SubscriptBox["Z", "2"], "+", "\[Ellipsis]", "+", 
      SubscriptBox["Z", "n"]}]}], TraditionalForm]],ExpressionUUID->
   "7bbcced6-851c-44a9-9be8-484a27dc4540"]],ExpressionUUID->
   "69787956-9626-4928-a81f-683e7deac14b"]],ExpressionUUID->
  "83d30246-6808-479b-a079-93c3675b04f1"],
 "on Bob's (or, equivalently, Alice's) qubits."
}], "Text",
 CellChangeTimes->{{3.876913449951779*^9, 3.876913455682701*^9}, {
  3.876913504724951*^9, 3.8769135283212643`*^9}},
 CellID->1184887274,ExpressionUUID->"48fc5445-ae2b-4f18-b082-3fca0c66c976"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bundle", "[", "]"}], ":=", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"bundle", "[", "p", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", "$n"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bundle", "[", "p_", "]"}], ":=", 
  RowBox[{"With", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"logp", "=", 
      RowBox[{"Ceiling", "@", 
       RowBox[{"Log", "[", 
        RowBox[{"2", ",", 
         RowBox[{"p", "+", "1"}]}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CNOT", "[", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{
          RowBox[{"T", "@", 
           RowBox[{"Range", "[", 
            RowBox[{"k", "-", "1"}], "]"}]}], ",", 
          RowBox[{"B", "[", "p", "]"}]}], "]"}], ",", 
        RowBox[{"T", "[", "k", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"k", ",", "logp", ",", "1", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->"In[387]:=",
 CellID->351751395,ExpressionUUID->"63d691f4-2331-4cc2-b31d-46d27df0de25"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The value of ",
 Cell[BoxData[Cell[TextData[Cell[BoxData[
   FormBox[
    SubscriptBox["Z", "tot"], TraditionalForm]],ExpressionUUID->
   "8e95616a-a134-4201-96bb-ec4c490eab26"]],ExpressionUUID->
   "7410e034-03a5-456f-85a8-e2c04028fdaf"]],ExpressionUUID->
  "516334db-a950-41ea-8345-2cd7700a78c6"],
 " is stored on Teddy's register."
}], "MathCaption",
 CellChangeTimes->{{3.876913556837555*^9, 3.8769136287401648`*^9}},
 CellID->2075092591,ExpressionUUID->"83e8397c-67e1-4283-8dfe-900d952b47a9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", "TT"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"bundle", "[", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"B", "[", 
      RowBox[{"$n", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellLabel->"In[395]:=",
 CellID->2010699221,ExpressionUUID->"d5f55e09-e0dd-4c39-ba05-d16295e1b36a"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {9, -1}}, {{0, -2}, {9, -2}}, {{0, -3}, {9, -3}}, {{
    0, -4}, {9, -4}}, {{0, -6}, {9, -6}}, {{0, -7}, {9, -7}}, {{0, -8}, {
    9, -8}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.035555555555555556`],
      FontWeight->"Light"], {-0.1, -6}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.035555555555555556`],
      FontWeight->"Light"], {-0.1, -7}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.035555555555555556`],
      FontWeight->"Light"], {-0.1, -8}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {
    LineBox[{{1, -1}, {1, -6}}], 
    DiskBox[{1, -1}, 0.09], {CircleBox[{1, -6}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -6}, {1.2666666666666666`, -6}}, {{
        1, -6.266666666666667}, {1, -5.733333333333333}}}]}}, {
    LineBox[{{2, -2}, {2, -6}, {2, -7}}], DiskBox[{2, -2}, 0.09], 
    DiskBox[{2, -6}, 0.09], {CircleBox[{2, -7}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -7}, {2.2666666666666666`, -7}}, {{
        2, -7.266666666666667}, {2, -6.733333333333333}}}]}}, {
    LineBox[{{3, -2}, {3, -6}}], 
    DiskBox[{3, -2}, 0.09], {CircleBox[{3, -6}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -6}, {3.2666666666666666`, -6}}, {{
        3, -6.266666666666667}, {3, -5.733333333333333}}}]}}, {
    LineBox[{{4, -3}, {4, -6}, {4, -7}}], DiskBox[{4, -3}, 0.09], 
    DiskBox[{4, -6}, 0.09], {CircleBox[{4, -7}, 0.26666666666666666], 
     LineBox[{{{3.7333333333333334`, -7}, {4.266666666666667, -7}}, {{
        4, -7.266666666666667}, {4, -6.733333333333333}}}]}}, {
    LineBox[{{5, -3}, {5, -6}}], 
    DiskBox[{5, -3}, 0.09], {CircleBox[{5, -6}, 0.26666666666666666], 
     LineBox[{{{4.733333333333333, -6}, {5.266666666666667, -6}}, {{
        5, -6.266666666666667}, {5, -5.733333333333333}}}]}}, {
    LineBox[{{6, -4}, {6, -6}, {6, -7}, {6, -8}}], DiskBox[{6, -4}, 0.09], 
    DiskBox[{6, -6}, 0.09], 
    DiskBox[{6, -7}, 0.09], {CircleBox[{6, -8}, 0.26666666666666666], 
     LineBox[{{{5.733333333333333, -8}, {6.266666666666667, -8}}, {{
        6, -8.266666666666667}, {6, -7.733333333333333}}}]}}, {
    LineBox[{{7, -4}, {7, -6}, {7, -7}}], DiskBox[{7, -4}, 0.09], 
    DiskBox[{7, -6}, 0.09], {CircleBox[{7, -7}, 0.26666666666666666], 
     LineBox[{{{6.733333333333333, -7}, {7.266666666666667, -7}}, {{
        7, -7.266666666666667}, {7, -6.733333333333333}}}]}}, {
    LineBox[{{8, -4}, {8, -6}}], 
    DiskBox[{8, -4}, 0.09], {CircleBox[{8, -6}, 0.26666666666666666], 
     LineBox[{{{7.733333333333333, -6}, {8.266666666666667, -6}}, {{
        8, -6.266666666666667}, {8, -5.733333333333333}}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
  ImageSize->370.8,
  PlotRange->NCache[{Full, {
      Rational[-17, 2], 
      Rational[-1, 2]}}, {Full, {-8.5, -0.5}}],
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{
  3.876913542454103*^9, {3.876913630152197*^9, 3.876913643892964*^9}},
 CellLabel->"Out[395]=",
 CellID->1448005656,ExpressionUUID->"7265aff3-c743-4891-8c48-1a5d068abf5f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Let us check that the above quantum circuit indeed gives the sum of the bit \
values of the Bob\[CloseCurlyQuote]s qubits.\
\>", "Text",
 CellID->325402613,ExpressionUUID->"2fdeadd1-433c-4ef3-b77b-9dfeab324f57"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", "BB", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qc1", "**", "in"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.8769136475299664`*^9},
 CellLabel->"In[396]:=",
 CellID->1548351429,ExpressionUUID->"0c482a0e-e3b6-4886-a0bd-728c06f40347"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sum", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"FromDigits", "[", 
      RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", 
    RowBox[{"Reverse", "/@", 
     RowBox[{"Through", "[", 
      RowBox[{"out", "[", "TT", "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"SimpleForm", "[", "in", "]"}], "->", "sum"}], "]"}], "//", 
  "TableForm"}]}], "Input",
 CellLabel->"In[398]:=",
 CellID->2083116504,ExpressionUUID->"53394859-0040-40fb-8179-e73fc1c198d7"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"0", "0", "0", "0"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "0"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"0", "0", "0", "1"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "1"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"0", "0", "1", "0"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "1"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"0", "0", "1", "1"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "2"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"0", "1", "0", "0"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "1"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"0", "1", "0", "1"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "2"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"0", "1", "1", "0"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "2"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"0", "1", "1", "1"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "3"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"1", "0", "0", "0"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "1"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"1", "0", "0", "1"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "2"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"1", "0", "1", "0"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "2"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"1", "0", "1", "1"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "3"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"1", "1", "0", "0"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "2"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"1", "1", "0", "1"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "3"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"1", "1", "1", "0"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "3"}]},
     {
      RowBox[{
       TemplateBox[{
         TemplateBox[{
           TemplateBox[{"1", "1", "1", "1"}, "RowDefault"]}, "RowDefault"]},
        "Ket"], "\[Rule]", "4"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.876913636697982*^9, 3.876913649601081*^9}},
 CellLabel->"Out[399]//TableForm=",
 CellID->2092491683,ExpressionUUID->"87fd5014-b145-49f2-bb07-f5e8aa6b552f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "In actual situation, one must perform the measurement on Teddy's register \
in the computational basis. The measurement outcome refers to the value of ",
 Cell[BoxData[
  SubscriptBox[
   StyleBox["Z",
    FontSlant->"Italic"], "tot"]], "InlineFormula",
  FormatType->StandardForm,ExpressionUUID->
  "e5d11078-7437-4a42-aacf-d2a38b562134"],
 "."
}], "MathCaption",
 CellChangeTimes->{{3.87691366594163*^9, 3.8769137506548767`*^9}},
 CellID->1803890242,ExpressionUUID->"a9e378e2-6d5a-415c-9f6f-20ddb36eb0f3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"$n", "+", 
         RowBox[{"1", "/", "2"}]}], "]"}], ",", 
       RowBox[{"B", "[", 
        RowBox[{"$n", "+", 
         RowBox[{"1", "/", "2"}]}], "]"}], ",", 
       RowBox[{"T", "[", "5", "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
    "qc0", ",", "\"\<Separator\>\"", ",", "qc1", ",", "\"\<Spacer\>\"", ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"T", "[", 
      RowBox[{
       RowBox[{"Range", "@", "ln"}], ",", "3"}], "]"}], "]"}]}], 
   "]"}]}]], "Input",
 CellLabel->"In[400]:=",
 CellID->817515057,ExpressionUUID->"79ed82a4-2741-41e7-9d18-bd88e99cf41d"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{16, -11}, {17, -11}}, {{16, -12}, {17, -12}}, {{16, -13}, {
     17, -13}}}]}, 
   LineBox[{{{0, -1}, {17, -1}}, {{0, -2}, {17, -2}}, {{0, -3}, {17, -3}}, {{
    0, -4}, {17, -4}}, {{0, -6}, {17, -6}}, {{0, -7}, {17, -7}}, {{0, -8}, {
    17, -8}}, {{0, -9}, {17, -9}}, {{0, -11}, {16, -11}}, {{0, -12}, {
    16, -12}}, {{0, -13}, {16, -13}}}], {{InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.018823529411764708`],
       FontWeight->"Light"], {-0.1, -11}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.018823529411764708`],
       FontWeight->"Light"], {-0.1, -12}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.018823529411764708`],
       FontWeight->"Light"], {-0.1, -13}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.018823529411764708`],
       FontWeight->"Light"], {-0.1, -1}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.018823529411764708`],
       FontWeight->"Light"], {-0.1, -2}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.018823529411764708`],
       FontWeight->"Light"], {-0.1, -3}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.018823529411764708`],
       FontWeight->"Light"], {-0.1, -4}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.018823529411764708`],
       FontWeight->"Light"], {-0.1, -6}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.018823529411764708`],
       FontWeight->"Light"], {-0.1, -7}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.018823529411764708`],
       FontWeight->"Light"], {-0.1, -8}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.018823529411764708`],
       FontWeight->"Light"], {-0.1, -9}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}}, {{
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, 
     LineBox[{{0.6, -3.4}, {1.4, -3.4}, {1.4, -2.6}, {0.6, -2.6}, {
      0.6, -3.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, 
     LineBox[{{0.6, -4.4}, {1.4, -4.4}, {1.4, -3.6}, {0.6, -3.6}, {
      0.6, -4.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}}, {LineBox[{{2, -1}, {2, -6}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -6}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -6}, {2.2666666666666666`, -6}}, {{
        2, -6.266666666666667}, {2, -5.733333333333333}}}]}}, {
    LineBox[{{3, -2}, {3, -7}}], 
    DiskBox[{3, -2}, 0.09], {CircleBox[{3, -7}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -7}, {3.2666666666666666`, -7}}, {{
        3, -7.266666666666667}, {3, -6.733333333333333}}}]}}, {
    LineBox[{{4, -3}, {4, -8}}], 
    DiskBox[{4, -3}, 0.09], {CircleBox[{4, -8}, 0.26666666666666666], 
     LineBox[{{{3.7333333333333334`, -8}, {4.266666666666667, -8}}, {{
        4, -8.266666666666667}, {4, -7.733333333333333}}}]}}, {
    LineBox[{{5, -4}, {5, -9}}], 
    DiskBox[{5, -4}, 0.09], {CircleBox[{5, -9}, 0.26666666666666666], 
     LineBox[{{{4.733333333333333, -9}, {5.266666666666667, -9}}, {{
        5, -9.266666666666667}, {5, -8.733333333333333}}}]}}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{6, Rational[-29, 2]}, {6, Rational[-1, 2]}}, {{
       6, -14.5}, {6, -0.5}}]]}, {LineBox[{{7, -6}, {7, -11}}], 
    DiskBox[{7, -6}, 0.09], {CircleBox[{7, -11}, 0.26666666666666666], 
     LineBox[{{{6.733333333333333, -11}, {7.266666666666667, -11}}, {{
        7, -11.266666666666667`}, {7, -10.733333333333333`}}}]}}, {
    LineBox[{{8, -7}, {8, -11}, {8, -12}}], DiskBox[{8, -7}, 0.09], 
    DiskBox[{8, -11}, 0.09], {CircleBox[{8, -12}, 0.26666666666666666], 
     LineBox[{{{7.733333333333333, -12}, {8.266666666666667, -12}}, {{
        8, -12.266666666666667`}, {8, -11.733333333333333`}}}]}}, {
    LineBox[{{9, -7}, {9, -11}}], 
    DiskBox[{9, -7}, 0.09], {CircleBox[{9, -11}, 0.26666666666666666], 
     LineBox[{{{8.733333333333333, -11}, {9.266666666666667, -11}}, {{
        9, -11.266666666666667`}, {9, -10.733333333333333`}}}]}}, {
    LineBox[{{10, -8}, {10, -11}, {10, -12}}], DiskBox[{10, -8}, 0.09], 
    DiskBox[{10, -11}, 0.09], {CircleBox[{10, -12}, 0.26666666666666666], 
     LineBox[{{{9.733333333333333, -12}, {10.266666666666667`, -12}}, {{
        10, -12.266666666666667`}, {10, -11.733333333333333`}}}]}}, {
    LineBox[{{11, -8}, {11, -11}}], 
    DiskBox[{11, -8}, 0.09], {CircleBox[{11, -11}, 0.26666666666666666], 
     LineBox[{{{10.733333333333333`, -11}, {11.266666666666667`, -11}}, {{
        11, -11.266666666666667`}, {11, -10.733333333333333`}}}]}}, {
    LineBox[{{12, -9}, {12, -11}, {12, -12}, {12, -13}}], 
    DiskBox[{12, -9}, 0.09], DiskBox[{12, -11}, 0.09], 
    DiskBox[{12, -12}, 0.09], {CircleBox[{12, -13}, 0.26666666666666666], 
     LineBox[{{{11.733333333333333`, -13}, {12.266666666666667`, -13}}, {{
        12, -13.266666666666667`}, {12, -12.733333333333333`}}}]}}, {
    LineBox[{{13, -9}, {13, -11}, {13, -12}}], DiskBox[{13, -9}, 0.09], 
    DiskBox[{13, -11}, 0.09], {CircleBox[{13, -12}, 0.26666666666666666], 
     LineBox[{{{12.733333333333333`, -12}, {13.266666666666667`, -12}}, {{
        13, -12.266666666666667`}, {13, -11.733333333333333`}}}]}}, {
    LineBox[{{14, -9}, {14, -11}}], 
    DiskBox[{14, -9}, 0.09], {CircleBox[{14, -11}, 0.26666666666666666], 
     LineBox[{{{13.733333333333333`, -11}, {14.266666666666667`, -11}}, {{
        14, -11.266666666666667`}, {14, -10.733333333333333`}}}]}}, {{{
      {GrayLevel[1], EdgeForm[None], 
       RectangleBox[{15.6, -11.4}, {16.4, -10.6}]}, 
      LineBox[{{15.6, -11.4}, {16.4, -11.4}, {16.4, -10.6}, {15.6, -10.6}, {
       15.6, -11.4}}]}, 
     CircleBox[{16, -11.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{16, -11.2}, {16.24, -10.76}}]}, {{
      {GrayLevel[1], EdgeForm[None], 
       RectangleBox[{15.6, -12.4}, {16.4, -11.6}]}, 
      LineBox[{{15.6, -12.4}, {16.4, -12.4}, {16.4, -11.6}, {15.6, -11.6}, {
       15.6, -12.4}}]}, 
     CircleBox[{16, -12.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{16, -12.2}, {16.24, -11.76}}]}, {{
      {GrayLevel[1], EdgeForm[None], 
       RectangleBox[{15.6, -13.4}, {16.4, -12.6}]}, 
      LineBox[{{15.6, -13.4}, {16.4, -13.4}, {16.4, -12.6}, {15.6, -12.6}, {
       15.6, -13.4}}]}, 
     CircleBox[{16, -13.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{16, -13.2}, {16.24, -12.76}}]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
  ImageSize->658.8000000000001,
  PlotRange->NCache[{Full, {
      Rational[-29, 2], 
      Rational[-1, 2]}}, {Full, {-14.5, -0.5}}],
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{3.876913758350912*^9},
 CellLabel->"Out[400]=",
 CellID->1866944612,ExpressionUUID->"b4df19e4-73b8-405c-93ed-75b13f3cf559"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transformation", "Section",
 CellChangeTimes->{{3.876913773943345*^9, 3.8769137775015087`*^9}},
 CellID->797821259,ExpressionUUID->"0f894b3d-c2fd-4322-867c-318ebbf73e83"],

Cell[CellGroupData[{

Cell[TextData[{
 "The post-measurement state is spread over the four qubits of Alice's and \
Bob's registers, respectively. One has to transform it into a smaller number \
pairs. Here, we assume that the measurement outcome is ",
 Cell[BoxData[Cell[TextData[Cell[BoxData[
   FormBox[
    RowBox[{
     SubscriptBox["Z", "tot"], "=", "3"}], TraditionalForm]],ExpressionUUID->
   "72baf89f-33d0-460c-acf5-c2a7015f20ba"]],ExpressionUUID->
   "632d69de-81c9-4edd-96a7-4c1babad198f"]],ExpressionUUID->
  "218e5a54-79ea-467a-b69a-a57d59b2b2af"],
 ", corresponding to two maximally entangled pairs."
}], "Text",
 CellChangeTimes->{{3.87691378303883*^9, 3.8769138199412518`*^9}, {
  3.876913850654917*^9, 3.876913869014278*^9}, {3.8769139448650513`*^9, 
  3.876914124620406*^9}},
 CellID->695573627,ExpressionUUID->"43916a76-a876-4e48-ad11-1940ad29c6b3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"bsA", "=", 
  RowBox[{"Basis", "[", "AA", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"bsB", "=", 
  RowBox[{"Basis", "[", "BB", "]"}]}]}], "Input",
 CellLabel->"In[404]:=",
 CellID->989436024,ExpressionUUID->"68fbf39b-d569-4d6e-bf37-5129d1f01af0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"\[SpaceIndicator]\""},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "}"}]], "Output",
 CellChangeTimes->{{3.876914126760735*^9, 3.876914130254706*^9}},
 CellLabel->"Out[404]=",
 CellID->1038342713,ExpressionUUID->"bb9bca4c-8a5c-44d9-881a-762277b9a9e7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"\[SpaceIndicator]\""},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "}"}]], "Output",
 CellChangeTimes->{{3.876914126760735*^9, 3.876914130270671*^9}},
 CellLabel->"Out[405]=",
 CellID->973861869,ExpressionUUID->"9a6f1739-7d16-4737-8ab3-78981595456c"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{"Permutations", "[", 
    RowBox[{"PadRight", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"1", ",", "3"}], "]"}], ",", "$n"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sppA", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"AA", "->", "#"}], "]"}], "&"}], "/@", "bb"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sppB", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"BB", "->", "#"}], "]"}], "&"}], "/@", "bb"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sppA", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"sppA", ",", 
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{"Complement", "[", 
        RowBox[{"bsA", ",", "sppA"}], "]"}], ",", 
       RowBox[{
        RowBox[{"LogicalForm", "[", 
         RowBox[{"#", ",", "AA"}], "]"}], "&"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sppB", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"sppB", ",", 
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{"Complement", "[", 
        RowBox[{"bsB", ",", "sppB"}], "]"}], ",", 
       RowBox[{
        RowBox[{"LogicalForm", "[", 
         RowBox[{"#", ",", "BB"}], "]"}], "&"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.876914156272278*^9, 3.876914201781519*^9}, {
  3.876914251549748*^9, 3.876914251943233*^9}},
 CellLabel->"In[435]:=",
 CellID->576306453,ExpressionUUID->"c84f116c-1d33-4084-8a4f-47e4eba37184"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"sppA", "//", "LogicalForm"}], "\[IndentingNewLine]", 
 RowBox[{"sppB", "//", "LogicalForm"}]}], "Input",
 CellLabel->"In[440]:=",
 CellID->2013079378,ExpressionUUID->"9e830136-510d-48d5-aea5-180f42fb4c81"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "}"}]], "Output",
 CellChangeTimes->{3.876914140589252*^9, 3.8769142535451927`*^9},
 CellLabel->"Out[440]=",
 CellID->1355544921,ExpressionUUID->"27929e84-3a43-4ac7-b85a-563233d9d128"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "}"}]], "Output",
 CellChangeTimes->{3.876914140589252*^9, 3.876914253570643*^9},
 CellLabel->"Out[441]=",
 CellID->2136959871,ExpressionUUID->"09853817-dc24-4fa9-a5a7-c01dac492c12"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"newA", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"A", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"newB", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"B", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"newA", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"newA", ",", 
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{"Complement", "[", 
        RowBox[{"bsA", ",", "newA"}], "]"}], ",", 
       RowBox[{
        RowBox[{"LogicalForm", "[", 
         RowBox[{"#", ",", "AA"}], "]"}], "&"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"newB", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"newB", ",", 
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{"Complement", "[", 
        RowBox[{"bsB", ",", "newB"}], "]"}], ",", 
       RowBox[{
        RowBox[{"LogicalForm", "[", 
         RowBox[{"#", ",", "BB"}], "]"}], "&"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellLabel->"In[442]:=",
 CellID->38369270,ExpressionUUID->"c223bfaa-a713-4f39-add4-bfc4d937e57c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"LogicalForm", "[", "newA", "]"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", "newB", "]"}]}], "Input",
 CellLabel->"In[446]:=",
 CellID->627226790,ExpressionUUID->"508366b2-d0f8-4ec3-acb0-71e60eeec672"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "}"}]], "Output",
 CellChangeTimes->{3.8769142559426603`*^9},
 CellLabel->"Out[446]=",
 CellID->1690865060,ExpressionUUID->"6e5eed20-519e-4e29-9adf-c0a3df89fec2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "}"}]], "Output",
 CellChangeTimes->{3.876914255966425*^9},
 CellLabel->"Out[447]=",
 CellID->717962669,ExpressionUUID->"37f374b2-8762-4ac3-84c7-876db5f36b5e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"trsA", "=", 
  RowBox[{"Total", "@", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Dyad", "[", 
       RowBox[{"#1", ",", "#2", ",", "AA"}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"newA", ",", "sppA"}], "}"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"trsB", "=", 
  RowBox[{"Total", "@", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Dyad", "[", 
       RowBox[{"#1", ",", "#2", ",", "BB"}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"newB", ",", "sppB"}], "}"}]}], "]"}]}]}]}], "Input",
 CellLabel->"In[448]:=",
 CellID->1604828370,ExpressionUUID->"adf25153-dba1-4e5a-9980-9ff5af18aa23"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"]}]], "Output",
 CellChangeTimes->{3.876914257729908*^9},
 CellLabel->"Out[448]=",
 CellID->1238155867,ExpressionUUID->"bc0c604f-b5bd-49ca-b564-f70c1ea6f792"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"], "+", 
  TemplateBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Ket"], 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]}, 
     "Bra"]},
   "RowDefault"]}]], "Output",
 CellChangeTimes->{3.876914257781517*^9},
 CellLabel->"Out[449]=",
 CellID->569117239,ExpressionUUID->"c7de96da-6caf-4380-a174-21de845958ff"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Overall", "Section",
 CellID->1248933531,ExpressionUUID->"543e3914-c7ba-444b-85b0-e367e6251f35"],

Cell[CellGroupData[{

Cell["\<\
Now, we have all components. Our desired quantum circuit is as follows. The \
first part generates four partially entangled pairs, the second measures the \
total Pauli Z on Bob's register, and the last transforms the post-measurement \
state a fixed pair of qubits from Alice's and Bob's registers.\
\>", "Text",
 CellChangeTimes->{{3.87691430082067*^9, 3.876914482921028*^9}},
 CellID->1308352194,ExpressionUUID->"c50697db-8ea8-4dae-9698-e81518c8fd9c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"all", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"qc2", ",", "\"\<Separator\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"trsA", ",", 
        RowBox[{"\"\<Label\>\"", "->", "\"\<U\>\""}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"trsB", ",", 
        RowBox[{"\"\<Label\>\"", "->", "\"\<U\>\""}]}], "}"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8769142777103167`*^9, 3.8769142891733227`*^9}},
 CellLabel->"In[453]:=",
 CellID->1320689739,ExpressionUUID->"bd78c7db-4888-4f7d-9d8d-d3e80a11d1f8"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{16, -11}, {19, -11}}, {{16, -12}, {19, -12}}, {{16, -13}, {
     19, -13}}}]}, 
   LineBox[{{{0, -1}, {19, -1}}, {{0, -2}, {19, -2}}, {{0, -3}, {19, -3}}, {{
    0, -4}, {19, -4}}, {{0, -6}, {19, -6}}, {{0, -7}, {19, -7}}, {{0, -8}, {
    19, -8}}, {{0, -9}, {19, -9}}, {{0, -11}, {16, -11}}, {{0, -12}, {
    16, -12}}, {{0, -13}, {16, -13}}}], {{InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.016842105263157894`],
       FontWeight->"Light"], {-0.1, -11}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.016842105263157894`],
       FontWeight->"Light"], {-0.1, -12}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.016842105263157894`],
       FontWeight->"Light"], {-0.1, -13}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.016842105263157894`],
       FontWeight->"Light"], {-0.1, -1}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.016842105263157894`],
       FontWeight->"Light"], {-0.1, -2}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.016842105263157894`],
       FontWeight->"Light"], {-0.1, -3}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.016842105263157894`],
       FontWeight->"Light"], {-0.1, -4}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.016842105263157894`],
       FontWeight->"Light"], {-0.1, -6}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.016842105263157894`],
       FontWeight->"Light"], {-0.1, -7}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.016842105263157894`],
       FontWeight->"Light"], {-0.1, -8}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.016842105263157894`],
       FontWeight->"Light"], {-0.1, -9}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}}, {{
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.021052631578947368`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.021052631578947368`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, 
     LineBox[{{0.6, -3.4}, {1.4, -3.4}, {1.4, -2.6}, {0.6, -2.6}, {
      0.6, -3.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.021052631578947368`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, 
     LineBox[{{0.6, -4.4}, {1.4, -4.4}, {1.4, -3.6}, {0.6, -3.6}, {
      0.6, -4.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.021052631578947368`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}}, {LineBox[{{2, -1}, {2, -6}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -6}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -6}, {2.2666666666666666`, -6}}, {{
        2, -6.266666666666667}, {2, -5.733333333333333}}}]}}, {
    LineBox[{{3, -2}, {3, -7}}], 
    DiskBox[{3, -2}, 0.09], {CircleBox[{3, -7}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -7}, {3.2666666666666666`, -7}}, {{
        3, -7.266666666666667}, {3, -6.733333333333333}}}]}}, {
    LineBox[{{4, -3}, {4, -8}}], 
    DiskBox[{4, -3}, 0.09], {CircleBox[{4, -8}, 0.26666666666666666], 
     LineBox[{{{3.7333333333333334`, -8}, {4.266666666666667, -8}}, {{
        4, -8.266666666666667}, {4, -7.733333333333333}}}]}}, {
    LineBox[{{5, -4}, {5, -9}}], 
    DiskBox[{5, -4}, 0.09], {CircleBox[{5, -9}, 0.26666666666666666], 
     LineBox[{{{4.733333333333333, -9}, {5.266666666666667, -9}}, {{
        5, -9.266666666666667}, {5, -8.733333333333333}}}]}}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{6, Rational[-29, 2]}, {6, Rational[-1, 2]}}, {{
       6, -14.5}, {6, -0.5}}]]}, {LineBox[{{7, -6}, {7, -11}}], 
    DiskBox[{7, -6}, 0.09], {CircleBox[{7, -11}, 0.26666666666666666], 
     LineBox[{{{6.733333333333333, -11}, {7.266666666666667, -11}}, {{
        7, -11.266666666666667`}, {7, -10.733333333333333`}}}]}}, {
    LineBox[{{8, -7}, {8, -11}, {8, -12}}], DiskBox[{8, -7}, 0.09], 
    DiskBox[{8, -11}, 0.09], {CircleBox[{8, -12}, 0.26666666666666666], 
     LineBox[{{{7.733333333333333, -12}, {8.266666666666667, -12}}, {{
        8, -12.266666666666667`}, {8, -11.733333333333333`}}}]}}, {
    LineBox[{{9, -7}, {9, -11}}], 
    DiskBox[{9, -7}, 0.09], {CircleBox[{9, -11}, 0.26666666666666666], 
     LineBox[{{{8.733333333333333, -11}, {9.266666666666667, -11}}, {{
        9, -11.266666666666667`}, {9, -10.733333333333333`}}}]}}, {
    LineBox[{{10, -8}, {10, -11}, {10, -12}}], DiskBox[{10, -8}, 0.09], 
    DiskBox[{10, -11}, 0.09], {CircleBox[{10, -12}, 0.26666666666666666], 
     LineBox[{{{9.733333333333333, -12}, {10.266666666666667`, -12}}, {{
        10, -12.266666666666667`}, {10, -11.733333333333333`}}}]}}, {
    LineBox[{{11, -8}, {11, -11}}], 
    DiskBox[{11, -8}, 0.09], {CircleBox[{11, -11}, 0.26666666666666666], 
     LineBox[{{{10.733333333333333`, -11}, {11.266666666666667`, -11}}, {{
        11, -11.266666666666667`}, {11, -10.733333333333333`}}}]}}, {
    LineBox[{{12, -9}, {12, -11}, {12, -12}, {12, -13}}], 
    DiskBox[{12, -9}, 0.09], DiskBox[{12, -11}, 0.09], 
    DiskBox[{12, -12}, 0.09], {CircleBox[{12, -13}, 0.26666666666666666], 
     LineBox[{{{11.733333333333333`, -13}, {12.266666666666667`, -13}}, {{
        12, -13.266666666666667`}, {12, -12.733333333333333`}}}]}}, {
    LineBox[{{13, -9}, {13, -11}, {13, -12}}], DiskBox[{13, -9}, 0.09], 
    DiskBox[{13, -11}, 0.09], {CircleBox[{13, -12}, 0.26666666666666666], 
     LineBox[{{{12.733333333333333`, -12}, {13.266666666666667`, -12}}, {{
        13, -12.266666666666667`}, {13, -11.733333333333333`}}}]}}, {
    LineBox[{{14, -9}, {14, -11}}], 
    DiskBox[{14, -9}, 0.09], {CircleBox[{14, -11}, 0.26666666666666666], 
     LineBox[{{{13.733333333333333`, -11}, {14.266666666666667`, -11}}, {{
        14, -11.266666666666667`}, {14, -10.733333333333333`}}}]}}, {{{
      {GrayLevel[1], EdgeForm[None], 
       RectangleBox[{15.6, -11.4}, {16.4, -10.6}]}, 
      LineBox[{{15.6, -11.4}, {16.4, -11.4}, {16.4, -10.6}, {15.6, -10.6}, {
       15.6, -11.4}}]}, 
     CircleBox[{16, -11.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{16, -11.2}, {16.24, -10.76}}]}, {{
      {GrayLevel[1], EdgeForm[None], 
       RectangleBox[{15.6, -12.4}, {16.4, -11.6}]}, 
      LineBox[{{15.6, -12.4}, {16.4, -12.4}, {16.4, -11.6}, {15.6, -11.6}, {
       15.6, -12.4}}]}, 
     CircleBox[{16, -12.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{16, -12.2}, {16.24, -11.76}}]}, {{
      {GrayLevel[1], EdgeForm[None], 
       RectangleBox[{15.6, -13.4}, {16.4, -12.6}]}, 
      LineBox[{{15.6, -13.4}, {16.4, -13.4}, {16.4, -12.6}, {15.6, -12.6}, {
       15.6, -13.4}}]}, 
     CircleBox[{16, -13.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{16, -13.2}, {16.24, -12.76}}]}}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{17, Rational[-29, 2]}, {17, Rational[-1, 2]}}, {{
       17, -14.5}, {17, -0.5}}]]}, {{
     {GrayLevel[1], EdgeForm[None], RectangleBox[{17.6, -4.4}, {18.4, -0.6}]},
      LineBox[{{17.6, -4.4}, {18.4, -4.4}, {18.4, -0.6}, {17.6, -0.6}, {
      17.6, -4.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.021052631578947368`],
       FontWeight->"Light",
       FontSlant->Italic], NCache[{18, Rational[-5, 2]}, {18, -2.5}], NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{17.6, -9.4}, {18.4, -5.6}]},
      LineBox[{{17.6, -9.4}, {18.4, -9.4}, {18.4, -5.6}, {17.6, -5.6}, {
      17.6, -9.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.021052631578947368`],
       FontWeight->"Light",
       FontSlant->Italic], NCache[{18, Rational[-15, 2]}, {18, -7.5}], NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}}},
  AxesStyle->Large,
  FrameStyle->Large,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
  ImageSize->730.8000000000001,
  PlotRange->NCache[{Full, {
      Rational[-29, 2], 
      Rational[-1, 2]}}, {Full, {-14.5, -0.5}}],
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.87691426095925*^9, 3.876914290112782*^9}, 
   3.876914487131399*^9},
 CellLabel->"Out[453]=",
 CellID->1846553495,ExpressionUUID->"86deccce-32d2-4b86-8b01-59c176d27d42"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Because the transformation on Alice\[CloseCurlyQuote]s and Bob\
\[CloseCurlyQuote]s sides are designed for the measurement outcome of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Z", "tot"], "=", "3"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "dc39250d-3b55-4171-884d-083a187d5835"],
 ", we just run the quantum circuit until we get the desired outcome."
}], "Text",
 CellID->196356282,ExpressionUUID->"2c56d7fa-37c4-4ff3-bc38-624540bcf713"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Until", "[", 
   RowBox[{
    RowBox[{"ztot", "==", "3"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"out", "=", 
      RowBox[{"Elaborate", "[", "all", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ztot", "=", 
      RowBox[{"FromDigits", "[", 
       RowBox[{
        RowBox[{"Reverse", "@", 
         RowBox[{"Readout", "[", 
          RowBox[{"Through", "[", 
           RowBox[{"TT", "[", "3", "]"}], "]"}], "]"}]}], ",", "2"}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellLabel->"In[454]:=",
 CellID->1625149782,ExpressionUUID->"8c92cb94-c212-4b23-9574-a551be752d7d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Here is the output state of the total system. Obviously, the whole register \
",
 StyleBox["T",
  FontSlant->"Italic"],
 " is separated from the other two registers. So are the last two registers \
of the respective registers A and B."
}], "Text",
 CellID->47879881,ExpressionUUID->"27cd6758-4e9a-4ab9-a03a-5d32b41fb8f2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LogicalForm", "[", 
  RowBox[{"out", ",", 
   RowBox[{"Join", "[", 
    RowBox[{"AA", ",", "BB", ",", "TT"}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[455]:=",
 CellID->1558275989,ExpressionUUID->"525db037-2a05-40e8-8608-34b8eac855e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"T"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"T"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"T"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"T"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"T"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"T"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"T"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"T"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"T"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"A"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"B"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"T"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"T"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"T"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{3.876914497478353*^9},
 CellLabel->"Out[455]=",
 CellID->136043132,ExpressionUUID->"79db79e3-90fa-4948-b8ec-e1a11ec87830"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Focusing on the two first two qubits of registers A and B, we see that there \
are two maximally entangled pairs.\
\>", "Text",
 CellID->1953490389,ExpressionUUID->"8a2222a2-dadb-4ac1-918b-a1d277ec715e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SimpleForm", "[", 
  RowBox[{"out", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], ",", 
     RowBox[{"B", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}]}], "}"}]}], "]"}]], "Input",
 CellLabel->"In[456]:=",
 CellID->1582972587,ExpressionUUID->"2dd2b211-3e22-4090-b6e3-470af69d8ed0"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{
     TemplateBox[{
       TemplateBox[{"0", "0"}, "RowDefault"], "\";\"", 
       TemplateBox[{"0", "0"}, "RowDefault"]}, "RowDefault"]},
    "Ket"], "2"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{
       TemplateBox[{"0", "1"}, "RowDefault"], "\";\"", 
       TemplateBox[{"0", "1"}, "RowDefault"]}, "RowDefault"]},
    "Ket"], "2"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{
       TemplateBox[{"1", "0"}, "RowDefault"], "\";\"", 
       TemplateBox[{"1", "0"}, "RowDefault"]}, "RowDefault"]},
    "Ket"], "2"], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{
       TemplateBox[{"1", "1"}, "RowDefault"], "\";\"", 
       TemplateBox[{"1", "1"}, "RowDefault"]}, "RowDefault"]},
    "Ket"], "2"]}]], "Output",
 CellChangeTimes->{3.8769144990607243`*^9},
 CellLabel->"Out[456]=",
 CellID->1302139166,ExpressionUUID->"0ec58f7f-44ba-4119-a8e2-fd846da2d4b9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KetFactor", "@", 
  RowBox[{"KetDrop", "[", 
   RowBox[{"out", ",", "TT"}], "]"}]}]], "Input",
 CellLabel->"In[457]:=",
 CellID->1686302499,ExpressionUUID->"6432b5d2-2ea7-4af3-844a-27333810bcf5"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], "+", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]], 
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], ")"}], "\[CircleTimes]", 
    RowBox[{"(", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]], 
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], "+", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]], 
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], ")"}]}],
   HoldForm]}]], "Output",
 CellChangeTimes->{3.876914500877365*^9},
 CellLabel->"Out[457]=",
 CellID->779286833,ExpressionUUID->"4a2d2419-ad66-480e-a78b-9f1eeb8e7dbf"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Related Guides", "TutorialMoreAboutSection",
 CellChangeTimes->{{3.843042384656711*^9, 3.843042386024461*^9}},
 CellID->1812928137,ExpressionUUID->"8b2ccaf6-8cab-43e2-bdc8-c590499182a0"],

Cell[TextData[ButtonBox["Quantum Computation and Information",
 BaseStyle->"Link",
 ButtonData->
  "paclet:Q3/guide/QuantumComputationAndInformation"]], "TutorialMoreAbout",
 CellChangeTimes->{{3.850943061537991*^9, 3.8509430815007553`*^9}},
 CellID->1551876817,ExpressionUUID->"8a770104-c5be-4890-a94e-63b989dc0720"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Related Tech Notes", "RelatedTutorialsSection",
 CellID->436993734,ExpressionUUID->"625ae735-7219-4661-b0d1-8323e57fe844"],

Cell[TextData[ButtonBox["Entanglement Distillation",
 BaseStyle->"Link",
 ButtonData->
  "paclet:QuantumWorkbook/tutorial/EntanglementDistillation"]], \
"RelatedTutorials",
 CellChangeTimes->{{3.876912470169544*^9, 3.876912480094108*^9}},
 CellID->159614598,ExpressionUUID->"de55eb4d-0b28-4dc4-8ba9-1c4f1884eeb8"],

Cell[TextData[ButtonBox["Quantum Information Theory",
 BaseStyle->"Link",
 ButtonData->
  "paclet:Q3/tutorial/QuantumInformationTheory"]], "RelatedTutorials",
 CellChangeTimes->{{3.8752464248056583`*^9, 3.8752464349647293`*^9}},
 CellID->728547302,ExpressionUUID->"61b46736-1ad7-4837-b3c8-62bf16de2d9c"],

Cell[TextData[ButtonBox["Quantum Computation and Information: Overview",
 BaseStyle->"Link",
 ButtonData->
  "paclet:Q3/tutorial/QuantumComputationAndInformationOverview"]], \
"RelatedTutorials",
 CellChangeTimes->{{3.850943050994355*^9, 3.850943087505946*^9}},
 CellID->2102036812,ExpressionUUID->"ef77ce92-dfeb-4426-834f-4a59b4da4f5a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Related Links", "TutorialRelatedLinksSection",
 CellChangeTimes->{{3.850597361716105*^9, 3.850597362195363*^9}},
 CellID->847161968,ExpressionUUID->"4640f67b-3cfb-43e7-a7d2-c1f8928e1c70"],

Cell[TextData[{
 ButtonBox["J. Preskill (1998)",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://theory.caltech.edu/~preskill/ph229/"], None}],
 ", Lecture Notes for Physics 229: Quantum Information and Computation."
}], "TutorialRelatedLinks",
 CellChangeTimes->{{3.838416666529841*^9, 3.8384167198471823`*^9}, {
  3.875246577338297*^9, 3.8752466017711143`*^9}},
 CellID->90212659,ExpressionUUID->"bfef24ae-266b-4952-adb1-3f880d882881"],

Cell[TextData[{
 StyleBox[ButtonBox["M. Nielsen and I. L. Chuang (2022)",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1017/CBO9780511976667"], None},
  ButtonNote->"https://doi.org/10.1017/CBO9780511976667"],
  FontSlant->"Plain"],
 StyleBox[", Quantum Computation and Quantum Information (Cambridge \
University Press, 2011).",
  FontSlant->"Plain"]
}], "TutorialRelatedLinks",
 CellChangeTimes->{{3.850961013179529*^9, 3.8509610304423647`*^9}, {
  3.856689068353026*^9, 3.856689111943965*^9}},
 CellID->1612042109,ExpressionUUID->"57202c2e-1a2d-491f-b66d-1bc8e6794516"],

Cell[TextData[{
 ButtonBox["Mahn-Soo Choi (2022)",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1007/978-3-030-91214-7"], None}],
 ", A Quantum Computation Workbook (Springer, 2022)."
}], "TutorialRelatedLinks",
 CellChangeTimes->{
  3.8505890170531683`*^9, {3.85668899380037*^9, 3.856689046766375*^9}, {
   3.8566891672259073`*^9, 3.85668919109593*^9}},
 CellID->1997366095,ExpressionUUID->"4740f4eb-d4a7-4547-a903-2b78e4a1ed8f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Metadata", "MetadataSection",
 CellID->435473483,ExpressionUUID->"57723b63-0f70-40f9-82e5-a2a920be4c70"],

Cell[TextData[{
 "New in: ",
 Cell["13.1", "HistoryData",
  CellTags->"New",ExpressionUUID->"99a99901-487b-45ad-953f-7d60aa0680cd"],
 " | Modified in: ",
 Cell[" ", "HistoryData",
  CellTags->"Modified",ExpressionUUID->"04fd9efc-882f-42fd-a0ca-c97eb43f6309"],
 " | Obsolete in: ",
 Cell[" ", "HistoryData",
  CellTags->"Obsolete",ExpressionUUID->"87ca3475-c829-4f72-a649-d7fa91745927"],
 " | Excised in: ",
 Cell[" ", "HistoryData",
  CellTags->"Excised",ExpressionUUID->"06229eb1-ad7c-4950-87db-23ff5a4f3df5"]
}], "History",
 CellChangeTimes->{{3.852925529388873*^9, 3.85292552956523*^9}, {
  3.875246359692999*^9, 3.8752463598293247`*^9}},
 CellID->675385998,ExpressionUUID->"0d8a6edb-27ca-44bf-9fc9-692d232dda08"],

Cell[CellGroupData[{

Cell["Categorization", "CategorizationSection",
 CellID->1608080221,ExpressionUUID->"4bcc2f0b-3803-47a5-a273-267c913437f9"],

Cell["Tech Note", "Categorization",
 CellLabel->"Entity Type",
 CellID->922576852,ExpressionUUID->"7042fe64-a20a-4df0-b785-6652247a506d"],

Cell["QuantumWorkbook", "Categorization",
 CellLabel->"Paclet Name",
 CellID->917220224,ExpressionUUID->"7d3318b9-96ff-4672-9279-2d497b142241"],

Cell["QuantumWorkbook`", "Categorization",
 CellLabel->"Context",
 CellID->1082686602,ExpressionUUID->"eac397f4-c0a9-49ea-82f6-95a2a469affc"],

Cell["\<\
QuantumWorkbook/tutorial/EntanglementDistillationQuantumCircuit\
\>", "Categorization",
 CellLabel->"URI",
 CellID->1084778783,ExpressionUUID->"b41aae16-508d-44a5-a776-9cce7caec9ed"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Keywords", "KeywordsSection",
 CellID->1888326498,ExpressionUUID->"d28114cb-8478-4213-958b-143ebb77ea6c"],

Cell["quantum entanglement", "Keywords",
 CellChangeTimes->{{3.875246350297999*^9, 3.8752463543099833`*^9}},
 CellID->4154011,ExpressionUUID->"9488c803-aa06-40d8-b014-f2609e6c78ad"],

Cell["entanglement distillation", "Keywords",
 CellChangeTimes->{{3.876912562625557*^9, 3.876912566734517*^9}},
 CellID->1392519909,ExpressionUUID->"6a99109c-d29d-49be-9877-82780997f883"],

Cell["entanglement purification", "Keywords",
 CellChangeTimes->{{3.876912567758479*^9, 3.876912571557537*^9}},
 CellID->1876418771,ExpressionUUID->"e6e9998e-9aa5-4c1c-9cff-87f8e038000d"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{735, 891},
WindowMargins->{{Automatic, 234}, {Automatic, 0}},
TaggingRules-><|"Paclet" -> "QuantumWorkbook"|>,
FrontEndVersion->"13.1 for Mac OS X ARM (64-bit) (June 16, 2022)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "TechNotePageStylesExt.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"cb945e51-4e0d-41af-baba-19ef7134ea36"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 135, 1, 114, "Title",ExpressionUUID->"e3335ae1-3816-4b0a-ac1a-259ca89dd70f",
 CellID->1980526771],
Cell[718, 25, 625, 16, 27, "Text",ExpressionUUID->"60fe75fc-9244-469e-9e07-e8b1d661bdfd",
 CellID->1308734266],
Cell[1346, 43, 383, 6, 44, "Text",ExpressionUUID->"1c91212a-cb27-4a49-a2e0-caaf7a40a765",
 CellID->444601366],
Cell[1732, 51, 921, 22, 104, "DefinitionBox",ExpressionUUID->"36dce4c0-3b60-4b8b-bb7a-648a7d616204",
 CellID->1410604422],
Cell[2656, 75, 195, 2, 30, "Caption",ExpressionUUID->"03c06594-0719-45e4-bd4f-139b405618da",
 CellID->1956541321],
Cell[CellGroupData[{
Cell[2876, 81, 193, 2, 41, "MathCaption",ExpressionUUID->"e626cdff-edee-405c-9619-fd3186ec257b",
 CellID->1329022598],
Cell[3072, 85, 147, 3, 27, "Input",ExpressionUUID->"5c3cdfba-d3e5-4be2-8be5-e654424db65f",
 CellID->172539488]
}, Open  ]],
Cell[CellGroupData[{
Cell[3256, 93, 349, 6, 58, "MathCaption",ExpressionUUID->"f8b90b09-75fd-41d3-b787-db4ae55bcfa2",
 CellID->1573161274],
Cell[3608, 101, 203, 4, 27, "Input",ExpressionUUID->"26dfcfe6-26c0-4548-a0c2-ae2be1681d41",
 CellID->768251366]
}, Open  ]],
Cell[CellGroupData[{
Cell[3848, 110, 321, 8, 41, "MathCaption",ExpressionUUID->"0f4181d3-092f-4fd3-ace1-f7e04b7ffa73",
 CellID->1676761233],
Cell[4172, 120, 594, 16, 85, "Input",ExpressionUUID->"f194e1a4-d4f1-4185-adf5-f329e1d25e04",
 CellID->363452503]
}, Open  ]],
Cell[CellGroupData[{
Cell[4803, 141, 294, 7, 41, "MathCaption",ExpressionUUID->"269f75b3-05f0-4f3b-8f4a-0877703dd84e",
 CellID->1432690958],
Cell[5100, 150, 509, 14, 47, "Input",ExpressionUUID->"d399fc7a-8f68-41b8-890c-1914542401c6",
 CellID->1164469075]
}, Open  ]],
Cell[CellGroupData[{
Cell[5646, 169, 195, 2, 45, "Section",ExpressionUUID->"67eace02-e406-44a8-ac18-deb8074e746b",
 CellID->9608243],
Cell[CellGroupData[{
Cell[5866, 175, 271, 5, 58, "MathCaption",ExpressionUUID->"4455ccba-7011-4cdd-a3c0-3de7d5557c44",
 CellID->1326468628],
Cell[CellGroupData[{
Cell[6162, 184, 539, 14, 66, "Input",ExpressionUUID->"ff095bbe-fdef-474c-b90c-de4fe7dbf16a",
 CellID->424466576],
Cell[6704, 200, 1275, 33, 46, "Output",ExpressionUUID->"1a6fc3a0-153c-41da-9ce5-6d3488323bf1",
 CellID->1508632545]
}, Open  ]],
Cell[CellGroupData[{
Cell[8016, 238, 234, 6, 27, "Input",ExpressionUUID->"c7be65ad-a30d-4db6-bee1-1f860f9a9dd9",
 CellID->1176269506],
Cell[8253, 246, 791, 25, 47, "Output",ExpressionUUID->"16ac89bb-3594-4e02-bb0c-3912b2445a3a",
 CellID->579262379]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9093, 277, 249, 4, 41, "MathCaption",ExpressionUUID->"3edfed6c-bf50-4ecd-9084-d10869c27e54",
 CellID->1153639981],
Cell[CellGroupData[{
Cell[9367, 285, 762, 19, 85, "Input",ExpressionUUID->"06706e9a-b84e-4e6f-87c1-7011523ced6e",
 CellID->1509698055],
Cell[10132, 306, 1514, 35, 82, "Output",ExpressionUUID->"6f480c8b-0f95-4ff5-9b42-bdc36a7c825c",
 CellID->702936330]
}, Open  ]],
Cell[CellGroupData[{
Cell[11683, 346, 343, 7, 47, "Input",ExpressionUUID->"dc12f677-158d-4246-9557-c7893481ec36",
 CellID->2084847387],
Cell[12029, 355, 1074, 33, 41, "Output",ExpressionUUID->"9b55fd01-33ee-400f-b19b-7f802d4a1eca",
 CellID->2042969412]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[13152, 394, 320, 5, 58, "MathCaption",ExpressionUUID->"20301db3-9431-4eb6-80db-fdfe37b269e5",
 CellID->70875601],
Cell[CellGroupData[{
Cell[13497, 403, 1000, 27, 142, "Input",ExpressionUUID->"49597941-f7d9-4a17-a29d-113d9875318c",
 CellID->170713811],
Cell[14500, 432, 5619, 131, 331, "Output",ExpressionUUID->"2f60e055-8ca8-47f5-a444-3ea48767e56f",
 CellID->771749506]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20180, 570, 122, 1, 45, "Section",ExpressionUUID->"2a853ae2-2058-412a-894e-7d95da384bfb",
 CellID->224262840],
Cell[CellGroupData[{
Cell[20327, 575, 737, 17, 27, "Text",ExpressionUUID->"48fc5445-ae2b-4f18-b082-3fca0c66c976",
 CellID->1184887274],
Cell[21067, 594, 1295, 36, 161, "Input",ExpressionUUID->"63d691f4-2331-4cc2-b31d-46d27df0de25",
 CellID->351751395]
}, Open  ]],
Cell[CellGroupData[{
Cell[22399, 635, 515, 11, 43, "MathCaption",ExpressionUUID->"83e8397c-67e1-4283-8dfe-900d952b47a9",
 CellID->2075092591],
Cell[CellGroupData[{
Cell[22939, 650, 590, 15, 85, "Input",ExpressionUUID->"d5f55e09-e0dd-4c39-ba05-d16295e1b36a",
 CellID->2010699221],
Cell[23532, 667, 3551, 71, 297, "Output",ExpressionUUID->"7265aff3-c743-4891-8c48-1a5d068abf5f",
 CellID->1448005656]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[27132, 744, 221, 4, 25, "Text",ExpressionUUID->"2fdeadd1-433c-4ef3-b77b-9dfeab324f57",
 CellID->325402613],
Cell[27356, 750, 347, 9, 47, "Input",ExpressionUUID->"0c482a0e-e3b6-4886-a0bd-728c06f40347",
 CellID->1548351429],
Cell[CellGroupData[{
Cell[27728, 763, 553, 17, 47, "Input",ExpressionUUID->"53394859-0040-40fb-8179-e73fc1c198d7",
 CellID->2083116504],
Cell[28284, 782, 3457, 113, 360, "Output",ExpressionUUID->"87fd5014-b145-49f2-bb07-f5e8aa6b552f",
 CellID->2092491683]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[31790, 901, 525, 12, 59, "MathCaption",ExpressionUUID->"a9e378e2-6d5a-415c-9f6f-20ddb36eb0f3",
 CellID->1803890242],
Cell[CellGroupData[{
Cell[32340, 917, 799, 21, 66, "Input",ExpressionUUID->"79ed82a4-2741-41e7-9d18-bd88e99cf41d",
 CellID->817515057],
Cell[33142, 940, 10040, 211, 513, "Output",ExpressionUUID->"b4df19e4-73b8-405c-93ed-75b13f3cf559",
 CellID->1866944612]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[43243, 1158, 176, 2, 45, "Section",ExpressionUUID->"0f894b3d-c2fd-4322-867c-318ebbf73e83",
 CellID->797821259],
Cell[CellGroupData[{
Cell[43444, 1164, 846, 16, 67, "Text",ExpressionUUID->"43916a76-a876-4e48-ad11-1940ad29c6b3",
 CellID->695573627],
Cell[CellGroupData[{
Cell[44315, 1184, 271, 6, 47, "Input",ExpressionUUID->"68fbf39b-d569-4d6e-bf37-5129d1f01af0",
 CellID->989436024],
Cell[44589, 1192, 6294, 195, 53, "Output",ExpressionUUID->"bb9bca4c-8a5c-44d9-881a-762277b9a9e7",
 CellID->1038342713],
Cell[50886, 1389, 6293, 195, 53, "Output",ExpressionUUID->"9a6f1739-7d16-4737-8ab3-78981595456c",
 CellID->973861869]
}, Open  ]],
Cell[57194, 1587, 1562, 50, 104, "Input",ExpressionUUID->"c84f116c-1d33-4084-8a4f-47e4eba37184",
 CellID->576306453],
Cell[CellGroupData[{
Cell[58781, 1641, 230, 4, 47, "Input",ExpressionUUID->"9e830136-510d-48d5-aea5-180f42fb4c81",
 CellID->2013079378],
Cell[59014, 1647, 10876, 325, 99, "Output",ExpressionUUID->"27929e84-3a43-4ac7-b85a-563233d9d128",
 CellID->1355544921],
Cell[69893, 1974, 10874, 325, 99, "Output",ExpressionUUID->"09853817-dc24-4fa9-a5a7-c01dac492c12",
 CellID->2136959871]
}, Open  ]],
Cell[80782, 2302, 1206, 38, 85, "Input",ExpressionUUID->"c223bfaa-a713-4f39-add4-bfc4d937e57c",
 CellID->38369270],
Cell[CellGroupData[{
Cell[82013, 2344, 237, 4, 47, "Input",ExpressionUUID->"508366b2-d0f8-4ec3-acb0-71e60eeec672",
 CellID->627226790],
Cell[82253, 2350, 10854, 325, 99, "Output",ExpressionUUID->"6e5eed20-519e-4e29-9adf-c0a3df89fec2",
 CellID->1690865060],
Cell[93110, 2677, 10851, 325, 99, "Output",ExpressionUUID->"37f374b2-8762-4ac3-84c7-876db5f36b5e",
 CellID->717962669]
}, Open  ]],
Cell[CellGroupData[{
Cell[103998, 3007, 703, 21, 47, "Input",ExpressionUUID->"adf25153-dba1-4e5a-9980-9ff5af18aa23",
 CellID->1604828370],
Cell[104704, 3030, 22637, 676, 191, "Output",ExpressionUUID->"bc0c604f-b5bd-49ca-b564-f70c1ea6f792",
 CellID->1238155867],
Cell[127344, 3708, 22636, 676, 191, "Output",ExpressionUUID->"c7de96da-6caf-4380-a174-21de845958ff",
 CellID->569117239]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[150041, 4391, 102, 1, 45, "Section",ExpressionUUID->"543e3914-c7ba-444b-85b0-e367e6251f35",
 CellID->1248933531],
Cell[CellGroupData[{
Cell[150168, 4396, 464, 7, 63, "Text",ExpressionUUID->"c50697db-8ea8-4dae-9698-e81518c8fd9c",
 CellID->1308352194],
Cell[CellGroupData[{
Cell[150657, 4407, 609, 15, 47, "Input",ExpressionUUID->"bd78c7db-4888-4f7d-9d8d-d3e80a11d1f8",
 CellID->1320689739],
Cell[151269, 4424, 11193, 235, 513, "Output",ExpressionUUID->"86deccce-32d2-4b86-8b01-59c176d27d42",
 CellID->1846553495]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[162511, 4665, 501, 11, 44, "Text",ExpressionUUID->"2c56d7fa-37c4-4ff3-bc38-624540bcf713",
 CellID->196356282],
Cell[163015, 4678, 656, 17, 85, "Input",ExpressionUUID->"8c92cb94-c212-4b23-9574-a551be752d7d",
 CellID->1625149782]
}, Open  ]],
Cell[CellGroupData[{
Cell[163708, 4700, 339, 8, 44, "Text",ExpressionUUID->"27cd6758-4e9a-4ab9-a03a-5d32b41fb8f2",
 CellID->47879881],
Cell[CellGroupData[{
Cell[164072, 4712, 260, 6, 27, "Input",ExpressionUUID->"525db037-2a05-40e8-8608-34b8eac855e0",
 CellID->1558275989],
Cell[164335, 4720, 6992, 204, 78, "Output",ExpressionUUID->"79db79e3-90fa-4948-b8ec-e1a11ec87830",
 CellID->136043132]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[171376, 4930, 213, 4, 25, "Text",ExpressionUUID->"8a2222a2-dadb-4ac1-918b-a1d277ec715e",
 CellID->1953490389],
Cell[CellGroupData[{
Cell[171614, 4938, 400, 12, 27, "Input",ExpressionUUID->"2dd2b211-3e22-4090-b6e3-470af69d8ed0",
 CellID->1582972587],
Cell[172017, 4952, 951, 28, 47, "Output",ExpressionUUID->"0ec58f7f-44ba-4119-a8e2-fd846da2d4b9",
 CellID->1302139166]
}, Open  ]],
Cell[CellGroupData[{
Cell[173005, 4985, 219, 5, 27, "Input",ExpressionUUID->"6432b5d2-2ea7-4af3-844a-27333810bcf5",
 CellID->1686302499],
Cell[173227, 4992, 2008, 60, 41, "Output",ExpressionUUID->"4a2d2419-ad66-480e-a78b-9f1eeb8e7dbf",
 CellID->779286833]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[175296, 5059, 192, 2, 74, "TutorialMoreAboutSection",ExpressionUUID->"8b2ccaf6-8cab-43e2-bdc8-c590499182a0",
 CellID->1812928137],
Cell[175491, 5063, 317, 5, 24, "TutorialMoreAbout",ExpressionUUID->"8a770104-c5be-4890-a94e-63b989dc0720",
 CellID->1551876817]
}, Open  ]],
Cell[CellGroupData[{
Cell[175845, 5073, 128, 1, 74, "RelatedTutorialsSection",ExpressionUUID->"625ae735-7219-4661-b0d1-8323e57fe844",
 CellID->436993734],
Cell[175976, 5076, 313, 6, 24, "RelatedTutorials",ExpressionUUID->"de55eb4d-0b28-4dc4-8ba9-1c4f1884eeb8",
 CellID->159614598],
Cell[176292, 5084, 303, 5, 24, "RelatedTutorials",ExpressionUUID->"61b46736-1ad7-4837-b3c8-62bf16de2d9c",
 CellID->728547302],
Cell[176598, 5091, 337, 6, 24, "RelatedTutorials",ExpressionUUID->"ef77ce92-dfeb-4426-834f-4a59b4da4f5a",
 CellID->2102036812]
}, Open  ]],
Cell[CellGroupData[{
Cell[176972, 5102, 193, 2, 74, "TutorialRelatedLinksSection",ExpressionUUID->"4640f67b-3cfb-43e7-a7d2-c1f8928e1c70",
 CellID->847161968],
Cell[177168, 5106, 447, 9, 24, "TutorialRelatedLinks",ExpressionUUID->"bfef24ae-266b-4952-adb1-3f880d882881",
 CellID->90212659],
Cell[177618, 5117, 597, 13, 42, "TutorialRelatedLinks",ExpressionUUID->"57202c2e-1a2d-491f-b66d-1bc8e6794516",
 CellID->1612042109],
Cell[178218, 5132, 455, 10, 24, "TutorialRelatedLinks",ExpressionUUID->"4740f4eb-d4a7-4547-a903-2b78e4a1ed8f",
 CellID->1997366095]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[178722, 5148, 110, 1, 72, "MetadataSection",ExpressionUUID->"57723b63-0f70-40f9-82e5-a2a920be4c70",
 CellID->435473483],
Cell[178835, 5151, 716, 16, 26, "History",ExpressionUUID->"0d8a6edb-27ca-44bf-9fc9-692d232dda08",
 CellID->675385998],
Cell[CellGroupData[{
Cell[179576, 5171, 123, 1, 21, "CategorizationSection",ExpressionUUID->"4bcc2f0b-3803-47a5-a273-267c913437f9",
 CellID->1608080221],
Cell[179702, 5174, 137, 2, 34, "Categorization",ExpressionUUID->"7042fe64-a20a-4df0-b785-6652247a506d",
 CellID->922576852],
Cell[179842, 5178, 143, 2, 34, "Categorization",ExpressionUUID->"7d3318b9-96ff-4672-9279-2d497b142241",
 CellID->917220224],
Cell[179988, 5182, 141, 2, 34, "Categorization",ExpressionUUID->"eac397f4-c0a9-49ea-82f6-95a2a469affc",
 CellID->1082686602],
Cell[180132, 5186, 192, 4, 34, "Categorization",ExpressionUUID->"b41aae16-508d-44a5-a776-9cce7caec9ed",
 CellID->1084778783]
}, Open  ]],
Cell[CellGroupData[{
Cell[180361, 5195, 111, 1, 31, "KeywordsSection",ExpressionUUID->"d28114cb-8478-4213-958b-143ebb77ea6c",
 CellID->1888326498],
Cell[180475, 5198, 181, 2, 20, "Keywords",ExpressionUUID->"9488c803-aa06-40d8-b014-f2609e6c78ad",
 CellID->4154011],
Cell[180659, 5202, 187, 2, 20, "Keywords",ExpressionUUID->"6a99109c-d29d-49be-9877-82780997f883",
 CellID->1392519909],
Cell[180849, 5206, 187, 2, 20, "Keywords",ExpressionUUID->"e6e9998e-9aa5-4c1c-9cff-87f8e038000d",
 CellID->1876418771]
}, Open  ]]
}, Open  ]]
}
]
*)

