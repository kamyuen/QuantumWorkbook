(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     67428,       1936]
NotebookOptionsPosition[     58795,       1797]
NotebookOutlinePosition[     59191,       1813]
CellTagsIndexPosition[     59148,       1810]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Clifford Operators: How To Test", "Title",ExpressionUUID->"f8956bb5-6e80-40c6-9084-831cefbfad1d"],

Cell[TextData[{
 "See also Section 6.3 of the ",
 ButtonBox["Quantum Workbook (Springer, 2022)",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1007/978-3-030-91214-7"], None}],
 "."
}], "Text",
 CellChangeTimes->{{3.85080797898475*^9, 3.850807984041913*^9}, {
   3.850808024812871*^9, 3.850808037947495*^9}, 3.850808121621657*^9, {
   3.85080823010712*^9, 3.850808231052006*^9}},
 TextAlignment->"Right",
 CellID->1308734266,ExpressionUUID->"3bea26dc-dc00-465f-a4e6-c8f5bf367fba"],

Cell[TextData[{
 "Given a unitary operator ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "dfa805fb-4c11-4bb7-88ac-3cbe67ff6717"],
 ", how can we check whether ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "238fb83c-af06-477d-aa14-9e22e8bc6b4c"],
 " is a Clifford operator or not?"
}], "Text",ExpressionUUID->"0a207f49-3481-4a09-b5af-23a15b39bbe7"],

Cell[TextData[{
 "A Clifford operator ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "10dc1914-da65-40fd-a37f-792814e851bb"],
 " transforms Pauli operators to other Pauli operators. Since Pauli operators \
are generated by single-qubit Pauli-",
 StyleBox["X",
  FontSlant->"Italic"],
 " and Pauli-",
 StyleBox["Z",
  FontSlant->"Italic"],
 " operators, a Clifford operator is completely specified (up to a global \
phase factor ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["e", 
    RowBox[{"\[ImaginaryI]", " ", "m", " ", 
     RowBox[{"\[Pi]", " ", "/", "4"}]}]], TraditionalForm]],ExpressionUUID->
  "dfef352a-59fb-469d-9392-471d2a951e37"],
 ") by the transformation of Pauli operators under conjugation by ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "b7f3dac9-2df7-4728-b3bb-1360d3f8dfe8"],
 ":\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubscriptBox["X", "j"], " ", 
     SuperscriptBox["U", "\[Dagger]"]}], "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      SubscriptBox["p", "j"]], 
     UnderoverscriptBox["\[CapitalPi]", 
      RowBox[{" ", 
       RowBox[{"i", "=", "1"}]}], 
      RowBox[{" ", "n"}]], 
     RowBox[{
      SubsuperscriptBox["X", "i", 
       SubscriptBox["a", 
        StyleBox["ij",
         FontSlant->"Italic"]]], 
      SubsuperscriptBox["Z", "i", 
       SubscriptBox["b", 
        StyleBox["ij",
         FontSlant->"Italic"]]]}]}]}], TraditionalForm]],ExpressionUUID->
  "be4a7059-d7e2-4546-9e79-0b0d542d0e95"],
 "\nand\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubscriptBox["Z", "j"], " ", 
     SuperscriptBox["U", "\[Dagger]"]}], "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      SubscriptBox["q", "j"]], 
     UnderoverscriptBox["\[CapitalPi]", 
      RowBox[{" ", 
       RowBox[{"i", "=", "1"}]}], 
      RowBox[{" ", "n"}]], 
     RowBox[{
      SubsuperscriptBox["X", "i", 
       SubscriptBox["c", 
        StyleBox["ij",
         FontSlant->"Italic"]]], 
      SubsuperscriptBox["Z", "i", 
       SubscriptBox["d", 
        StyleBox["ij",
         FontSlant->"Italic"]]]}]}]}], TraditionalForm]],ExpressionUUID->
  "c5643274-b9b6-4a2c-9f75-fd9922e060f0"],
 "."
}], "Text",
 CellID->1417856937,ExpressionUUID->"0b2b3941-3d08-418d-ac12-32588a3acf6e"],

Cell["Here, we are going to use this observation.", "Text",ExpressionUUID->"04556e6e-3091-4de4-bcd9-af1c3a0b068f"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[32]:=",ExpressionUUID->"4c6db5e6-57d8-45a4-94f9-9ab208f3eb88"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[33]:=",ExpressionUUID->"1ceae594-1638-4e2b-9c11-73d6e0ef149c"],

Cell[CellGroupData[{

Cell["Simple Test", "Section",ExpressionUUID->"487808af-fd9e-4623-96c9-a2b70f9dff6b"],

Cell["Let us start with simple examples.", "Text",ExpressionUUID->"1db8f89f-fdd7-4935-ab76-385a0f1ad7c1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kk", "=", 
   RowBox[{"Range", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ss", "=", 
   RowBox[{"S", "[", 
    RowBox[{"kk", ",", "$"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.885889486662773*^9},
 CellLabel->"In[34]:=",ExpressionUUID->"375a7901-d925-4f54-8f48-d799632d33fa"],

Cell["\<\
The Clifford group is finite and yet increases quite fast in size with the \
number of qubits.\
\>", "Text",ExpressionUUID->"7747342f-1940-460d-b0f5-5bbe8e1dc25e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"grp", "=", 
   RowBox[{"CliffordGroup", "[", "ss", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elm", "=", 
   RowBox[{"GroupElements", "[", "grp", "]"}]}], ";"}]}], "Input",
 CellLabel->"In[37]:=",ExpressionUUID->"8dfc1521-923c-4825-9e4c-cb122caa725b"],

Cell[BoxData[
 TemplateBox[{
  "CliffordGroup", "toobig", 
   "\"There are about \\!\\(\\*RowBox[{\\\"\\\\\\\"1.2\\\\\\\"\\\", \\\"\
\[Times]\\\", SuperscriptBox[\\\"10\\\", \\\"\\\\\\\"4\\\\\\\"\\\"]}]\\) \
elements in the group. Only the first 10 elements are returned.\"", 2, 38, 1, 
   33934045772652954124, "Local", "Q3`CliffordGroup"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.885890185680933*^9},
 CellLabel->
  "During evaluation of \
In[37]:=",ExpressionUUID->"71379c73-1ba5-4b40-a90e-01dc74d2c524"]
}, Open  ]],

Cell["Here is the total number of Clifford operators in this case.", "Text",ExpressionUUID->"be77ebca-eaf0-4180-ad0b-ebe9686743ee"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"odr", "=", 
  RowBox[{"GroupOrder", "[", "grp", "]"}]}]], "Input",
 CellLabel->"In[39]:=",ExpressionUUID->"65f322ae-e898-47a7-ab3b-1f07e567011f"],

Cell[BoxData["11520"], "Output",
 CellChangeTimes->{3.885890188138893*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"3bb264ed-6e5a-4a4e-b00d-757be02cb9df"]
}, Open  ]],

Cell["Let us choose one randomly.", "Text",ExpressionUUID->"0c0220eb-9587-44bf-8c5a-4612966a189f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ptr", "=", 
  RowBox[{"RandomInteger", "[", 
   RowBox[{"{", 
    RowBox[{"1", ",", "odr"}], "}"}], "]"}]}]], "Input",
 CellLabel->"In[40]:=",ExpressionUUID->"09ca97dd-8c65-4212-9eed-5ab9eeecc633"],

Cell[BoxData["8839"], "Output",
 CellChangeTimes->{3.8858901897473392`*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"a515a206-6716-4566-9a6a-4bf06497a587"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"opc", "=", 
  RowBox[{"First", "@", 
   RowBox[{"GroupElements", "[", 
    RowBox[{"grp", ",", 
     RowBox[{"{", "ptr", "}"}]}], "]"}]}]}]], "Input",
 CellLabel->"In[41]:=",ExpressionUUID->"d9f2378c-68ba-441f-a6c8-fb95144eef4f"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], "+", 
      FractionBox["\[ImaginaryI]", "2"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"], 
            TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
           SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 1]], 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
           SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[2, 1]]}, "RowDefault"]},
      "RowDefault"],
     Q3`Multiply[
      $CellContext`S[1, 1], 
      $CellContext`S[2, 1]]]}], 
   SqrtBox["2"]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], "-", 
      FractionBox["\[ImaginaryI]", "2"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"], 
            TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
           SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 2]], 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
           SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[2, 2]]}, "RowDefault"]},
      "RowDefault"],
     Q3`Multiply[
      $CellContext`S[1, 2], 
      $CellContext`S[2, 2]]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], "+", 
      FractionBox["\[ImaginaryI]", "2"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
           SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 3]], 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
           SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[2, 1]]}, "RowDefault"]},
      "RowDefault"],
     Q3`Multiply[
      $CellContext`S[1, 3], 
      $CellContext`S[2, 1]]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], "+", 
      FractionBox["\[ImaginaryI]", "2"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"],
     $CellContext`S[2, 2]]}], 
   SqrtBox["2"]]}]], "Output",
 CellChangeTimes->{3.8858901917331753`*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"0e282119-d146-413c-aad3-fb62e8671a3f"]
}, Open  ]],

Cell["\<\
The CliffordQ function provided by Q3 confirms that it is indeed a Clifford \
operator.\
\>", "Text",ExpressionUUID->"94cfc894-9ec9-494d-84b8-f229c3487b26"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CliffordQ", "[", "opc", "]"}]], "Input",
 CellLabel->"In[42]:=",ExpressionUUID->"66dbafa4-c94f-485a-872b-d7a4463225aa"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.885890200143921*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"d6c69f3d-5ae4-4df4-bf94-c011f3a6cf15"]
}, Open  ]],

Cell[TextData[{
 "Pick up single-qubit Pauli-",
 StyleBox["X",
  FontSlant->"Italic"],
 " and Pauli-",
 StyleBox["Z",
  FontSlant->"Italic"],
 " operators."
}], "Text",ExpressionUUID->"117354f9-70cf-4ca9-bfb7-b2a25fe4e61a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"opx", "=", 
  RowBox[{"S", "[", 
   RowBox[{"kk", ",", "1"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"opz", "=", 
  RowBox[{"S", "[", 
   RowBox[{"kk", ",", "3"}], "]"}]}]}], "Input",
 CellLabel->"In[43]:=",ExpressionUUID->"3866bf62-884c-4ba0-a3d7-66c7617ab8cc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[1, 1]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"2"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[2, 1]]}], "}"}]], "Output",
 CellChangeTimes->{3.885890202308248*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"6913ca2b-b102-4e52-aab3-58c00346f65c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[1, 3]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"2"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[2, 3]]}], "}"}]], "Output",
 CellChangeTimes->{3.885890202310875*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"f3a7251f-4324-4440-b55c-323cf9d3aa81"]
}, Open  ]],

Cell[TextData[{
 "Under the conjugation by the operator ",
 StyleBox["opc", "Input"],
 " in question, the single-qubit Pauli-X and Pauli-Z operators result in \
certain Pauli operators, confirming again that the operator ",
 StyleBox["opc", "Input"],
 " is a Clifford operator."
}], "Text",ExpressionUUID->"ea723f27-1397-4b8b-8f79-36bb7f38f2e0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"EchoTiming", "[", 
  RowBox[{"opc", "**", "opx", "**", 
   RowBox[{"Dagger", "[", "opc", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"EchoTiming", "[", 
  RowBox[{"opc", "**", "opz", "**", 
   RowBox[{"Dagger", "[", "opc", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.885890204797583*^9, 3.885890210067684*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"af2b1b23-9da7-4547-9045-6e3a21d9d586"],

Cell[BoxData["0.024507`"], "EchoTiming",
 CellChangeTimes->{
  3.885890211120545*^9},ExpressionUUID->"1cb57cd4-88da-49bf-87ad-\
2aef5fcd31db"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[1, 3]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 2]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 2]]]}], "}"}]], "Output",
 CellChangeTimes->{3.885890211127645*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"52fa748a-4595-4134-ad7e-0b4eb529674e"],

Cell[BoxData["0.016891`"], "EchoTiming",
 CellChangeTimes->{
  3.885890211147067*^9},ExpressionUUID->"764c91f4-c288-46be-98b1-\
98161db5fdc1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 2]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 2], 
     $CellContext`S[2, 3]]], ",", 
   RowBox[{"-", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"],
     $CellContext`S[2, 3]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.885890211155676*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"036cb119-3a76-4e78-b061-300fe1acd61a"]
}, Open  ]],

Cell[TextData[{
 "Now, consider a new operator involving the octant phase operator on the \
first qubit. Note that the  octant phase operator is not a Clifford operator. \
Indeed, the results involve several terms of Pauli operators indicating that \
the operator ",
 StyleBox["opd", "Input"],
 " is not a Clifford operator."
}], "Text",ExpressionUUID->"039b07a8-568d-40fc-9f76-8ae794ba8bfb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"opd", "=", 
   RowBox[{"opc", "**", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "8"}], "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[47]:=",ExpressionUUID->"64822854-1aaa-4c01-8831-532202b6e9a1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"EchoTiming", "[", 
  RowBox[{"out", "=", 
   RowBox[{"opd", "**", "opx", "**", 
    RowBox[{"Dagger", "[", "opd", "]"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"EchoTiming", "[", 
  RowBox[{"out", "=", 
   RowBox[{"opd", "**", "opz", "**", 
    RowBox[{"Dagger", "[", "opd", "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.885890215584506*^9, 3.8858902183833437`*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"077da391-1cc1-4e10-a4d2-8b29bc053da6"],

Cell[BoxData["0.187663`"], "EchoTiming",
 CellChangeTimes->{
  3.885890220317437*^9},ExpressionUUID->"74269971-07e9-450f-bcdc-\
92b36e5d437e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["\[ImaginaryI]", 
     RowBox[{"8", " ", 
      SqrtBox["2"]}]], "+", 
    FractionBox[
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[1, 1]], 
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[2, 3]]}, "RowDefault"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`S[1, 1], 
       $CellContext`S[2, 3]]], 
     SqrtBox["2"]], "+", 
    FractionBox[
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[1, 3]], 
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[2, 3]]}, "RowDefault"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3]]], 
     RowBox[{"8", " ", 
      SqrtBox["2"]}]], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[ImaginaryI]"}], ")"}], "+", 
        SqrtBox["2"]}], ")"}], " ", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           InterpretationBox[
            TemplateBox[{
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"], 
              TemplateBox[{"\"T\""}, "RowDefault"]}, "Subsuperscript", 
             SyntaxForm -> SubsuperscriptBox], 
            $CellContext`S[1, 8]], 
           InterpretationBox[
            TemplateBox[{
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"], 
              TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
             SyntaxForm -> SubsuperscriptBox], 
            $CellContext`S[2, 3]]}, "RowDefault"]},
        "RowDefault"],
       Q3`Multiply[
        $CellContext`S[1, 8], 
        $CellContext`S[2, 3]]]}], 
     RowBox[{"8", " ", 
      SqrtBox["2"]}]], "+", 
    RowBox[{
     FractionBox["1", "16"], " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", 
       RowBox[{"7", " ", 
        SqrtBox["2"]}]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      $CellContext`S[1, 3]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "8"]}], "+", 
       FractionBox[
        RowBox[{
         FractionBox["1", "8"], "-", 
         FractionBox["\[ImaginaryI]", "8"]}], 
        SqrtBox["2"]]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"T\""}, "RowDefault"]},
       "Subsuperscript"],
      $CellContext`S[1, 8]]}], "+", 
    RowBox[{
     FractionBox["1", "16"], " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", 
       SqrtBox["2"]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      $CellContext`S[2, 3]]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "8"], "-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "8"], "+", 
         FractionBox["\[ImaginaryI]", "8"]}], 
        SqrtBox["2"]]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          InterpretationBox[
           TemplateBox[{
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"], 
                TemplateBox[{"\"T\""}, "RowDefault"]}, "Subsuperscript", 
               SyntaxForm -> SubsuperscriptBox], 
              $CellContext`S[1, 8]], "\"\[Dagger]\""}, "Superscript", 
            SyntaxForm -> SuperscriptBox], 
           $CellContext`S[1, -8]], 
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[2, 2]]}, "RowDefault"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`S[1, -8], 
       $CellContext`S[2, 2]]]}], "+", 
    RowBox[{
     FractionBox["1", "8"], " ", 
     RowBox[{"(", 
      RowBox[{"6", "+", 
       SqrtBox["2"]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[1, 3]], 
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[2, 2]]}, "RowDefault"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 2]]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "8"], "-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "8"], "-", 
         FractionBox["\[ImaginaryI]", "8"]}], 
        SqrtBox["2"]]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"T\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[1, 8]], 
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[2, 2]]}, "RowDefault"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`S[1, 8], 
       $CellContext`S[2, 2]]]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.8858902203286333`*^9},
 CellLabel->"Out[48]=",ExpressionUUID->"2799eea5-82fb-40b2-a8a5-3ccd6d358dc9"],

Cell[BoxData["0.085609`"], "EchoTiming",
 CellChangeTimes->{
  3.885890220409932*^9},ExpressionUUID->"dfb87c59-433c-4a76-bd17-\
279a54f9e515"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox["\[ImaginaryI]", 
      RowBox[{"8", " ", 
       SqrtBox["2"]}]]}], "+", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"], 
            TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
           SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 2]], 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
           SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[2, 3]]}, "RowDefault"]},
      "RowDefault"],
     Q3`Multiply[
      $CellContext`S[1, 2], 
      $CellContext`S[2, 3]]], "+", 
    FractionBox[
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[1, 3]], 
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[2, 3]]}, "RowDefault"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3]]], 
     RowBox[{"8", " ", 
      SqrtBox["2"]}]], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[ImaginaryI]"}], ")"}], "+", 
        SqrtBox["2"]}], ")"}], " ", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           InterpretationBox[
            TemplateBox[{
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"], 
              TemplateBox[{"\"T\""}, "RowDefault"]}, "Subsuperscript", 
             SyntaxForm -> SubsuperscriptBox], 
            $CellContext`S[1, 8]], 
           InterpretationBox[
            TemplateBox[{
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"], 
              TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
             SyntaxForm -> SubsuperscriptBox], 
            $CellContext`S[2, 3]]}, "RowDefault"]},
        "RowDefault"],
       Q3`Multiply[
        $CellContext`S[1, 8], 
        $CellContext`S[2, 3]]]}], 
     RowBox[{"8", " ", 
      SqrtBox["2"]}]], "+", 
    RowBox[{
     FractionBox["1", "16"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", 
       SqrtBox["2"]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      $CellContext`S[1, 3]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "8"], "-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "8"], "-", 
         FractionBox["\[ImaginaryI]", "8"]}], 
        SqrtBox["2"]]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"T\""}, "RowDefault"]},
       "Subsuperscript"],
      $CellContext`S[1, 8]]}], "+", 
    RowBox[{
     FractionBox["1", "16"], " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", 
       SqrtBox["2"]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      $CellContext`S[2, 3]]}]}], ",", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"4", " ", 
      SqrtBox["2"]}]], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "16"], "-", 
       FractionBox["\[ImaginaryI]", "16"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[ImaginaryI]"}], ")"}], "+", 
       SqrtBox["2"]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"T\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 8]], "\"\[Dagger]\""},
       "Superscript"],
      $CellContext`S[1, -8]]}], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[ImaginaryI]"}], ")"}], "+", 
        SqrtBox["2"]}], ")"}], " ", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"T\""}, "RowDefault"]},
        "Subsuperscript"],
       $CellContext`S[1, 8]]}], 
     RowBox[{"8", " ", 
      SqrtBox["2"]}]], "-", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"],
     $CellContext`S[2, 3]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.88589022041547*^9},
 CellLabel->"Out[49]=",ExpressionUUID->"69a77629-eb34-4abf-a28c-f7646eb2bda4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Using Matrix Representations", "Section",ExpressionUUID->"4da7c507-b2da-4d3c-b4ba-204336a6a034"],

Cell["\<\
In principle, the above test works. Unfortunately, however, the method \
quickly gets slower with the number of qubits. To improve the speed of the \
test, we use the matrix representations.\
\>", "Text",ExpressionUUID->"d1cdb173-0384-4640-8a4e-e834d8b5f008"],

Cell[TextData[{
 "Here is the matrix representation of the given operator ",
 StyleBox["opc", "Input"],
 "."
}], "Text",ExpressionUUID->"97387e12-e05e-4f96-ab12-48ab253a7813"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"matc", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"opc", ",", "ss"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"matc", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[50]:=",ExpressionUUID->"84b94015-29f2-4e4a-8a3e-d637471c69ca"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      FractionBox["1", 
       SqrtBox["2"]], "0", 
      FractionBox["1", 
       SqrtBox["2"]]},
     {
      FractionBox["\[ImaginaryI]", 
       SqrtBox["2"]], "0", 
      FractionBox["\[ImaginaryI]", 
       SqrtBox["2"]], "0"},
     {"0", 
      FractionBox["\[ImaginaryI]", 
       SqrtBox["2"]], "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        SqrtBox["2"]]}]},
     {
      FractionBox["1", 
       SqrtBox["2"]], "0", 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}], "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{2}, {4}, {1}, {3}, {4}, {2}, {3}, {1}}}, {
      2^Rational[-1, 2], 2^Rational[-1, 2], Complex[0, 1] 2^Rational[-1, 2], 
       Complex[0, 1] 2^Rational[-1, 2], Complex[0, -1] 2^Rational[-1, 2], 
       Complex[0, 1] 2^Rational[-1, 2], -2^Rational[-1, 2], 2^
       Rational[-1, 2]}}]]]]], "Output",
 CellChangeTimes->{3.885890226353969*^9},
 CellLabel->
  "Out[51]//MatrixForm=",ExpressionUUID->"1bc58ee8-5250-45ac-ad7c-\
645562ea2aa1"]
}, Open  ]],

Cell[TextData[{
 "These are the matrix representations of the single-qubit Pauli-",
 StyleBox["X",
  FontSlant->"Italic"],
 " and Pauli-",
 StyleBox["Z",
  FontSlant->"Italic"],
 " operators."
}], "Text",ExpressionUUID->"55ff4218-cc66-45d9-b76d-b519e4f50d05"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"matx", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"opx", ",", "ss"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matz", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"opz", ",", "ss"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "/@", "matx"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "/@", "matz"}]}], "Input",
 CellLabel->"In[52]:=",ExpressionUUID->"902f49fa-3c76-4c7b-8830-88f39fe45c99"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"},
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{3}, {4}, {1}, {2}}}, {1, 1, 1, 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "1", "0", "0"},
       {"1", "0", "0", "0"},
       {"0", "0", "0", "1"},
       {"0", "0", "1", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{2}, {1}, {4}, {3}}}, {1, 1, 1, 1}}]]]]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.885890227917911*^9},
 CellLabel->"Out[54]=",ExpressionUUID->"e4ff9fed-e92b-4be9-8ea6-414b7584af27"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"-", "1"}], "0"},
       {"0", "0", "0", 
        RowBox[{"-", "1"}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {1, 1, -1, -1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"-", "1"}], "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", 
        RowBox[{"-", "1"}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {1, -1, 1, -1}}]]]]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.885890227920192*^9},
 CellLabel->"Out[55]=",ExpressionUUID->"5276733f-1789-43e0-bb65-78c0ee652173"]
}, Open  ]],

Cell["\<\
The single-qubit Pauli-X and Pauli-Z operators (i.e., their matrix \
representation) transform under the given operator as follows.\
\>", "Text",ExpressionUUID->"160d49d5-a338-47a8-9265-7403482657b9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"outx", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"matc", ".", "#", ".", 
      RowBox[{"Topple", "[", "matc", "]"}]}], "&"}], "/@", "matx"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outz", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"matc", ".", "#", ".", 
      RowBox[{"Topple", "[", "matc", "]"}]}], "&"}], "/@", "matz"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "/@", "outx"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "/@", "outz"}]}], "Input",
 CellLabel->"In[56]:=",ExpressionUUID->"c84e4fb4-5faa-4448-a840-2631e18e5c1a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"-", "1"}], "0"},
       {"0", "0", "0", 
        RowBox[{"-", "1"}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 2, 4, 6, 8}, {{1}, {3}, {2}, {4}, {1}, {3}, {2}, {4}}}, {1, 0, 
        1, 0, 0, -1, 0, -1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        RowBox[{"-", "\[ImaginaryI]"}], "0", "0"},
       {"\[ImaginaryI]", "0", "0", "0"},
       {"0", "0", "0", "\[ImaginaryI]"},
       {"0", "0", 
        RowBox[{"-", "\[ImaginaryI]"}], "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 2, 4, 6, 8}, {{2}, {4}, {1}, {3}, {2}, {4}, {1}, {3}}}, {
        Complex[0, -1], 0, Complex[0, 1], 0, 0, Complex[0, 1], 0, Complex[
         0, -1]}}]]]]}], "}"}]], "Output",
 CellChangeTimes->{3.8858902300220137`*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"b5aab612-0058-4082-af8c-cb9b1abacb04"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", 
        RowBox[{"-", "\[ImaginaryI]"}], "0"},
       {"0", "0", "0", "\[ImaginaryI]"},
       {"\[ImaginaryI]", "0", "0", "0"},
       {"0", 
        RowBox[{"-", "\[ImaginaryI]"}], "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 2, 4, 6, 8}, {{1}, {3}, {2}, {4}, {1}, {3}, {2}, {4}}}, {
        0, Complex[0, -1], 0, Complex[0, 1], Complex[0, 1], 0, Complex[0, -1],
          0}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"-", "1"}], "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"-", "1"}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 2, 4, 6, 8}, {{1}, {3}, {2}, {4}, {1}, {3}, {2}, {4}}}, {-1, 0,
         1, 0, 0, -1, 0, 1}}]]]]}], "}"}]], "Output",
 CellChangeTimes->{3.885890230024287*^9},
 CellLabel->"Out[59]=",ExpressionUUID->"763ca53c-e2c6-4bce-915e-6276d0fff17b"]
}, Open  ]],

Cell[TextData[{
 "These results represents Pauli operators. This is seen by taking the ",
 ButtonBox["Pauli decomposition",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/PauliDecompose"],
 "."
}], "Text",ExpressionUUID->"a1faad71-164f-4fd3-b29a-89aad02770ab"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"rrx", "=", 
  RowBox[{"PauliDecompose", "/@", "outx"}]}], "\[IndentingNewLine]", 
 RowBox[{"rrz", "=", 
  RowBox[{"PauliDecompose", "/@", "outz"}]}]}], "Input",
 CellChangeTimes->{{3.885890265465316*^9, 3.885890271635296*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"8dab8bf4-2ae6-452b-90d7-1c28114faa0b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "0"}], "}"}], "\[Rule]", "1"}], 
    "\[RightAssociation]"}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "2"}], "}"}], "\[Rule]", "1"}], 
    "\[RightAssociation]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.885890272631015*^9, 3.885890304809623*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"cacdab07-3489-4748-b696-5aa47e08822d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], "\[Rule]", "1"}], 
    "\[RightAssociation]"}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "3"}], "}"}], "\[Rule]", 
     RowBox[{"-", "1"}]}], "\[RightAssociation]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.885890272631015*^9, 3.88589030481174*^9},
 CellLabel->"Out[65]=",ExpressionUUID->"ff1bffd4-3783-4f89-9194-0990c1b877cc"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Relation to Stabilizer States", "Section",ExpressionUUID->"c62f57c4-3e01-4c70-a7cb-059497618a3f"],

Cell[TextData[{
 "A state is called a stabilizer state if it can be generated from ",
 Cell[BoxData[
  TemplateBox[{
    RowBox[{"00", "\[Ellipsis]0"}]},
   "Ket"]],ExpressionUUID->"6df9d786-451e-4d30-87d4-80a381d13165"],
 "by a Clifford operator. It is called that name since such a state can be \
stabilized by some non-trivial Pauli operators."
}], "Text",ExpressionUUID->"60befa21-8b32-4bd7-b203-3486b0544ad7"],

Cell["So, we consider the following typical initial state.", "Text",ExpressionUUID->"5f7b64fe-355e-4597-84b0-c4bf4f8e39a2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"in", "=", 
  RowBox[{"Ket", "[", "ss", "]"}]}]], "Input",
 CellChangeTimes->{3.8858903467645903`*^9},
 CellLabel->"In[66]:=",ExpressionUUID->"932f111c-4b20-4e7d-8100-ae4b54405715"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{
    TemplateBox[{
      SubscriptBox["0", 
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"]], 
        $CellContext`S[1, Q3`$]]], 
      SubscriptBox["0", 
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"]], 
        $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
   "Ket"],
  Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
    0|>]]], "Output",
 CellChangeTimes->{3.885890347635109*^9},
 CellLabel->"Out[66]=",ExpressionUUID->"22f148d4-4c82-4850-9137-104be7641dcf"]
}, Open  ]],

Cell[TextData[{
 "Some Clifford operators (e.g., the octant phase operator) operates in a \
trivial way on such a special state as ",
 Cell[BoxData[
  TemplateBox[{
    RowBox[{"00", "\[Ellipsis]0"}]},
   "Ket"]],ExpressionUUID->"92227b9f-e640-440d-b91d-c72c0fb5082a"],
 ". Therefore, we consider another common stabilizer state."
}], "Text",ExpressionUUID->"0da2dde3-c0d7-4cc3-bb3a-4e7d4b660d9b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"hh", "=", 
   RowBox[{"Multiply", "@@", 
    RowBox[{"S", "[", 
     RowBox[{"kk", ",", "6"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"hh", "=", 
  RowBox[{"hh", "**", "in"}]}]}], "Input",
 CellLabel->"In[67]:=",ExpressionUUID->"1456cf93-82ee-4347-8bb4-a4bf8f7230b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]]}], 
  "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]]}], 
  "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1|>]]}]}]], "Output",
 CellChangeTimes->{3.8858903506181107`*^9},
 CellLabel->"Out[68]=",ExpressionUUID->"2efe0363-d8ed-40bc-b5fc-8b4d7c35060a"]
}, Open  ]],

Cell["\<\
A Clifford operator transforms both states to different stablizer states.\
\>", "Text",ExpressionUUID->"c71b0ec8-265b-4af8-9b62-a492207ab2ad"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"out1", "=", 
  RowBox[{"opc", "**", "in"}]}], "\[IndentingNewLine]", 
 RowBox[{"out2", "=", 
  RowBox[{"opc", "**", "hh"}]}]}], "Input",
 CellLabel->"In[69]:=",ExpressionUUID->"84743373-77b0-41d8-bac6-75584995b7aa"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 1|>]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 1|>]], 
   SqrtBox["2"]]}]], "Output",
 CellChangeTimes->{3.8858903554527187`*^9},
 CellLabel->"Out[69]=",ExpressionUUID->"0eb17b28-f899-40aa-b9d4-1a9dcdabab2f"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 1|>]]}], 
   SqrtBox["2"]]}]], "Output",
 CellChangeTimes->{3.885890355464768*^9},
 CellLabel->"Out[70]=",ExpressionUUID->"b412ef9e-55d0-4bc5-af49-951ce756a733"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"StabilizerStateQ", "[", "out1", "]"}], "\[IndentingNewLine]", 
 RowBox[{"StabilizerStateQ", "[", "out2", "]"}]}], "Input",
 CellLabel->"In[71]:=",ExpressionUUID->"ce811e4a-1fb3-44c6-9f98-dbaeedab8296"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.885890358667357*^9},
 CellLabel->"Out[71]=",ExpressionUUID->"f33563a3-87d5-4feb-8e4d-dc0c6cdb66e9"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.885890358668706*^9},
 CellLabel->"Out[72]=",ExpressionUUID->"ee78792c-fa08-4e38-b08b-0e5025555036"]
}, Open  ]],

Cell["\<\
On the other hand, a non-Clifford operator transforms either or both states \
to a non-stabilizer state.\
\>", "Text",ExpressionUUID->"2d2ee55c-7683-4032-b604-448f6def29f1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"new1", "=", 
  RowBox[{"opd", "**", "in"}]}], "\[IndentingNewLine]", 
 RowBox[{"new2", "=", 
  RowBox[{"opd", "**", "hh"}]}]}], "Input",
 CellLabel->"In[73]:=",ExpressionUUID->"1b276799-7e9c-44d8-8a14-d572e5a06c81"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 1|>]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 1|>]], 
   SqrtBox["2"]]}]], "Output",
 CellChangeTimes->{3.885890361148756*^9},
 CellLabel->"Out[73]=",ExpressionUUID->"91fc2569-e12a-422d-b3d3-1af6a545967a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]]}], 
  "+", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "-", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]]}], 
  "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "-", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1|>]]}]}]], "Output",
 CellChangeTimes->{3.8858903611781883`*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"1c22d5e8-786c-409f-927f-e1ac846d2694"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"StabilizerStateQ", "[", "new1", "]"}], "\[IndentingNewLine]", 
 RowBox[{"StabilizerStateQ", "[", "new2", "]"}]}], "Input",
 CellLabel->"In[75]:=",ExpressionUUID->"3992e45d-8470-40d5-b87a-f143e7db6a95"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.885890362904594*^9},
 CellLabel->"Out[75]=",ExpressionUUID->"2970bc39-763f-4563-9a59-dd659215ccf6"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.885890362918421*^9},
 CellLabel->"Out[76]=",ExpressionUUID->"b6e165ae-9136-4d44-8a2f-b45ba96cd3b5"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{735, 891},
WindowMargins->{{Automatic, 212}, {Automatic, 0}},
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (January 30, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e5401879-4c30-4562-a36a-301bf5dfda5b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 103, 0, 98, "Title",ExpressionUUID->"f8956bb5-6e80-40c6-9084-831cefbfad1d"],
Cell[686, 24, 504, 12, 35, "Text",ExpressionUUID->"3bea26dc-dc00-465f-a4e6-c8f5bf367fba",
 CellID->1308734266],
Cell[1193, 38, 457, 12, 35, "Text",ExpressionUUID->"0a207f49-3481-4a09-b5af-23a15b39bbe7"],
Cell[1653, 52, 2404, 78, 205, "Text",ExpressionUUID->"0b2b3941-3d08-418d-ac12-32588a3acf6e",
 CellID->1417856937],
Cell[4060, 132, 114, 0, 35, "Text",ExpressionUUID->"04556e6e-3091-4de4-bcd9-af1c3a0b068f"],
Cell[4177, 134, 126, 2, 30, "Input",ExpressionUUID->"4c6db5e6-57d8-45a4-94f9-9ab208f3eb88"],
Cell[4306, 138, 162, 3, 30, "Input",ExpressionUUID->"1ceae594-1638-4e2b-9c11-73d6e0ef149c"],
Cell[CellGroupData[{
Cell[4493, 145, 85, 0, 67, "Section",ExpressionUUID->"487808af-fd9e-4623-96c9-a2b70f9dff6b"],
Cell[4581, 147, 105, 0, 35, "Text",ExpressionUUID->"1db8f89f-fdd7-4935-ab76-385a0f1ad7c1"],
Cell[4689, 149, 418, 11, 73, "Input",ExpressionUUID->"375a7901-d925-4f54-8f48-d799632d33fa"],
Cell[5110, 162, 173, 3, 35, "Text",ExpressionUUID->"7747342f-1940-460d-b0f5-5bbe8e1dc25e"],
Cell[CellGroupData[{
Cell[5308, 169, 308, 8, 52, "Input",ExpressionUUID->"8dfc1521-923c-4825-9e4c-cb122caa725b"],
Cell[5619, 179, 530, 11, 28, "Message",ExpressionUUID->"71379c73-1ba5-4b40-a90e-01dc74d2c524"]
}, Open  ]],
Cell[6164, 193, 131, 0, 35, "Text",ExpressionUUID->"be77ebca-eaf0-4180-ad0b-ebe9686743ee"],
Cell[CellGroupData[{
Cell[6320, 197, 169, 3, 30, "Input",ExpressionUUID->"65f322ae-e898-47a7-ab3b-1f07e567011f"],
Cell[6492, 202, 153, 2, 34, "Output",ExpressionUUID->"3bb264ed-6e5a-4a4e-b00d-757be02cb9df"]
}, Open  ]],
Cell[6660, 207, 98, 0, 35, "Text",ExpressionUUID->"0c0220eb-9587-44bf-8c5a-4612966a189f"],
Cell[CellGroupData[{
Cell[6783, 211, 221, 5, 30, "Input",ExpressionUUID->"09ca97dd-8c65-4212-9eed-5ab9eeecc633"],
Cell[7007, 218, 154, 2, 34, "Output",ExpressionUUID->"a515a206-6716-4566-9a6a-4bf06497a587"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7198, 225, 253, 6, 30, "Input",ExpressionUUID->"d9f2378c-68ba-441f-a6c8-fb95144eef4f"],
Cell[7454, 233, 3393, 101, 64, "Output",ExpressionUUID->"0e282119-d146-413c-aad3-fb62e8671a3f"]
}, Open  ]],
Cell[10862, 337, 166, 3, 35, "Text",ExpressionUUID->"94cfc894-9ec9-494d-84b8-f229c3487b26"],
Cell[CellGroupData[{
Cell[11053, 344, 143, 2, 30, "Input",ExpressionUUID->"66dbafa4-c94f-485a-872b-d7a4463225aa"],
Cell[11199, 348, 152, 2, 34, "Output",ExpressionUUID->"d6c69f3d-5ae4-4df4-bf94-c011f3a6cf15"]
}, Open  ]],
Cell[11366, 353, 223, 8, 35, "Text",ExpressionUUID->"117354f9-70cf-4ca9-bfb7-b2a25fe4e61a"],
Cell[CellGroupData[{
Cell[11614, 365, 290, 7, 52, "Input",ExpressionUUID->"3866bf62-884c-4ba0-a3d7-66c7617ab8cc"],
Cell[11907, 374, 622, 18, 37, "Output",ExpressionUUID->"6913ca2b-b102-4e52-aab3-58c00346f65c"],
Cell[12532, 394, 622, 18, 37, "Output",ExpressionUUID->"f3a7251f-4324-4440-b55c-323cf9d3aa81"]
}, Open  ]],
Cell[13169, 415, 345, 7, 81, "Text",ExpressionUUID->"ea723f27-1397-4b8b-8f79-36bb7f38f2e0"],
Cell[CellGroupData[{
Cell[13539, 426, 424, 8, 52, "Input",ExpressionUUID->"af2b1b23-9da7-4547-9045-6e3a21d9d586"],
Cell[13966, 436, 142, 3, 25, "EchoTiming",ExpressionUUID->"1cb57cd4-88da-49bf-87ad-2aef5fcd31db"],
Cell[14111, 441, 1152, 32, 38, "Output",ExpressionUUID->"52fa748a-4595-4134-ad7e-0b4eb529674e"],
Cell[15266, 475, 142, 3, 25, "EchoTiming",ExpressionUUID->"764c91f4-c288-46be-98b1-98161db5fdc1"],
Cell[15411, 480, 1178, 33, 38, "Output",ExpressionUUID->"036cb119-3a76-4e78-b061-300fe1acd61a"]
}, Open  ]],
Cell[16604, 516, 392, 7, 81, "Text",ExpressionUUID->"039b07a8-568d-40fc-9f76-8ae794ba8bfb"],
Cell[16999, 525, 231, 6, 30, "Input",ExpressionUUID->"64822854-1aaa-4c01-8831-532202b6e9a1"],
Cell[CellGroupData[{
Cell[17255, 535, 480, 10, 52, "Input",ExpressionUUID->"077da391-1cc1-4e10-a4d2-8b29bc053da6"],
Cell[17738, 547, 142, 3, 25, "EchoTiming",ExpressionUUID->"74269971-07e9-450f-bcdc-92b36e5d437e"],
Cell[17883, 552, 7550, 218, 125, "Output",ExpressionUUID->"2799eea5-82fb-40b2-a8a5-3ccd6d358dc9"],
Cell[25436, 772, 142, 3, 25, "EchoTiming",ExpressionUUID->"dfb87c59-433c-4a76-bd17-279a54f9e515"],
Cell[25581, 777, 5846, 175, 170, "Output",ExpressionUUID->"69a77629-eb34-4abf-a28c-f7646eb2bda4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[31476, 958, 102, 0, 67, "Section",ExpressionUUID->"4da7c507-b2da-4d3c-b4ba-204336a6a034"],
Cell[31581, 960, 269, 4, 58, "Text",ExpressionUUID->"d1cdb173-0384-4640-8a4e-e834d8b5f008"],
Cell[31853, 966, 175, 4, 35, "Text",ExpressionUUID->"97387e12-e05e-4f96-ab12-48ab253a7813"],
Cell[CellGroupData[{
Cell[32053, 974, 276, 6, 52, "Input",ExpressionUUID->"84b94015-29f2-4e4a-8a3e-d637471c69ca"],
Cell[32332, 982, 1473, 46, 137, "Output",ExpressionUUID->"1bc58ee8-5250-45ac-ad7c-645562ea2aa1"]
}, Open  ]],
Cell[33820, 1031, 259, 8, 35, "Text",ExpressionUUID->"55ff4218-cc66-45d9-b76d-b519e4f50d05"],
Cell[CellGroupData[{
Cell[34104, 1043, 472, 11, 94, "Input",ExpressionUUID->"902f49fa-3c76-4c7b-8830-88f39fe45c99"],
Cell[34579, 1056, 1529, 45, 83, "Output",ExpressionUUID->"e4ff9fed-e92b-4be9-8ea6-414b7584af27"],
Cell[36111, 1103, 1629, 49, 83, "Output",ExpressionUUID->"5276733f-1789-43e0-bb65-78c0ee652173"]
}, Open  ]],
Cell[37755, 1155, 210, 3, 58, "Text",ExpressionUUID->"160d49d5-a338-47a8-9265-7403482657b9"],
Cell[CellGroupData[{
Cell[37990, 1162, 608, 17, 94, "Input",ExpressionUUID->"c84e4fb4-5faa-4448-a840-2631e18e5c1a"],
Cell[38601, 1181, 1816, 51, 83, "Output",ExpressionUUID->"b5aab612-0058-4082-af8c-cb9b1abacb04"],
Cell[40420, 1234, 1814, 51, 83, "Output",ExpressionUUID->"763ca53c-e2c6-4bce-915e-6276d0fff17b"]
}, Open  ]],
Cell[42249, 1288, 263, 6, 35, "Text",ExpressionUUID->"a1faad71-164f-4fd3-b29a-89aad02770ab"],
Cell[CellGroupData[{
Cell[42537, 1298, 330, 6, 52, "Input",ExpressionUUID->"8dab8bf4-2ae6-452b-90d7-1c28114faa0b"],
Cell[42870, 1306, 512, 14, 34, "Output",ExpressionUUID->"cacdab07-3489-4748-b696-5aa47e08822d"],
Cell[43385, 1322, 527, 14, 34, "Output",ExpressionUUID->"ff1bffd4-3783-4f89-9194-0990c1b877cc"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[43961, 1342, 103, 0, 67, "Section",ExpressionUUID->"c62f57c4-3e01-4c70-a7cb-059497618a3f"],
Cell[44067, 1344, 414, 8, 62, "Text",ExpressionUUID->"60befa21-8b32-4bd7-b203-3486b0544ad7"],
Cell[44484, 1354, 123, 0, 35, "Text",ExpressionUUID->"5f7b64fe-355e-4597-84b0-c4bf4f8e39a2"],
Cell[CellGroupData[{
Cell[44632, 1358, 204, 4, 30, "Input",ExpressionUUID->"932f111c-4b20-4e7d-8100-ae4b54405715"],
Cell[44839, 1364, 699, 20, 38, "Output",ExpressionUUID->"22f148d4-4c82-4850-9137-104be7641dcf"]
}, Open  ]],
Cell[45553, 1387, 397, 8, 62, "Text",ExpressionUUID->"0da2dde3-c0d7-4cc3-bb3a-4e7d4b660d9b"],
Cell[CellGroupData[{
Cell[45975, 1399, 315, 8, 52, "Input",ExpressionUUID->"1456cf93-82ee-4347-8bb4-a4bf8f7230b9"],
Cell[46293, 1409, 2705, 83, 49, "Output",ExpressionUUID->"2efe0363-d8ed-40bc-b5fc-8b4d7c35060a"]
}, Open  ]],
Cell[49013, 1495, 152, 2, 35, "Text",ExpressionUUID->"c71b0ec8-265b-4af8-9b62-a492207ab2ad"],
Cell[CellGroupData[{
Cell[49190, 1501, 240, 5, 52, "Input",ExpressionUUID->"84743373-77b0-41d8-bac6-75584995b7aa"],
Cell[49433, 1508, 1452, 42, 60, "Output",ExpressionUUID->"0eb17b28-f899-40aa-b9d4-1a9dcdabab2f"],
Cell[50888, 1552, 1450, 42, 60, "Output",ExpressionUUID->"b412ef9e-55d0-4bc5-af49-951ce756a733"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52375, 1599, 226, 3, 52, "Input",ExpressionUUID->"ce811e4a-1fb3-44c6-9f98-dbaeedab8296"],
Cell[52604, 1604, 152, 2, 34, "Output",ExpressionUUID->"f33563a3-87d5-4feb-8e4d-dc0c6cdb66e9"],
Cell[52759, 1608, 152, 2, 34, "Output",ExpressionUUID->"ee78792c-fa08-4e38-b08b-0e5025555036"]
}, Open  ]],
Cell[52926, 1613, 183, 3, 58, "Text",ExpressionUUID->"2d2ee55c-7683-4032-b604-448f6def29f1"],
Cell[CellGroupData[{
Cell[53134, 1620, 240, 5, 52, "Input",ExpressionUUID->"1b276799-7e9c-44d8-8a14-d572e5a06c81"],
Cell[53377, 1627, 1450, 42, 60, "Output",ExpressionUUID->"91fc2569-e12a-422d-b3d3-1af6a545967a"],
Cell[54830, 1671, 3351, 105, 87, "Output",ExpressionUUID->"1c22d5e8-786c-409f-927f-e1ac846d2694"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58218, 1781, 226, 3, 52, "Input",ExpressionUUID->"3992e45d-8470-40d5-b87a-f143e7db6a95"],
Cell[58447, 1786, 152, 2, 34, "Output",ExpressionUUID->"2970bc39-763f-4563-9a59-dd659215ccf6"],
Cell[58602, 1790, 153, 2, 34, "Output",ExpressionUUID->"b6e165ae-9136-4d44-8a2f-b45ba96cd3b5"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

