(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     49844,       1472]
NotebookOptionsPosition[     41631,       1337]
NotebookOutlinePosition[     42024,       1353]
CellTagsIndexPosition[     41981,       1350]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Clifford Operators: How To Test", "Title",ExpressionUUID->"f8956bb5-6e80-40c6-9084-831cefbfad1d"],

Cell[TextData[{
 "See also Section 6.3 of the ",
 ButtonBox["Quantum Workbook (Springer, 2022)",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1007/978-3-030-91214-7"], None}],
 "."
}], "Text",
 CellChangeTimes->{{3.85080797898475*^9, 3.850807984041913*^9}, {
   3.850808024812871*^9, 3.850808037947495*^9}, 3.850808121621657*^9, {
   3.85080823010712*^9, 3.850808231052006*^9}},
 TextAlignment->"Right",
 CellID->1308734266,ExpressionUUID->"3bea26dc-dc00-465f-a4e6-c8f5bf367fba"],

Cell[TextData[{
 "Given a unitary operator ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "dfa805fb-4c11-4bb7-88ac-3cbe67ff6717"],
 ", how can we check whether ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "238fb83c-af06-477d-aa14-9e22e8bc6b4c"],
 " is a Clifford operator or not?"
}], "Text",ExpressionUUID->"0a207f49-3481-4a09-b5af-23a15b39bbe7"],

Cell[TextData[{
 "A Clifford operator ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "10dc1914-da65-40fd-a37f-792814e851bb"],
 " transforms Pauli operators to other Pauli operators. Since Pauli operators \
are generated by single-qubit Pauli-",
 StyleBox["X",
  FontSlant->"Italic"],
 " and Pauli-",
 StyleBox["Z",
  FontSlant->"Italic"],
 " operators, a Clifford operator is completely specified (up to a global \
phase factor ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["e", 
    RowBox[{"\[ImaginaryI]", " ", "m", " ", 
     RowBox[{"\[Pi]", " ", "/", "4"}]}]], TraditionalForm]],ExpressionUUID->
  "dfef352a-59fb-469d-9392-471d2a951e37"],
 ") by the transformation of Pauli operators under conjugation by ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "b7f3dac9-2df7-4728-b3bb-1360d3f8dfe8"],
 ":\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubscriptBox["X", "j"], " ", 
     SuperscriptBox["U", "\[Dagger]"]}], "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      SubscriptBox["p", "j"]], 
     UnderoverscriptBox["\[CapitalPi]", 
      RowBox[{" ", 
       RowBox[{"i", "=", "1"}]}], 
      RowBox[{" ", "n"}]], 
     RowBox[{
      SubsuperscriptBox["X", "i", 
       SubscriptBox["a", 
        StyleBox["ij",
         FontSlant->"Italic"]]], 
      SubsuperscriptBox["Z", "i", 
       SubscriptBox["b", 
        StyleBox["ij",
         FontSlant->"Italic"]]]}]}]}], TraditionalForm]],ExpressionUUID->
  "be4a7059-d7e2-4546-9e79-0b0d542d0e95"],
 "\nand\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubscriptBox["Z", "j"], " ", 
     SuperscriptBox["U", "\[Dagger]"]}], "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      SubscriptBox["q", "j"]], 
     UnderoverscriptBox["\[CapitalPi]", 
      RowBox[{" ", 
       RowBox[{"i", "=", "1"}]}], 
      RowBox[{" ", "n"}]], 
     RowBox[{
      SubsuperscriptBox["X", "i", 
       SubscriptBox["c", 
        StyleBox["ij",
         FontSlant->"Italic"]]], 
      SubsuperscriptBox["Z", "i", 
       SubscriptBox["d", 
        StyleBox["ij",
         FontSlant->"Italic"]]]}]}]}], TraditionalForm]],ExpressionUUID->
  "c5643274-b9b6-4a2c-9f75-fd9922e060f0"],
 "."
}], "Text",
 CellID->1417856937,ExpressionUUID->"0b2b3941-3d08-418d-ac12-32588a3acf6e"],

Cell["Here, we are going to use this observation.", "Text",ExpressionUUID->"04556e6e-3091-4de4-bcd9-af1c3a0b068f"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellLabel->"In[46]:=",ExpressionUUID->"4c6db5e6-57d8-45a4-94f9-9ab208f3eb88"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[47]:=",ExpressionUUID->"1ceae594-1638-4e2b-9c11-73d6e0ef149c"],

Cell[CellGroupData[{

Cell["Simple Test", "Section",ExpressionUUID->"487808af-fd9e-4623-96c9-a2b70f9dff6b"],

Cell["Let us start with simple examples.", "Text",ExpressionUUID->"1db8f89f-fdd7-4935-ab76-385a0f1ad7c1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kk", "=", 
   RowBox[{"Range", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ss", "=", 
   RowBox[{"S", "[", 
    RowBox[{"kk", ",", "None"}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[53]:=",ExpressionUUID->"375a7901-d925-4f54-8f48-d799632d33fa"],

Cell["\<\
The Clifford group is finite and yet increases quite fast in size with the \
number of qubits.\
\>", "Text",ExpressionUUID->"7747342f-1940-460d-b0f5-5bbe8e1dc25e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"grp", "=", 
   RowBox[{"CliffordGroup", "[", "ss", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elm", "=", 
   RowBox[{"GroupElements", "[", "grp", "]"}]}], ";"}]}], "Input",
 CellLabel->"In[58]:=",ExpressionUUID->"8dfc1521-923c-4825-9e4c-cb122caa725b"],

Cell[BoxData[
 TemplateBox[{
  "CliffordGroup", "toobig", 
   "\"There are about \\!\\(\\*RowBox[{\\\"\\\\\\\"1.2\\\\\\\"\\\", \\\"\
\[Times]\\\", SuperscriptBox[\\\"10\\\", \\\"\\\\\\\"4\\\\\\\"\\\"]}]\\) \
elements in the group. Only the first 10 elements are returned.\"", 2, 59, 3, 
   33842165023499965717, "Local", "Q3`CliffordGroup"},
  "MessageTemplate2"]], "Message", "MSG",
 CellLabel->
  "During evaluation of \
In[58]:=",ExpressionUUID->"b65703b3-7ff7-4dd6-bbc8-3caa490887ec"]
}, Open  ]],

Cell["Here is the total number of Clifford operators in this case.", "Text",ExpressionUUID->"be77ebca-eaf0-4180-ad0b-ebe9686743ee"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"odr", "=", 
  RowBox[{"GroupOrder", "[", "grp", "]"}]}]], "Input",
 CellLabel->"In[65]:=",ExpressionUUID->"65f322ae-e898-47a7-ab3b-1f07e567011f"],

Cell[BoxData["11520"], "Output",
 CellLabel->"Out[65]=",ExpressionUUID->"3b8f22f7-7966-4fb1-97a9-b0bc8098a224"]
}, Open  ]],

Cell["Let us choose one randomly.", "Text",ExpressionUUID->"0c0220eb-9587-44bf-8c5a-4612966a189f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ptr", "=", 
  RowBox[{"RandomInteger", "[", 
   RowBox[{"{", 
    RowBox[{"1", ",", "odr"}], "}"}], "]"}]}]], "Input",
 CellLabel->"In[66]:=",ExpressionUUID->"09ca97dd-8c65-4212-9eed-5ab9eeecc633"],

Cell[BoxData["5909"], "Output",
 CellLabel->"Out[66]=",ExpressionUUID->"00ce464a-9e84-44f3-a26a-8435fd50ae54"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"opc", "=", 
  RowBox[{"First", "@", 
   RowBox[{"GroupElements", "[", 
    RowBox[{"grp", ",", 
     RowBox[{"{", "ptr", "}"}]}], "]"}]}]}]], "Input",
 CellLabel->"In[67]:=",ExpressionUUID->"d9f2378c-68ba-441f-a6c8-fb95144eef4f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "4"], "-", 
     FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"], 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "4"], "+", 
     FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"], 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "4"], "-", 
     FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"y\""}, "RowDefault"]},
      "Subsuperscript"], 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"]}],
    DisplayForm]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "4"], "-", 
     FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
   TagBox[
    RowBox[{
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"], 
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"2"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"]}],
    DisplayForm]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "4"], "-", 
     FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "4"], "-", 
     FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "4"], "+", 
     FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "4"], "-", 
     FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"]}]}]], "Output",
 CellLabel->"Out[67]=",ExpressionUUID->"214f4364-e839-4df7-97a4-2d6a7dde9fe1"]
}, Open  ]],

Cell["\<\
The CliffordQ function provided by Q3 confirms that it is indeed a Clifford \
operator.\
\>", "Text",ExpressionUUID->"94cfc894-9ec9-494d-84b8-f229c3487b26"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CliffordQ", "[", "opc", "]"}]], "Input",
 CellLabel->"In[69]:=",ExpressionUUID->"66dbafa4-c94f-485a-872b-d7a4463225aa"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[69]=",ExpressionUUID->"a823a035-e678-4106-a0d7-025ee2616f5f"]
}, Open  ]],

Cell[TextData[{
 "Pick up single-qubit Pauli-",
 StyleBox["X",
  FontSlant->"Italic"],
 " and Pauli-",
 StyleBox["Z",
  FontSlant->"Italic"],
 " operators."
}], "Text",ExpressionUUID->"117354f9-70cf-4ca9-bfb7-b2a25fe4e61a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"opx", "=", 
  RowBox[{"S", "[", 
   RowBox[{"kk", ",", "1"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"opz", "=", 
  RowBox[{"S", "[", 
   RowBox[{"kk", ",", "3"}], "]"}]}]}], "Input",
 CellLabel->"In[72]:=",ExpressionUUID->"3866bf62-884c-4ba0-a3d7-66c7617ab8cc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], ",", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"]}], "}"}]], "Output",
 CellLabel->"Out[72]=",ExpressionUUID->"e2618820-15dd-4ac5-829c-674603a5fa1e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"], ",", 
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"]}], "}"}]], "Output",
 CellLabel->"Out[73]=",ExpressionUUID->"9ab7b9c1-1586-44b7-bcdc-2c1aac85b6c0"]
}, Open  ]],

Cell[TextData[{
 "Under the conjugation by the operator ",
 StyleBox["opc", "Input"],
 " in question, the single-qubit Pauli-X and Pauli-Z operators result in \
certain Pauli operators, confirming again that the operator ",
 StyleBox["opc", "Input"],
 " is a Clifford operator."
}], "Text",ExpressionUUID->"ea723f27-1397-4b8b-8f79-36bb7f38f2e0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Timing", "[", 
  RowBox[{"opc", "**", "opx", "**", 
   RowBox[{"Dagger", "[", "opc", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{"opc", "**", "opz", "**", 
   RowBox[{"Dagger", "[", "opc", "]"}]}], "]"}]}], "Input",
 CellLabel->"In[76]:=",ExpressionUUID->"af2b1b23-9da7-4547-9045-6e3a21d9d586"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.059004`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      TagBox[
       RowBox[{
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"y\""}, "RowDefault"]},
         "Subsuperscript"], 
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"]}],
       DisplayForm]}], ",", 
     RowBox[{"-", 
      TagBox[
       RowBox[{
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"], 
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"], 
          TemplateBox[{"\"y\""}, "RowDefault"]},
         "Subsuperscript"]}],
       DisplayForm]}]}], "}"}]}], "}"}]], "Output",
 CellLabel->"Out[76]=",ExpressionUUID->"2b14ac6c-144f-48b1-b2bb-5df0b45084cb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.038526`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"]}], ",", 
     RowBox[{"-", 
      TagBox[
       RowBox[{
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"z\""}, "RowDefault"]},
         "Subsuperscript"], 
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"], 
          TemplateBox[{"\"y\""}, "RowDefault"]},
         "Subsuperscript"]}],
       DisplayForm]}]}], "}"}]}], "}"}]], "Output",
 CellLabel->"Out[77]=",ExpressionUUID->"0de93b4c-c3dd-483f-9bce-9da8328b8b1f"]
}, Open  ]],

Cell[TextData[{
 "Now, consider a new operator involving the octant phase operator on the \
first qubit. Note that the  octant phase operator is not a Clifford operator. \
Indeed, the results involve several terms of Pauli operators indicating that \
the operator ",
 StyleBox["opd", "Input"],
 " is not a Clifford operator."
}], "Text",ExpressionUUID->"039b07a8-568d-40fc-9f76-8ae794ba8bfb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"opd", "=", 
   RowBox[{"opc", "**", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "8"}], "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[79]:=",ExpressionUUID->"64822854-1aaa-4c01-8831-532202b6e9a1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Timing", "[", 
  RowBox[{"out", "=", 
   RowBox[{"opd", "**", "opx", "**", 
    RowBox[{"Dagger", "[", "opd", "]"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{"out", "=", 
   RowBox[{"opd", "**", "opz", "**", 
    RowBox[{"Dagger", "[", "opd", "]"}]}]}], "]"}]}], "Input",
 CellLabel->"In[82]:=",ExpressionUUID->"077da391-1cc1-4e10-a4d2-8b29bc053da6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.198811`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        TagBox[
         RowBox[{
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"], 
            TemplateBox[{"\"y\""}, "RowDefault"]},
           "Subsuperscript"], 
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"x\""}, "RowDefault"]},
           "Subsuperscript"]}],
         DisplayForm], 
        SqrtBox["2"]]}], "-", 
      FractionBox[
       TagBox[
        RowBox[{
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]},
          "Subsuperscript"], 
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]},
          "Subsuperscript"]}],
        DisplayForm], 
       SqrtBox["2"]]}], ",", 
     RowBox[{"-", 
      TagBox[
       RowBox[{
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]},
         "Subsuperscript"], 
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"], 
          TemplateBox[{"\"y\""}, "RowDefault"]},
         "Subsuperscript"]}],
       DisplayForm]}]}], "}"}]}], "}"}]], "Output",
 CellLabel->"Out[82]=",ExpressionUUID->"5cf1066e-236a-4e74-bf15-42f9d438f30e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.186148`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"y\""}, "RowDefault"]},
       "Subsuperscript"]}], ",", 
     RowBox[{"-", 
      TagBox[
       RowBox[{
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"z\""}, "RowDefault"]},
         "Subsuperscript"], 
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"], 
          TemplateBox[{"\"y\""}, "RowDefault"]},
         "Subsuperscript"]}],
       DisplayForm]}]}], "}"}]}], "}"}]], "Output",
 CellLabel->"Out[83]=",ExpressionUUID->"93ad1e9c-5f04-42da-852a-2c7d0399f022"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Using Matrix Representations", "Section",ExpressionUUID->"4da7c507-b2da-4d3c-b4ba-204336a6a034"],

Cell["\<\
In principle, the above test works. Unfortunately, however, the method \
quickly gets slower with the number of qubits. To improve the speed of the \
test, we use the matrix representations.\
\>", "Text",ExpressionUUID->"d1cdb173-0384-4640-8a4e-e834d8b5f008"],

Cell[TextData[{
 "Here is the matrix representation of the given operator ",
 StyleBox["opc", "Input"],
 "."
}], "Text",ExpressionUUID->"97387e12-e05e-4f96-ab12-48ab253a7813"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"matc", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"opc", ",", "ss"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"matc", "//", "MatrixForm"}]}], "Input",
 CellLabel->
  "In[110]:=",ExpressionUUID->"84b94015-29f2-4e4a-8a3e-d637471c69ca"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox["1", "2"], "-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0", "0", 
      RowBox[{
       FractionBox["1", "2"], "-", 
       FractionBox["\[ImaginaryI]", "2"]}]},
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], "-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0", "0", 
      RowBox[{
       FractionBox["1", "2"], "+", 
       FractionBox["\[ImaginaryI]", "2"]}]},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], "-", 
       FractionBox["\[ImaginaryI]", "2"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], "+", 
       FractionBox["\[ImaginaryI]", "2"]}], "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], "-", 
       FractionBox["\[ImaginaryI]", "2"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], "-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 4, 8, 12, 16}, {{1}, {2}, {3}, {4}, {2}, {1}, {4}, {3}, {3}, {
       4}, {1}, {2}, {4}, {3}, {2}, {1}}}, {
      Complex[Rational[1, 2], Rational[-1, 2]], 0, 0, Complex[
       Rational[1, 2], Rational[-1, 2]], 0, Complex[
       Rational[-1, 2], Rational[-1, 2]], Complex[
       Rational[1, 2], Rational[1, 2]], 0, Complex[
       Rational[-1, 2], Rational[1, 2]], 0, 0, Complex[
       Rational[1, 2], Rational[-1, 2]], 0, Complex[
       Rational[-1, 2], Rational[-1, 2]], Complex[
       Rational[-1, 2], Rational[-1, 2]], 0}}]]]]], "Output",
 CellLabel->
  "Out[111]//MatrixForm=",ExpressionUUID->"7a15ac42-c0e3-4d62-bcc3-\
2bb21f1a6531"]
}, Open  ]],

Cell[TextData[{
 "These are the matrix representations of the single-qubit Pauli-",
 StyleBox["X",
  FontSlant->"Italic"],
 " and Pauli-",
 StyleBox["Z",
  FontSlant->"Italic"],
 " operators."
}], "Text",ExpressionUUID->"55ff4218-cc66-45d9-b76d-b519e4f50d05"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"matx", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"opx", ",", "ss"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matz", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"opz", ",", "ss"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "/@", "matx"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "/@", "matz"}]}], "Input",
 CellLabel->
  "In[112]:=",ExpressionUUID->"902f49fa-3c76-4c7b-8830-88f39fe45c99"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"},
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{3}, {4}, {1}, {2}}}, {1, 1, 1, 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "1", "0", "0"},
       {"1", "0", "0", "0"},
       {"0", "0", "0", "1"},
       {"0", "0", "1", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{2}, {1}, {4}, {3}}}, {1, 1, 1, 1}}]]]]}], 
  "}"}]], "Output",
 CellLabel->
  "Out[114]=",ExpressionUUID->"edbc6abb-dba5-4f28-9dec-e94131d33f9b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"-", "1"}], "0"},
       {"0", "0", "0", 
        RowBox[{"-", "1"}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {1, 1, -1, -1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"-", "1"}], "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", 
        RowBox[{"-", "1"}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {1, -1, 1, -1}}]]]]}], 
  "}"}]], "Output",
 CellLabel->
  "Out[115]=",ExpressionUUID->"cd4c54de-8114-4938-ae35-b3a8c8b37633"]
}, Open  ]],

Cell["\<\
The single-qubit Pauli-X and Pauli-Z operators (i.e., their matrix \
representation) transform under the given operator as follows.\
\>", "Text",ExpressionUUID->"160d49d5-a338-47a8-9265-7403482657b9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"outx", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"matc", ".", "#", ".", 
      RowBox[{"Topple", "[", "matc", "]"}]}], "&"}], "/@", "matx"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outz", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"matc", ".", "#", ".", 
      RowBox[{"Topple", "[", "matc", "]"}]}], "&"}], "/@", "matz"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "/@", "outx"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "/@", "outz"}]}], "Input",
 CellLabel->
  "In[116]:=",ExpressionUUID->"c84e4fb4-5faa-4448-a840-2631e18e5c1a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "\[ImaginaryI]"},
       {"0", "0", "\[ImaginaryI]", "0"},
       {"0", 
        RowBox[{"-", "\[ImaginaryI]"}], "0", "0"},
       {
        RowBox[{"-", "\[ImaginaryI]"}], "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 4, 8, 12, 16}, {{1}, {2}, {3}, {4}, {1}, {2}, {3}, {4}, {1}, {
         2}, {3}, {4}, {1}, {2}, {3}, {4}}}, {
        0, 0, 0, Complex[0, 1], 0, 0, Complex[0, 1], 0, 0, Complex[0, -1], 0, 
         0, Complex[0, -1], 0, 0, 0}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "\[ImaginaryI]"},
       {"0", "0", 
        RowBox[{"-", "\[ImaginaryI]"}], "0"},
       {"0", "\[ImaginaryI]", "0", "0"},
       {
        RowBox[{"-", "\[ImaginaryI]"}], "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 4, 8, 12, 16}, {{1}, {2}, {3}, {4}, {1}, {2}, {3}, {4}, {1}, {
         2}, {3}, {4}, {1}, {2}, {3}, {4}}}, {
        0, 0, 0, Complex[0, 1], 0, 0, Complex[0, -1], 0, 0, Complex[0, 1], 0, 
         0, Complex[0, -1], 0, 0, 0}}]]]]}], "}"}]], "Output",
 CellLabel->
  "Out[118]=",ExpressionUUID->"d5a0608b-4443-4fea-a760-0a188aa54510"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "\[ImaginaryI]", "0", "0"},
       {
        RowBox[{"-", "\[ImaginaryI]"}], "0", "0", "0"},
       {"0", "0", "0", "\[ImaginaryI]"},
       {"0", "0", 
        RowBox[{"-", "\[ImaginaryI]"}], "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 4, 8, 12, 16}, {{1}, {2}, {3}, {4}, {1}, {2}, {3}, {4}, {1}, {
         2}, {3}, {4}, {1}, {2}, {3}, {4}}}, {
        0, Complex[0, 1], 0, 0, Complex[0, -1], 0, 0, 0, 0, 0, 0, Complex[
         0, 1], 0, 0, Complex[0, -1], 0}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "\[ImaginaryI]", "0", "0"},
       {
        RowBox[{"-", "\[ImaginaryI]"}], "0", "0", "0"},
       {"0", "0", "0", 
        RowBox[{"-", "\[ImaginaryI]"}]},
       {"0", "0", "\[ImaginaryI]", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 4, 8, 12, 16}, {{1}, {2}, {3}, {4}, {1}, {2}, {3}, {4}, {1}, {
         2}, {3}, {4}, {1}, {2}, {3}, {4}}}, {
        0, Complex[0, 1], 0, 0, Complex[0, -1], 0, 0, 0, 0, 0, 0, Complex[
         0, -1], 0, 0, Complex[0, 1], 0}}]]]]}], "}"}]], "Output",
 CellLabel->
  "Out[119]=",ExpressionUUID->"b8af73ed-2641-47d2-ae92-5abc14edfd9f"]
}, Open  ]],

Cell[TextData[{
 "These results represents Pauli operators. This is seen by taking the ",
 ButtonBox["Pauli decomposition",
  BaseStyle->"Link",
  ButtonData->"paclet:Q3/ref/PauliDecompose"],
 "."
}], "Text",ExpressionUUID->"a1faad71-164f-4fd3-b29a-89aad02770ab"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"rrx", "=", 
  RowBox[{"Most", "/@", 
   RowBox[{"ArrayRules", "/@", 
    RowBox[{"PauliDecompose", "/@", "outx"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"rrz", "=", 
  RowBox[{"Most", "/@", 
   RowBox[{"ArrayRules", "/@", 
    RowBox[{"PauliDecompose", "/@", "outz"}]}]}]}]}], "Input",
 CellLabel->
  "In[124]:=",ExpressionUUID->"b8770c7d-1869-4dbf-bbc7-3e37bba37ecd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "2"}], "}"}], "\[Rule]", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], "\[Rule]", 
     RowBox[{"-", "1"}]}], "}"}]}], "}"}]], "Output",
 CellLabel->
  "Out[124]=",ExpressionUUID->"1dea690d-edc4-44e9-b205-4ba651a0081e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], "\[Rule]", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "3"}], "}"}], "\[Rule]", 
     RowBox[{"-", "1"}]}], "}"}]}], "}"}]], "Output",
 CellLabel->
  "Out[125]=",ExpressionUUID->"36ea52e6-c149-44b3-9792-e1d8b29a6278"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Relation to Stabilizer States", "Section",ExpressionUUID->"c62f57c4-3e01-4c70-a7cb-059497618a3f"],

Cell[TextData[{
 "A state is called a stabilizer state if it can be generated from ",
 Cell[BoxData[
  TemplateBox[{
    RowBox[{"00", "\[Ellipsis]0"}]},
   "Ket"]],ExpressionUUID->"6df9d786-451e-4d30-87d4-80a381d13165"],
 "by a Clifford operator. It is called that name since such a state can be \
stabilized by some non-trivial Pauli operators."
}], "Text",ExpressionUUID->"60befa21-8b32-4bd7-b203-3486b0544ad7"],

Cell["So, we consider the following typical initial state.", "Text",ExpressionUUID->"5f7b64fe-355e-4597-84b0-c4bf4f8e39a2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Ket", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"in", ",", "ss"}], "]"}]}], "Input",
 CellLabel->
  "In[180]:=",ExpressionUUID->"932f111c-4b20-4e7d-8100-ae4b54405715"],

Cell[BoxData[
 TemplateBox[{
   TagBox[
    TemplateBox[{
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"]]], 
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
  "Ket"]], "Output",
 CellLabel->
  "Out[181]=",ExpressionUUID->"efd69947-4331-484a-8169-3b38b736db58"]
}, Open  ]],

Cell[TextData[{
 "Some Clifford operators (e.g., the octant phase operator) operates in a \
trivial way on such a special state as ",
 Cell[BoxData[
  TemplateBox[{
    RowBox[{"00", "\[Ellipsis]0"}]},
   "Ket"]],ExpressionUUID->"92227b9f-e640-440d-b91d-c72c0fb5082a"],
 ". Therefore, we consider another common stabilizer state."
}], "Text",ExpressionUUID->"0da2dde3-c0d7-4cc3-bb3a-4e7d4b660d9b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"hh", "=", 
   RowBox[{"Multiply", "@@", 
    RowBox[{"S", "[", 
     RowBox[{"kk", ",", "6"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"hh", "=", 
  RowBox[{"hh", "**", "in"}]}]}], "Input",
 CellLabel->
  "In[182]:=",ExpressionUUID->"1456cf93-82ee-4347-8bb4-a4bf8f7230b9"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{"\"\[SpaceIndicator]\""},
    "Ket"], "2"], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], "2"], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], "2"]}]], "Output",
 CellLabel->
  "Out[183]=",ExpressionUUID->"83e06c78-1380-4717-89c5-46b02ac517c6"]
}, Open  ]],

Cell["\<\
A Clifford operator transforms both states to different stablizer states.\
\>", "Text",ExpressionUUID->"c71b0ec8-265b-4af8-9b62-a492207ab2ad"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"out1", "=", 
  RowBox[{"opc", "**", "in"}]}], "\[IndentingNewLine]", 
 RowBox[{"out2", "=", 
  RowBox[{"opc", "**", "hh"}]}]}], "Input",
 CellLabel->
  "In[184]:=",ExpressionUUID->"84743373-77b0-41d8-bac6-75584995b7aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "2"], "-", 
     FractionBox["\[ImaginaryI]", "2"]}], ")"}], " ", 
   TemplateBox[{"\"\[SpaceIndicator]\""},
    "Ket"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "2"], "+", 
     FractionBox["\[ImaginaryI]", "2"]}], ")"}], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellLabel->
  "Out[184]=",ExpressionUUID->"d2a812e4-412a-4105-b83c-f6f2df4c0d89"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "2"], "-", 
     FractionBox["\[ImaginaryI]", "2"]}], ")"}], " ", 
   TemplateBox[{"\"\[SpaceIndicator]\""},
    "Ket"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "2"], "+", 
     FractionBox["\[ImaginaryI]", "2"]}], ")"}], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellLabel->
  "Out[185]=",ExpressionUUID->"aaa165d2-5bf9-4d3c-81ba-37f45ba6863a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"StabilizerStateQ", "[", "out1", "]"}], "\[IndentingNewLine]", 
 RowBox[{"StabilizerStateQ", "[", "out2", "]"}]}], "Input",
 CellLabel->
  "In[186]:=",ExpressionUUID->"ce811e4a-1fb3-44c6-9f98-dbaeedab8296"],

Cell[BoxData["True"], "Output",
 CellLabel->
  "Out[186]=",ExpressionUUID->"bdc4c3e0-8ead-4959-91b7-c79ed68536e5"],

Cell[BoxData["True"], "Output",
 CellLabel->
  "Out[187]=",ExpressionUUID->"75d04a84-b8c1-48ab-bb25-2481837cd370"]
}, Open  ]],

Cell["\<\
On the other hand, a non-Clifford operator transforms either or both states \
to a non-stabilizer state.\
\>", "Text",ExpressionUUID->"2d2ee55c-7683-4032-b604-448f6def29f1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"new1", "=", 
  RowBox[{"opd", "**", "in"}]}], "\[IndentingNewLine]", 
 RowBox[{"new2", "=", 
  RowBox[{"opd", "**", "hh"}]}]}], "Input",
 CellLabel->
  "In[188]:=",ExpressionUUID->"1b276799-7e9c-44d8-8a14-d572e5a06c81"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "2"], "-", 
     FractionBox["\[ImaginaryI]", "2"]}], ")"}], " ", 
   TemplateBox[{"\"\[SpaceIndicator]\""},
    "Ket"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "2"], "+", 
     FractionBox["\[ImaginaryI]", "2"]}], ")"}], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellLabel->
  "Out[188]=",ExpressionUUID->"f064d572-03d2-4028-81f3-dad67cbd4a64"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   TemplateBox[{"\"\[SpaceIndicator]\""},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[ImaginaryI]"}], ")"}], "-", 
     SqrtBox["2"]}], ")"}], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellLabel->
  "Out[189]=",ExpressionUUID->"45733aca-4e0b-4d96-b3c9-5bac84aad7a9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"StabilizerStateQ", "[", "new1", "]"}], "\[IndentingNewLine]", 
 RowBox[{"StabilizerStateQ", "[", "new2", "]"}]}], "Input",
 CellLabel->
  "In[190]:=",ExpressionUUID->"3992e45d-8470-40d5-b87a-f143e7db6a95"],

Cell[BoxData["True"], "Output",
 CellLabel->
  "Out[190]=",ExpressionUUID->"e81573f7-7cc3-4cfe-8735-ac653bb15a1d"],

Cell[BoxData["False"], "Output",
 CellLabel->
  "Out[191]=",ExpressionUUID->"2bbd4340-8ec1-47ac-8c2a-2320166e6468"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{735, 891},
WindowMargins->{{Automatic, 212}, {Automatic, 0}},
FrontEndVersion->"13.1 for Mac OS X ARM (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e5401879-4c30-4562-a36a-301bf5dfda5b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 103, 0, 98, "Title",ExpressionUUID->"f8956bb5-6e80-40c6-9084-831cefbfad1d"],
Cell[686, 24, 504, 12, 35, "Text",ExpressionUUID->"3bea26dc-dc00-465f-a4e6-c8f5bf367fba",
 CellID->1308734266],
Cell[1193, 38, 457, 12, 35, "Text",ExpressionUUID->"0a207f49-3481-4a09-b5af-23a15b39bbe7"],
Cell[1653, 52, 2404, 78, 205, "Text",ExpressionUUID->"0b2b3941-3d08-418d-ac12-32588a3acf6e",
 CellID->1417856937],
Cell[4060, 132, 114, 0, 35, "Text",ExpressionUUID->"04556e6e-3091-4de4-bcd9-af1c3a0b068f"],
Cell[4177, 134, 126, 2, 30, "Input",ExpressionUUID->"4c6db5e6-57d8-45a4-94f9-9ab208f3eb88"],
Cell[4306, 138, 162, 3, 30, "Input",ExpressionUUID->"1ceae594-1638-4e2b-9c11-73d6e0ef149c"],
Cell[CellGroupData[{
Cell[4493, 145, 85, 0, 67, "Section",ExpressionUUID->"487808af-fd9e-4623-96c9-a2b70f9dff6b"],
Cell[4581, 147, 105, 0, 35, "Text",ExpressionUUID->"1db8f89f-fdd7-4935-ab76-385a0f1ad7c1"],
Cell[4689, 149, 379, 10, 73, "Input",ExpressionUUID->"375a7901-d925-4f54-8f48-d799632d33fa"],
Cell[5071, 161, 173, 3, 35, "Text",ExpressionUUID->"7747342f-1940-460d-b0f5-5bbe8e1dc25e"],
Cell[CellGroupData[{
Cell[5269, 168, 308, 8, 52, "Input",ExpressionUUID->"8dfc1521-923c-4825-9e4c-cb122caa725b"],
Cell[5580, 178, 488, 10, 28, "Message",ExpressionUUID->"b65703b3-7ff7-4dd6-bbc8-3caa490887ec"]
}, Open  ]],
Cell[6083, 191, 131, 0, 35, "Text",ExpressionUUID->"be77ebca-eaf0-4180-ad0b-ebe9686743ee"],
Cell[CellGroupData[{
Cell[6239, 195, 169, 3, 30, "Input",ExpressionUUID->"65f322ae-e898-47a7-ab3b-1f07e567011f"],
Cell[6411, 200, 111, 1, 34, "Output",ExpressionUUID->"3b8f22f7-7966-4fb1-97a9-b0bc8098a224"]
}, Open  ]],
Cell[6537, 204, 98, 0, 35, "Text",ExpressionUUID->"0c0220eb-9587-44bf-8c5a-4612966a189f"],
Cell[CellGroupData[{
Cell[6660, 208, 221, 5, 30, "Input",ExpressionUUID->"09ca97dd-8c65-4212-9eed-5ab9eeecc633"],
Cell[6884, 215, 110, 1, 34, "Output",ExpressionUUID->"00ce464a-9e84-44f3-a26a-8435fd50ae54"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7031, 221, 253, 6, 30, "Input",ExpressionUUID->"d9f2378c-68ba-441f-a6c8-fb95144eef4f"],
Cell[7287, 229, 3441, 114, 87, "Output",ExpressionUUID->"214f4364-e839-4df7-97a4-2d6a7dde9fe1"]
}, Open  ]],
Cell[10743, 346, 166, 3, 35, "Text",ExpressionUUID->"94cfc894-9ec9-494d-84b8-f229c3487b26"],
Cell[CellGroupData[{
Cell[10934, 353, 143, 2, 30, "Input",ExpressionUUID->"66dbafa4-c94f-485a-872b-d7a4463225aa"],
Cell[11080, 357, 110, 1, 34, "Output",ExpressionUUID->"a823a035-e678-4106-a0d7-025ee2616f5f"]
}, Open  ]],
Cell[11205, 361, 223, 8, 35, "Text",ExpressionUUID->"117354f9-70cf-4ca9-bfb7-b2a25fe4e61a"],
Cell[CellGroupData[{
Cell[11453, 373, 290, 7, 52, "Input",ExpressionUUID->"3866bf62-884c-4ba0-a3d7-66c7617ab8cc"],
Cell[11746, 382, 472, 13, 37, "Output",ExpressionUUID->"e2618820-15dd-4ac5-829c-674603a5fa1e"],
Cell[12221, 397, 472, 13, 37, "Output",ExpressionUUID->"9ab7b9c1-1586-44b7-bcdc-2c1aac85b6c0"]
}, Open  ]],
Cell[12708, 413, 345, 7, 81, "Text",ExpressionUUID->"ea723f27-1397-4b8b-8f79-36bb7f38f2e0"],
Cell[CellGroupData[{
Cell[13078, 424, 350, 7, 52, "Input",ExpressionUUID->"af2b1b23-9da7-4547-9045-6e3a21d9d586"],
Cell[13431, 433, 1107, 33, 38, "Output",ExpressionUUID->"2b14ac6c-144f-48b1-b2bb-5df0b45084cb"],
Cell[14541, 468, 854, 25, 38, "Output",ExpressionUUID->"0de93b4c-c3dd-483f-9bce-9da8328b8b1f"]
}, Open  ]],
Cell[15410, 496, 392, 7, 81, "Text",ExpressionUUID->"039b07a8-568d-40fc-9f76-8ae794ba8bfb"],
Cell[15805, 505, 231, 6, 30, "Input",ExpressionUUID->"64822854-1aaa-4c01-8831-532202b6e9a1"],
Cell[CellGroupData[{
Cell[16061, 515, 404, 9, 52, "Input",ExpressionUUID->"077da391-1cc1-4e10-a4d2-8b29bc053da6"],
Cell[16468, 526, 1687, 51, 59, "Output",ExpressionUUID->"5cf1066e-236a-4e74-bf15-42f9d438f30e"],
Cell[18158, 579, 854, 25, 38, "Output",ExpressionUUID->"93ad1e9c-5f04-42da-852a-2c7d0399f022"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19061, 610, 102, 0, 67, "Section",ExpressionUUID->"4da7c507-b2da-4d3c-b4ba-204336a6a034"],
Cell[19166, 612, 269, 4, 58, "Text",ExpressionUUID->"d1cdb173-0384-4640-8a4e-e834d8b5f008"],
Cell[19438, 618, 175, 4, 35, "Text",ExpressionUUID->"97387e12-e05e-4f96-ab12-48ab253a7813"],
Cell[CellGroupData[{
Cell[19638, 626, 280, 7, 52, "Input",ExpressionUUID->"84b94015-29f2-4e4a-8a3e-d637471c69ca"],
Cell[19921, 635, 2058, 60, 129, "Output",ExpressionUUID->"7a15ac42-c0e3-4d62-bcc3-2bb21f1a6531"]
}, Open  ]],
Cell[21994, 698, 259, 8, 35, "Text",ExpressionUUID->"55ff4218-cc66-45d9-b76d-b519e4f50d05"],
Cell[CellGroupData[{
Cell[22278, 710, 476, 12, 94, "Input",ExpressionUUID->"902f49fa-3c76-4c7b-8830-88f39fe45c99"],
Cell[22757, 724, 1491, 45, 83, "Output",ExpressionUUID->"edbc6abb-dba5-4f28-9dec-e94131d33f9b"],
Cell[24251, 771, 1591, 49, 83, "Output",ExpressionUUID->"cd4c54de-8114-4938-ae35-b3a8c8b37633"]
}, Open  ]],
Cell[25857, 823, 210, 3, 58, "Text",ExpressionUUID->"160d49d5-a338-47a8-9265-7403482657b9"],
Cell[CellGroupData[{
Cell[26092, 830, 612, 18, 94, "Input",ExpressionUUID->"c84e4fb4-5faa-4448-a840-2631e18e5c1a"],
Cell[26707, 850, 2034, 54, 83, "Output",ExpressionUUID->"d5a0608b-4443-4fea-a760-0a188aa54510"],
Cell[28744, 906, 2034, 54, 83, "Output",ExpressionUUID->"b8af73ed-2641-47d2-ae92-5abc14edfd9f"]
}, Open  ]],
Cell[30793, 963, 263, 6, 35, "Text",ExpressionUUID->"a1faad71-164f-4fd3-b29a-89aad02770ab"],
Cell[CellGroupData[{
Cell[31081, 973, 394, 10, 52, "Input",ExpressionUUID->"b8770c7d-1869-4dbf-bbc7-3e37bba37ecd"],
Cell[31478, 985, 414, 14, 34, "Output",ExpressionUUID->"1dea690d-edc4-44e9-b205-4ba651a0081e"],
Cell[31895, 1001, 414, 14, 34, "Output",ExpressionUUID->"36ea52e6-c149-44b3-9792-e1d8b29a6278"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32358, 1021, 103, 0, 67, "Section",ExpressionUUID->"c62f57c4-3e01-4c70-a7cb-059497618a3f"],
Cell[32464, 1023, 414, 8, 62, "Text",ExpressionUUID->"60befa21-8b32-4bd7-b203-3486b0544ad7"],
Cell[32881, 1033, 123, 0, 35, "Text",ExpressionUUID->"5f7b64fe-355e-4597-84b0-c4bf4f8e39a2"],
Cell[CellGroupData[{
Cell[33029, 1037, 269, 7, 52, "Input",ExpressionUUID->"932f111c-4b20-4e7d-8100-ae4b54405715"],
Cell[33301, 1046, 459, 14, 38, "Output",ExpressionUUID->"efd69947-4331-484a-8169-3b38b736db58"]
}, Open  ]],
Cell[33775, 1063, 397, 8, 62, "Text",ExpressionUUID->"0da2dde3-c0d7-4cc3-bb3a-4e7d4b660d9b"],
Cell[CellGroupData[{
Cell[34197, 1075, 319, 9, 52, "Input",ExpressionUUID->"1456cf93-82ee-4347-8bb4-a4bf8f7230b9"],
Cell[34519, 1086, 1143, 38, 55, "Output",ExpressionUUID->"83e06c78-1380-4717-89c5-46b02ac517c6"]
}, Open  ]],
Cell[35677, 1127, 152, 2, 35, "Text",ExpressionUUID->"c71b0ec8-265b-4af8-9b62-a492207ab2ad"],
Cell[CellGroupData[{
Cell[35854, 1133, 244, 6, 52, "Input",ExpressionUUID->"84743373-77b0-41d8-bac6-75584995b7aa"],
Cell[36101, 1141, 677, 23, 49, "Output",ExpressionUUID->"d2a812e4-412a-4105-b83c-f6f2df4c0d89"],
Cell[36781, 1166, 819, 27, 49, "Output",ExpressionUUID->"aaa165d2-5bf9-4d3c-81ba-37f45ba6863a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37637, 1198, 230, 4, 52, "Input",ExpressionUUID->"ce811e4a-1fb3-44c6-9f98-dbaeedab8296"],
Cell[37870, 1204, 114, 2, 34, "Output",ExpressionUUID->"bdc4c3e0-8ead-4959-91b7-c79ed68536e5"],
Cell[37987, 1208, 114, 2, 34, "Output",ExpressionUUID->"75d04a84-b8c1-48ab-bb25-2481837cd370"]
}, Open  ]],
Cell[38116, 1213, 183, 3, 58, "Text",ExpressionUUID->"2d2ee55c-7683-4032-b604-448f6def29f1"],
Cell[CellGroupData[{
Cell[38324, 1220, 244, 6, 52, "Input",ExpressionUUID->"1b276799-7e9c-44d8-8a14-d572e5a06c81"],
Cell[38571, 1228, 677, 23, 49, "Output",ExpressionUUID->"f064d572-03d2-4028-81f3-dad67cbd4a64"],
Cell[39251, 1253, 1838, 62, 87, "Output",ExpressionUUID->"45733aca-4e0b-4d96-b3c9-5bac84aad7a9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41126, 1320, 230, 4, 52, "Input",ExpressionUUID->"3992e45d-8470-40d5-b87a-f143e7db6a95"],
Cell[41359, 1326, 114, 2, 34, "Output",ExpressionUUID->"e81573f7-7cc3-4cfe-8735-ac653bb15a1d"],
Cell[41476, 1330, 115, 2, 34, "Output",ExpressionUUID->"2bbd4340-8ec1-47ac-8c2a-2320166e6468"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

