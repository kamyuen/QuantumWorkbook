(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     79834,       2255]
NotebookOptionsPosition[     68772,       2066]
NotebookOutlinePosition[     69376,       2086]
CellTagsIndexPosition[     69333,       2083]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Transposition as a Supermap", "Title",ExpressionUUID->"6b646aa4-8f40-4c43-b6dc-da26f6e74203"],

Cell[CellGroupData[{

Cell["Overview", "Section",ExpressionUUID->"d117685b-23cb-48a7-9ee5-3c943f4fa266"],

Cell[TextData[{
 "Recall the defining equation of the Choi matrix ",
 Cell[BoxData[
  FormBox["C", TraditionalForm]],ExpressionUUID->
  "22a1e2bb-eb37-41b3-a57c-37817678bb2f"],
 " of a supermap ",
 Cell[BoxData[
  FormBox["\[ScriptCapitalF]", TraditionalForm]],ExpressionUUID->
  "e9a21934-13aa-42cd-a466-87820a1ed4e7"],
 ","
}], "Text",ExpressionUUID->"cd64fe1b-90da-442e-8a87-f0c252553dd8"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[ScriptCapitalF]", "(", 
     OverscriptBox["\[Rho]", "^"], ")"}], "=", 
    RowBox[{
     UnderscriptBox["\[CapitalSigma]", 
      RowBox[{"i", "\[VeryThinSpace]", "j"}]], 
     UnderscriptBox["\[CapitalSigma]", 
      RowBox[{"k", "\[VeryThinSpace]", "l"}]], 
     SubscriptBox[
      OverscriptBox["F", "^"], 
      RowBox[{"i", "\[VeryThinSpace]", "j"}]], 
     OverscriptBox["\[Rho]", "^"], 
     SubsuperscriptBox[
      OverscriptBox["F", "^"], 
      RowBox[{"k", "\[VeryThinSpace]", "l"}], "\[Dagger]"], 
     SubscriptBox["C", 
      RowBox[{
       RowBox[{"i", "\[VeryThinSpace]", "j"}], ";", 
       RowBox[{"k", "\[VeryThinSpace]", "l"}]}]]}]}], TraditionalForm]],
  ExpressionUUID->"9857c9f0-967b-49eb-96b4-5511570657e6"],
 " ,"
}], "Text",ExpressionUUID->"2c58a30f-7294-4081-833f-23c1cb49894e"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     OverscriptBox["F", "^"], 
     RowBox[{"i", "\[VeryThinSpace]", "j"}]], ":=", 
    RowBox[{
     TemplateBox[{
       SubscriptBox["v", "i"]},
      "Ket"], 
     TemplateBox[{
       SubscriptBox["v", "j"]},
      "Bra"]}]}], TraditionalForm]],ExpressionUUID->
  "ddfe3d4f-2df5-4ef7-8785-5d709f95d477"],
 ". An equivalent definition is"
}], "Text",ExpressionUUID->"e649058e-6752-4480-bd22-6513c7e1ba53"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[ScriptCapitalF]", "(", 
     RowBox[{
      TemplateBox[{
        SubscriptBox["v", "k"]},
       "Ket"], 
      TemplateBox[{
        SubscriptBox["v", "l"]},
       "Bra"]}], ")"}], "=", 
    RowBox[{
     UnderscriptBox["\[CapitalSigma]", 
      RowBox[{"i", "\[VeryThinSpace]", "j"}]], 
     TemplateBox[{
       SubscriptBox["v", "i"]},
      "Ket"], 
     SubscriptBox["C", 
      RowBox[{
       RowBox[{"i", "\[VeryThinSpace]", "k"}], ";", 
       RowBox[{"j", "\[VeryThinSpace]", "l"}]}]], 
     TemplateBox[{
       SubscriptBox["v", "j"]},
      "Bra"]}]}], TraditionalForm]],ExpressionUUID->
  "62080d87-aeea-4f82-8444-96e37907988f"]
}], "Text",ExpressionUUID->"f3fdafdb-0c70-42cd-8229-c68a457e06c1"],

Cell[TextData[{
 "with respect to a given orthonormal basis ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       TemplateBox[{
         SubscriptBox["v", "k"]},
        "Ket"], "|", "k"}], "=", "1"}], ",", "2", ",", "\[Ellipsis]", ",", 
     "d"}], "}"}], TraditionalForm]],ExpressionUUID->
  "fa9afeea-22ad-48e7-bcd4-d0bde0dec41d"],
 "."
}], "Text",ExpressionUUID->"3648aad2-8dc6-400e-af58-35fcfb70a8cd"],

Cell["The Choi matrix of the transposition supermap is given by", "Text",ExpressionUUID->"6ad4453b-7657-463a-85ae-758b7b094fd9"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["C", 
     RowBox[{
      RowBox[{"i", "\[VeryThinSpace]", "j"}], ";", 
      RowBox[{"k", "\[VeryThinSpace]", "l"}]}]], "=", 
    RowBox[{
     SubscriptBox["\[Delta]", 
      RowBox[{"j", "\[VeryThinSpace]", "k"}]], 
     SubscriptBox["\[Delta]", 
      RowBox[{"i", "\[VeryThinSpace]", "l"}]]}]}], TraditionalForm]],
  ExpressionUUID->"41b62285-41ec-4f9d-aab2-9330e3e1d4b5"],
 "."
}], "Text",ExpressionUUID->"f9abfe60-e2a1-47a2-b59a-988bc994e09b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Operator-Sum Representation", "Section",ExpressionUUID->"7e73a43b-3f01-4fbe-8628-f01d7e997cc4"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellChangeTimes->{{3.873944663446315*^9, 3.8739446654104633`*^9}},
 CellLabel->"In[82]:=",
 CellID->1053255760,ExpressionUUID->"cc0d95fb-b243-44f9-828d-c880d9542a87"],

Cell[TextData[{
 "Let us consider a ",
 Cell[BoxData[
  FormBox["d", TraditionalForm]],ExpressionUUID->
  "2c4f133b-c840-4f69-99d6-94c8475a977d"],
 "-level system. The quantum levels are labeled by integers from 0 to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"d", "-", "1"}], TraditionalForm]],ExpressionUUID->
  "1b081636-b28b-414e-b94d-284a80d4c9d2"],
 "."
}], "Text",ExpressionUUID->"6c0fb5b8-b129-47c5-95d5-b4eb5c406554"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$d", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"jj", "=", 
  RowBox[{
   RowBox[{"Range", "[", "$d", "]"}], "-", "1"}]}]}], "Input",
 CellLabel->"In[83]:=",
 CellID->1177418092,ExpressionUUID->"f76ae442-c37c-484b-b78f-18308096fda9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.885889792403406*^9},
 CellLabel->"Out[84]=",ExpressionUUID->"d7e62885-3d90-4f82-a145-fcb110ee8d53"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qudit", ",", "A", ",", 
   RowBox[{"Dimension", "->", "$d"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8739446667496357`*^9, 3.8739446982941513`*^9}},
 CellLabel->"In[85]:=",
 CellID->1177691642,ExpressionUUID->"0a51d35d-2551-4b72-af9d-6217ab8eef92"],

Cell[TextData[{
 "We want to select a set of operators to span the supermaps that we are \
interested in; in this particular case, the standard basis of operators on \
the ",
 Cell[BoxData[
  FormBox["d", TraditionalForm]],ExpressionUUID->
  "b78f8512-2e44-470a-90b1-1c4b0fcc31c4"],
 "-dimensional Hilbert space. We first construct all possible ordered pairs \
of level indices."
}], "Text",ExpressionUUID->"830995ae-2c9b-407a-b401-e8e58ef83aeb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tpl", "=", 
  RowBox[{"Tuples", "[", 
   RowBox[{"jj", ",", 
    RowBox[{"{", "2", "}"}]}], "]"}]}]], "Input",
 CellLabel->"In[86]:=",ExpressionUUID->"5758b469-f1f8-44f1-9f34-b8be2c218462"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.885889795390074*^9},
 CellLabel->"Out[86]=",ExpressionUUID->"07f18ce8-9576-4b19-8c79-9838fe303fe0"]
}, Open  ]],

Cell[TextData[{
 "Recalling that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["C", 
     RowBox[{
      RowBox[{"i", "\[VeryThinSpace]", "j"}], ";", 
      RowBox[{"k", "\[VeryThinSpace]", "l"}]}]], "=", 
    RowBox[{
     SubscriptBox["\[Delta]", 
      RowBox[{"j", "\[VeryThinSpace]", "k"}]], 
     SubscriptBox["\[Delta]", 
      RowBox[{"i", "\[VeryThinSpace]", "l"}]]}]}], TraditionalForm]],
  ExpressionUUID->"3552c46b-dde8-4538-95e2-5cb086698eae"],
 " the transposition supermap, we construct the list of reversed pairs from \
the previously constructed list of ordered pairs."
}], "Text",ExpressionUUID->"44264045-c0b1-4dca-a8c7-dc181fb5dfdf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rvs", "=", 
  RowBox[{"Reverse", "/@", "tpl"}]}]], "Input",
 CellLabel->"In[87]:=",ExpressionUUID->"cae958bd-a616-4b2e-b136-30ac9346c60d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.885889797144474*^9},
 CellLabel->"Out[87]=",ExpressionUUID->"7cecc101-e6ec-4575-b788-c5cd3d941e4d"]
}, Open  ]],

Cell["\<\
We then construct the set of operators from the above ordered pairs.\
\>", "Text",ExpressionUUID->"cd0749ef-e7b4-49f5-b691-5b330c0d5e50"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ops", "=", 
  RowBox[{"Map", "[", 
   RowBox[{"A", ",", 
    RowBox[{"Rule", "@@@", "rvs"}]}], "]"}]}]], "Input",
 CellLabel->"In[89]:=",ExpressionUUID->"8eaf554a-1100-49b1-b080-d627440c9936"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"\"(\"", 
      TemplateBox[{"0"}, "Ket"], 
      TemplateBox[{"0"}, "Bra"], "\")\""},
     "RowDefault"],
    $CellContext`A[0 -> 0]], ",", 
   InterpretationBox[
    TemplateBox[{"\"(\"", 
      TemplateBox[{"0"}, "Ket"], 
      TemplateBox[{"1"}, "Bra"], "\")\""},
     "RowDefault"],
    $CellContext`A[1 -> 0]], ",", 
   InterpretationBox[
    TemplateBox[{"\"(\"", 
      TemplateBox[{"0"}, "Ket"], 
      TemplateBox[{"2"}, "Bra"], "\")\""},
     "RowDefault"],
    $CellContext`A[2 -> 0]], ",", 
   InterpretationBox[
    TemplateBox[{"\"(\"", 
      TemplateBox[{"1"}, "Ket"], 
      TemplateBox[{"0"}, "Bra"], "\")\""},
     "RowDefault"],
    $CellContext`A[0 -> 1]], ",", 
   InterpretationBox[
    TemplateBox[{"\"(\"", 
      TemplateBox[{"1"}, "Ket"], 
      TemplateBox[{"1"}, "Bra"], "\")\""},
     "RowDefault"],
    $CellContext`A[1 -> 1]], ",", 
   InterpretationBox[
    TemplateBox[{"\"(\"", 
      TemplateBox[{"1"}, "Ket"], 
      TemplateBox[{"2"}, "Bra"], "\")\""},
     "RowDefault"],
    $CellContext`A[2 -> 1]], ",", 
   InterpretationBox[
    TemplateBox[{"\"(\"", 
      TemplateBox[{"2"}, "Ket"], 
      TemplateBox[{"0"}, "Bra"], "\")\""},
     "RowDefault"],
    $CellContext`A[0 -> 2]], ",", 
   InterpretationBox[
    TemplateBox[{"\"(\"", 
      TemplateBox[{"2"}, "Ket"], 
      TemplateBox[{"1"}, "Bra"], "\")\""},
     "RowDefault"],
    $CellContext`A[1 -> 2]], ",", 
   InterpretationBox[
    TemplateBox[{"\"(\"", 
      TemplateBox[{"2"}, "Ket"], 
      TemplateBox[{"2"}, "Bra"], "\")\""},
     "RowDefault"],
    $CellContext`A[2 -> 2]]}], "}"}]], "Output",
 CellChangeTimes->{{3.885889799172764*^9, 3.8858898027367773`*^9}},
 CellLabel->"Out[89]=",ExpressionUUID->"6deb5465-2435-43bd-b9f9-ff90dee1f421"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Using Graph", "Subsection",ExpressionUUID->"bc9a4584-9c9c-41e9-96c5-17c0de298320"],

Cell["\<\
Here is one way to get the Choi matrix for transposition: using graph and its \
adjacency matrix.\
\>", "Text",ExpressionUUID->"b2844f8c-3f45-4b30-bad2-9c9b7a7f7ea0"],

Cell["Construct the edges.", "Text",ExpressionUUID->"ffdcf153-e8cb-4f13-84a5-6104d93fd4ca"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"edges", "=", 
  RowBox[{"Thread", "[", 
   RowBox[{"tpl", "->", "rvs"}], "]"}]}]], "Input",
 CellLabel->"In[90]:=",ExpressionUUID->"2544cf41-6132-4491-8923-cee22f5d2470"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "2"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"2", ",", "0"}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "0"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "2"}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.8858898214996443`*^9},
 CellLabel->"Out[90]=",ExpressionUUID->"60381c07-79d3-4443-b3bc-ea91f545c04e"]
}, Open  ]],

Cell["\<\
In many cases, you do not have to specify the vertices explicitly. However, \
in this case, doing it is necessary to keep the order of vortices as we want.\
\
\>", "Text",ExpressionUUID->"fff01d65-40ab-4331-8f78-4eb3777d68fd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"grf", "=", 
  RowBox[{"Graph", "[", 
   RowBox[{"tpl", ",", "edges", ",", 
    RowBox[{"VertexLabels", "->", "\"\<Name\>\""}]}], "]"}]}]], "Input",
 CellLabel->"In[91]:=",ExpressionUUID->"e0174592-b4dd-4c2b-a8ea-8bf3d2038f2e"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{{0, 0}, {0, 1}, {0, 2}, {1, 0}, {1, 1}, {1, 2}, {2, 0}, {2, 1}, {
      2, 2}}, {{{1, 1}, {2, 4}, {3, 7}, {4, 2}, {5, 5}, {6, 8}, {7, 3}, {8, 
       6}, {9, 9}}, Null}, {VertexLabels -> {"Name"}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[Medium], 
        ArrowBox[
         BezierCurveBox[{{0.6875100000000001, -0.6875100000000001}, {
          0.5990307445322395, -0.8782935323853024}, {
          0.4001522669946487, -0.9346897748458964}, {
          0.2729816425201914, -0.8757326960710232}, {
          0.2729816425201914, -0.49928730392897697`}, {
          0.4001522669946487, -0.4403302251541037}, {
          0.5990307445322395, -0.49672646761469774`}, {
          0.6875100000000001, -0.6875100000000001}},
          SplineDegree->7], 0.02158924996565012], 
        ArrowBox[
         BezierCurveBox[{{2.56253, -1.6250200000000001`}, {
          2.0625300000000215`, -1.7894607471831252`}, {
          1.5625300000000002`, -1.6250200000000001`}}], 0.02158924996565012], 
        ArrowBox[
         BezierCurveBox[{{2.56253, -2.06253}, {
          2.062529999999951, -2.226970747183111}, {
          1.5625300000000002`, -2.06253}}], 0.02158924996565012], 
        ArrowBox[
         BezierCurveBox[{{1.5625300000000002`, -1.6250200000000001`}, {
          2.0625300000000246`, -1.460579252816882}, {
          2.56253, -1.6250200000000001`}}], 0.02158924996565012], 
        ArrowBox[
         BezierCurveBox[{{0.6875100000000001, -2.06253}, {
          0.5990307445322395, -2.2533135323853024`}, {
          0.4001522669946487, -2.3097097748458966`}, {
          0.2729816425201914, -2.2507526960710234`}, {
          0.2729816425201914, -1.874307303928977}, {
          0.4001522669946487, -1.8153502251541038`}, {
          0.5990307445322395, -1.871746467614698}, {
          0.6875100000000001, -2.06253}},
          SplineDegree->7], 0.02158924996565012], 
        ArrowBox[
         BezierCurveBox[{{2.56253, -2.5000400000000003`}, {
          2.0625300000000077`, -2.6644807471831204`}, {
          1.5625300000000002`, -2.5000400000000003`}}], 0.02158924996565012], 
        ArrowBox[
         BezierCurveBox[{{1.5625300000000002`, -2.06253}, {
          2.0625299999999736`, -1.8980892528168771`}, {2.56253, -2.06253}}], 
         0.02158924996565012], 
        ArrowBox[
         BezierCurveBox[{{1.5625300000000002`, -2.5000400000000003`}, {
          2.062529999999973, -2.3355992528168725`}, {
          2.56253, -2.5000400000000003`}}], 0.02158924996565012], 
        ArrowBox[
         BezierCurveBox[{{2.06253, -0.6875100000000001}, {
          1.9740507445322397`, -0.8782935323853024}, {
          1.7751722669946488`, -0.9346897748458964}, {
          1.6480016425201915`, -0.8757326960710232}, {
          1.6480016425201915`, -0.49928730392897697`}, {
          1.7751722669946488`, -0.4403302251541037}, {
          1.9740507445322397`, -0.49672646761469774`}, {
          2.06253, -0.6875100000000001}},
          SplineDegree->7], 0.02158924996565012]}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {
         DiskBox[{0.6875100000000001, -0.6875100000000001}, 
          0.02158924996565012], InsetBox[
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], 
          Offset[{2, 2}, {0.7090992499656502, -0.6659207500343499}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{2.56253, -1.6250200000000001}, 0.02158924996565012], 
         InsetBox[
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], 
          Offset[{2, 2}, {2.5841192499656502, -1.60343075003435}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{2.56253, -2.06253}, 0.02158924996565012], InsetBox[
          RowBox[{"{", 
           RowBox[{"0", ",", "2"}], "}"}], 
          Offset[{2, 2}, {2.5841192499656502, -2.04094075003435}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{1.5625300000000002, -1.6250200000000001}, 
          0.02158924996565012], InsetBox[
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], 
          Offset[{2, 2}, {1.5841192499656502, -1.60343075003435}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.6875100000000001, -2.06253}, 0.02158924996565012], 
         InsetBox[
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], 
          Offset[{2, 2}, {0.7090992499656502, -2.04094075003435}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{2.56253, -2.5000400000000003}, 0.02158924996565012], 
         InsetBox[
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}], 
          Offset[{2, 2}, {2.5841192499656502, -2.4784507500343502}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{1.5625300000000002, -2.06253}, 0.02158924996565012], 
         InsetBox[
          RowBox[{"{", 
           RowBox[{"2", ",", "0"}], "}"}], 
          Offset[{2, 2}, {1.5841192499656502, -2.04094075003435}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{1.5625300000000002, -2.5000400000000003}, 
          0.02158924996565012], InsetBox[
          RowBox[{"{", 
           RowBox[{"2", ",", "1"}], "}"}], 
          Offset[{2, 2}, {1.5841192499656502, -2.4784507500343502}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{2.06253, -0.6875100000000001}, 0.02158924996565012], 
         InsetBox[
          RowBox[{"{", 
           RowBox[{"2", ",", "2"}], "}"}], 
          Offset[{2, 2}, {2.0841192499656502, -0.6659207500343499}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  AxesStyle->{},
  DefaultBaseStyle->"NetworkGraphics",
  FormatType->TraditionalForm,
  FrameStyle->{},
  FrameTicks->None,
  ImageSize->Automatic,
  PlotRangePadding->Automatic]], "Output",
 CellChangeTimes->{3.8858898235768003`*^9},
 CellLabel->"Out[91]=",ExpressionUUID->"ebdcc395-1969-45f3-ae8d-f8f850a299f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"AdjacencyMatrix", "[", "grf", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[92]:=",ExpressionUUID->"2e7cfb68-4bed-4d40-8c78-3f91e054c7e9"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {9, 9}, 0, {
     1, {{0, 1, 2, 3, 4, 5, 6, 7, 8, 9}, {{1}, {4}, {7}, {2}, {5}, {8}, {3}, {
       6}, {9}}}, {1, 1, 1, 1, 1, 1, 1, 1, 1}}]]]]], "Output",
 CellChangeTimes->{3.885889825607751*^9},
 CellLabel->
  "Out[93]//MatrixForm=",ExpressionUUID->"15860fa5-0a22-463f-aeae-\
0e45792db173"]
}, Open  ]],

Cell["With the Choi matrix given, construct the supermap.", "Text",ExpressionUUID->"bc13410a-b8cb-4ed4-a72b-02af8e8ce7a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"spr", "=", 
   RowBox[{"Supermap", "[", 
    RowBox[{"ops", ",", "mat"}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[94]:=",ExpressionUUID->"a1e514fe-63c4-42e6-95a5-a81b635e7d6d"],

Cell["\<\
To verify the supermap, think of a few examples of input operators.\
\>", "Text",ExpressionUUID->"7c716546-dd8e-4c88-8813-306bc4b4ca01"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"in", "=", 
  RowBox[{"A", "[", 
   RowBox[{"0", "->", "2"}], "]"}]}]], "Input",
 CellLabel->"In[95]:=",ExpressionUUID->"53e984c7-fe18-4aa7-91ca-30b7b1fb3aa3"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{"\"(\"", 
    TemplateBox[{"2"}, "Ket"], 
    TemplateBox[{"0"}, "Bra"], "\")\""},
   "RowDefault"],
  $CellContext`A[0 -> 2]]], "Output",
 CellChangeTimes->{3.885889829168707*^9},
 CellLabel->"Out[95]=",ExpressionUUID->"52c1dd96-ed2f-4e53-98cb-30e5c6a5a347"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"spr", "[", "in", "]"}]}]], "Input",
 CellLabel->"In[96]:=",ExpressionUUID->"a31a564c-8af8-4361-aa82-87f8c5a2b3bf"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{"\"(\"", 
    TemplateBox[{"0"}, "Ket"], 
    TemplateBox[{"2"}, "Bra"], "\")\""},
   "RowDefault"],
  $CellContext`A[2 -> 0]]], "Output",
 CellChangeTimes->{3.8858898303809443`*^9},
 CellLabel->"Out[96]=",ExpressionUUID->"57f3c433-a1ba-41d0-91a2-23e5f082cfc6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"in", "=", 
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"0", "->", "2"}], "]"}], "+", 
   RowBox[{"I", "*", 
    RowBox[{"A", "[", 
     RowBox[{"1", "->", "2"}], "]"}]}]}]}]], "Input",
 CellLabel->"In[97]:=",ExpressionUUID->"e7d7f00a-ff15-4af5-892b-b5cbd7c5efe4"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{"\"(\"", 
     TemplateBox[{"2"}, "Ket"], 
     TemplateBox[{"0"}, "Bra"], "\")\""},
    "RowDefault"],
   $CellContext`A[0 -> 2]], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{"\"(\"", 
      TemplateBox[{"2"}, "Ket"], 
      TemplateBox[{"1"}, "Bra"], "\")\""},
     "RowDefault"],
    $CellContext`A[1 -> 2]]}]}]], "Output",
 CellChangeTimes->{3.885889831726439*^9},
 CellLabel->"Out[97]=",ExpressionUUID->"53d90879-0668-4a99-a413-75043ff2dfff"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"spr", "[", "in", "]"}]}]], "Input",
 CellLabel->"In[98]:=",ExpressionUUID->"9b58cfa7-fd78-493c-bb39-36b01000a198"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{"\"(\"", 
     TemplateBox[{"0"}, "Ket"], 
     TemplateBox[{"2"}, "Bra"], "\")\""},
    "RowDefault"],
   $CellContext`A[2 -> 0]], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{"\"(\"", 
      TemplateBox[{"1"}, "Ket"], 
      TemplateBox[{"2"}, "Bra"], "\")\""},
     "RowDefault"],
    $CellContext`A[2 -> 1]]}]}]], "Output",
 CellChangeTimes->{3.8858898334192753`*^9},
 CellLabel->"Out[98]=",ExpressionUUID->"2d3b513c-0992-4e94-a5b5-474c991064a8"]
}, Open  ]],

Cell["Note that this is different from the Hermitian conjugate.", "Text",ExpressionUUID->"7e195296-ee92-41fa-afbf-caaa9d5eecb3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dagger", "[", "in", "]"}]], "Input",
 CellLabel->"In[99]:=",ExpressionUUID->"01e11418-c729-4e98-b89e-092a603ba630"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{"\"(\"", 
     TemplateBox[{"0"}, "Ket"], 
     TemplateBox[{"2"}, "Bra"], "\")\""},
    "RowDefault"],
   $CellContext`A[2 -> 0]], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{"\"(\"", 
      TemplateBox[{"1"}, "Ket"], 
      TemplateBox[{"2"}, "Bra"], "\")\""},
     "RowDefault"],
    $CellContext`A[2 -> 1]]}]}]], "Output",
 CellChangeTimes->{3.885889835777457*^9},
 CellLabel->"Out[99]=",ExpressionUUID->"597f4802-32d6-442a-8ab2-e13149263a45"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Using Permutation", "Subsection",ExpressionUUID->"131bfca5-07ff-4e01-aef9-37b450a6c6b2"],

Cell["\<\
Here is another method to get the Choi matrix: using permutation matrix.\
\>", "Text",ExpressionUUID->"4cad76f2-aa14-4236-a2e7-027ac379ac56"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"prm", "=", 
  RowBox[{"FindPermutation", "[", 
   RowBox[{"tpl", ",", "rvs"}], "]"}]}]], "Input",
 CellLabel->
  "In[100]:=",ExpressionUUID->"97ce89be-36c7-44b7-8a08-0f0f469a9af4"],

Cell[BoxData[
 RowBox[{"Cycles", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "7"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"6", ",", "8"}], "}"}]}], "}"}], "]"}]], "Output",
 CellChangeTimes->{3.8858898377961493`*^9},
 CellLabel->
  "Out[100]=",ExpressionUUID->"69cec4b7-1ebd-4074-9f46-aa370cb6d873"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"PermutationMatrix", "[", 
    RowBox[{"prm", ",", "9"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellLabel->
  "In[101]:=",ExpressionUUID->"54073fda-9242-4992-bdc5-c609baa6e967"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
    PermutationMatrix[
     StructuredArray`StructuredData[{9, 9}, {
       Cycles[{{2, 4}, {3, 7}, {6, 8}}], 
       DirectedInfinity[1]}]]]]]], "Output",
 CellChangeTimes->{3.885889838727172*^9},
 CellLabel->
  "Out[102]//MatrixForm=",ExpressionUUID->"ec7e5699-7957-41a8-844f-\
872912ef971a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mat", "-", "new"}], "//", "MatrixForm"}]], "Input",
 CellLabel->
  "In[103]:=",ExpressionUUID->"3292f239-e6bb-4d6f-92ee-1a1abb193df9"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.885889841782309*^9},
 CellLabel->
  "Out[103]//MatrixForm=",ExpressionUUID->"123559d1-2ce9-4eea-9896-\
19207235aac6"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Positive, But Not Completely Positive", "Section",ExpressionUUID->"cd917106-7f0b-4870-ba10-2cf2c43c0170"],

Cell["\<\
Let us further analyse the Choi matrix using its spectral decomposition.\
\>", "Text",ExpressionUUID->"6f399f48-07c0-46ac-9c44-2c502eef9872"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"val", ",", "vec"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", "mat", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[104]:=",ExpressionUUID->"8fe5b4ab-aa91-44b3-affa-4ce003ae5630"],

Cell[TextData[{
 "First, note that the Choi matrix has some negative eigenvalues and hence is \
not positive (semi-definite). This implies that the corresponding supermap ",
 Cell[BoxData[
  FormBox["\[ScriptCapitalF]", TraditionalForm]],ExpressionUUID->
  "11fcf329-b8a8-4824-bb39-393413366530"],
 " is ",
 StyleBox["not completely positive",
  FontSlant->"Italic"],
 " even though it is obviously positive."
}], "Text",ExpressionUUID->"3943a3ed-cd82-4b60-bc22-a41ca6ed4232"],

Cell[CellGroupData[{

Cell[BoxData["val"], "Input",
 CellLabel->
  "In[105]:=",ExpressionUUID->"a92d5bd1-bd72-49f2-addf-579e6b827ec1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1"}], "}"}]], "Output",
 CellChangeTimes->{3.885889845698522*^9},
 CellLabel->
  "Out[105]=",ExpressionUUID->"b49c0152-4fa6-4633-8abf-84cb7aa01bfa"]
}, Open  ]],

Cell["\<\
Now, let us optimize the operator-sum representation. Before doing that, \
check the eigenvectors are orthonormal to each other. \
\>", "Text",ExpressionUUID->"ea0cfbfa-4d96-4065-a831-e938cab108e1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Topple", "[", "vec", "]"}], ".", "vec"}], "//", 
  "MatrixForm"}]], "Input",
 CellLabel->
  "In[106]:=",ExpressionUUID->"96dddc4b-969c-4aa2-a969-b9d45c022dd3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "2", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "2", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "2", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "2", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "2", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "2", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.885889847226565*^9},
 CellLabel->
  "Out[106]//MatrixForm=",ExpressionUUID->"de8ca22c-61f7-457b-a980-\
50b9e13da1d5"]
}, Open  ]],

Cell["\<\
It turns out that they are orthogonal to each other, but are not normalized. \
Just normalization suffices.\
\>", "Text",ExpressionUUID->"81d0601e-4649-49b3-9391-247c1abf7423"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"trs", "=", 
   RowBox[{"Normalize", "/@", "vec"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Topple", "[", "trs", "]"}], ".", "trs"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->
  "In[107]:=",ExpressionUUID->"9ddcdecf-87ae-479c-826f-0496c0ca7531"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.885889848595817*^9},
 CellLabel->
  "Out[108]//MatrixForm=",ExpressionUUID->"9741603b-9840-464c-822c-\
2c57d7ada5b0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"obs", "=", 
  RowBox[{"trs", ".", "ops"}]}]], "Input",
 CellLabel->
  "In[109]:=",ExpressionUUID->"00e67d03-4660-410a-aa85-1ebc1df46965"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox[
     InterpretationBox[
      TemplateBox[{"\"(\"", 
        TemplateBox[{"2"}, "Ket"], 
        TemplateBox[{"1"}, "Bra"], "\")\""},
       "RowDefault"],
      $CellContext`A[1 -> 2]], 
     SqrtBox["2"]], "-", 
    FractionBox[
     InterpretationBox[
      TemplateBox[{"\"(\"", 
        TemplateBox[{"1"}, "Ket"], 
        TemplateBox[{"2"}, "Bra"], "\")\""},
       "RowDefault"],
      $CellContext`A[2 -> 1]], 
     SqrtBox["2"]]}], ",", 
   RowBox[{
    FractionBox[
     InterpretationBox[
      TemplateBox[{"\"(\"", 
        TemplateBox[{"2"}, "Ket"], 
        TemplateBox[{"0"}, "Bra"], "\")\""},
       "RowDefault"],
      $CellContext`A[0 -> 2]], 
     SqrtBox["2"]], "-", 
    FractionBox[
     InterpretationBox[
      TemplateBox[{"\"(\"", 
        TemplateBox[{"0"}, "Ket"], 
        TemplateBox[{"2"}, "Bra"], "\")\""},
       "RowDefault"],
      $CellContext`A[2 -> 0]], 
     SqrtBox["2"]]}], ",", 
   RowBox[{
    FractionBox[
     InterpretationBox[
      TemplateBox[{"\"(\"", 
        TemplateBox[{"1"}, "Ket"], 
        TemplateBox[{"0"}, "Bra"], "\")\""},
       "RowDefault"],
      $CellContext`A[0 -> 1]], 
     SqrtBox["2"]], "-", 
    FractionBox[
     InterpretationBox[
      TemplateBox[{"\"(\"", 
        TemplateBox[{"0"}, "Ket"], 
        TemplateBox[{"1"}, "Bra"], "\")\""},
       "RowDefault"],
      $CellContext`A[1 -> 0]], 
     SqrtBox["2"]]}], ",", 
   InterpretationBox[
    TemplateBox[{"\"(\"", 
      TemplateBox[{"2"}, "Ket"], 
      TemplateBox[{"2"}, "Bra"], "\")\""},
     "RowDefault"],
    $CellContext`A[2 -> 2]], ",", 
   RowBox[{
    FractionBox[
     InterpretationBox[
      TemplateBox[{"\"(\"", 
        TemplateBox[{"2"}, "Ket"], 
        TemplateBox[{"1"}, "Bra"], "\")\""},
       "RowDefault"],
      $CellContext`A[1 -> 2]], 
     SqrtBox["2"]], "+", 
    FractionBox[
     InterpretationBox[
      TemplateBox[{"\"(\"", 
        TemplateBox[{"1"}, "Ket"], 
        TemplateBox[{"2"}, "Bra"], "\")\""},
       "RowDefault"],
      $CellContext`A[2 -> 1]], 
     SqrtBox["2"]]}], ",", 
   RowBox[{
    FractionBox[
     InterpretationBox[
      TemplateBox[{"\"(\"", 
        TemplateBox[{"2"}, "Ket"], 
        TemplateBox[{"0"}, "Bra"], "\")\""},
       "RowDefault"],
      $CellContext`A[0 -> 2]], 
     SqrtBox["2"]], "+", 
    FractionBox[
     InterpretationBox[
      TemplateBox[{"\"(\"", 
        TemplateBox[{"0"}, "Ket"], 
        TemplateBox[{"2"}, "Bra"], "\")\""},
       "RowDefault"],
      $CellContext`A[2 -> 0]], 
     SqrtBox["2"]]}], ",", 
   InterpretationBox[
    TemplateBox[{"\"(\"", 
      TemplateBox[{"1"}, "Ket"], 
      TemplateBox[{"1"}, "Bra"], "\")\""},
     "RowDefault"],
    $CellContext`A[1 -> 1]], ",", 
   RowBox[{
    FractionBox[
     InterpretationBox[
      TemplateBox[{"\"(\"", 
        TemplateBox[{"1"}, "Ket"], 
        TemplateBox[{"0"}, "Bra"], "\")\""},
       "RowDefault"],
      $CellContext`A[0 -> 1]], 
     SqrtBox["2"]], "+", 
    FractionBox[
     InterpretationBox[
      TemplateBox[{"\"(\"", 
        TemplateBox[{"0"}, "Ket"], 
        TemplateBox[{"1"}, "Bra"], "\")\""},
       "RowDefault"],
      $CellContext`A[1 -> 0]], 
     SqrtBox["2"]]}], ",", 
   InterpretationBox[
    TemplateBox[{"\"(\"", 
      TemplateBox[{"0"}, "Ket"], 
      TemplateBox[{"0"}, "Bra"], "\")\""},
     "RowDefault"],
    $CellContext`A[0 -> 0]]}], "}"}]], "Output",
 CellChangeTimes->{3.885889850463159*^9},
 CellLabel->
  "Out[109]=",ExpressionUUID->"2d0c2425-e7d0-442c-a43a-f8dcadb526ec"]
}, Open  ]],

Cell["\<\
Double check that they are orthogonal to each other with respect to the \
Hilbert-Schmidt inner product.\
\>", "Text",ExpressionUUID->"d19ce00d-8034-440e-b6fb-c3c9e5e0601e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"chk", "=", 
   RowBox[{"Outer", "[", 
    RowBox[{"HilbertSchmidtProduct", ",", 
     RowBox[{"Matrix", "/@", "obs"}], ",", 
     RowBox[{"Matrix", "/@", "obs"}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"chk", "//", "MatrixForm"}]}], "Input",
 CellLabel->
  "In[110]:=",ExpressionUUID->"22288d7a-6f46-4f3f-89ca-b91e2367e965"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.885889851998098*^9},
 CellLabel->
  "Out[111]//MatrixForm=",ExpressionUUID->"85bad855-129d-4bb4-aab4-\
540ed08c7303"]
}, Open  ]],

Cell["\<\
Finally, let us construct the supermap in terms of this new set of operators \
and the eigenvalues.\
\>", "Text",ExpressionUUID->"c1fc6822-726e-489f-8c3e-17ba7f5bb1da"],

Cell[BoxData[
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"Supermap", "[", 
    RowBox[{"obs", ",", "val"}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[112]:=",ExpressionUUID->"c542785b-a18f-416f-b818-961d8fc403e0"],

Cell["\<\
Check that this new specification of the supermap produces the same result.\
\>", "Text",ExpressionUUID->"4116158a-8e7b-48e5-a9c0-18b4899ede06"],

Cell[CellGroupData[{

Cell[BoxData["in"], "Input",
 CellLabel->
  "In[113]:=",ExpressionUUID->"f1fe2bc4-31a8-4682-91e9-81393e71f134"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{"\"(\"", 
     TemplateBox[{"2"}, "Ket"], 
     TemplateBox[{"0"}, "Bra"], "\")\""},
    "RowDefault"],
   $CellContext`A[0 -> 2]], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{"\"(\"", 
      TemplateBox[{"2"}, "Ket"], 
      TemplateBox[{"1"}, "Bra"], "\")\""},
     "RowDefault"],
    $CellContext`A[1 -> 2]]}]}]], "Output",
 CellChangeTimes->{3.8858898550745983`*^9},
 CellLabel->
  "Out[113]=",ExpressionUUID->"576c805a-9a20-4406-a83c-980e7f1b9688"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "[", "in", "]"}]], "Input",
 CellLabel->
  "In[114]:=",ExpressionUUID->"6ea0eea6-e29b-49ee-ab6f-b24ccd80a290"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{"\"(\"", 
     TemplateBox[{"0"}, "Ket"], 
     TemplateBox[{"2"}, "Bra"], "\")\""},
    "RowDefault"],
   $CellContext`A[2 -> 0]], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{"\"(\"", 
      TemplateBox[{"1"}, "Ket"], 
      TemplateBox[{"2"}, "Bra"], "\")\""},
     "RowDefault"],
    $CellContext`A[2 -> 1]]}]}]], "Output",
 CellChangeTimes->{3.885889856061241*^9},
 CellLabel->
  "Out[114]=",ExpressionUUID->"83fdec97-5854-4ec9-ad8e-b5e8981456b6"]
}, Open  ]],

Cell[TextData[{
 "The fact that the transposition supermap is not completely positive can be \
seen applying the partial transposition, i.e., ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalF]", "\[CircleTimes]", "\[ScriptCapitalI]"}], 
   TraditionalForm]],ExpressionUUID->"5d1ce367-e4a4-4121-abe8-07d413557216"],
 " on the composite system of the \[OpenCurlyDoubleQuote]system\
\[CloseCurlyDoubleQuote] and any \[OpenCurlyDoubleQuote]environment\
\[CloseCurlyDoubleQuote]. For example, let us consider the maximally \
entangled state in ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalV]", "\[CircleTimes]", "\[ScriptCapitalV]"}], 
   TraditionalForm]],ExpressionUUID->"6e5507a7-e90c-4e3f-bcfc-bf695221ac75"],
 "."
}], "Text",ExpressionUUID->"44947701-3059-4560-9fed-f2a30e2e18d7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ket", "=", 
   RowBox[{
    RowBox[{"Total", "@", 
     RowBox[{"Multiply", "[", 
      RowBox[{
       RowBox[{"Basis", "[", "A", "]"}], ",", 
       RowBox[{"Basis", "[", 
        RowBox[{"A", "[", "E", "]"}], "]"}]}], "]"}]}], "/", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"Dimension", "@", "A"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"KetRegulate", "[", "ket", "]"}]}], "Input",
 CellLabel->
  "In[115]:=",ExpressionUUID->"f89688b9-58a6-498c-902e-b9a5b9a9a1ca"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox["A", 
          $CellContext`A[Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
          $CellContext`A[E, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[Q3`$] -> 0, $CellContext`A[E, Q3`$] -> 0|>]], "+", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox["A", 
          $CellContext`A[Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
          $CellContext`A[E, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[Q3`$] -> 1, $CellContext`A[E, Q3`$] -> 1|>]], "+", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["2", 
         InterpretationBox["A", 
          $CellContext`A[Q3`$]]], 
        SubscriptBox["2", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
          $CellContext`A[E, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[Q3`$] -> 2, $CellContext`A[E, Q3`$] -> 2|>]]}], 
  SqrtBox["3"]]], "Output",
 CellChangeTimes->{3.885889858055148*^9},
 CellLabel->
  "Out[116]=",ExpressionUUID->"d0761eff-3976-4775-8638-3dfdb7fbf649"]
}, Open  ]],

Cell["\<\
Take the dyadic product of it with itself to construct the (pure-state) \
density operator.\
\>", "Text",ExpressionUUID->"cd690b9a-601f-42e7-b5f7-213f0933bb78"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"in", "=", 
  RowBox[{"Dyad", "[", 
   RowBox[{"ket", ",", "ket", ",", 
    RowBox[{"{", 
     RowBox[{"A", ",", 
      RowBox[{"A", "[", "E", "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.885889866039921*^9, 3.885889921408897*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"c3434cf2-bef2-49c0-9dfc-01e73a2fe1b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "3"], " ", 
   InterpretationBox[
    TemplateBox[{
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           SubscriptBox["0", 
            InterpretationBox["A", 
             $CellContext`A[Q3`$]]], 
           SubscriptBox["0", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"A"}, "RowDefault"], 
              TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
             $CellContext`A[E, Q3`$]]]}, "RowDefault"]}, "Ket"], 
       Ket[<|$CellContext`A[Q3`$] -> 0, $CellContext`A[E, Q3`$] -> 0|>]], 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           SubscriptBox["0", 
            InterpretationBox["A", 
             $CellContext`A[Q3`$]]], 
           SubscriptBox["0", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"A"}, "RowDefault"], 
              TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
             $CellContext`A[E, Q3`$]]]}, "RowDefault"]}, "Bra"], 
       Bra[<|$CellContext`A[Q3`$] -> 0, $CellContext`A[E, Q3`$] -> 0|>]]},
     "RowDefault"],
    Q3`Dyad[<|$CellContext`A[Q3`$] -> 0, $CellContext`A[E, Q3`$] -> 
      0|>, <|$CellContext`A[Q3`$] -> 0, $CellContext`A[E, Q3`$] -> 0|>]]}], 
  "+", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   InterpretationBox[
    TemplateBox[{
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           SubscriptBox["0", 
            InterpretationBox["A", 
             $CellContext`A[Q3`$]]], 
           SubscriptBox["0", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"A"}, "RowDefault"], 
              TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
             $CellContext`A[E, Q3`$]]]}, "RowDefault"]}, "Ket"], 
       Ket[<|$CellContext`A[Q3`$] -> 0, $CellContext`A[E, Q3`$] -> 0|>]], 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           SubscriptBox["1", 
            InterpretationBox["A", 
             $CellContext`A[Q3`$]]], 
           SubscriptBox["1", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"A"}, "RowDefault"], 
              TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
             $CellContext`A[E, Q3`$]]]}, "RowDefault"]}, "Bra"], 
       Bra[<|$CellContext`A[Q3`$] -> 1, $CellContext`A[E, Q3`$] -> 1|>]]},
     "RowDefault"],
    Q3`Dyad[<|$CellContext`A[Q3`$] -> 0, $CellContext`A[E, Q3`$] -> 
      0|>, <|$CellContext`A[Q3`$] -> 1, $CellContext`A[E, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   InterpretationBox[
    TemplateBox[{
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           SubscriptBox["0", 
            InterpretationBox["A", 
             $CellContext`A[Q3`$]]], 
           SubscriptBox["0", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"A"}, "RowDefault"], 
              TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
             $CellContext`A[E, Q3`$]]]}, "RowDefault"]}, "Ket"], 
       Ket[<|$CellContext`A[Q3`$] -> 0, $CellContext`A[E, Q3`$] -> 0|>]], 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           SubscriptBox["2", 
            InterpretationBox["A", 
             $CellContext`A[Q3`$]]], 
           SubscriptBox["2", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"A"}, "RowDefault"], 
              TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
             $CellContext`A[E, Q3`$]]]}, "RowDefault"]}, "Bra"], 
       Bra[<|$CellContext`A[Q3`$] -> 2, $CellContext`A[E, Q3`$] -> 2|>]]},
     "RowDefault"],
    Q3`Dyad[<|$CellContext`A[Q3`$] -> 0, $CellContext`A[E, Q3`$] -> 
      0|>, <|$CellContext`A[Q3`$] -> 2, $CellContext`A[E, Q3`$] -> 2|>]]}], 
  "+", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   InterpretationBox[
    TemplateBox[{
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           SubscriptBox["1", 
            InterpretationBox["A", 
             $CellContext`A[Q3`$]]], 
           SubscriptBox["1", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"A"}, "RowDefault"], 
              TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
             $CellContext`A[E, Q3`$]]]}, "RowDefault"]}, "Ket"], 
       Ket[<|$CellContext`A[Q3`$] -> 1, $CellContext`A[E, Q3`$] -> 1|>]], 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           SubscriptBox["0", 
            InterpretationBox["A", 
             $CellContext`A[Q3`$]]], 
           SubscriptBox["0", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"A"}, "RowDefault"], 
              TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
             $CellContext`A[E, Q3`$]]]}, "RowDefault"]}, "Bra"], 
       Bra[<|$CellContext`A[Q3`$] -> 0, $CellContext`A[E, Q3`$] -> 0|>]]},
     "RowDefault"],
    Q3`Dyad[<|$CellContext`A[Q3`$] -> 1, $CellContext`A[E, Q3`$] -> 
      1|>, <|$CellContext`A[Q3`$] -> 0, $CellContext`A[E, Q3`$] -> 0|>]]}], 
  "+", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   InterpretationBox[
    TemplateBox[{
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           SubscriptBox["1", 
            InterpretationBox["A", 
             $CellContext`A[Q3`$]]], 
           SubscriptBox["1", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"A"}, "RowDefault"], 
              TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
             $CellContext`A[E, Q3`$]]]}, "RowDefault"]}, "Ket"], 
       Ket[<|$CellContext`A[Q3`$] -> 1, $CellContext`A[E, Q3`$] -> 1|>]], 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           SubscriptBox["1", 
            InterpretationBox["A", 
             $CellContext`A[Q3`$]]], 
           SubscriptBox["1", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"A"}, "RowDefault"], 
              TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
             $CellContext`A[E, Q3`$]]]}, "RowDefault"]}, "Bra"], 
       Bra[<|$CellContext`A[Q3`$] -> 1, $CellContext`A[E, Q3`$] -> 1|>]]},
     "RowDefault"],
    Q3`Dyad[<|$CellContext`A[Q3`$] -> 1, $CellContext`A[E, Q3`$] -> 
      1|>, <|$CellContext`A[Q3`$] -> 1, $CellContext`A[E, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   InterpretationBox[
    TemplateBox[{
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           SubscriptBox["1", 
            InterpretationBox["A", 
             $CellContext`A[Q3`$]]], 
           SubscriptBox["1", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"A"}, "RowDefault"], 
              TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
             $CellContext`A[E, Q3`$]]]}, "RowDefault"]}, "Ket"], 
       Ket[<|$CellContext`A[Q3`$] -> 1, $CellContext`A[E, Q3`$] -> 1|>]], 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           SubscriptBox["2", 
            InterpretationBox["A", 
             $CellContext`A[Q3`$]]], 
           SubscriptBox["2", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"A"}, "RowDefault"], 
              TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
             $CellContext`A[E, Q3`$]]]}, "RowDefault"]}, "Bra"], 
       Bra[<|$CellContext`A[Q3`$] -> 2, $CellContext`A[E, Q3`$] -> 2|>]]},
     "RowDefault"],
    Q3`Dyad[<|$CellContext`A[Q3`$] -> 1, $CellContext`A[E, Q3`$] -> 
      1|>, <|$CellContext`A[Q3`$] -> 2, $CellContext`A[E, Q3`$] -> 2|>]]}], 
  "+", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   InterpretationBox[
    TemplateBox[{
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           SubscriptBox["2", 
            InterpretationBox["A", 
             $CellContext`A[Q3`$]]], 
           SubscriptBox["2", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"A"}, "RowDefault"], 
              TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
             $CellContext`A[E, Q3`$]]]}, "RowDefault"]}, "Ket"], 
       Ket[<|$CellContext`A[Q3`$] -> 2, $CellContext`A[E, Q3`$] -> 2|>]], 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           SubscriptBox["0", 
            InterpretationBox["A", 
             $CellContext`A[Q3`$]]], 
           SubscriptBox["0", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"A"}, "RowDefault"], 
              TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
             $CellContext`A[E, Q3`$]]]}, "RowDefault"]}, "Bra"], 
       Bra[<|$CellContext`A[Q3`$] -> 0, $CellContext`A[E, Q3`$] -> 0|>]]},
     "RowDefault"],
    Q3`Dyad[<|$CellContext`A[Q3`$] -> 2, $CellContext`A[E, Q3`$] -> 
      2|>, <|$CellContext`A[Q3`$] -> 0, $CellContext`A[E, Q3`$] -> 0|>]]}], 
  "+", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   InterpretationBox[
    TemplateBox[{
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           SubscriptBox["2", 
            InterpretationBox["A", 
             $CellContext`A[Q3`$]]], 
           SubscriptBox["2", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"A"}, "RowDefault"], 
              TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
             $CellContext`A[E, Q3`$]]]}, "RowDefault"]}, "Ket"], 
       Ket[<|$CellContext`A[Q3`$] -> 2, $CellContext`A[E, Q3`$] -> 2|>]], 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           SubscriptBox["1", 
            InterpretationBox["A", 
             $CellContext`A[Q3`$]]], 
           SubscriptBox["1", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"A"}, "RowDefault"], 
              TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
             $CellContext`A[E, Q3`$]]]}, "RowDefault"]}, "Bra"], 
       Bra[<|$CellContext`A[Q3`$] -> 1, $CellContext`A[E, Q3`$] -> 1|>]]},
     "RowDefault"],
    Q3`Dyad[<|$CellContext`A[Q3`$] -> 2, $CellContext`A[E, Q3`$] -> 
      2|>, <|$CellContext`A[Q3`$] -> 1, $CellContext`A[E, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   InterpretationBox[
    TemplateBox[{
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           SubscriptBox["2", 
            InterpretationBox["A", 
             $CellContext`A[Q3`$]]], 
           SubscriptBox["2", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"A"}, "RowDefault"], 
              TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
             $CellContext`A[E, Q3`$]]]}, "RowDefault"]}, "Ket"], 
       Ket[<|$CellContext`A[Q3`$] -> 2, $CellContext`A[E, Q3`$] -> 2|>]], 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           SubscriptBox["2", 
            InterpretationBox["A", 
             $CellContext`A[Q3`$]]], 
           SubscriptBox["2", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"A"}, "RowDefault"], 
              TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
             $CellContext`A[E, Q3`$]]]}, "RowDefault"]}, "Bra"], 
       Bra[<|$CellContext`A[Q3`$] -> 2, $CellContext`A[E, Q3`$] -> 2|>]]},
     "RowDefault"],
    Q3`Dyad[<|$CellContext`A[Q3`$] -> 2, $CellContext`A[E, Q3`$] -> 
      2|>, <|$CellContext`A[Q3`$] -> 2, $CellContext`A[E, Q3`$] -> 
      2|>]]}]}]], "Output",
 CellChangeTimes->{
  3.885889859626741*^9, {3.8858899061018476`*^9, 3.8858899248249493`*^9}},
 CellLabel->
  "Out[121]=",ExpressionUUID->"161c2220-a5e9-40d1-8f45-1fe1bd08a4bd"]
}, Open  ]],

Cell["\<\
Obviously, as a pure state, it only has non-negative eigenvalues.\
\>", "Text",ExpressionUUID->"e978dc07-ca99-4624-8b1d-0f8536ed45dd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ProperValues", "[", "in", "]"}]], "Input",
 CellLabel->
  "In[122]:=",ExpressionUUID->"7efa9356-71aa-4222-8737-b9f07c432d9d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.885889926187747*^9},
 CellLabel->
  "Out[122]=",ExpressionUUID->"7df64630-df26-4015-a631-061bb2b4d936"]
}, Open  ]],

Cell["What about the partial transposition.", "Text",ExpressionUUID->"7df017c1-ec61-4a4f-b3ed-624d36edb2d1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"PartialTranspose", "[", 
   RowBox[{"in", ",", "A"}], "]"}]}]], "Input",
 CellLabel->
  "In[123]:=",ExpressionUUID->"9ad48529-c7ec-4283-9888-bec9eaef5aa9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "3"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{"\"(\"", 
           TemplateBox[{"0"}, "Ket"], 
           TemplateBox[{"0"}, "Bra"], "\")\""}, "RowDefault"], 
         $CellContext`A[0 -> 0]], 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{
            TemplateBox[{"\"(\"", 
              TemplateBox[{"0"}, "Ket"], 
              TemplateBox[{"0"}, "Bra"], "\")\""}, "RowDefault"]}, 
           "RowDefault"], 
          TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
         $CellContext`A[E, 0 -> 0]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`A[0 -> 0], 
     $CellContext`A[E, 0 -> 0]]]}], "+", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{"\"(\"", 
           TemplateBox[{"1"}, "Ket"], 
           TemplateBox[{"0"}, "Bra"], "\")\""}, "RowDefault"], 
         $CellContext`A[0 -> 1]], 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{
            TemplateBox[{"\"(\"", 
              TemplateBox[{"0"}, "Ket"], 
              TemplateBox[{"1"}, "Bra"], "\")\""}, "RowDefault"]}, 
           "RowDefault"], 
          TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
         $CellContext`A[E, 1 -> 0]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`A[0 -> 1], 
     $CellContext`A[E, 1 -> 0]]]}], "+", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{"\"(\"", 
           TemplateBox[{"2"}, "Ket"], 
           TemplateBox[{"0"}, "Bra"], "\")\""}, "RowDefault"], 
         $CellContext`A[0 -> 2]], 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{
            TemplateBox[{"\"(\"", 
              TemplateBox[{"0"}, "Ket"], 
              TemplateBox[{"2"}, "Bra"], "\")\""}, "RowDefault"]}, 
           "RowDefault"], 
          TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
         $CellContext`A[E, 2 -> 0]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`A[0 -> 2], 
     $CellContext`A[E, 2 -> 0]]]}], "+", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{"\"(\"", 
           TemplateBox[{"0"}, "Ket"], 
           TemplateBox[{"1"}, "Bra"], "\")\""}, "RowDefault"], 
         $CellContext`A[1 -> 0]], 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{
            TemplateBox[{"\"(\"", 
              TemplateBox[{"1"}, "Ket"], 
              TemplateBox[{"0"}, "Bra"], "\")\""}, "RowDefault"]}, 
           "RowDefault"], 
          TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
         $CellContext`A[E, 0 -> 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`A[1 -> 0], 
     $CellContext`A[E, 0 -> 1]]]}], "+", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{"\"(\"", 
           TemplateBox[{"1"}, "Ket"], 
           TemplateBox[{"1"}, "Bra"], "\")\""}, "RowDefault"], 
         $CellContext`A[1 -> 1]], 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{
            TemplateBox[{"\"(\"", 
              TemplateBox[{"1"}, "Ket"], 
              TemplateBox[{"1"}, "Bra"], "\")\""}, "RowDefault"]}, 
           "RowDefault"], 
          TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
         $CellContext`A[E, 1 -> 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`A[1 -> 1], 
     $CellContext`A[E, 1 -> 1]]]}], "+", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{"\"(\"", 
           TemplateBox[{"2"}, "Ket"], 
           TemplateBox[{"1"}, "Bra"], "\")\""}, "RowDefault"], 
         $CellContext`A[1 -> 2]], 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{
            TemplateBox[{"\"(\"", 
              TemplateBox[{"1"}, "Ket"], 
              TemplateBox[{"2"}, "Bra"], "\")\""}, "RowDefault"]}, 
           "RowDefault"], 
          TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
         $CellContext`A[E, 2 -> 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`A[1 -> 2], 
     $CellContext`A[E, 2 -> 1]]]}], "+", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{"\"(\"", 
           TemplateBox[{"0"}, "Ket"], 
           TemplateBox[{"2"}, "Bra"], "\")\""}, "RowDefault"], 
         $CellContext`A[2 -> 0]], 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{
            TemplateBox[{"\"(\"", 
              TemplateBox[{"2"}, "Ket"], 
              TemplateBox[{"0"}, "Bra"], "\")\""}, "RowDefault"]}, 
           "RowDefault"], 
          TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
         $CellContext`A[E, 0 -> 2]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`A[2 -> 0], 
     $CellContext`A[E, 0 -> 2]]]}], "+", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{"\"(\"", 
           TemplateBox[{"1"}, "Ket"], 
           TemplateBox[{"2"}, "Bra"], "\")\""}, "RowDefault"], 
         $CellContext`A[2 -> 1]], 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{
            TemplateBox[{"\"(\"", 
              TemplateBox[{"2"}, "Ket"], 
              TemplateBox[{"1"}, "Bra"], "\")\""}, "RowDefault"]}, 
           "RowDefault"], 
          TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
         $CellContext`A[E, 1 -> 2]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`A[2 -> 1], 
     $CellContext`A[E, 1 -> 2]]]}], "+", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{"\"(\"", 
           TemplateBox[{"2"}, "Ket"], 
           TemplateBox[{"2"}, "Bra"], "\")\""}, "RowDefault"], 
         $CellContext`A[2 -> 2]], 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{
            TemplateBox[{"\"(\"", 
              TemplateBox[{"2"}, "Ket"], 
              TemplateBox[{"2"}, "Bra"], "\")\""}, "RowDefault"]}, 
           "RowDefault"], 
          TemplateBox[{"\[ExponentialE]"}, "RowDefault"]], 
         $CellContext`A[E, 2 -> 2]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`A[2 -> 2], 
     $CellContext`A[E, 2 -> 2]]]}]}]], "Output",
 CellChangeTimes->{3.8858899277712383`*^9},
 CellLabel->
  "Out[123]=",ExpressionUUID->"64a440a1-95b0-4202-8b9b-82c187021640"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ProperValues", "[", "out", "]"}]], "Input",
 CellLabel->
  "In[124]:=",ExpressionUUID->"68aebf92-616c-4a69-9a29-979b272611b3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "3"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "3"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "3"]}], ",", 
   FractionBox["1", "3"], ",", 
   FractionBox["1", "3"], ",", 
   FractionBox["1", "3"], ",", 
   FractionBox["1", "3"], ",", 
   FractionBox["1", "3"], ",", 
   FractionBox["1", "3"]}], "}"}]], "Output",
 CellChangeTimes->{3.885889930356119*^9},
 CellLabel->
  "Out[124]=",ExpressionUUID->"bca56469-251d-4055-bc27-f215f78c071f"]
}, Open  ]],

Cell["\<\
In fact, according to the Choi isomorphism, out is the Choi operator (up to a \
normalization factor).\
\>", "Text",ExpressionUUID->"4885468b-e0a2-47f1-898a-4e6c0a91ecaf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"iso", "=", 
   RowBox[{"3", "*", 
    RowBox[{"Matrix", "[", "out", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"iso", "//", "MatrixForm"}]}], "Input",
 CellLabel->
  "In[125]:=",ExpressionUUID->"d1586043-0bc6-4323-98e7-5f73dc83df93"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {9, 9}, 0, {
     1, {{0, 1, 2, 3, 4, 5, 6, 7, 8, 9}, {{1}, {4}, {7}, {2}, {5}, {8}, {3}, {
       6}, {9}}}, {1, 1, 1, 1, 1, 1, 1, 1, 1}}]]]]], "Output",
 CellChangeTimes->{3.8858899325262957`*^9},
 CellLabel->
  "Out[126]//MatrixForm=",ExpressionUUID->"0556b994-3ede-4d1a-bd85-\
f9e6c92bc87e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"iso", "-", "mat"}], "//", "MatrixForm"}]], "Input",
 CellLabel->
  "In[127]:=",ExpressionUUID->"dcddadc9-59f4-491a-a1b4-1954ca40ab13"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {9, 9}, 0, {
     1, {{0, 1, 2, 3, 4, 5, 6, 7, 8, 9}, {{1}, {4}, {7}, {2}, {5}, {8}, {3}, {
       6}, {9}}}, {0, 0, 0, 0, 0, 0, 0, 0, 0}}]]]]], "Output",
 CellChangeTimes->{3.885889934255331*^9},
 CellLabel->
  "Out[127]//MatrixForm=",ExpressionUUID->"381e23cf-3810-4124-b887-\
17320e825819"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{854, 891},
WindowMargins->{{Automatic, 191}, {Automatic, 0}},
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (January 30, 2023)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]]}, Visible -> False, 
  FrontEndVersion -> "13.2 for Mac OS X ARM (64-bit) (January 30, 2023)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"6192abde-3239-4e5e-9224-9e88415a223c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 99, 0, 98, "Title",ExpressionUUID->"6b646aa4-8f40-4c43-b6dc-da26f6e74203"],
Cell[CellGroupData[{
Cell[704, 26, 82, 0, 67, "Section",ExpressionUUID->"d117685b-23cb-48a7-9ee5-3c943f4fa266"],
Cell[789, 28, 392, 10, 35, "Text",ExpressionUUID->"cd64fe1b-90da-442e-8a87-f0c252553dd8"],
Cell[1184, 40, 885, 25, 51, "Text",ExpressionUUID->"2c58a30f-7294-4081-833f-23c1cb49894e"],
Cell[2072, 67, 492, 17, 42, "Text",ExpressionUUID->"e649058e-6752-4480-bd22-6513c7e1ba53"],
Cell[2567, 86, 788, 27, 50, "Text",ExpressionUUID->"f3fdafdb-0c70-42cd-8229-c68a457e06c1"],
Cell[3358, 115, 447, 14, 41, "Text",ExpressionUUID->"3648aad2-8dc6-400e-af58-35fcfb70a8cd"],
Cell[3808, 131, 128, 0, 35, "Text",ExpressionUUID->"6ad4453b-7657-463a-85ae-758b7b094fd9"],
Cell[3939, 133, 528, 16, 38, "Text",ExpressionUUID->"f9abfe60-e2a1-47a2-b59a-988bc994e09b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4504, 154, 101, 0, 67, "Section",ExpressionUUID->"7e73a43b-3f01-4fbe-8628-f01d7e997cc4"],
Cell[4608, 156, 215, 4, 30, "Input",ExpressionUUID->"cc0d95fb-b243-44f9-828d-c880d9542a87",
 CellID->1053255760],
Cell[4826, 162, 423, 11, 35, "Text",ExpressionUUID->"6c0fb5b8-b129-47c5-95d5-b4eb5c406554"],
Cell[CellGroupData[{
Cell[5274, 177, 278, 7, 52, "Input",ExpressionUUID->"f76ae442-c37c-484b-b78f-18308096fda9",
 CellID->1177418092],
Cell[5555, 186, 204, 4, 34, "Output",ExpressionUUID->"d7e62885-3d90-4f82-a145-fcb110ee8d53"]
}, Open  ]],
Cell[5774, 193, 297, 6, 30, "Input",ExpressionUUID->"0a51d35d-2551-4b72-af9d-6217ab8eef92",
 CellID->1177691642],
Cell[6074, 201, 446, 9, 81, "Text",ExpressionUUID->"830995ae-2c9b-407a-b401-e8e58ef83aeb"],
Cell[CellGroupData[{
Cell[6545, 214, 213, 5, 30, "Input",ExpressionUUID->"5758b469-f1f8-44f1-9f34-b8be2c218462"],
Cell[6761, 221, 705, 22, 34, "Output",ExpressionUUID->"07f18ce8-9576-4b19-8c79-9838fe303fe0"]
}, Open  ]],
Cell[7481, 246, 665, 17, 61, "Text",ExpressionUUID->"44264045-c0b1-4dca-a8c7-dc181fb5dfdf"],
Cell[CellGroupData[{
Cell[8171, 267, 162, 3, 30, "Input",ExpressionUUID->"cae958bd-a616-4b2e-b136-30ac9346c60d"],
Cell[8336, 272, 705, 22, 34, "Output",ExpressionUUID->"7cecc101-e6ec-4575-b788-c5cd3d941e4d"]
}, Open  ]],
Cell[9056, 297, 147, 2, 35, "Text",ExpressionUUID->"cd0749ef-e7b4-49f5-b691-5b330c0d5e50"],
Cell[CellGroupData[{
Cell[9228, 303, 216, 5, 30, "Input",ExpressionUUID->"8eaf554a-1100-49b1-b080-d627440c9936"],
Cell[9447, 310, 1829, 58, 38, "Output",ExpressionUUID->"6deb5465-2435-43bd-b9f9-ff90dee1f421"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11313, 373, 88, 0, 54, "Subsection",ExpressionUUID->"bc9a4584-9c9c-41e9-96c5-17c0de298320"],
Cell[11404, 375, 176, 3, 35, "Text",ExpressionUUID->"b2844f8c-3f45-4b30-bad2-9c9b7a7f7ea0"],
Cell[11583, 380, 91, 0, 35, "Text",ExpressionUUID->"ffdcf153-e8cb-4f13-84a5-6104d93fd4ca"],
Cell[CellGroupData[{
Cell[11699, 384, 194, 4, 30, "Input",ExpressionUUID->"2544cf41-6132-4491-8923-cee22f5d2470"],
Cell[11896, 390, 1454, 49, 56, "Output",ExpressionUUID->"60381c07-79d3-4443-b3bc-ea91f545c04e"]
}, Open  ]],
Cell[13365, 442, 236, 4, 58, "Text",ExpressionUUID->"fff01d65-40ab-4331-8f78-4eb3777d68fd"],
Cell[CellGroupData[{
Cell[13626, 450, 250, 5, 30, "Input",ExpressionUUID->"e0174592-b4dd-4c2b-a8ea-8bf3d2038f2e"],
Cell[13879, 457, 6319, 137, 345, "Output",ExpressionUUID->"ebdcc395-1969-45f3-ae8d-f8f850a299f0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20235, 599, 260, 6, 52, "Input",ExpressionUUID->"2e7cfb68-4bed-4d40-8c78-3f91e054c7e9"],
Cell[20498, 607, 1215, 30, 181, "Output",ExpressionUUID->"15860fa5-0a22-463f-aeae-0e45792db173"]
}, Open  ]],
Cell[21728, 640, 122, 0, 35, "Text",ExpressionUUID->"bc13410a-b8cb-4ed4-a72b-02af8e8ce7a0"],
Cell[21853, 642, 213, 5, 30, "Input",ExpressionUUID->"a1e514fe-63c4-42e6-95a5-a81b635e7d6d"],
Cell[22069, 649, 146, 2, 35, "Text",ExpressionUUID->"7c716546-dd8e-4c88-8813-306bc4b4ca01"],
Cell[CellGroupData[{
Cell[22240, 655, 182, 4, 30, "Input",ExpressionUUID->"53e984c7-fe18-4aa7-91ca-30b7b1fb3aa3"],
Cell[22425, 661, 308, 8, 38, "Output",ExpressionUUID->"52c1dd96-ed2f-4e53-98cb-30e5c6a5a347"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22770, 674, 161, 3, 30, "Input",ExpressionUUID->"a31a564c-8af8-4361-aa82-87f8c5a2b3bf"],
Cell[22934, 679, 310, 8, 38, "Output",ExpressionUUID->"57f3c433-a1ba-41d0-91a2-23e5f082cfc6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23281, 692, 288, 8, 30, "Input",ExpressionUUID->"e7d7f00a-ff15-4af5-892b-b5cbd7c5efe4"],
Cell[23572, 702, 542, 16, 38, "Output",ExpressionUUID->"53d90879-0668-4a99-a413-75043ff2dfff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24151, 723, 161, 3, 30, "Input",ExpressionUUID->"9b58cfa7-fd78-493c-bb39-36b01000a198"],
Cell[24315, 728, 544, 16, 38, "Output",ExpressionUUID->"2d3b513c-0992-4e94-a5b5-474c991064a8"]
}, Open  ]],
Cell[24874, 747, 128, 0, 35, "Text",ExpressionUUID->"7e195296-ee92-41fa-afbf-caaa9d5eecb3"],
Cell[CellGroupData[{
Cell[25027, 751, 139, 2, 30, "Input",ExpressionUUID->"01e11418-c729-4e98-b89e-092a603ba630"],
Cell[25169, 755, 542, 16, 38, "Output",ExpressionUUID->"597f4802-32d6-442a-8ab2-e13149263a45"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25760, 777, 94, 0, 54, "Subsection",ExpressionUUID->"131bfca5-07ff-4e01-aef9-37b450a6c6b2"],
Cell[25857, 779, 151, 2, 35, "Text",ExpressionUUID->"4cad76f2-aa14-4236-a2e7-027ac379ac56"],
Cell[CellGroupData[{
Cell[26033, 785, 204, 5, 30, "Input",ExpressionUUID->"97ce89be-36c7-44b7-8a08-0f0f469a9af4"],
Cell[26240, 792, 397, 12, 34, "Output",ExpressionUUID->"69cec4b7-1ebd-4074-9f46-aa370cb6d873"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26674, 809, 288, 7, 52, "Input",ExpressionUUID->"54073fda-9242-4992-bdc5-c609baa6e967"],
Cell[26965, 818, 1186, 30, 181, "Output",ExpressionUUID->"ec7e5699-7957-41a8-844f-872912ef971a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28188, 853, 169, 4, 30, "Input",ExpressionUUID->"3292f239-e6bb-4d6f-92ee-1a1abb193df9"],
Cell[28360, 859, 1055, 26, 181, "Output",ExpressionUUID->"123559d1-2ce9-4eea-9896-19207235aac6"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[29476, 892, 111, 0, 67, "Section",ExpressionUUID->"cd917106-7f0b-4870-ba10-2cf2c43c0170"],
Cell[29590, 894, 151, 2, 35, "Text",ExpressionUUID->"6f399f48-07c0-46ac-9c44-2c502eef9872"],
Cell[29744, 898, 244, 7, 30, "Input",ExpressionUUID->"8fe5b4ab-aa91-44b3-affa-4ce003ae5630"],
Cell[29991, 907, 476, 10, 58, "Text",ExpressionUUID->"3943a3ed-cd82-4b60-bc22-a41ca6ed4232"],
Cell[CellGroupData[{
Cell[30492, 921, 112, 2, 30, "Input",ExpressionUUID->"a92d5bd1-bd72-49f2-addf-579e6b827ec1"],
Cell[30607, 925, 329, 9, 34, "Output",ExpressionUUID->"b49c0152-4fa6-4633-8abf-84cb7aa01bfa"]
}, Open  ]],
Cell[30951, 937, 208, 3, 58, "Text",ExpressionUUID->"ea0cfbfa-4d96-4065-a831-e938cab108e1"],
Cell[CellGroupData[{
Cell[31184, 944, 206, 6, 30, "Input",ExpressionUUID->"96dddc4b-969c-4aa2-a969-b9d45c022dd3"],
Cell[31393, 952, 1055, 26, 181, "Output",ExpressionUUID->"de8ca22c-61f7-457b-a980-50b9e13da1d5"]
}, Open  ]],
Cell[32463, 981, 186, 3, 35, "Text",ExpressionUUID->"81d0601e-4649-49b3-9391-247c1abf7423"],
Cell[CellGroupData[{
Cell[32674, 988, 313, 9, 52, "Input",ExpressionUUID->"9ddcdecf-87ae-479c-826f-0496c0ca7531"],
Cell[32990, 999, 1055, 26, 181, "Output",ExpressionUUID->"9741603b-9840-464c-822c-2c57d7ada5b0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34082, 1030, 161, 4, 30, "Input",ExpressionUUID->"00e67d03-4660-410a-aa85-1ebc1df46965"],
Cell[34246, 1036, 3577, 125, 112, "Output",ExpressionUUID->"2d0c2425-e7d0-442c-a43a-f8dcadb526ec"]
}, Open  ]],
Cell[37838, 1164, 183, 3, 35, "Text",ExpressionUUID->"d19ce00d-8034-440e-b6fb-c3c9e5e0601e"],
Cell[CellGroupData[{
Cell[38046, 1171, 385, 10, 52, "Input",ExpressionUUID->"22288d7a-6f46-4f3f-89ca-b91e2367e965"],
Cell[38434, 1183, 1055, 26, 181, "Output",ExpressionUUID->"85bad855-129d-4bb4-aab4-540ed08c7303"]
}, Open  ]],
Cell[39504, 1212, 178, 3, 35, "Text",ExpressionUUID->"c1fc6822-726e-489f-8c3e-17ba7f5bb1da"],
Cell[39685, 1217, 217, 6, 30, "Input",ExpressionUUID->"c542785b-a18f-416f-b818-961d8fc403e0"],
Cell[39905, 1225, 154, 2, 35, "Text",ExpressionUUID->"4116158a-8e7b-48e5-a9c0-18b4899ede06"],
Cell[CellGroupData[{
Cell[40084, 1231, 111, 2, 30, "Input",ExpressionUUID->"f1fe2bc4-31a8-4682-91e9-81393e71f134"],
Cell[40198, 1235, 548, 17, 38, "Output",ExpressionUUID->"576c805a-9a20-4406-a83c-980e7f1b9688"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40783, 1257, 140, 3, 30, "Input",ExpressionUUID->"6ea0eea6-e29b-49ee-ab6f-b24ccd80a290"],
Cell[40926, 1262, 546, 17, 38, "Output",ExpressionUUID->"83fdec97-5854-4ec9-ad8e-b5e8981456b6"]
}, Open  ]],
Cell[41487, 1282, 799, 16, 81, "Text",ExpressionUUID->"44947701-3059-4560-9fed-f2a30e2e18d7"],
Cell[CellGroupData[{
Cell[42311, 1302, 514, 14, 52, "Input",ExpressionUUID->"f89688b9-58a6-498c-902e-b9a5b9a9a1ca"],
Cell[42828, 1318, 1643, 48, 60, "Output",ExpressionUUID->"d0761eff-3976-4775-8638-3dfdb7fbf649"]
}, Open  ]],
Cell[44486, 1369, 170, 3, 35, "Text",ExpressionUUID->"cd690b9a-601f-42e7-b5f7-213f0933bb78"],
Cell[CellGroupData[{
Cell[44681, 1376, 351, 9, 30, "Input",ExpressionUUID->"c3434cf2-bef2-49c0-9dfc-01e73a2fe1b8"],
Cell[45035, 1387, 11795, 311, 89, "Output",ExpressionUUID->"161c2220-a5e9-40d1-8f45-1fe1bd08a4bd"]
}, Open  ]],
Cell[56845, 1701, 144, 2, 35, "Text",ExpressionUUID->"e978dc07-ca99-4624-8b1d-0f8536ed45dd"],
Cell[CellGroupData[{
Cell[57014, 1707, 149, 3, 30, "Input",ExpressionUUID->"7efa9356-71aa-4222-8737-b9f07c432d9d"],
Cell[57166, 1712, 275, 7, 34, "Output",ExpressionUUID->"7df64630-df26-4015-a631-061bb2b4d936"]
}, Open  ]],
Cell[57456, 1722, 108, 0, 35, "Text",ExpressionUUID->"7df017c1-ec61-4a4f-b3ed-624d36edb2d1"],
Cell[CellGroupData[{
Cell[57589, 1726, 202, 5, 30, "Input",ExpressionUUID->"9ad48529-c7ec-4283-9888-bec9eaef5aa9"],
Cell[57794, 1733, 7078, 211, 128, "Output",ExpressionUUID->"64a440a1-95b0-4202-8b9b-82c187021640"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64909, 1949, 150, 3, 30, "Input",ExpressionUUID->"68aebf92-616c-4a69-9a29-979b272611b3"],
Cell[65062, 1954, 526, 17, 50, "Output",ExpressionUUID->"bca56469-251d-4055-bc27-f215f78c071f"]
}, Open  ]],
Cell[65603, 1974, 181, 3, 35, "Text",ExpressionUUID->"4885468b-e0a2-47f1-898a-4e6c0a91ecaf"],
Cell[CellGroupData[{
Cell[65809, 1981, 277, 7, 52, "Input",ExpressionUUID->"d1586043-0bc6-4323-98e7-5f73dc83df93"],
Cell[66089, 1990, 1218, 30, 181, "Output",ExpressionUUID->"0556b994-3ede-4d1a-bd85-f9e6c92bc87e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67344, 2025, 169, 4, 30, "Input",ExpressionUUID->"dcddadc9-59f4-491a-a1b4-1954ca40ab13"],
Cell[67516, 2031, 1216, 30, 181, "Output",ExpressionUUID->"381e23cf-3810-4124-b887-17320e825819"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

