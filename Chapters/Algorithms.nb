(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    681106,      18405]
NotebookOptionsPosition[    628089,      17252]
NotebookOutlinePosition[    633768,      17401]
CellTagsIndexPosition[    633005,      17374]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Quantum Algorithms: Introduction", "Title",
 CellChangeTimes->{{3.81848277080221*^9, 3.818482778013246*^9}, {
  3.818621337257331*^9, 3.818621344827136*^9}, {3.8186783094240227`*^9, 
  3.818678314451894*^9}},ExpressionUUID->"b9269d85-53e8-4b1a-8e3e-\
227531db259b"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellEpilog:>Get["QuantumPlaybook`Custom`"],
 CellChangeTimes->{{3.81862136736141*^9, 3.818621374064451*^9}, {
  3.823859231762335*^9, 3.823859238106399*^9}, {3.823917848999551*^9, 
  3.823917853066269*^9}, {3.82702872918224*^9, 3.827028729542859*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"461ddb1f-d118-47e8-96bb-6e4be8172a11"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellChangeTimes->{{3.8186213773725233`*^9, 3.8186213801841288`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"d69ce98c-fbd2-4f2c-9529-43b1fbb7afb1"],

Cell[BoxData[
 RowBox[{"Off", "[", 
  RowBox[{"Measurement", "::", "nonum"}], "]"}]], "Input",
 CellChangeTimes->{{3.849307428920402*^9, 3.8493074372402*^9}},
 CellLabel->"In[3]:=",
 CellID->2069736141,ExpressionUUID->"f2adc606-2818-4529-98db-e2af57b7ac6d"],

Cell[BoxData[
 FormBox[GridBox[{
    {
     ButtonBox[
      StyleBox["\<\"Table of Contents\"\>",
       StripOnInput->False,
       FontWeight->Bold],
      Alignment->Left,
      Appearance->None,
      ButtonFunction:>{},
      Evaluator->None,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"Quantum Teleportation\"\>", True->
       StyleBox["\<\"Quantum Teleportation\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 2095711634, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tNonlocality in Entanglement\"\>", True->
       
       StyleBox["\<\"\\tNonlocality in Entanglement\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 1746138191, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{
       False->"\<\"\\tImplementation of Quantum Teleportation\"\>", True->
       StyleBox["\<\"\\tImplementation of Quantum Teleportation\"\>", 
        "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 1980539882, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"Deutsch-Jozsa Algorithm\"\>", True->
       StyleBox["\<\"Deutsch-Jozsa Algorithm\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 937268274, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tQuantum Oracle\"\>", True->
       StyleBox["\<\"\\tQuantum Oracle\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 875330373, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tDeutsch-Jozsa Algorithm\"\>", True->
       StyleBox["\<\"\\tDeutsch-Jozsa Algorithm\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 1414597061, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tBernstein-Vazirani Algorithm\"\>", True->
       
       StyleBox["\<\"\\tBernstein-Vazirani Algorithm\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 341348290, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tSimon\[CloseCurlyQuote]s Algorithm\"\>",
        True->
       StyleBox["\<\"\\tSimon\[CloseCurlyQuote]s Algorithm\"\>", 
        "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 1111888893, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"Quantum Fourier Transform\"\>", True->
       StyleBox["\<\"Quantum Fourier Transform\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 113928457, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tDefinition and Physical Meaning\"\>", 
       True->
       StyleBox["\<\"\\tDefinition and Physical Meaning\"\>", 
        "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 1387647322, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tQuantum Implementation\"\>", True->
       StyleBox["\<\"\\tQuantum Implementation\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 516134434, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tSemiclassical Implementation\"\>", True->
       
       StyleBox["\<\"\\tSemiclassical Implementation\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 984982005, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"Quantum Phase Estimation\"\>", True->
       StyleBox["\<\"Quantum Phase Estimation\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 1788606959, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tDefinition\"\>", True->
       StyleBox["\<\"\\tDefinition\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 641069207, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tImplementation\"\>", True->
       StyleBox["\<\"\\tImplementation\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 524705050, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tAccuracy\"\>", True->
       StyleBox["\<\"\\tAccuracy\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 387810204, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{
       False->"\<\"\\tSimulation of von Neumann Measurement\"\>", True->
       StyleBox["\<\"\\tSimulation of von Neumann Measurement\"\>", 
        "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 1945118114, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"Applications\"\>", True->
       StyleBox["\<\"Applications\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 523633377, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tThe Period-Finding Algorithm\"\>", True->
       
       StyleBox["\<\"\\tThe Period-Finding Algorithm\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 1070104587, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tThe Order-Finding Algorithm\"\>", True->
       
       StyleBox["\<\"\\tThe Order-Finding Algorithm\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 2091554196, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tQuantum Factorization Algorithm\"\>", 
       True->
       StyleBox["\<\"\\tQuantum Factorization Algorithm\"\>", 
        "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 113725620, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tQuantum Search Algorithm\"\>", True->
       StyleBox["\<\"\\tQuantum Search Algorithm\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 1872307380, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
  Column]], "Text",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellMargins->{Inherited, {Inherited, 25}},
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellFrameColor->GrayLevel[0.7],
 CellTags->"TableOfContents",
 CellID->1638414179,ExpressionUUID->"12ed387c-ee8a-42a2-bc06-9be8217a49e4"],

Cell[CellGroupData[{

Cell["Quantum Teleportation", "Section",
 CellChangeTimes->{{3.8186783639377327`*^9, 3.818678368336421*^9}},
 CellTags->"Section45",
 CellID->2095711634,ExpressionUUID->"3886c840-ec60-4cdc-b383-7657a1c495b8"],

Cell[CellGroupData[{

Cell["\<\
When one has access to both qubits, a SWAP gate for example is enough to send \
state from one qubit to the other.\
\>", "MathCaption",
 CellChangeTimes->{{3.823917879502029*^9, 
  3.8239179871483097`*^9}},ExpressionUUID->"8253e7cd-3585-427b-bcaf-\
270c233ab8b3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"LogicalForm", "[", 
       RowBox[{
        RowBox[{"Ket", "[", "]"}], ",", 
        RowBox[{"S", "[", "1", "]"}]}], "]"}], ",", 
      RowBox[{"ProductState", "[", 
       RowBox[{
        RowBox[{"S", "[", "2", "]"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"c", "[", "0", "]"}], ",", 
          RowBox[{"c", "[", "1", "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"SWAP", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"LogicalForm", "[", 
       RowBox[{
        RowBox[{"Ket", "[", "]"}], ",", 
        RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
      RowBox[{"ProductState", "[", 
       RowBox[{
        RowBox[{"S", "[", "1", "]"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"c", "[", "0", "]"}], ",", 
          RowBox[{"c", "[", "1", "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"\"\<PortSize\>\"", "\[Rule]", "2"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8206076890474*^9, 3.8206079872651443`*^9}, {
   3.8206080242428713`*^9, 3.8206081152380733`*^9}, {3.820623201937827*^9, 
   3.8206232198128242`*^9}, 3.823917873710122*^9, {3.823917999673588*^9, 
   3.823918011593699*^9}, {3.826341611003764*^9, 3.826341640825021*^9}, 
   3.829808701605588*^9},
 CellLabel->
  "In[700]:=",ExpressionUUID->"db0223f3-0f26-44f0-b237-b88ca9a274c7"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      RowBox[{
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], " ", 
        FormBox[
         SubscriptBox[
          TemplateBox[{"c"},
           "RowDefault"], 
          TemplateBox[{"0"},
           "RowDefault"]],
         TraditionalForm]}], "+", 
       RowBox[{
        TemplateBox[{"1"},
         "Ket"], " ", 
        FormBox[
         SubscriptBox[
          TemplateBox[{"c"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         TraditionalForm]}]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]]}, {
    LineBox[{{1, -1}, {1, -2}}], 
    LineBox[{{{0.91, -1.09}, {1.09, -0.91}}, {{0.91, -0.91}, {1.09, -1.09}}}],
     LineBox[{{{0.91, -2.09}, {1.09, -1.91}}, {{0.91, -1.91}, {
     1.09, -2.09}}}]}, {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {2.1, -2}, ImageScaled[{0, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      RowBox[{
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], " ", 
        FormBox[
         SubscriptBox[
          TemplateBox[{"c"},
           "RowDefault"], 
          TemplateBox[{"0"},
           "RowDefault"]],
         TraditionalForm]}], "+", 
       RowBox[{
        TemplateBox[{"1"},
         "Ket"], " ", 
        FormBox[
         SubscriptBox[
          TemplateBox[{"c"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         TraditionalForm]}]}],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {2.1, -1}, ImageScaled[{0, Rational[1, 2]}]]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{72, 72}, {5, 5}},
  ImageSize->216,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.8239179890601254`*^9, 3.823918012350231*^9}, 
   3.8239441077294493`*^9, 3.824001204249385*^9, {3.826341584581862*^9, 
   3.826341643598193*^9}, 3.8298087125473433`*^9, 3.830132256722672*^9, 
   3.836554401972937*^9, 3.8393741903773212`*^9, 3.839713838100548*^9, 
   3.849245932143331*^9, 3.84926545526754*^9},
 CellLabel->"Out[701]=",
 CellID->254795820,ExpressionUUID->"6dbf2b37-67e8-47df-a13f-79ecbf8e67f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"KetFactor", "@", 
   RowBox[{"ExpressionFor", "[", "qc", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8206076890474*^9, 3.8206079872651443`*^9}, {
   3.8206080242428713`*^9, 3.8206081152380733`*^9}, {3.820623201937827*^9, 
   3.8206232198128242`*^9}, 3.823917873710122*^9, 3.830132248287406*^9, 
   3.839713827375766*^9},
 CellLabel->
  "In[702]:=",ExpressionUUID->"d67a6af1-c5f4-43d2-b409-067f197dcd89"],

Cell[BoxData[
 TagBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"0"},
        "RowDefault"]], " ", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], "+", 
     RowBox[{
      SubscriptBox[
       TemplateBox[{"c"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]], " ", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}]}], ")"}], "\[CircleTimes]", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}],
  HoldForm]], "Output",
 CellChangeTimes->{
  3.820607716795273*^9, {3.820607790890019*^9, 3.820607987774851*^9}, {
   3.8206080332335577`*^9, 3.8206081156961737`*^9}, {3.820623184007908*^9, 
   3.820623220293353*^9}, {3.820623311293703*^9, 3.8206233207623663`*^9}, 
   3.820623522467767*^9, 3.823859241484501*^9, {3.823917992610868*^9, 
   3.823918013850889*^9}, 3.82394410892616*^9, 3.8240012051595297`*^9, 
   3.826341584626802*^9, 3.8263416443558483`*^9, 3.829808713872015*^9, 
   3.830132259051464*^9, 3.8365544026878567`*^9, 3.839374192105624*^9, 
   3.839713839475103*^9, 3.8492459331908913`*^9, 3.849265456564848*^9},
 CellLabel->"Out[702]=",
 CellID->1606730912,ExpressionUUID->"1f554a42-3fbb-4a8f-a36d-6fb35a325d90"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Nonlocality in Entanglement", "Subsection",
 CellChangeTimes->{{3.8206086868863983`*^9, 3.820608701555379*^9}, {
  3.820608752797825*^9, 3.820608760828293*^9}},
 CellTags->"Section46",
 CellID->1746138191,ExpressionUUID->"35a44857-9ee4-4e9a-8a3a-5b79ccff192d"],

Cell[CellGroupData[{

Cell["\<\
This is the quantum entangler circuit. It generates a maximally entagnled \
state.\
\>", "MathCaption",
 CellChangeTimes->{{3.823918066225876*^9, 3.823918085103017*^9}, {
  3.8365571530879374`*^9, 
  3.836557177093548*^9}},ExpressionUUID->"3a9f9482-813e-4fa8-9668-\
8c5dac04f70f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8196810214112263`*^9, 3.8196810932465467`*^9}, {
   3.819681663311687*^9, 3.8196816889377003`*^9}, {3.819682435416142*^9, 
   3.81968245528093*^9}, {3.819947891387398*^9, 3.8199479315921392`*^9}, {
   3.82062337224579*^9, 3.820623378184033*^9}, {3.82391804733279*^9, 
   3.823918051949298*^9}, {3.823918181628296*^9, 3.823918194621209*^9}, 
   3.826341651861103*^9, 3.82980870160754*^9},
 CellLabel->
  "In[703]:=",ExpressionUUID->"3cf3fcd2-d078-4c71-8a92-674a346c6bc1"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.10666666666666667`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.10666666666666667`],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.823918186311542*^9, 3.8239181965330267`*^9}, 
   3.8239441110613623`*^9, 3.824001207239872*^9, 3.8263415846646643`*^9, 
   3.826341652216069*^9, 3.82980871884466*^9, 3.8301322614863863`*^9, 
   3.836554337964682*^9, 3.836554404209736*^9, 3.836557178656437*^9, 
   3.8393741940029573`*^9, 3.8397138415526047`*^9, 3.84924593574962*^9, 
   3.849265457881651*^9},
 CellLabel->"Out[703]=",
 CellID->857955628,ExpressionUUID->"7d705847-df50-47e1-b477-cdc158b4656f"]
}, Open  ]],

Cell["\<\
Here is the output state. It is indeed a maximally entangled state.\
\>", "Text",
 CellChangeTimes->{{3.836557194384576*^9, 3.836557222609872*^9}},
 CellID->1375495557,ExpressionUUID->"47c8d4be-3006-4d6f-af0d-70bafce3546b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{"ExpressionFor", "[", "qc", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"vec", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.8196810214112263`*^9, 3.8196810932465467`*^9}, {
   3.819681663311687*^9, 3.8196816889377003`*^9}, {3.819682435416142*^9, 
   3.81968245528093*^9}, {3.819947891387398*^9, 3.8199479315921392`*^9}, {
   3.82062337224579*^9, 3.820623378184033*^9}, 3.82391804733279*^9, 
   3.830132248288884*^9},
 CellLabel->
  "In[704]:=",ExpressionUUID->"1cd7be62-287b-4b9a-a4da-32b541e752f3"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   SqrtBox["2"]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   SqrtBox["2"]]}]], "Output",
 CellChangeTimes->{{3.819947918754657*^9, 3.8199479446869717`*^9}, 
   3.819948323029711*^9, {3.820623322585906*^9, 3.820623333369824*^9}, {
   3.8206233730993223`*^9, 3.82062337844249*^9}, {3.820623524432777*^9, 
   3.8206235277249327`*^9}, 3.820623563747868*^9, 3.823918087444934*^9, 
   3.82391816571317*^9, 3.82391819735709*^9, 3.8239441121267567`*^9, 
   3.824001208058538*^9, 3.826341584706069*^9, 3.826341653752843*^9, 
   3.8298087198946667`*^9, 3.830132262352303*^9, 3.836554339081505*^9, 
   3.836554404873046*^9, 3.836557179533205*^9, 3.839374195326166*^9, 
   3.839713843372142*^9, 3.8492459371367397`*^9, 3.8492654591144133`*^9},
 CellLabel->"Out[705]=",
 CellID->1004364066,ExpressionUUID->"78fa5936-0b68-4042-bde9-467eeba6fd5f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Now Bob measure on his qubit.", "MathCaption",
 CellChangeTimes->{{3.823918479233938*^9, 3.823918495726202*^9}, {
  3.83655723135191*^9, 
  3.836557239912528*^9}},ExpressionUUID->"dc115596-55cc-4aaa-933d-\
90a60121dc70"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"qc", ",", "\"\<Spacer\>\"", ",", 
    RowBox[{"Measurement", "@", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "3"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.81994832716678*^9, 3.819948376629531*^9}, {
   3.823918135901305*^9, 3.8239181776224823`*^9}, {3.823918225439268*^9, 
   3.8239182401835203`*^9}, 3.826341658126906*^9, 3.82980870160902*^9, {
   3.849245940496949*^9, 3.8492459406104527`*^9}},
 CellLabel->
  "In[706]:=",ExpressionUUID->"41955f4b-3b09-41f4-83a8-90ac145fa2a8"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{{{4, -2}, {5, -2}}}]}, 
   LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {4, -2}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, 
    CircleBox[{4, -2.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{4, -2.2}, {4.24, -1.76}}]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->226.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.823918160837358*^9, 3.823918240509852*^9}, 
   3.824001209198943*^9, 3.8263415847428913`*^9, 3.826341658482609*^9, 
   3.8298087214283037`*^9, 3.830132263818049*^9, 3.8365543403606033`*^9, 
   3.836554406505591*^9, {3.836557226506194*^9, 3.8365572430815763`*^9}, 
   3.839374196932396*^9, 3.839713845143993*^9, 3.84924594128796*^9, 
   3.849265460542996*^9},
 CellLabel->"Out[706]=",
 CellID->397812618,ExpressionUUID->"0c6ffe10-e501-41fa-936d-cc01fbf44e15"]
}, Open  ]],

Cell["This shows that the measurement outcome is just random.", "Text",
 CellChangeTimes->{{3.82391860206037*^9, 
  3.823918636171028*^9}},ExpressionUUID->"542e65b5-34bc-494c-9716-\
43f33e9576e5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"val", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Elaborate", "[", "qc2", "]"}], ";", 
      RowBox[{"Readout", "[", 
       RowBox[{"S", "[", 
        RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", "300", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", 
  RowBox[{"val", ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Measurement Readout\>\"", ",", "\"\<Counts\>\""}], 
     "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.757833819085938*^9, 3.757833878367415*^9}, {
   3.75783415356551*^9, 3.757834157691675*^9}, {3.7578341980203867`*^9, 
   3.757834204277904*^9}, {3.757978993308991*^9, 3.757979003319545*^9}, {
   3.813354967009922*^9, 3.8133549951892223`*^9}, {3.813355032752533*^9, 
   3.813355060211356*^9}, {3.817791789367127*^9, 3.81779179920787*^9}, {
   3.819948432583926*^9, 3.8199484749712477`*^9}, {3.819948520645576*^9, 
   3.819948545391061*^9}, {3.819948579186079*^9, 3.819948582133692*^9}, {
   3.8199486296184587`*^9, 3.81994868359206*^9}, {3.823918498494471*^9, 
   3.823918509822711*^9}, {3.82980873429081*^9, 3.829808735246167*^9}, {
   3.836554350112028*^9, 3.83655436022469*^9}, 3.836554423675166*^9, {
   3.8365572573059*^9, 3.836557257417177*^9}, {3.849245947248886*^9, 
   3.849245953524807*^9}},
 CellLabel->
  "In[707]:=",ExpressionUUID->"6f49f58c-e127-441c-853b-e72267b401b9"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
    Opacity[0.6719999999999999], Thickness[Small]}], {}, 
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
     Opacity[0.6719999999999999], Thickness[Small]}], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{-0.5, 0}, {0.5, 145.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{43.955128205128204`, 
           143.35256410256412`}, {-73.43880225883463, 44.42784586279862}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 145]& ,
        TagBoxNote->"145"],
       StyleBox["145", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[145, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{0.5, 0}, {1.5, 155.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{142.85256410256412`, 
           242.25000000000003`}, {-81.53305385343002, 44.42784586279862}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 155]& ,
        TagBoxNote->"155"],
       StyleBox["155", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[155, {}], "Tooltip"]& ]}, {}, {}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{-0.54, 0},
  AxesStyle->Automatic,
  Frame->True,
  FrameLabel->{{
     FormBox["\"Counts\"", TraditionalForm], None}, {
     FormBox["\"Measurement Readout\"", TraditionalForm], None}},
  FrameStyle->Automatic,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->250,
  PlotRange->{{-0.5, 1.5}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {None, 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.836554415716673*^9, 3.836554454192327*^9}, {
   3.836557246415987*^9, 3.836557265276142*^9}, 3.83937420103821*^9, 
   3.839713849280641*^9, 3.8492459560022497`*^9, 3.849265463419917*^9},
 CellLabel->"Out[708]=",
 CellID->1296764807,ExpressionUUID->"b8a787e5-ced1-4ff6-8cb7-7c9e72b567a0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Here Alice, possessing the first qubit, measures her qubit before Bob \
measures his qubit.\
\>", "MathCaption",
 CellChangeTimes->{{3.82391866282165*^9, 3.823918721939959*^9}, {
  3.8365572789267263`*^9, 
  3.8365572858900967`*^9}},ExpressionUUID->"877b7a67-7b67-4bc3-b690-\
9148b574f47e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc3", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"qc", ",", "\"\<Spacer\>\"", ",", 
    RowBox[{"Measurement", "@", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "3"}], "]"}]}], ",", "\"\<Separator\>\"", ",", 
    RowBox[{"Measurement", "@", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "3"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.81994832716678*^9, 3.819948376629531*^9}, {
   3.81994887421369*^9, 3.8199489041027803`*^9}, {3.823918656965748*^9, 
   3.8239186607296333`*^9}, 3.826341674247471*^9, 3.829808701620606*^9, {
   3.8492459629085407`*^9, 3.849245969061611*^9}},
 CellLabel->
  "In[709]:=",ExpressionUUID->"98c9ed68-3059-4b85-99b9-3ac9c69e552a"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{4, -1}, {7, -1}}, {{6, -2}, {7, -2}}}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {6, -2}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.045714285714285714`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.045714285714285714`],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05714285714285714],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -2}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
        2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, 
    CircleBox[{4, -1.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{4, -1.2}, {4.24, -0.76}}]}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{5, Rational[-5, 2]}, {5, Rational[-1, 2]}}, {{5, -2.5}, {
       5, -0.5}}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, 
    CircleBox[{6, -2.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{6, -2.2}, {6.24, -1.76}}]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->298.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.819948892325859*^9, 3.819948916492695*^9}, 
   3.820623581887166*^9, 3.8239187236653223`*^9, 3.824001216031522*^9, 
   3.826341586384729*^9, 3.82634167457677*^9, 3.8298087412471123`*^9, 
   3.830132269673972*^9, {3.836554431811647*^9, 3.836554455026424*^9}, {
   3.836557270245068*^9, 3.8365572913844624`*^9}, 3.839374203072646*^9, 
   3.839713854023962*^9, 3.8492459695105457`*^9, 3.849265465385964*^9},
 CellLabel->"Out[709]=",
 CellID->1311056077,ExpressionUUID->"241e5ffc-d6ae-403a-9064-b9af15f29fdc"]
}, Open  ]],

Cell["\<\
This shows that the measurement outcomes of Alice\[CloseCurlyQuote]s and Bobs\
\[CloseCurlyQuote] are perfectly correlated. This illustrates that Bob\
\[CloseCurlyQuote]s measurement results have affected by Alice measurement.\
\>", "Text",
 CellChangeTimes->{{3.8239187447558928`*^9, 3.8239187755691833`*^9}, {
  3.836557313273419*^9, 
  3.8365574452205467`*^9}},ExpressionUUID->"fce603a3-39c5-4781-9594-\
8cd35c1a6302"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"val", "=", 
   RowBox[{"Boole", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Elaborate", "[", "qc3", "]"}], ";", 
       RowBox[{"Equal", "@@", 
        RowBox[{"Readout", "[", 
         RowBox[{"S", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], ",", "3"}], "]"}], "]"}]}]}], ",", 
      RowBox[{"{", "300", "}"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", 
  RowBox[{"val", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.5"}], ",", "1.5", ",", "1"}], "}"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Bob's readout equal to Alice's\>\"", ",", "\"\<Counts\>\""}], 
     "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.757833819085938*^9, 3.757833878367415*^9}, {
   3.75783415356551*^9, 3.757834157691675*^9}, {3.7578341980203867`*^9, 
   3.757834204277904*^9}, {3.757978993308991*^9, 3.757979003319545*^9}, {
   3.813354967009922*^9, 3.8133549951892223`*^9}, {3.813355032752533*^9, 
   3.813355060211356*^9}, {3.817791789367127*^9, 3.81779179920787*^9}, {
   3.819948432583926*^9, 3.8199484749712477`*^9}, {3.819948520645576*^9, 
   3.819948545391061*^9}, {3.819948579186079*^9, 3.819948582133692*^9}, {
   3.8199486296184587`*^9, 3.81994868359206*^9}, {3.8199489332614326`*^9, 
   3.819948987708858*^9}, {3.819949104151166*^9, 3.819949106147994*^9}, 
   3.819949150453641*^9, {3.8199492007038383`*^9, 3.819949270765074*^9}, {
   3.8239187285897493`*^9, 3.823918741132864*^9}, {3.8298087474534883`*^9, 
   3.8298087505345573`*^9}, {3.836554441210479*^9, 3.836554460941975*^9}, {
   3.836557300122205*^9, 3.8365573002000237`*^9}, {3.849245980481889*^9, 
   3.849245991842885*^9}, {3.8492460262725973`*^9, 3.849246026309206*^9}},
 CellLabel->
  "In[710]:=",ExpressionUUID->"11671a1e-7fdb-4f7d-a1af-4a9a4f40d956"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
    Opacity[0.6719999999999999], Thickness[Small]}], {}, 
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
     Opacity[0.6719999999999999], Thickness[Small]}], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{0.5, 0}, {1.5, 300.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{142.85256410256412`, 
           242.25000000000006`}, {-79.75, 46.21089971622865}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 300]& ,
        TagBoxNote->"300"],
       StyleBox["300", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[300, {}], "Tooltip"]& ]}, {}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{-0.54, 0},
  AxesStyle->Automatic,
  Frame->True,
  FrameLabel->{{
     FormBox["\"Counts\"", TraditionalForm], None}, {
     FormBox["\"Bob's readout equal to Alice's\"", TraditionalForm], None}},
  FrameStyle->Automatic,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->250,
  PlotRange->{{-0.5, 1.5}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {None, 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.819949002460515*^9, 3.8199490633283978`*^9, {3.819949096284566*^9, 
   3.8199491151640863`*^9}, {3.819949272815937*^9, 3.819949277235587*^9}, 
   3.820623589659492*^9, 3.824001218800576*^9, 3.826341587819272*^9, 
   3.826341679533002*^9, 3.829808752404788*^9, 3.8301322787578697`*^9, {
   3.836554435150576*^9, 3.836554463685851*^9}, {3.8365572940915337`*^9, 
   3.836557302872114*^9}, 3.836557449541531*^9, 3.839374207091049*^9, 
   3.839713858474571*^9, {3.84924600008494*^9, 3.849246035495449*^9}, 
   3.849265470026699*^9},
 CellLabel->"Out[711]=",
 CellID->505099217,ExpressionUUID->"555c4768-6745-4bfb-9530-cb5f0777d94a"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Implementation of Quantum Teleportation", "Subsection",
 CellChangeTimes->{{3.820608834883165*^9, 3.820608846953576*^9}},
 CellTags->"Section47",
 CellID->1980539882,ExpressionUUID->"44fd6f9e-cfc5-46eb-aa98-4c5faf2af388"],

Cell[CellGroupData[{

Cell["\<\
Here is a simulation of the quantum teleportation protocol using Q3. \
\>", "MathCaption",
 CellChangeTimes->{{3.820610713071062*^9, 3.820610737775258*^9}, {
  3.828484327556226*^9, 
  3.828484348324554*^9}},ExpressionUUID->"20ec431c-c846-45f3-90fa-\
8cbdd5f934ba"],

Cell["\<\
The initial state of the total system at the beginning of the protocol.\
\>", "Text",
 CellChangeTimes->{{3.820610713071062*^9, 3.820610737775258*^9}, {
  3.828484327556226*^9, 3.828484344080509*^9}},
 CellID->89151289,ExpressionUUID->"aabd563e-2e41-4f82-b262-3ee4c5268142"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "\[Psi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Ket", "[", "]"}], 
     RowBox[{"\[Psi]", "[", "0", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{
       RowBox[{"S", "[", "3", "]"}], "\[Rule]", "1"}], "]"}], 
     RowBox[{"\[Psi]", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"vec", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.820610480532551*^9, 3.8206105892914343`*^9}, {
   3.820610688412643*^9, 3.82061069020115*^9}, {3.820610907904666*^9, 
   3.820610909164497*^9}, {3.820625697863352*^9, 3.820625703093348*^9}, 
   3.824001232111161*^9, {3.832011146666233*^9, 3.832011153581595*^9}},
 CellLabel->
  "In[712]:=",ExpressionUUID->"56c1fb4d-55b6-4edd-a586-5941bf77075c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], " ", 
   SubscriptBox[
    TemplateBox[{"\[Psi]"},
     "RowDefault"], 
    TemplateBox[{"0"},
     "RowDefault"]]}], "+", 
  RowBox[{
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], " ", 
   SubscriptBox[
    TemplateBox[{"\[Psi]"},
     "RowDefault"], 
    TemplateBox[{"1"},
     "RowDefault"]]}]}]], "Output",
 CellChangeTimes->{
  3.824001233703411*^9, 3.826341587869145*^9, 3.826341683225895*^9, 
   3.828484355415997*^9, 3.830132356510376*^9, 3.832011009499461*^9, {
   3.8320111406924353`*^9, 3.832011157706265*^9}, 3.832017307921155*^9, 
   3.8393742104971457`*^9, 3.839713860846409*^9, 3.849246055900463*^9, 
   3.849265472649765*^9},
 CellLabel->"Out[714]=",
 CellID->832036843,ExpressionUUID->"e9dfc927-e038-4ef9-a6a1-59bdf41358a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"tot", "=", 
   RowBox[{
    RowBox[{"BellState", "[", 
     RowBox[{
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"0", ",", "2"}], "}"}]}], ",", "0"}], "]"}], "**", "vec"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"tot", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.820610480532551*^9, 3.8206105892914343`*^9}, {
   3.820610688412643*^9, 3.82061069020115*^9}, {3.820610907904666*^9, 
   3.820610909164497*^9}, {3.820625697863352*^9, 3.820625703093348*^9}, 
   3.824001232111161*^9},
 CellLabel->
  "In[715]:=",ExpressionUUID->"034c6148-eb2c-443f-a21a-f2a06afb16ab"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"0"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], " ", 
    SubscriptBox[
     TemplateBox[{"\[Psi]"},
      "RowDefault"], 
     TemplateBox[{"0"},
      "RowDefault"]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"0"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], " ", 
    SubscriptBox[
     TemplateBox[{"\[Psi]"},
      "RowDefault"], 
     TemplateBox[{"0"},
      "RowDefault"]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"0"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], " ", 
    SubscriptBox[
     TemplateBox[{"\[Psi]"},
      "RowDefault"], 
     TemplateBox[{"1"},
      "RowDefault"]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"0"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], " ", 
    SubscriptBox[
     TemplateBox[{"\[Psi]"},
      "RowDefault"], 
     TemplateBox[{"1"},
      "RowDefault"]]}], 
   SqrtBox["2"]]}]], "Output",
 CellChangeTimes->{{3.820610570336235*^9, 3.82061059382568*^9}, {
   3.820610690686666*^9, 3.82061070336735*^9}, 3.820610739183467*^9, 
   3.8206109096088133`*^9, 3.820615705478013*^9, 3.820615824044629*^9, 
   3.820623591824802*^9, {3.820625706456706*^9, 3.8206257260325727`*^9}, 
   3.8239190904247093`*^9, 3.823919278469183*^9, {3.824001225634192*^9, 
   3.824001234691008*^9}, 3.826341587904613*^9, 3.826341684313527*^9, 
   3.828484356347959*^9, 3.830132357441215*^9, 3.832011014207903*^9, 
   3.832011158693286*^9, 3.8320173091211147`*^9, 3.8393742115289583`*^9, 
   3.839713862199737*^9, 3.8492460576399603`*^9, 3.849265473918482*^9},
 CellLabel->"Out[716]=",
 CellID->580363400,ExpressionUUID->"4211c717-4086-4270-8b34-2ec61c47014c"]
}, Open  ]],

Cell[TextData[{
 "The total state is rewritten in the Bell basis for qubits ",
 StyleBox["S[2,None]", "Input"],
 " and ",
 StyleBox["S[3,None]", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.8206104279852667`*^9, 3.82061043383187*^9}, {
  3.820615728986845*^9, 
  3.8206157948071117`*^9}},ExpressionUUID->"5e2ff89d-fc0e-4362-b128-\
78c644cf3812"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"BellState", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prj", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Dyad", "[", 
      RowBox[{"#", ",", "#"}], "]"}], "&"}], "/@", "bs"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KetFactor", "/@", 
   RowBox[{"(", 
    RowBox[{"prj", "**", "tot"}], ")"}]}], "//", 
  "TableForm"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8206104366685553`*^9, 3.820610468402416*^9}, {
   3.820610613219509*^9, 3.820610645056326*^9}, {3.820615722418232*^9, 
   3.82061572313405*^9}, {3.823919082044626*^9, 3.823919084875095*^9}, 
   3.8397138274346952`*^9},
 CellLabel->
  "In[717]:=",ExpressionUUID->"3dd3cde4-82f6-4c9a-ac6b-fd1635c2d802"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      FractionBox[
       TagBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{
             TagBox[
              TemplateBox[{
                SubscriptBox["0", 
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"2"}, "RowDefault"]]], 
                SubscriptBox["0", 
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
              DisplayForm]},
            "Ket"], "+", 
           TemplateBox[{
             TagBox[
              TemplateBox[{
                SubscriptBox["1", 
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"2"}, "RowDefault"]]], 
                SubscriptBox["1", 
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
              DisplayForm]},
            "Ket"]}], ")"}], "\[CircleTimes]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            TemplateBox[{
              TagBox[
               TemplateBox[{
                 SubscriptBox["0", 
                  SubscriptBox[
                   TemplateBox[{"S"}, "RowDefault"], 
                   TemplateBox[{"0"}, "RowDefault"]]]}, "RowDefault"], 
               DisplayForm]},
             "Ket"], " ", 
            SubscriptBox[
             TemplateBox[{"\[Psi]"},
              "RowDefault"], 
             TemplateBox[{"0"},
              "RowDefault"]]}], "+", 
           RowBox[{
            TemplateBox[{
              TagBox[
               TemplateBox[{
                 SubscriptBox["1", 
                  SubscriptBox[
                   TemplateBox[{"S"}, "RowDefault"], 
                   TemplateBox[{"0"}, "RowDefault"]]]}, "RowDefault"], 
               DisplayForm]},
             "Ket"], " ", 
            SubscriptBox[
             TemplateBox[{"\[Psi]"},
              "RowDefault"], 
             TemplateBox[{"1"},
              "RowDefault"]]}]}], ")"}]}],
        HoldForm], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox[
       TagBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{
             TagBox[
              TemplateBox[{
                SubscriptBox["0", 
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"2"}, "RowDefault"]]], 
                SubscriptBox["1", 
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
              DisplayForm]},
            "Ket"], "+", 
           TemplateBox[{
             TagBox[
              TemplateBox[{
                SubscriptBox["1", 
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"2"}, "RowDefault"]]], 
                SubscriptBox["0", 
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
              DisplayForm]},
            "Ket"]}], ")"}], "\[CircleTimes]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            TemplateBox[{
              TagBox[
               TemplateBox[{
                 SubscriptBox["1", 
                  SubscriptBox[
                   TemplateBox[{"S"}, "RowDefault"], 
                   TemplateBox[{"0"}, "RowDefault"]]]}, "RowDefault"], 
               DisplayForm]},
             "Ket"], " ", 
            SubscriptBox[
             TemplateBox[{"\[Psi]"},
              "RowDefault"], 
             TemplateBox[{"0"},
              "RowDefault"]]}], "+", 
           RowBox[{
            TemplateBox[{
              TagBox[
               TemplateBox[{
                 SubscriptBox["0", 
                  SubscriptBox[
                   TemplateBox[{"S"}, "RowDefault"], 
                   TemplateBox[{"0"}, "RowDefault"]]]}, "RowDefault"], 
               DisplayForm]},
             "Ket"], " ", 
            SubscriptBox[
             TemplateBox[{"\[Psi]"},
              "RowDefault"], 
             TemplateBox[{"1"},
              "RowDefault"]]}]}], ")"}]}],
        HoldForm], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox[
       TagBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            TemplateBox[{
              TagBox[
               TemplateBox[{
                 SubscriptBox["0", 
                  SubscriptBox[
                   TemplateBox[{"S"}, "RowDefault"], 
                   TemplateBox[{"2"}, "RowDefault"]]], 
                 SubscriptBox["1", 
                  SubscriptBox[
                   TemplateBox[{"S"}, "RowDefault"], 
                   TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
               DisplayForm]},
             "Ket"]}], "+", 
           TemplateBox[{
             TagBox[
              TemplateBox[{
                SubscriptBox["1", 
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"2"}, "RowDefault"]]], 
                SubscriptBox["0", 
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
              DisplayForm]},
            "Ket"]}], ")"}], "\[CircleTimes]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            TemplateBox[{
              TagBox[
               TemplateBox[{
                 SubscriptBox["1", 
                  SubscriptBox[
                   TemplateBox[{"S"}, "RowDefault"], 
                   TemplateBox[{"0"}, "RowDefault"]]]}, "RowDefault"], 
               DisplayForm]},
             "Ket"], " ", 
            SubscriptBox[
             TemplateBox[{"\[Psi]"},
              "RowDefault"], 
             TemplateBox[{"0"},
              "RowDefault"]]}], "-", 
           RowBox[{
            TemplateBox[{
              TagBox[
               TemplateBox[{
                 SubscriptBox["0", 
                  SubscriptBox[
                   TemplateBox[{"S"}, "RowDefault"], 
                   TemplateBox[{"0"}, "RowDefault"]]]}, "RowDefault"], 
               DisplayForm]},
             "Ket"], " ", 
            SubscriptBox[
             TemplateBox[{"\[Psi]"},
              "RowDefault"], 
             TemplateBox[{"1"},
              "RowDefault"]]}]}], ")"}]}],
        HoldForm], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox[
       TagBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{
             TagBox[
              TemplateBox[{
                SubscriptBox["0", 
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"2"}, "RowDefault"]]], 
                SubscriptBox["0", 
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
              DisplayForm]},
            "Ket"], "-", 
           TemplateBox[{
             TagBox[
              TemplateBox[{
                SubscriptBox["1", 
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"2"}, "RowDefault"]]], 
                SubscriptBox["1", 
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
              DisplayForm]},
            "Ket"]}], ")"}], "\[CircleTimes]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            TemplateBox[{
              TagBox[
               TemplateBox[{
                 SubscriptBox["0", 
                  SubscriptBox[
                   TemplateBox[{"S"}, "RowDefault"], 
                   TemplateBox[{"0"}, "RowDefault"]]]}, "RowDefault"], 
               DisplayForm]},
             "Ket"], " ", 
            SubscriptBox[
             TemplateBox[{"\[Psi]"},
              "RowDefault"], 
             TemplateBox[{"0"},
              "RowDefault"]]}], "-", 
           RowBox[{
            TemplateBox[{
              TagBox[
               TemplateBox[{
                 SubscriptBox["1", 
                  SubscriptBox[
                   TemplateBox[{"S"}, "RowDefault"], 
                   TemplateBox[{"0"}, "RowDefault"]]]}, "RowDefault"], 
               DisplayForm]},
             "Ket"], " ", 
            SubscriptBox[
             TemplateBox[{"\[Psi]"},
              "RowDefault"], 
             TemplateBox[{"1"},
              "RowDefault"]]}]}], ")"}]}],
        HoldForm], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.820610449183913*^9, 3.8206104686370077`*^9}, {
   3.820610629454199*^9, 3.820610639557543*^9}, 3.820610755908063*^9, {
   3.820615710520041*^9, 3.820615723956667*^9}, {3.820615817580792*^9, 
   3.8206158254009657`*^9}, 3.8206235943219223`*^9, {3.820625716539257*^9, 
   3.82062572742437*^9}, {3.8239190860745792`*^9, 3.823919092746128*^9}, 
   3.823919279814774*^9, {3.824001227303564*^9, 3.824001240338683*^9}, 
   3.826341587976707*^9, 3.826341686084917*^9, 3.828484357669713*^9, 
   3.8301323589373198`*^9, 3.8320110156870317`*^9, 3.832011159774722*^9, 
   3.832017313393784*^9, 3.839374212967613*^9, 3.839713863983755*^9, 
   3.8492460590025673`*^9, 3.849265475284946*^9},
 CellLabel->"Out[719]//TableForm=",
 CellID->1501340363,ExpressionUUID->"5c499933-69d3-45ef-9173-39bebdad5ede"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Step 1",
  FontWeight->"Bold"],
 ". Alice and Bob generates an entangled pair. Bob prepares a quantum state \
in a separate qubit."
}], "Text",
 CellChangeTimes->{{3.819680984754881*^9, 3.8196810170880117`*^9}, {
  3.8196811189854107`*^9, 3.81968112643225*^9}, {3.8206088020020533`*^9, 
  3.8206088110006123`*^9}, {3.820614184429797*^9, 
  3.820614232498385*^9}},ExpressionUUID->"5377a36f-9701-43c7-9b69-\
092ef0195e08"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], ",", 
    RowBox[{"ProductState", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "[", "3", "]"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Psi]", "[", "0", "]"}], ",", 
         RowBox[{"\[Psi]", "[", "1", "]"}]}], "}"}]}], ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", 
       RowBox[{"Ket", "[", "\[Psi]", "]"}]}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "\"\<Separator\>\"", ",", 
    RowBox[{"\"\<Invisible\>\"", "\[Rule]", 
     RowBox[{"S", "[", "1.5", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8196810214112263`*^9, 3.8196810932465467`*^9}, {
   3.819681663311687*^9, 3.8196816889377003`*^9}, {3.819682435416142*^9, 
   3.81968245528093*^9}, {3.8206142371789207`*^9, 3.820614322594985*^9}, {
   3.820623601256412*^9, 3.820623607537077*^9}, {3.8206257324889603`*^9, 
   3.820625811403986*^9}, {3.8238593163038597`*^9, 3.823859344954926*^9}, {
   3.823859382889353*^9, 3.823859386803042*^9}, {3.823859437629483*^9, 
   3.823859461713778*^9}, 3.826341694159404*^9, 3.829808701655698*^9, {
   3.832017317804859*^9, 3.832017339042611*^9}},
 CellLabel->
  "In[720]:=",ExpressionUUID->"405f8952-b853-4831-ae4e-525ecd8ddd34"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -3}, {4, -3}}, {{0, -4}, {
    4, -4}}}], {{InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]]}, 
    InsetBox[
     StyleBox[
      TemplateBox[{"\[Psi]"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -3}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
        2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{3, Rational[-9, 2]}, {3, Rational[-1, 2]}}, {{3, -4.5}, {
       3, -0.5}}]]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.8206143229921923`*^9, 3.8206143279967012`*^9}, 
   3.8206158273651257`*^9, {3.8206235963955812`*^9, 3.820623610379974*^9}, {
   3.8206257513203382`*^9, 3.820625764600428*^9}, {3.820625808191299*^9, 
   3.820625819227428*^9}, {3.823859317088916*^9, 3.82385934543661*^9}, {
   3.823859387153483*^9, 3.82385940347917*^9}, {3.8238594411538258`*^9, 
   3.8238594637124233`*^9}, 3.823919281122294*^9, 3.8240012418006268`*^9, 
   3.8263415880201263`*^9, {3.826341688512888*^9, 3.8263416945027246`*^9}, 
   3.826341791670527*^9, 3.826342387924938*^9, 3.828484361416594*^9, 
   3.83013236056247*^9, 3.83201102071873*^9, 3.832011161081163*^9, {
   3.832017315255056*^9, 3.832017341770697*^9}, 3.8393742143473883`*^9, 
   3.839713870816999*^9, 3.8492460615931797`*^9, 3.849265476592409*^9},
 CellLabel->"Out[720]=",
 CellID->1123852585,ExpressionUUID->"557147fa-e840-4bba-b75d-ef2494635fab"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Step 2",
  FontWeight->"Bold"],
 ". Bob performs a Bell measurement on his qubits. This can be done by \
reversing the entangler circuit."
}], "Text",
 CellChangeTimes->{{3.819681716329297*^9, 3.819681776783428*^9}, {
  3.8206143365215282`*^9, 
  3.820614379572941*^9}},ExpressionUUID->"81ae4a7a-4bd8-4df8-bec8-\
e16f3b69febb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"qc2a", "=", 
   RowBox[{"QuantumCircuit", "[", 
    RowBox[{
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{"S", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "6"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ExpressionFor", "[", "qc2a", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"BellState", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ls", "=", 
   RowBox[{"op", "**", "bs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LogicalForm", "@", 
   RowBox[{"Transpose", "@", 
    RowBox[{"Thread", "[", 
     RowBox[{"bs", "\[Rule]", "ls"}], "]"}]}]}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.81968178550368*^9, 3.819681868927196*^9}, {
   3.820614403826923*^9, 3.8206145037436533`*^9}, {3.820614552780044*^9, 
   3.820614557245816*^9}, {3.820614587507839*^9, 3.8206145917035103`*^9}, {
   3.820614643630529*^9, 3.820614732320513*^9}, {3.8206147934945927`*^9, 
   3.8206148073304987`*^9}, {3.8206148448477497`*^9, 3.820614868359404*^9}, {
   3.820614916877695*^9, 3.820614937947359*^9}, {3.820623679011879*^9, 
   3.820623682757235*^9}, {3.820625826197987*^9, 3.820625856447442*^9}, {
   3.820626147068818*^9, 3.820626155211606*^9}, 3.820626190030142*^9, {
   3.823859255735791*^9, 3.823859259705635*^9}, 3.823859292252767*^9, {
   3.823859485776475*^9, 3.8238594883638763`*^9}, 3.829808701663891*^9, 
   3.830132248332259*^9, {3.8320173469518557`*^9, 3.832017355793619*^9}},
 CellLabel->
  "In[721]:=",ExpressionUUID->"6ce1e810-3eac-4926-a097-24db81f269cf"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       FractionBox[
        RowBox[{
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], "+", 
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"]}], 
        SqrtBox["2"]], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], "+", 
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"]}], 
        SqrtBox["2"]], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], "-", 
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"]}], 
        SqrtBox["2"]], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]], 
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"], "-", 
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]]], 
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"]}], 
        SqrtBox["2"]], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8238592941500597`*^9, 3.823859299273356*^9}, {
   3.82385936202118*^9, 3.823859372737845*^9}, {3.823859473848755*^9, 
   3.823859488887245*^9}, 3.823919282804644*^9, 3.8240012434420013`*^9, 
   3.826341588071189*^9, 3.826341698475767*^9, 3.82634238946891*^9, 
   3.828484362800097*^9, 3.8301323620509033`*^9, 3.8320110232247763`*^9, 
   3.832011162109181*^9, {3.8320173564442673`*^9, 3.832017365266095*^9}, 
   3.839374215940686*^9, 3.839713872543015*^9, 3.849246063488132*^9, 
   3.8492654779527473`*^9},
 CellLabel->"Out[725]//TableForm=",
 CellID->1461761368,ExpressionUUID->"e99131e1-ab98-4b1a-ac07-6b69106eccf7"]
}, Open  ]],

Cell["This is the corresponding quantum circuit model.", "Text",
 CellChangeTimes->{{3.823919185675393*^9, 
  3.8239192073867893`*^9}},ExpressionUUID->"9afda341-25b0-48c4-b566-\
5e947d183f57"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"\"\<Separator\>\"", ",", "qc2a", ",", 
    RowBox[{"Measurement", "@", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], ",", "3"}], "]"}]}], ",", 
    RowBox[{"\"\<Visible\>\"", "\[Rule]", 
     RowBox[{"S", "[", "1", "]"}]}], ",", 
    RowBox[{"\"\<Invisible\>\"", "\[Rule]", 
     RowBox[{"S", "[", "1.5", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.81968178550368*^9, 3.819681868927196*^9}, {
   3.820614403826923*^9, 3.8206145037436533`*^9}, {3.820614552780044*^9, 
   3.820614557245816*^9}, {3.820614587507839*^9, 3.8206145917035103`*^9}, {
   3.820614643630529*^9, 3.820614732320513*^9}, {3.8206147934945927`*^9, 
   3.8206148073304987`*^9}, {3.8206148448477497`*^9, 3.820614868359404*^9}, {
   3.820614916877695*^9, 3.820614937947359*^9}, {3.820623679011879*^9, 
   3.820623682757235*^9}, {3.820625826197987*^9, 3.820625856447442*^9}, {
   3.820626147068818*^9, 3.820626155211606*^9}, 3.820626190030142*^9, {
   3.823859255735791*^9, 3.823859259705635*^9}, 3.823859292252767*^9, 
   3.823859356487089*^9, 3.823859493606247*^9, {3.823919213541272*^9, 
   3.823919217951315*^9}, {3.826341702855031*^9, 3.826341703247864*^9}, 
   3.8298087016760902`*^9, {3.83201738162402*^9, 3.832017389756394*^9}, {
   3.8492460692646313`*^9, 3.849246072683378*^9}},
 CellLabel->
  "In[726]:=",ExpressionUUID->"4d7ec85a-14c6-4605-a3ca-e7ef18a8f5be"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{4, -3}, {5, -3}}, {{4, -4}, {5, -4}}}]}, 
   LineBox[{{{0, -1}, {5, -1}}, {{0, -3}, {4, -3}}, {{0, -4}, {4, -4}}}], 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{1, Rational[-9, 2]}, {1, Rational[-1, 2]}}, {{1, -4.5}, {
       1, -0.5}}]]}, {LineBox[{{2, -3}, {2, -4}}], 
    DiskBox[{2, -3}, 0.09], {CircleBox[{2, -4}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -4}, {2.2666666666666666`, -4}}, {{
        2, -4.266666666666667}, {2, -3.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light",
      FontSlant->Italic], {3, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, 
     CircleBox[{4, -3.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -3.2}, {4.24, -2.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, 
     CircleBox[{4, -4.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -4.2}, {4.24, -3.76}}]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->226.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.819681789935841*^9, 3.81968180212041*^9}, {
   3.8196818650954933`*^9, 3.8196818691998262`*^9}, 3.819803794999077*^9, 
   3.81980420663871*^9, 3.8198042867407503`*^9, 3.819947871565641*^9, {
   3.8206143832456284`*^9, 3.820614410639799*^9}, {3.820614448797456*^9, 
   3.82061450774603*^9}, {3.8206145576224937`*^9, 3.820614561686839*^9}, {
   3.8206145942715893`*^9, 3.820614597298908*^9}, {3.820614678290799*^9, 
   3.820614685380723*^9}, {3.820614724750433*^9, 3.820614735106225*^9}, {
   3.820614797296652*^9, 3.820614808164074*^9}, {3.820614862600165*^9, 
   3.820614868848022*^9}, {3.820614917344324*^9, 3.820614940762912*^9}, 
   3.820615832603849*^9, 3.82062361298812*^9, {3.820623663048524*^9, 
   3.820623685490617*^9}, {3.820625856960861*^9, 3.820625861329494*^9}, {
   3.820626155546088*^9, 3.820626191016008*^9}, {3.823859248394248*^9, 
   3.823859260134684*^9}, {3.823859295331983*^9, 3.8238593000886087`*^9}, {
   3.823859357592621*^9, 3.82385937346321*^9}, {3.823859481085997*^9, 
   3.823859494045043*^9}, 3.8239192848813877`*^9, 3.824001248164638*^9, 
   3.826341588111765*^9, 3.8263417036807833`*^9, 3.826342391177099*^9, 
   3.828484364421124*^9, 3.830132363563733*^9, 3.832011025644661*^9, 
   3.832011163469984*^9, {3.832017382493957*^9, 3.83201739426226*^9}, 
   3.839374217304605*^9, 3.839713874268202*^9, 3.849246073360785*^9, 
   3.849265479420753*^9},
 CellLabel->"Out[726]=",
 CellID->1016209443,ExpressionUUID->"260bd750-c009-4ed8-8890-a0ad5d002ede"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Step 3",
  FontWeight->"Bold"],
 ". Bob sends the measurement outcome to Alice through a classical channel.\n",
 StyleBox["Step 4",
  FontWeight->"Bold"],
 ". Alice applies a proper unitary gate on her qubit in accordance with Bob\
\[CloseCurlyQuote]s message. These two steps are simulated by a feedback \
control."
}], "Text",
 CellChangeTimes->{{3.819681887511485*^9, 3.819681926028859*^9}, {
   3.82061507842439*^9, 3.820615282938031*^9}, {3.8206153306365137`*^9, 
   3.8206154056011877`*^9}, 3.8320149872812157`*^9, {3.8320151789186993`*^9, 
   3.832015297647676*^9}},ExpressionUUID->"7712b946-da0a-40d8-93fe-\
79fd869f046b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Measurement", "@", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], ",", "3"}], "]"}]}], ",", 
    "\"\<Separator\>\"", ",", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"1", ",", "3"}], "]"}]}], "]"}], ",", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"S", "[", "3", "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"1", ",", "1"}], "]"}]}], "]"}], ",", 
    RowBox[{"\"\<Invisible\>\"", "\[Rule]", 
     RowBox[{"S", "[", "1.5", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.81968178550368*^9, 3.819681868927196*^9}, {
   3.820614403826923*^9, 3.8206145037436533`*^9}, {3.820614552780044*^9, 
   3.820614557245816*^9}, {3.820614587507839*^9, 3.8206145917035103`*^9}, {
   3.820614643630529*^9, 3.820614732320513*^9}, {3.8206147934945927`*^9, 
   3.8206148073304987`*^9}, {3.8206148448477497`*^9, 3.820614868359404*^9}, {
   3.820614916877695*^9, 3.820614937947359*^9}, {3.820623679011879*^9, 
   3.820623682757235*^9}, {3.820625826197987*^9, 3.820625856447442*^9}, {
   3.820626147068818*^9, 3.820626155211606*^9}, 3.820626190030142*^9, {
   3.823859255735791*^9, 3.823859259705635*^9}, 3.823859292252767*^9, 
   3.823859356487089*^9, 3.823859493606247*^9, {3.823919213541272*^9, 
   3.823919217951315*^9}, {3.826341702855031*^9, 3.826341703247864*^9}, 
   3.8298087016760902`*^9, {3.832015060098785*^9, 3.832015097246147*^9}, {
   3.832017400568181*^9, 3.832017413189954*^9}, {3.84924608082893*^9, 
   3.849246083347912*^9}},
 CellLabel->"In[727]:=",
 CellID->1612209499,ExpressionUUID->"5d37941d-b2fd-4052-b581-456e6c5db41a"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{1, -3}, {5, -3}}, {{1, -4}, {5, -4}}}]}, 
   LineBox[{{{0, -1}, {5, -1}}, {{0, -3}, {1, -3}}, {{0, -4}, {1, -4}}}], {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, 
     CircleBox[{1, -3.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{1, -3.2}, {1.24, -2.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, 
     CircleBox[{1, -4.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{1, -4.2}, {1.24, -3.76}}]}}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{2, Rational[-9, 2]}, {2, Rational[-1, 2]}}, {{2, -4.5}, {
       2, -0.5}}]]}, {LineBox[{{3, -3}, {3, -1}}], DiskBox[{3, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light",
      FontSlant->Italic], {3, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -4}, {4, -1}}], DiskBox[{4, -4}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light",
      FontSlant->Italic], {4, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->226.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.832015098379876*^9, 3.8320151092764463`*^9}, 
   3.8320153011817913`*^9, {3.83201741355374*^9, 3.83201741593615*^9}, 
   3.839374218992559*^9, 3.839713876877391*^9, 3.849246083739978*^9, 
   3.849265483132749*^9},
 CellLabel->"Out[727]=",
 CellID->1127749299,ExpressionUUID->"98ae65e5-180c-4607-9f37-d92338ab66fc"]
}, Open  ]],

Cell["\<\
Combining all the steps, one can transmit a quantum state to a remote party \
without a quantum channel.\
\>", "Text",
 CellChangeTimes->{{3.819681887511485*^9, 3.819681926028859*^9}, {
  3.82061507842439*^9, 3.820615282938031*^9}, {3.8206153306365137`*^9, 
  3.8206154056011877`*^9}, {3.832015140320554*^9, 3.832015141186541*^9}, {
  3.8320153072660713`*^9, 3.832015307401075*^9}},
 CellID->158133487,ExpressionUUID->"f7f90dab-359f-4d47-9b82-5192a9601fd1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"in", "=", 
     RowBox[{"ProductState", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"S", "[", "3", "]"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Psi]", "[", "0", "]"}], ",", 
          RowBox[{"\[Psi]", "[", "1", "]"}]}], "}"}]}], ",", 
       RowBox[{"\"\<Label\>\"", "\[Rule]", 
        RowBox[{"Ket", "[", "\[Psi]", "]"}]}]}], "]"}]}], ",", 
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "\"\<Separator\>\"", ",", 
    "\"\<Spacer\>\"", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "6"}], "]"}], ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], ",", "3"}], "]"}], "]"}], ",", 
    "\"\<Separator\>\"", ",", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"1", ",", "3"}], "]"}]}], "]"}], ",", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"S", "[", "3", "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"1", ",", "1"}], "]"}]}], "]"}], ",", 
    RowBox[{"ProductState", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "[", "1", "]"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Psi]", "[", "0", "]"}], ",", 
         RowBox[{"\[Psi]", "[", "1", "]"}]}], "}"}]}], ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", 
       RowBox[{"Ket", "[", "\[Psi]", "]"}]}]}], "]"}], ",", 
    RowBox[{"\"\<Invisible\>\"", "\[Rule]", 
     RowBox[{"S", "[", "1.5", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8196810214112263`*^9, 3.8196810932465467`*^9}, {
   3.819681152374172*^9, 3.8196815947691097`*^9}, {3.819681944064476*^9, 
   3.81968194439972*^9}, {3.820615640782695*^9, 3.8206156496460743`*^9}, {
   3.820625872197032*^9, 3.82062594660067*^9}, {3.820626001274185*^9, 
   3.820626047219674*^9}, 3.823859529380582*^9, {3.823919228308436*^9, 
   3.8239192400125093`*^9}, 3.826341765537208*^9, {3.8263423985684566`*^9, 
   3.826342405204833*^9}, 3.829808701680975*^9, {3.832011061232883*^9, 
   3.832011082762474*^9}, {3.83201742499142*^9, 3.832017463093536*^9}, {
   3.8492460897861958`*^9, 3.849246124816655*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"f00faa65-2b56-46a3-b23e-2cb8c35f59e9"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{7, -3}, {11, -3}}, {{7, -4}, {11, -4}}}]}, 
   LineBox[{{{0, -1}, {11, -1}}, {{0, -3}, {7, -3}}, {{0, -4}, {7, -4}}}], {
    InsetBox[
     StyleBox[
      TemplateBox[{"\[Psi]"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.029090909090909098`],
      FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, Rational[1, 2]}]], {
     InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.029090909090909098`],
       FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.029090909090909098`],
       FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03636363636363637],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -1}, {2, -3}}], 
    DiskBox[{2, -1}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
        2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{3, Rational[-9, 2]}, {3, Rational[-1, 2]}}, {{3, -4.5}, {
       3, -0.5}}]]}, {LineBox[{{5, -3}, {5, -4}}], 
    DiskBox[{5, -3}, 0.09], {CircleBox[{5, -4}, 0.26666666666666666], 
     LineBox[{{{4.733333333333333, -4}, {5.266666666666667, -4}}, {{
        5, -4.266666666666667}, {5, -3.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03636363636363637],
      FontWeight->"Light",
      FontSlant->Italic], {6, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, 
     CircleBox[{7, -3.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{7, -3.2}, {7.24, -2.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, 
     CircleBox[{7, -4.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{7, -4.2}, {7.24, -3.76}}]}}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{8, Rational[-9, 2]}, {8, Rational[-1, 2]}}, {{8, -4.5}, {
       8, -0.5}}]]}, {LineBox[{{9, -3}, {9, -1}}], DiskBox[{9, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -1.4}, {9.4, -0.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03636363636363637],
      FontWeight->"Light",
      FontSlant->Italic], {9, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{10, -4}, {10, -1}}], DiskBox[{10, -4}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -1.4}, {10.4, -0.6}]}, InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03636363636363637],
      FontWeight->"Light",
      FontSlant->Italic], {10, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, InsetBox[
    StyleBox[
     TemplateBox[{"\[Psi]"},
      "Ket"],
     StripOnInput->False,
     FontSize->Scaled[0.029090909090909098`],
     FontWeight->"Light"], {11.1, -1}, ImageScaled[{0, Rational[1, 2]}]]},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->442.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{
  3.8492461256745453`*^9, {3.849246157531438*^9, 3.8492461820371733`*^9}, 
   3.849265484976927*^9, 3.849307454275324*^9},
 CellLabel->"Out[117]=",
 CellID->2071485807,ExpressionUUID->"0fb8433c-92eb-4051-9c93-731a4519f4ae"]
}, Open  ]],

Cell["Check the result.", "Text",
 CellChangeTimes->{{3.823919260408451*^9, 
  3.8239192651670856`*^9}},ExpressionUUID->"c433d0fc-5610-44c8-9814-\
3a55bed8feb8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"ExpressionFor", "[", "qc", "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Conjugate", "[", 
         RowBox[{"\[Psi]", "[", "0", "]"}], "]"}], "*", 
        RowBox[{"\[Psi]", "[", "0", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Conjugate", "[", 
         RowBox[{"\[Psi]", "[", "1", "]"}], "]"}], "*", 
        RowBox[{"\[Psi]", "[", "1", "]"}]}]}], "->", "1"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "@", 
  RowBox[{"KetFactor", "[", 
   RowBox[{"out", ",", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.832011174666563*^9, 3.8320112467355747`*^9}, {
   3.832017472892591*^9, 3.832017473769042*^9}, 3.839713827501883*^9},
 CellLabel->"In[118]:=",
 CellID->629111375,ExpressionUUID->"3770f1ec-e968-4fd7-bc24-b89f2537b55e"],

Cell[BoxData[
 RowBox[{
  TagBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"],
   HoldForm], "\[CircleTimes]", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], " ", 
      RowBox[{"\[Psi]", "[", "0", "]"}]}], "+", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], " ", 
      RowBox[{"\[Psi]", "[", "1", "]"}]}]}],
    HoldForm], ")"}]}]], "Output",
 CellChangeTimes->{{3.83201117863984*^9, 3.832011263092457*^9}, 
   3.832017474238118*^9, 3.839374222229291*^9, 3.839713890461031*^9, {
   3.8492461293206463`*^9, 3.849246183137806*^9}, 3.849265487323019*^9, 
   3.849307455532116*^9},
 CellLabel->"Out[119]=",
 CellID->937707500,ExpressionUUID->"31f74d59-92d7-49ca-b061-92388ce5d6e6"]
}, Open  ]],

Cell["Try with an explicit numbers as well.", "Text",
 CellChangeTimes->{{3.832011270673993*^9, 3.83201133300025*^9}},
 CellID->1767478406,ExpressionUUID->"d0315347-7644-4340-8496-d2a12cee028c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Psi]", "[", "0", "]"}], ",", 
     RowBox[{"\[Psi]", "[", "1", "]"}]}], "}"}], "=", 
   RowBox[{"Normalize", "@", 
    RowBox[{"RandomVector", "[", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"ExpressionFor", "[", "qc", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"in", "->", 
  RowBox[{"LogicalForm", "@", 
   RowBox[{"KetFactor", "[", 
    RowBox[{"out", ",", 
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}]}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.819681607235526*^9, 3.8196816228246717`*^9}, {
   3.819681946323516*^9, 3.819682121217149*^9}, {3.819803822980609*^9, 
   3.819803823486397*^9}, {3.820615654325889*^9, 3.820615657137817*^9}, {
   3.8206259619344683`*^9, 3.820625963373358*^9}, 3.830132248350807*^9, {
   3.832011108503851*^9, 3.8320111088737373`*^9}, {3.832017480204878*^9, 
   3.832017481149362*^9}, 3.8397138275086946`*^9},
 CellLabel->
  "In[731]:=",ExpressionUUID->"73247977-8429-4591-aa70-8c068b2cf3f7"],

Cell[BoxData[
 RowBox[{
  TagBox[
   SubscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.45505521985997893`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.725007999634644`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       TemplateBox[{"0"},
        "Ket"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.3551046923881251`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.37575098774040927`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       TemplateBox[{"1"},
        "Ket"]}]}], ")"}], 
    SubscriptBox[
     TemplateBox[{"S"},
      "RowDefault"], 
     TemplateBox[{"3"},
      "RowDefault"]]],
   DisplayForm], "\[Rule]", 
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox["0", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]]], 
          SubscriptBox["0", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"],
     HoldForm], "\[CircleTimes]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.4550552198599789`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.7250079996346441`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1.`", "\[VeryThinSpace]", "+", 
           RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["0", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"0.1512603183811938`", "\[VeryThinSpace]", "+", 
           RowBox[{"0.5847335340283216`", " ", "\[ImaginaryI]"}]}], ")"}], 
         " ", 
         TemplateBox[{
           TagBox[
            TemplateBox[{
              SubscriptBox["1", 
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], 
            DisplayForm]},
          "Ket"]}]}], ")"}]}], ")"}]}],
   DisplayForm]}]], "Output",
 CellChangeTimes->{{3.819681993501895*^9, 3.8196820160803747`*^9}, {
   3.819682051526339*^9, 3.819682060877207*^9}, {3.819682098504368*^9, 
   3.819682124109915*^9}, {3.819803800710024*^9, 3.8198038284282703`*^9}, 
   3.819804206734027*^9, 3.819804286835518*^9, {3.820615658089082*^9, 
   3.820615660650713*^9}, 3.820623694119419*^9, {3.820625963801478*^9, 
   3.820625965599852*^9}, {3.820626023051506*^9, 3.82062605828424*^9}, 
   3.8238595340812902`*^9, 3.823919288924312*^9, 3.824001252741226*^9, 
   3.826341588196217*^9, 3.826341713014358*^9, 3.8263424099685907`*^9, 
   3.828484368355275*^9, 3.828484463320517*^9, 3.830132367953751*^9, {
   3.832011091966814*^9, 3.8320111117922153`*^9}, 3.8320113352220163`*^9, 
   3.832017481577422*^9, 3.839374223986709*^9, 3.839713893304278*^9, 
   3.849246134375504*^9, 3.84924618664272*^9, 3.8492654908070383`*^9},
 CellLabel->"Out[733]=",
 CellID->965959337,ExpressionUUID->"e9552531-8e7a-4a28-877e-aac3094995c8"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Deutsch-Jozsa Algorithm", "Section",
 CellChangeTimes->{{3.818666937476184*^9, 3.81866694190833*^9}, {
  3.81867834945993*^9, 3.8186783571659327`*^9}},
 CellTags->"Section48",
 CellID->937268274,ExpressionUUID->"147d10ce-32ef-4c90-adce-43267f63c000"],

Cell[CellGroupData[{

Cell["Quantum Oracle", "Subsection",
 CellChangeTimes->{{3.818667551341221*^9, 3.818667569758067*^9}, {
  3.818667712809558*^9, 3.818667746652706*^9}, {3.818902865032364*^9, 
  3.8189028674057693`*^9}},
 CellTags->"Section49",
 CellID->875330373,ExpressionUUID->"25bade32-d675-4545-a640-24c6cbd9b899"],

Cell[CellGroupData[{

Cell["\<\
Here is a simple example, which is used in the Deutsch-Jozsa algorithm.\
\>", "MathCaption",
 CellChangeTimes->{{3.81890287556196*^9, 
  3.818902902818839*^9}},ExpressionUUID->"5bfdb562-9ae7-484c-8c48-\
5f465405351e"],

Cell[TextData[{
 "Consider a balanced function ",
 Cell[BoxData[
  FormBox["f", TraditionalForm]],ExpressionUUID->
  "71a7d463-b98b-4e05-b92d-b1218006f6c0"],
 " as a classical oracle."
}], "Text",
 CellChangeTimes->{{3.8186671838914948`*^9, 3.818667200191592*^9}, {
  3.8186678036327467`*^9, 3.8186678127002172`*^9}, {3.818895342236134*^9, 
  3.818895342448854*^9}, {3.8206070180929317`*^9, 
  3.8206070262203693`*^9}},ExpressionUUID->"587bb975-3f3f-44b1-88ae-\
074d6937023a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "f", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "=", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "1"}], "]"}], "=", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "0"}], "]"}], "=", "1"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8186508164773283`*^9, 3.818650885233067*^9}, {
   3.818651470688508*^9, 3.818651533211761*^9}, {3.818667796534925*^9, 
   3.8186678007981577`*^9}, {3.818834201660343*^9, 3.818834206463353*^9}, {
   3.820581401118075*^9, 3.8205814057189817`*^9}, {3.820967135877077*^9, 
   3.820967139172207*^9}, {3.823919359318804*^9, 3.8239193755292892`*^9}, 
   3.8393754245801363`*^9},
 CellLabel->
  "In[734]:=",ExpressionUUID->"6ddfe543-ec47-493b-840b-65e7af264000"],

Cell["Here is the corresponding quantum oracle.", "Text",
 CellChangeTimes->{{3.8239194549648314`*^9, 
  3.823919467609632*^9}},ExpressionUUID->"01626fc4-125c-47f5-8c4b-\
5f41628a16f7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"S", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Oracle", "[", 
    RowBox[{"f", ",", "cc", ",", "tt"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8186674197347527`*^9, 3.81866745452712*^9}, {
   3.818669381184102*^9, 3.818669381568959*^9}, 3.82400126831072*^9, 
   3.826342419143506*^9, 3.829808701694859*^9},
 CellLabel->
  "In[737]:=",ExpressionUUID->"c850b8fa-65fe-41f1-95ad-3e6b68f47540"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {
    LineBox[{{1, -1}, {1, -2}, {1, -3}}], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     FilledCurveBox[{
      BezierCurve[{{1.4, -1}, {1.4, -0.47439999999999993`}, {
         0.6, -0.47439999999999993`}, {0.6, -1}}], 
       Line[{{0.6, -1}, {0.6, -2}}], 
       BezierCurve[{{0.6, -2.5256}, {1.4, -2.5256}, {1.4, -2}}]}]}, InsetBox[
     StyleBox["\<\"f\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.2],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{1, Rational[-3, 2]}, {1, -1.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]], {
     CircleBox[{1, -3}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
        1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{
  3.824001269720481*^9, 3.8263415882337437`*^9, 3.8263424195248938`*^9, 
   3.830132372043928*^9, {3.8393742285693703`*^9, 3.8393742327693443`*^9}, 
   3.839713897308044*^9, 3.849246193324052*^9, 3.849265498201705*^9},
 CellLabel->"Out[739]=",
 CellID->454802627,ExpressionUUID->"91a3ed16-f3a0-47b0-bc38-fe4839a3df9a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}]], "Input",
 CellChangeTimes->{{3.8186674197347527`*^9, 3.81866745452712*^9}, {
   3.818669381184102*^9, 3.818669381568959*^9}, 3.82400126831072*^9, 
   3.8301322483574142`*^9},
 CellLabel->
  "In[740]:=",ExpressionUUID->"be2053d7-6a9b-4e34-a133-f9ddb233f8aa"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"3"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], "2"]}]], "Output",
 CellChangeTimes->{{3.81866745009214*^9, 3.818667454843136*^9}, 
   3.81866775048929*^9, 3.8186678149084063`*^9, 3.81866905411077*^9, 
   3.8186690967494793`*^9, {3.8186693239356823`*^9, 3.818669382107456*^9}, {
   3.8188341848784018`*^9, 3.818834208163007*^9}, 3.818977048337471*^9, 
   3.819682565776505*^9, 3.819803851477058*^9, 3.819804206777025*^9, 
   3.819804286880169*^9, 3.8205814074621696`*^9, 3.820967140760066*^9, 
   3.82391939313916*^9, {3.824001264640233*^9, 3.8240012707602987`*^9}, 
   3.8263415882660513`*^9, 3.826342421849168*^9, 3.830132373840843*^9, 
   3.8393742341783543`*^9, 3.839713899387952*^9, 3.849246194637944*^9, 
   3.8492655000148373`*^9},
 CellLabel->"Out[740]=",
 CellID->768515850,ExpressionUUID->"59e8b094-78ab-4b92-aef6-1cedca6f24c4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"Basis", "@", 
    RowBox[{"Join", "[", 
     RowBox[{"cc", ",", 
      RowBox[{"{", "tt", "}"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"bs", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.818669125975196*^9, 3.818669147401524*^9}},
 CellLabel->
  "In[741]:=",ExpressionUUID->"e7cb7f3e-785f-4f3b-b37a-a134e7e106ce"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "}"}]], "Output",
 CellChangeTimes->{{3.8186691404483128`*^9, 3.818669147666494*^9}, 
   3.818669384332067*^9, 3.8188342095534277`*^9, 3.819682567066229*^9, 
   3.819803852851074*^9, 3.8198042068409643`*^9, 3.819804286918715*^9, 
   3.820581409594315*^9, 3.820967142326235*^9, 3.823919395324748*^9, 
   3.824001272424952*^9, 3.826341588278335*^9, 3.826342423202829*^9, 
   3.830132376719472*^9, 3.8393742352942266`*^9, 3.839713900214775*^9, 
   3.849246195199769*^9, 3.849265500750677*^9},
 CellLabel->"Out[742]=",
 CellID->669939798,ExpressionUUID->"5987f4c7-7234-4b29-a055-9e0678fbdbdc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "bs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.818669150128396*^9, 3.818669160957694*^9}},
 CellLabel->
  "In[743]:=",ExpressionUUID->"0efa830c-e112-46d8-a612-2e3f6510c697"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "}"}]], "Output",
 CellChangeTimes->{{3.818669152036134*^9, 3.8186691612336187`*^9}, 
   3.8186693851406*^9, 3.818834210320101*^9, 3.819682567717531*^9, 
   3.8198038537678423`*^9, 3.819804206879312*^9, 3.819804286956664*^9, 
   3.820581410311504*^9, 3.8209671432759457`*^9, 3.8239193965394373`*^9, 
   3.824001273211231*^9, 3.826341588317404*^9, 3.826342423933498*^9, 
   3.830132377767914*^9, 3.8393742363464003`*^9, 3.839713901294924*^9, 
   3.849246196197208*^9, 3.849265501773734*^9},
 CellLabel->"Out[744]=",
 CellID->886753315,ExpressionUUID->"134af486-0021-49b2-80bb-df19df049480"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"bs", "\[Rule]", "out"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]], "Input",
 CellChangeTimes->{{3.8186691716714153`*^9, 3.818669232686678*^9}},
 CellLabel->
  "In[745]:=",ExpressionUUID->"d412f9fa-5d50-41bf-8686-34bfb9254ce1"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8186691871875134`*^9, 3.818669202452326*^9}, 
   3.8186692330741987`*^9, 3.818669386418865*^9, 3.818834211020423*^9, 
   3.819682568566146*^9, 3.8198038545147867`*^9, 3.819804206918117*^9, 
   3.819804286996956*^9, 3.8205814112617292`*^9, 3.820967144343652*^9, 
   3.823919399139598*^9, 3.824001273963195*^9, 3.826341588358282*^9, 
   3.8263424247856827`*^9, 3.8301323789657593`*^9, 3.8393742372472258`*^9, 
   3.8397139034648542`*^9, 3.849246196938674*^9, 3.8492655027161493`*^9},
 CellLabel->"Out[745]//TableForm=",
 CellID->1929799839,ExpressionUUID->"3fea937a-41fa-47f9-9d2a-5d6f38a7f138"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Let us consider another example, which is used in Simon\[CloseCurlyQuote]s \
algorithm.\
\>", "MathCaption",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.81890276823136*^9, 
  3.818902801315727*^9}},ExpressionUUID->"1de127be-6045-4115-af7b-\
07356f9bf72b"],

Cell["Consider a two-to-one function as a classical oracle.", "Text",
 CellChangeTimes->{{3.818667068937937*^9, 
  3.818667100857731*^9}},ExpressionUUID->"5c10a6e7-d503-4387-89f0-\
942ea65dbba3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "f", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "1"}], "]"}], "=", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "0"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8186508164773283`*^9, 3.818650885233067*^9}, {
   3.818651470688508*^9, 3.818651533211761*^9}, {3.820581416518656*^9, 
   3.8205814216935673`*^9}, {3.823919421902055*^9, 3.82391943173372*^9}, 
   3.839375418336508*^9},
 CellLabel->
  "In[746]:=",ExpressionUUID->"63c7fd9e-d1a7-44c2-8aed-fc6088d2751d"],

Cell["\<\
Here is an implementation of the corresponding quantum oracle.\
\>", "Text",
 CellChangeTimes->{{3.818667106879932*^9, 
  3.818667130610606*^9}},ExpressionUUID->"f03d2935-2471-4f83-86a2-\
d11af88fe7a6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"3", ",", "4"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Oracle", "[", 
    RowBox[{"f", ",", "cc", ",", "tt"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.818657304343545*^9, 3.818657362073503*^9}, {
   3.818657566718795*^9, 3.818657575098328*^9}, {3.8186656344167633`*^9, 
   3.818665646880411*^9}, 3.818667002511541*^9, 3.826342434408588*^9, 
   3.829808701732821*^9},
 CellLabel->
  "In[749]:=",ExpressionUUID->"4f460cfc-a4fc-4134-ac88-b815cae52b06"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
    0, -4}, {2, -4}}}], {LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}}], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     FilledCurveBox[{
      BezierCurve[{{1.4, -1}, {1.4, -0.47439999999999993`}, {
         0.6, -0.47439999999999993`}, {0.6, -1}}], 
       Line[{{0.6, -1}, {0.6, -2}}], 
       BezierCurve[{{0.6, -2.5256}, {1.4, -2.5256}, {1.4, -2}}]}]}, InsetBox[
     StyleBox["\<\"f\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.2],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{1, Rational[-3, 2]}, {1, -1.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]], {
     CircleBox[{1, -3}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
        1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}, {
     CircleBox[{1, -4}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -4}, {1.2666666666666666`, -4}}, {{
        1, -4.266666666666667}, {1, -3.7333333333333334`}}}]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->118.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.81866699288649*^9, 3.818667004777478*^9}, 
   3.818667082015224*^9, 3.8186671327204657`*^9, 3.8188342149783154`*^9, 
   3.8196825719057093`*^9, 3.81980385895487*^9, 3.8198042069651537`*^9, 
   3.819804287045104*^9, 3.820581424945641*^9, 3.820967149624407*^9, 
   3.823919478798514*^9, 3.82400127823132*^9, 3.8263415884074783`*^9, {
   3.826342429254836*^9, 3.826342434874078*^9}, 3.830132382558268*^9, 
   3.839374241014347*^9, 3.8397139181646023`*^9, 3.8492461998323603`*^9, 
   3.849265506064437*^9},
 CellLabel->"Out[751]=",
 CellID->630144415,ExpressionUUID->"b10d6665-41d3-4d28-ae10-65fc3155ea5d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"Elaborate", "@", 
   RowBox[{"Oracle", "[", 
    RowBox[{"f", ",", "cc", ",", "tt"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8186555194531183`*^9, 3.818655543391605*^9}, {
   3.818655694757443*^9, 3.818655695643837*^9}, 3.818657558138802*^9, {
   3.8301323926397552`*^9, 3.830132394630026*^9}, {3.839374252137344*^9, 
   3.8393742534633007`*^9}},
 CellLabel->
  "In[752]:=",ExpressionUUID->"6cfadacc-2806-448d-9541-2529de8dc1b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TagBox[
    RowBox[{
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"], 
        TemplateBox[{"\"z\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm], 
     TagBox[
      TemplateBox[{
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"], 
        TemplateBox[{"\"x\""}, "RowDefault"]},
       "Subsuperscript"],
      DisplayForm]}],
    DisplayForm]}], "+", 
  FractionBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"4"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Subsuperscript"], "2"]}]], "Output",
 CellChangeTimes->{
  3.8186528179185963`*^9, {3.81865287043755*^9, 3.81865289402213*^9}, 
   3.818655362786578*^9, {3.818655473698975*^9, 3.818655543951762*^9}, {
   3.818655696164872*^9, 3.818655728383875*^9}, 3.818656335045885*^9, {
   3.818657544312244*^9, 3.818657579902013*^9}, 3.818667159322407*^9, 
   3.818834216359177*^9, 3.819682573837982*^9, 3.819803860389805*^9, 
   3.8198042070818243`*^9, 3.819804287160975*^9, 3.820581427052782*^9, 
   3.820967151652677*^9, {3.823919475116673*^9, 3.82391947983384*^9}, 
   3.824001279637068*^9, 3.826341588552984*^9, 3.826342436859271*^9, {
   3.8301323847437963`*^9, 3.8301323955663137`*^9}, {3.839374243324108*^9, 
   3.839374253911262*^9}, 3.839713920109556*^9, 3.849246201552697*^9, 
   3.8492655075471897`*^9},
 CellLabel->"Out[752]=",
 CellID->574483153,ExpressionUUID->"32e36d63-6c21-40df-8014-cf1f9b362897"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"Basis", "@", 
    RowBox[{"Join", "[", 
     RowBox[{"cc", ",", "tt"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"bs", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.8186537072843227`*^9, 3.8186537324269667`*^9}, {
  3.8186538060238523`*^9, 3.818653809206686*^9}, {3.818655733466798*^9, 
  3.818655750767226*^9}, {3.8189028392386723`*^9, 3.818902840812481*^9}, {
  3.819682579070649*^9, 3.819682579620739*^9}},
 CellLabel->
  "In[753]:=",ExpressionUUID->"62d46754-e89c-4e76-83fc-32ad62252ca2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.818653734072915*^9, 3.8186538095165377`*^9, 3.818655598215893*^9, 
   3.818655636474676*^9, {3.818655698777288*^9, 3.8186557518810587`*^9}, 
   3.818656336015027*^9, 3.818657581029008*^9, 3.8186671599213037`*^9, 
   3.818834217213787*^9, {3.819682574530595*^9, 3.8196825800046997`*^9}, 
   3.819803861057811*^9, 3.8198042071153107`*^9, 3.819804287195079*^9, 
   3.820581427956897*^9, 3.820967153332909*^9, 3.823919481367729*^9, 
   3.8240012803020687`*^9, 3.826341588589465*^9, 3.826342437591687*^9, 
   3.830132396813025*^9, 3.839374255237767*^9, 3.839713920850255*^9, 
   3.849246202231494*^9, 3.849265508368332*^9},
 CellLabel->"Out[754]=",
 CellID->780916396,ExpressionUUID->"382d8bf0-0444-498c-ba31-bc551e6d3eae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "bs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.8186557551562634`*^9, 3.818655762634967*^9}},
 CellLabel->
  "In[755]:=",ExpressionUUID->"752c6e32-e938-44a2-85a3-d7051261f35d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], ",", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "}"}]], "Output",
 CellChangeTimes->{3.8186557637060823`*^9, 3.818656336793481*^9, 
  3.818657581948091*^9, 3.8186671606454*^9, 3.8188342180547247`*^9, 
  3.81968258155282*^9, 3.819803862158731*^9, 3.819804207182549*^9, 
  3.819804287285782*^9, 3.8205814291531277`*^9, 3.8209671572816133`*^9, 
  3.823919482589678*^9, 3.824001281396783*^9, 3.8263415886575193`*^9, 
  3.826342438524213*^9, 3.830132397924754*^9, 3.839374256231791*^9, 
  3.839713922276587*^9, 3.849246203273581*^9, 3.849265509612167*^9},
 CellLabel->"Out[756]=",
 CellID->312286360,ExpressionUUID->"2a2714df-13ea-4137-ad94-5cd0cad8f42c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"tbl", "=", 
   RowBox[{
    RowBox[{"Thread", "[", 
     RowBox[{"Rule", "[", 
      RowBox[{"bs", ",", "out"}], "]"}], "]"}], "//", "LogicalForm"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tbl", "[", 
   RowBox[{"[", 
    RowBox[{";;", "8"}], "]"}], "]"}], "//", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.81865564111726*^9, 3.8186556589002647`*^9}, {
  3.839374262058977*^9, 3.839374273352022*^9}},
 CellLabel->
  "In[757]:=",ExpressionUUID->"2d0878c3-2104-47c8-81b6-fad14c347f16"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8186671615003233`*^9, 3.818834218900676*^9, 3.819682584759885*^9, 
   3.819803863198292*^9, 3.819804207233789*^9, 3.819804287337451*^9, 
   3.8205814303620167`*^9, 3.8209671582505283`*^9, 3.823919483923918*^9, 
   3.824001282819792*^9, 3.826341588715005*^9, 3.8263424394642982`*^9, 
   3.8301323988061113`*^9, {3.839374257521759*^9, 3.839374274230925*^9}, 
   3.8397139237611847`*^9, 3.8492462040321627`*^9, 3.849265510706655*^9},
 CellLabel->"Out[758]//TableForm=",
 CellID->641457973,ExpressionUUID->"4ccdc9b7-c371-4fe1-81a2-25f8d6870fc5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Here is demonstrate the feature of quantum oracle that makes a copy of the \
image f(x) of the native register to the ancillary qubit.\
\>", "MathCaption",
 CellChangeTimes->{{3.8302093224777*^9, 3.8302094462545137`*^9}},
 CellID->1089484095,ExpressionUUID->"b9bbfa87-21e4-469b-a635-7ad30d05fece"],

Cell["\<\
In this particular example, we consider a one-to-one function, but it can be \
arbitrary (but not constant if an entanglement is necessary).\
\>", "Text",
 CellChangeTimes->{{3.830209551673346*^9, 3.8302096647747793`*^9}},
 CellID->1334404591,ExpressionUUID->"0a6cfb8b-58a5-453f-97dd-aa11edd077ff"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "f", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "0"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "1"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "0"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "1"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.830209459027478*^9, 3.830209529951232*^9}, {
   3.830209670930111*^9, 3.830209675215191*^9}, 3.839375411192707*^9},
 CellLabel->"In[759]:=",
 CellID->219138262,ExpressionUUID->"75a513cd-ee2b-4264-b733-c0e7d6027bf8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"S", "@", "cc"}], ",", 
        RowBox[{"S", "@", "tt"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"cc", ",", "6"}], "]"}], ",", 
    RowBox[{"Oracle", "[", 
     RowBox[{"f", ",", 
      RowBox[{"S", "@", "cc"}], ",", 
      RowBox[{"S", "@", "tt"}]}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.830209685261272*^9, 3.8302097464687862`*^9}},
 CellLabel->"In[764]:=",
 CellID->1528492484,ExpressionUUID->"201e9610-5958-4732-9551-ec53893ee997"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}, {{0, -3}, {3, -3}}, {{
    0, -4}, {3, -4}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.10666666666666667`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.10666666666666667`],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.10666666666666667`],
      FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.10666666666666667`],
      FontWeight->"Light"], {-0.1, -4}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -2}, {2, -3}, {2, -4}}], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     FilledCurveBox[{
      BezierCurve[{{2.4, -1}, {2.4, -0.47439999999999993`}, {
         1.6, -0.47439999999999993`}, {1.6, -1}}], 
       Line[{{1.6, -1}, {1.6, -2}}], 
       BezierCurve[{{1.6, -2.5256}, {2.4, -2.5256}, {2.4, -2}}]}]}, InsetBox[
     StyleBox["\<\"f\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.13333333333333333`],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{2, Rational[-3, 2]}, {2, -1.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]], {
     CircleBox[{2, -3}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
        2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}, {
     CircleBox[{2, -4}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -4}, {2.2666666666666666`, -4}}, {{
        2, -4.266666666666667}, {2, -3.7333333333333334`}}}]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->154.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.830209720747389*^9, 3.830209749614572*^9}, 
   3.839374278177744*^9, 3.839713927649428*^9, 3.849246207391191*^9, 
   3.849265514274623*^9},
 CellLabel->"Out[766]=",
 CellID->870465674,ExpressionUUID->"63f140e9-2568-4bbf-8c12-f86bad467d32"]
}, Open  ]],

Cell[TextData[{
 "The output state is an entangled state (unless the classical oracle ",
 StyleBox["f", "Input"],
 " is constant)."
}], "Text",
 CellChangeTimes->{{3.830209798496826*^9, 3.830209839073638*^9}},
 CellID->1245720949,ExpressionUUID->"7b4209c1-a5a1-47e0-b357-5d5efd91e144"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"ExpressionFor", "[", "qc", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"out", ",", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"S", "@", "cc"}], ",", 
     RowBox[{"S", "@", "tt"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.830209752602504*^9, 3.830209781308255*^9}},
 CellLabel->"In[767]:=",
 CellID->1881044746,ExpressionUUID->"d1210a33-dff3-4b6f-83b9-2d7d3883ec99"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{{3.830209760747807*^9, 3.830209781788172*^9}, 
   3.830209848693027*^9, 3.839374280031402*^9, 3.8397139291976423`*^9, 
   3.849246208999425*^9, 3.849265516203038*^9},
 CellLabel->"Out[768]=",
 CellID->778700642,ExpressionUUID->"55dac68c-04d3-481f-88a0-f33f0f736e20"]
}, Open  ]],

Cell["\<\
To make clearer the copies made tot the ancillary register, it may be useful \
to rewrite the state vector in a form that distinguishes the native and \
ancillary register.\
\>", "Text",
 CellChangeTimes->{{3.8302099176863613`*^9, 3.830210017871719*^9}},
 CellID->254930395,ExpressionUUID->"d72a2f14-45a3-411f-a251-dd38e4b752fc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"KetFactor", "[", 
   RowBox[{"out", ",", 
    RowBox[{"S", "@", "cc"}]}], "]"}], "//", "LogicalForm"}]], "Input",
 CellChangeTimes->{{3.830209852070178*^9, 3.830209864677494*^9}, 
   3.839713827743103*^9},
 CellLabel->"In[769]:=",
 CellID->427420082,ExpressionUUID->"57958642-d929-460d-abf0-1dda3bb8d0dd"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox["0", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]], 
          SubscriptBox["0", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"],
     HoldForm], "\[CircleTimes]", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], ")"}]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox["0", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]], 
          SubscriptBox["1", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"],
     HoldForm], "\[CircleTimes]", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], ")"}]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox["1", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]], 
          SubscriptBox["0", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"],
     HoldForm], "\[CircleTimes]", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], ")"}]}],
   DisplayForm], "+", 
  TagBox[
   RowBox[{
    TagBox[
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox["1", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]], 
          SubscriptBox["1", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"],
     HoldForm], "\[CircleTimes]", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]]], 
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], ")"}]}],
   DisplayForm]}]], "Output",
 CellChangeTimes->{3.8302098649215527`*^9, 3.830210019561301*^9, 
  3.839374281625114*^9, 3.839713931044599*^9, 3.8492462102857924`*^9, 
  3.8492655176739197`*^9},
 CellLabel->"Out[769]=",
 CellID->2039437969,ExpressionUUID->"beabd85d-40af-4e1b-b0af-cd929cc016e4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
This is an interesting twist of the quantum oracle. It is useful in Grover\
\[CloseCurlyQuote]s search algorithm.\
\>", "MathCaption",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.8207352519815407`*^9, 3.820735304560794*^9}, {
  3.820737432315325*^9, 3.820737442979941*^9}, {3.829627797966975*^9, 
  3.829627799383397*^9}},ExpressionUUID->"7a513a07-14e9-49ab-9551-\
7f23b4dffe2a"],

Cell[TextData[{
 "The classical oracle mark the solutions, ",
 StyleBox["{0,0}=0", "Input"],
 " and {",
 StyleBox["1,1}=1", "Input"],
 " in this particular case."
}], "Text",
 CellChangeTimes->{{3.82073538287929*^9, 
  3.8207354280902348`*^9}},ExpressionUUID->"1019f323-5d42-4e4b-951f-\
265f64107e55"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "f", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "0"}], "]"}], "=", "1"}], ";", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "1"}], "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "0"}], "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "1"}], "]"}], "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8207340710326757`*^9, 3.820734119555006*^9}, {
   3.820734678887533*^9, 3.820734687773491*^9}, {3.820735372238793*^9, 
   3.820735376332213*^9}, {3.823919502995899*^9, 3.823919505375963*^9}, 
   3.839375443288794*^9},
 CellLabel->
  "In[770]:=",ExpressionUUID->"2550c51d-10b5-42d3-9beb-3a91fea1afe6"],

Cell["This quantum circuit model implements the desired mapping.", "Text",
 CellChangeTimes->{{3.820736026971243*^9, 3.820736071934588*^9}, {
   3.820736338838376*^9, 3.820736355841976*^9}, {3.820736423356009*^9, 
   3.820736464619094*^9}, 3.820736518482196*^9, {3.820736605223884*^9, 
   3.820736711029003*^9}, {3.820736748911724*^9, 3.8207367517739162`*^9}, {
   3.820736795416318*^9, 3.820736813337393*^9}, {3.820736847263426*^9, 
   3.82073690497252*^9}, {3.820736963920908*^9, 3.8207369657358923`*^9}, 
   3.820737006882168*^9, {3.820737423496604*^9, 
   3.820737429582111*^9}},ExpressionUUID->"f0ec82fb-1e6a-4392-959d-\
1e96af5354bf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"{", "3", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ct", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"cc", ",", "tt"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{
        RowBox[{"S", "[", "tt", "]"}], "\[Rule]", "1"}], "]"}], ",", 
      RowBox[{"S", "[", "ct", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"ct", ",", "6"}], "]"}], ",", 
    RowBox[{"Oracle", "[", 
     RowBox[{"f", ",", 
      RowBox[{"S", "@", "cc"}], ",", 
      RowBox[{"S", "@", "tt"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"tt", ",", "6"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8207341237164783`*^9, 3.820734240699329*^9}, {
   3.820734283537939*^9, 3.820734381980672*^9}, {3.8207344778038797`*^9, 
   3.8207345284592743`*^9}, {3.820734699429063*^9, 3.820734699551868*^9}, {
   3.8207354709846563`*^9, 3.8207354723347054`*^9}, 3.823919513285721*^9, {
   3.82400129278986*^9, 3.8240012956468697`*^9}, 3.829808701814889*^9},
 CellLabel->
  "In[772]:=",ExpressionUUID->"828812a7-a3ab-4121-86a1-4c4005ea4bb0"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"1"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -3}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -2}, {2, -3}}], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     FilledCurveBox[{
      BezierCurve[{{2.4, -1}, {2.4, -0.47439999999999993`}, {
         1.6, -0.47439999999999993`}, {1.6, -1}}], 
       Line[{{1.6, -1}, {1.6, -2}}], 
       BezierCurve[{{1.6, -2.5256}, {2.4, -2.5256}, {2.4, -2}}]}]}, InsetBox[
     StyleBox["\<\"f\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{2, Rational[-3, 2]}, {2, -1.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]], {
     CircleBox[{2, -3}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
        2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {3, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{
  3.823919517217609*^9, {3.824001288702516*^9, 3.824001296523334*^9}, 
   3.826341588788279*^9, 3.826342443455125*^9, 3.8296278034017897`*^9, 
   3.83013240269462*^9, 3.839374285141116*^9, 3.839713934346798*^9, 
   3.849246213769637*^9, 3.8492655208494577`*^9},
 CellLabel->"Out[775]=",
 CellID->636449805,ExpressionUUID->"c368218f-7241-4b10-8b8e-4d837cebd32c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"ExpressionFor", "[", "qc", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KetFactor", "[", 
   RowBox[{"out", ",", 
    RowBox[{"S", "[", "tt", "]"}]}], "]"}], "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.8207341237164783`*^9, 3.820734240699329*^9}, {
   3.820734283537939*^9, 3.820734381980672*^9}, {3.8207344778038797`*^9, 
   3.8207345284592743`*^9}, {3.820734699429063*^9, 3.820734699551868*^9}, {
   3.8207354709846563`*^9, 3.8207354723347054`*^9}, 3.823919513285721*^9, 
   3.830132248467436*^9, 3.839713827764832*^9},
 CellLabel->
  "In[776]:=",ExpressionUUID->"c488cc91-fda1-4982-9983-c538e6e5cdd4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "2"]}], " ", 
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], "-", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], ")"}], "\[CircleTimes]", 
    RowBox[{"(", 
     RowBox[{
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["0", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"], "-", 
      TemplateBox[{
        TagBox[
         TemplateBox[{
           SubscriptBox["1", 
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
       "Ket"]}], ")"}], "\[CircleTimes]", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}],
   HoldForm]}]], "Output",
 CellChangeTimes->{{3.820734178221023*^9, 3.820734186573391*^9}, {
   3.820734234994615*^9, 3.820734242821121*^9}, {3.820734311577573*^9, 
   3.8207343324952383`*^9}, {3.820734364097548*^9, 3.820734388675584*^9}, {
   3.820734483834763*^9, 3.820734529822081*^9}, {3.820734693850215*^9, 
   3.820734704154944*^9}, {3.820735458104334*^9, 3.820735484234213*^9}, {
   3.82073690719611*^9, 3.8207369329243507`*^9}, 3.8207370156730213`*^9, 
   3.823919519477951*^9, 3.8240012983973303`*^9, 3.826341588854162*^9, 
   3.826342446299863*^9, 3.829627804408196*^9, 3.830132404645096*^9, 
   3.839374288622562*^9, 3.8397139421862*^9, 3.849246215867364*^9, 
   3.849265523036458*^9},
 CellLabel->"Out[777]=",
 CellID->1062945456,ExpressionUUID->"1f03c22c-45fa-4600-a42e-84dd2ea28ccb"]
}, Open  ]],

Cell["Check the result.", "Text",
 CellChangeTimes->{{3.82073694644897*^9, 3.820736953221857*^9}, {
  3.82962780508739*^9, 
  3.82962780774193*^9}},ExpressionUUID->"580fd625-e958-413a-93be-\
db1bc6d9d5e7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", "cc"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ff", "=", 
   RowBox[{"f", "@@@", 
    RowBox[{"IntegerDigits", "[", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"2", "^", "2"}], "-", "1"}]}], "]"}], ",", "2", ",", "2"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"bs", "\[Rule]", 
    RowBox[{"Power", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "ff"}], "]"}]}], "]"}], "//", 
  "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.820734539721662*^9, 3.820734622774235*^9}, {
   3.820734721049636*^9, 3.820734852239805*^9}, {3.820734897700405*^9, 
   3.820734897980145*^9}, {3.8207358674830103`*^9, 3.8207359870362253`*^9}, 
   3.824001305715301*^9},
 CellLabel->
  "In[778]:=",ExpressionUUID->"6417ab25-238a-4a31-bdd9-4a3d34246c75"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], "\[Rule]", "1"}], ",", 
   RowBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], "\[Rule]", "1"}], ",", 
   RowBox[{
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], "\[Rule]", 
    RowBox[{"-", "1"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.824001306871017*^9, 3.826341588903171*^9, 
  3.8263424477082157`*^9, 3.82962781025504*^9, 3.830132407041937*^9, 
  3.839374290178177*^9, 3.839713945278554*^9, 3.849246217287958*^9, 
  3.849265524933754*^9},
 CellLabel->"Out[780]=",
 CellID->1849324419,ExpressionUUID->"353f8afe-89f4-49f9-89f2-6287242bdd2d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{"bs", ".", 
     RowBox[{"Power", "[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "ff"}], "]"}]}], "/", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.820734539721662*^9, 3.820734622774235*^9}, {
   3.820734721049636*^9, 3.820734852239805*^9}, {3.820734897700405*^9, 
   3.820734897980145*^9}, {3.8207358674830103`*^9, 3.8207359870362253`*^9}, 
   3.824001305715301*^9},
 CellLabel->
  "In[781]:=",ExpressionUUID->"e00f4fbb-5dac-4148-b2df-32f1f55ee51f"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     TemplateBox[{
       TagBox[
        TemplateBox[{
          SubscriptBox["0", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]]], 
          SubscriptBox["0", 
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
      
      "Ket"]}], "+", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], "+", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["0", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"], "-", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.8207359230671062`*^9, 3.820735996812357*^9}, 
   3.820736320900751*^9, {3.820736934802186*^9, 3.820736954303666*^9}, 
   3.823919522776595*^9, {3.824001300180232*^9, 3.824001307749277*^9}, 
   3.826341588912094*^9, 3.826342448488612*^9, 3.8296278111972313`*^9, 
   3.8301324078431253`*^9, 3.839374291282278*^9, 3.839713946273966*^9, 
   3.849246218618012*^9, 3.849265526198773*^9},
 CellLabel->"Out[782]=",
 CellID->1176676157,ExpressionUUID->"f869dae0-2b23-4323-84a9-add01c8ee68d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Deutsch-Jozsa Algorithm", "Subsection",
 CellChangeTimes->{{3.8189030988669033`*^9, 3.818903108282305*^9}},
 CellTags->"Section50",
 CellID->1414597061,ExpressionUUID->"6137aaa5-3d2a-4794-a331-4532a2a3e483"],

Cell[CellGroupData[{

Cell["Consider a balanced function as an example.", "MathCaption",
 CellChangeTimes->{{3.818903118373352*^9, 3.818903126821419*^9}, {
  3.823919545212079*^9, 
  3.8239195473383503`*^9}},ExpressionUUID->"b45446c7-744a-4b2a-a32e-\
e51174a7d807"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "f", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "=", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "1"}], "]"}], "=", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "0"}], "]"}], "=", "1"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8186508164773283`*^9, 3.818650885233067*^9}, {
   3.818651470688508*^9, 3.818651533211761*^9}, {3.818667796534925*^9, 
   3.8186678007981577`*^9}, {3.818834201660343*^9, 3.818834206463353*^9}, {
   3.820581436093001*^9, 3.820581441346249*^9}, {3.823919550792388*^9, 
   3.823919565957226*^9}, 3.839375402530632*^9},
 CellLabel->
  "In[783]:=",ExpressionUUID->"9830c86f-95aa-4f30-b862-950499eb46b2"],

Cell["\<\
Here is a quantum circuit model of the Deutsch-Jozsa algorithm. The final \
Hadamard gate on the third qubit is not necessary, but we put it here to make \
the output state more readable.\
\>", "Text",
 CellChangeTimes->{{3.818903862958913*^9, 3.8189039335168552`*^9}, {
  3.8239352344233093`*^9, 
  3.823935236953595*^9}},ExpressionUUID->"70e9111a-4a79-4dca-97fc-\
6ed5e0d6591b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"{", "3", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"all", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{
        RowBox[{"S", "[", "3", "]"}], "\[Rule]", "1"}], "]"}], ",", 
      RowBox[{"S", "@", "all"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"all", ",", "6"}], "]"}], ",", 
    RowBox[{"Oracle", "[", 
     RowBox[{"f", ",", 
      RowBox[{"S", "@", "cc"}], ",", 
      RowBox[{"S", "@", "tt"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"all", ",", "6"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8186674197347527`*^9, 3.81866745452712*^9}, {
   3.818669381184102*^9, 3.818669381568959*^9}, {3.81890313509046*^9, 
   3.818903226259439*^9}, {3.8189032703755207`*^9, 3.8189033651515408`*^9}, {
   3.8189036796627693`*^9, 3.8189037201816273`*^9}, 3.818977856093588*^9, {
   3.8239195733828087`*^9, 3.823919577218214*^9}, 3.829808701833343*^9},
 CellLabel->
  "In[786]:=",ExpressionUUID->"c29c2fa8-f4fd-476f-97a9-b8b6981d0e31"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"1"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -3}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -2}, {2, -3}}], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     FilledCurveBox[{
      BezierCurve[{{2.4, -1}, {2.4, -0.47439999999999993`}, {
         1.6, -0.47439999999999993`}, {1.6, -1}}], 
       Line[{{1.6, -1}, {1.6, -2}}], 
       BezierCurve[{{1.6, -2.5256}, {2.4, -2.5256}, {2.4, -2}}]}]}, InsetBox[
     StyleBox["\<\"f\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{2, Rational[-3, 2]}, {2, -1.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]], {
     CircleBox[{2, -3}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
        2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.8189031125563726`*^9, 3.818903129704894*^9}, {
   3.8189031623532877`*^9, 3.818903167663526*^9}, 3.8189032277523117`*^9, {
   3.818903295112104*^9, 3.8189033813132353`*^9}, 3.818903680082749*^9, {
   3.818903712054371*^9, 3.81890374382491*^9}, 3.8189039356169033`*^9, 
   3.818977058827387*^9, 3.818977822230962*^9, 3.8189778568055143`*^9, 
   3.8196825943483133`*^9, 3.819803869448086*^9, 3.819804207300788*^9, 
   3.819804287406341*^9, 3.820581444559362*^9, {3.8239195695539618`*^9, 
   3.823919578176765*^9}, 3.8240013138935547`*^9, 3.826341588962926*^9, 
   3.8263424519620533`*^9, 3.830132411127973*^9, 3.83937429462814*^9, 
   3.839713949456276*^9, 3.849246230262341*^9, 3.849265529198606*^9},
 CellLabel->"Out[789]=",
 CellID->1459290829,ExpressionUUID->"0aa100b9-65c7-4937-9c7c-1fbd39b02d31"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}]], "Input",
 CellChangeTimes->{{3.818977842875135*^9, 3.818977845451254*^9}, 
   3.830132248485298*^9},
 CellLabel->
  "In[790]:=",ExpressionUUID->"4e9e1446-0ecb-48cf-b741-704a43c93b0e"],

Cell[BoxData[
 TemplateBox[{
   TagBox[
    TemplateBox[{
      SubscriptBox["1", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"]]], 
      SubscriptBox["1", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"]]], 
      SubscriptBox["1", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
  "Ket"]], "Output",
 CellChangeTimes->{{3.818977845946446*^9, 3.818977857783165*^9}, 
   3.8196825979528847`*^9, 3.819803871114594*^9, 3.81980420735709*^9, 
   3.8198042874636707`*^9, 3.820581446567244*^9, {3.8239195707567167`*^9, 
   3.8239195808593597`*^9}, 3.824001315752549*^9, 3.82634158902773*^9, 
   3.830132413282453*^9, 3.839374298230842*^9, 3.839713951329722*^9, 
   3.8492462324579897`*^9, 3.849265531065789*^9},
 CellLabel->"Out[790]=",
 CellID->1714949992,ExpressionUUID->"b891a8b8-7f24-4506-85bb-0858f67534ad"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bernstein-Vazirani Algorithm", "Subsection",
 CellChangeTimes->{{3.8189030988669033`*^9, 3.818903108282305*^9}, {
  3.818904066237439*^9, 3.8189040737851467`*^9}},
 CellTags->"Section51",
 CellID->341348290,ExpressionUUID->"0144cad6-22c0-4d32-aac1-b2a20db1544f"],

Cell[CellGroupData[{

Cell["\<\
Consider a secrete string of bits. The task is to find the secrete string.\
\>", "MathCaption",
 CellChangeTimes->{{3.818904084944839*^9, 3.818904091446907*^9}, {
  3.818904186954587*^9, 3.818904188079145*^9}, {3.820968282384454*^9, 
  3.8209683483281717`*^9}},ExpressionUUID->"0d6da1ed-84a9-4701-9a2e-\
073a5443510e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"string", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.818904094485598*^9, 3.818904102943906*^9}, 
   3.8239195963102903`*^9},
 CellLabel->
  "In[791]:=",ExpressionUUID->"8ea712e3-eb33-491f-9b5f-27f77fff50a1"],

Cell[TextData[{
 "In the Bernstein-Vazirani algorithm, the value of the classical oracle ",
 Cell[BoxData[
  FormBox["f", TraditionalForm]],ExpressionUUID->
  "6ee91faa-7c22-49df-8bcc-a3d4b5714084"],
 " is determined by the given secrete string."
}], "Text",
 CellChangeTimes->{{3.818903118373352*^9, 3.818903126821419*^9}, {
  3.820968184453271*^9, 3.820968274037355*^9}, {3.82967462715307*^9, 
  3.8296746356909523`*^9}},ExpressionUUID->"acb4a83b-2de2-4598-9c36-\
5bc90599cd30"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "f", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "[", "x__", "]"}], ":=", 
  RowBox[{"Mod", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", "x", "}"}], ".", "string"}], ",", "2"}], "]"}]}]}], "Input",\

 CellChangeTimes->{{3.818904119594163*^9, 3.8189041667165823`*^9}, {
   3.818904260964506*^9, 3.8189042615824747`*^9}, {3.82058146006627*^9, 
   3.820581474430538*^9}, 3.820968212173956*^9, {3.8239196078295603`*^9, 
   3.823919620676609*^9}, 3.829674668698045*^9, {3.830132467551529*^9, 
   3.83013248325613*^9}},
 CellLabel->
  "In[792]:=",ExpressionUUID->"b74733ba-dcd3-4286-9bcf-36564a2917a4"],

Cell[TextData[{
 "For example, ",
 StyleBox["f[1,1]=0\[CenterDot]1 + 1\[CenterDot]1=1", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.829674672330936*^9, 3.8296747076878767`*^9}, {
  3.8301324709367456`*^9, 3.830132472017712*^9}, {3.8492655352855453`*^9, 
  3.8492655367206793`*^9}},
 CellID->224738400,ExpressionUUID->"f03f4611-e65c-4e09-85b9-8e97544a249e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"f", "[", 
  RowBox[{"1", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.818904119594163*^9, 3.8189041667165823`*^9}, {
   3.818904260964506*^9, 3.8189042615824747`*^9}, {3.82058146006627*^9, 
   3.820581474430538*^9}, 3.820968212173956*^9, {3.8239196078295603`*^9, 
   3.823919620676609*^9}, 3.829674668698045*^9},
 CellLabel->"In[794]:=",
 CellID->1599000074,ExpressionUUID->"930f2837-f261-4fcb-bb56-99d0c4df062e"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.823919620985218*^9, 3.8239196255542717`*^9}, 
   3.824001319223105*^9, 3.8263415890678797`*^9, 3.8263424585065527`*^9, 
   3.829674645198907*^9, 3.829674714743149*^9, 3.8296747876057243`*^9, {
   3.83013241835602*^9, 3.830132490411171*^9}, 3.839374308550812*^9, 
   3.839713956811851*^9, 3.8492655379374638`*^9},
 CellLabel->"Out[794]=",
 CellID->173960086,ExpressionUUID->"ef6acd8c-ee46-4f88-a703-590b03a114c9"]
}, Open  ]],

Cell["\<\
Here is a quantum circuit of the Bernstein-Vazirani algorithm. The final \
Hadamard gate on the third qubit is not necessary, and we put it here to make \
the output state more readable.\
\>", "Text",
 CellChangeTimes->{{3.818903862958913*^9, 3.8189039335168552`*^9}, {
  3.818904207113173*^9, 3.8189042163939466`*^9}, {3.8520697720066977`*^9, 
  3.852069793135584*^9}},ExpressionUUID->"fc3c1f12-4ce9-4b61-98dd-\
c54008cc63b9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"{", "3", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"all", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{
        RowBox[{"S", "[", "3", "]"}], "\[Rule]", "1"}], "]"}], ",", 
      RowBox[{"S", "@", "all"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"all", ",", "6"}], "]"}], ",", 
    RowBox[{"Oracle", "[", 
     RowBox[{"f", ",", 
      RowBox[{"S", "@", "cc"}], ",", 
      RowBox[{"S", "@", "tt"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"all", ",", "6"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8186674197347527`*^9, 3.81866745452712*^9}, {
   3.818669381184102*^9, 3.818669381568959*^9}, {3.81890313509046*^9, 
   3.818903226259439*^9}, {3.8189032703755207`*^9, 3.8189033651515408`*^9}, {
   3.8189036796627693`*^9, 3.8189037201816273`*^9}, 3.8189778720117397`*^9, {
   3.82391963203983*^9, 3.823919635819447*^9}, 3.82980870184414*^9},
 CellLabel->
  "In[795]:=",ExpressionUUID->"0ba36037-2522-4b52-aa50-5f184f614949"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"1"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {-0.1, -3}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -2}, {2, -3}}], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     FilledCurveBox[{
      BezierCurve[{{2.4, -1}, {2.4, -0.47439999999999993`}, {
         1.6, -0.47439999999999993`}, {1.6, -1}}], 
       Line[{{1.6, -1}, {1.6, -2}}], 
       BezierCurve[{{1.6, -2.5256}, {2.4, -2.5256}, {2.4, -2}}]}]}, InsetBox[
     StyleBox["\<\"f\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{2, Rational[-3, 2]}, {2, -1.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]], {
     CircleBox[{2, -3}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
        2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.8189031125563726`*^9, 3.818903129704894*^9}, {
   3.8189031623532877`*^9, 3.818903167663526*^9}, 3.8189032277523117`*^9, {
   3.818903295112104*^9, 3.8189033813132353`*^9}, 3.818903680082749*^9, {
   3.818903712054371*^9, 3.81890374382491*^9}, 3.8189039356169033`*^9, {
   3.818904221203209*^9, 3.8189042296312227`*^9}, 3.818904263526133*^9, {
   3.818977870152629*^9, 3.818977872761547*^9}, 3.8196826023404007`*^9, 
   3.8198038769071493`*^9, 3.819804207426532*^9, 3.819804287534464*^9, 
   3.820581479091004*^9, 3.820968353165903*^9, 3.823919636745912*^9, 
   3.824001321120735*^9, 3.8263415891110287`*^9, 3.8263424599746113`*^9, 
   3.829674748140437*^9, 3.8296747894082413`*^9, 3.830132492036614*^9, 
   3.8393743100869226`*^9, 3.839713958909585*^9, 3.8492655394854183`*^9},
 CellLabel->"Out[798]=",
 CellID->156179771,ExpressionUUID->"c15fbe0b-3f1e-4e6b-9bd5-8348c1e8d5a2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"ExpressionFor", "[", "qc", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"out", ",", 
   RowBox[{"S", "@", "cc"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8189033819599047`*^9, 3.81890338749216*^9}, {
   3.818903431479766*^9, 3.818903510740753*^9}, 3.8189038260956783`*^9, {
   3.818977878254779*^9, 3.818977878569373*^9}, {3.829674797909436*^9, 
   3.829674807887768*^9}, 3.8301322484935207`*^9},
 CellLabel->
  "In[799]:=",ExpressionUUID->"a5535642-5409-4f72-8ff9-1c63801349a3"],

Cell[BoxData[
 TemplateBox[{
   TagBox[
    TemplateBox[{
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"]]], 
      SubscriptBox["1", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"]]], 
      SubscriptBox["1", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
  "Ket"]], "Output",
 CellChangeTimes->{{3.818903457785836*^9, 3.8189035118395357`*^9}, 
   3.818903681632509*^9, {3.818903721426993*^9, 3.818903744914145*^9}, 
   3.818903826856085*^9, 3.818903936882328*^9, 3.818904230427023*^9, 
   3.8189042644354143`*^9, 3.81897787904102*^9, 3.8196826039717216`*^9, 
   3.819803878464964*^9, 3.819804207479177*^9, 3.819804287586084*^9, 
   3.8205814816075*^9, 3.820968354492276*^9, 3.823919637931217*^9, 
   3.824001323277062*^9, 3.8263415891767387`*^9, 3.826342462075377*^9, {
   3.829674792967708*^9, 3.8296748100012207`*^9}, 3.8301324935299263`*^9, 
   3.839374312585902*^9, 3.8397139609181767`*^9, 3.849265541260716*^9},
 CellLabel->"Out[800]=",
 CellID->1375228138,ExpressionUUID->"812e0a2c-0720-4952-930e-38e3e9c79c30"]
}, Open  ]],

Cell["Here is the secrete string successfully retrieved.", "Text",
 CellChangeTimes->{{3.818904330946151*^9, 3.81890435461495*^9}, {
  3.820968355731267*^9, 
  3.820968356833029*^9}},ExpressionUUID->"6bc5583d-3f49-4c2e-bf43-\
13c893ef56f5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"answer", "=", 
  RowBox[{"out", "[", 
   RowBox[{"S", "@", "cc"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.818904298765443*^9, 3.8189043179196577`*^9}},
 CellLabel->
  "In[801]:=",ExpressionUUID->"9360ad6b-a03c-4fb6-852d-28923d6c0f52"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{{3.8189043182895803`*^9, 3.8189043214080153`*^9}, 
   3.818977883300321*^9, 3.819682605127398*^9, 3.8198038797988462`*^9, 
   3.819804207485951*^9, 3.819804287593141*^9, 3.8205814831219397`*^9, 
   3.820968358096036*^9, 3.824001324449862*^9, 3.826341589183804*^9, 
   3.826342463320889*^9, 3.829674815512308*^9, 3.830132494843184*^9, 
   3.839374314474805*^9, 3.83971396238654*^9, 3.849265542779455*^9},
 CellLabel->"Out[801]=",
 CellID->748991817,ExpressionUUID->"b92ccb72-8708-43bc-a79f-6e6af92ebb7f"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simon\[CloseCurlyQuote]s Algorithm", "Subsection",
 CellChangeTimes->{{3.8189043663034573`*^9, 3.818904371905249*^9}},
 CellTags->"Section52",
 CellID->1111888893,ExpressionUUID->"241c7854-4cba-419d-943e-669ba872fff9"],

Cell[CellGroupData[{

Cell["Consider again a secrete bit string.", "MathCaption",
 CellChangeTimes->{{3.818904468841568*^9, 3.818904477638376*^9}, {
  3.823919664810712*^9, 
  3.823919665383595*^9}},ExpressionUUID->"c9458ad1-85e5-4819-97ba-\
ae56d927e586"],

Cell[BoxData[
 RowBox[{
  RowBox[{"string", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.818904479394968*^9, 3.818904486648967*^9}, {
   3.8189045779726343`*^9, 3.818904578522773*^9}, 3.8239196693215714`*^9},
 CellLabel->
  "In[802]:=",ExpressionUUID->"713d4ff2-220e-45e9-bacf-338b049f1714"],

Cell["\<\
Consider a two-to-one function obeying the rule (specified in Simon\
\[CloseCurlyQuote]s problem).\
\>", "Text",
 CellChangeTimes->{{3.818667068937937*^9, 3.818667100857731*^9}, {
  3.818904425228112*^9, 3.818904426228716*^9}, {3.818904530128048*^9, 
  3.818904540241255*^9}, {3.8189045945983677`*^9, 
  3.8189046183567533`*^9}},ExpressionUUID->"b2ee20e5-59b3-42bb-b099-\
270f84147052"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "f", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "1"}], "]"}], "=", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "0"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8186508164773283`*^9, 3.818650885233067*^9}, {
   3.818651470688508*^9, 3.818651533211761*^9}, {3.820581492666233*^9, 
   3.820581497412994*^9}, {3.823919672438292*^9, 3.823919683305297*^9}, 
   3.839375455033903*^9},
 CellLabel->
  "In[803]:=",ExpressionUUID->"4cbeb37b-2b67-444d-ae1a-b45fd31496a9"],

Cell["\<\
Here is an implementation of the corresponding quantum oracle.\
\>", "Text",
 CellChangeTimes->{{3.818667106879932*^9, 
  3.818667130610606*^9}},ExpressionUUID->"87907545-3afc-4ca1-a5d8-\
0f8a4ac1c82d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"all", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"cc", ",", "tt"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"S", "@", "all"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"cc", ",", "6"}], "]"}], ",", 
    RowBox[{"Oracle", "[", 
     RowBox[{"f", ",", 
      RowBox[{"S", "@", "cc"}], ",", 
      RowBox[{"S", "@", "tt"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"cc", ",", "6"}], "]"}], ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", 
      RowBox[{"cc", ",", "3"}], "]"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.818657304343545*^9, 3.818657362073503*^9}, {
   3.818657566718795*^9, 3.818657575098328*^9}, {3.8186656344167633`*^9, 
   3.818665646880411*^9}, 3.818667002511541*^9, {3.8189046330493393`*^9, 
   3.818904782249652*^9}, {3.8196825458067217`*^9, 3.819682546637857*^9}, {
   3.823919698875877*^9, 3.823919705625057*^9}, 3.829779079533222*^9, 
   3.829808701853804*^9, {3.849246248272028*^9, 3.8492462502983103`*^9}},
 CellLabel->
  "In[806]:=",ExpressionUUID->"e9427b1e-e7fb-4bca-a01f-2b9e7291b5d2"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{4, -1}, {5, -1}}, {{4, -2}, {5, -2}}}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {5, -3}}, {{
    0, -4}, {5, -4}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -4}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -2}, {2, -3}, {2, -4}}], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     FilledCurveBox[{
      BezierCurve[{{2.4, -1}, {2.4, -0.47439999999999993`}, {
         1.6, -0.47439999999999993`}, {1.6, -1}}], 
       Line[{{1.6, -1}, {1.6, -2}}], 
       BezierCurve[{{1.6, -2.5256}, {2.4, -2.5256}, {2.4, -2}}]}]}, InsetBox[
     StyleBox["\<\"f\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{2, Rational[-3, 2]}, {2, -1.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]], {
     CircleBox[{2, -3}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
        2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}, {
     CircleBox[{2, -4}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -4}, {2.2666666666666666`, -4}}, {{
        2, -4.266666666666667}, {2, -3.7333333333333334`}}}]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {3, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, 
     CircleBox[{4, -1.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -1.2}, {4.24, -0.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, 
     CircleBox[{4, -2.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -2.2}, {4.24, -1.76}}]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->226.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.81866699288649*^9, 3.818667004777478*^9}, 
   3.818667082015224*^9, 3.8186671327204657`*^9, 3.8188342149783154`*^9, 
   3.818904641791965*^9, {3.818904698263281*^9, 3.818904782722649*^9}, 
   3.818977888320998*^9, 3.819682553944664*^9, 3.81968260926081*^9, 
   3.819803884408242*^9, 3.819804207556581*^9, 3.819804287666625*^9, {
   3.820581500838455*^9, 3.8205815235013742`*^9}, 3.823919706737158*^9, 
   3.824001328691001*^9, 3.82634158923775*^9, 3.826342467527625*^9, {
   3.829779082232997*^9, 3.829779092194749*^9}, 3.830132499365251*^9, 
   3.830142132550832*^9, 3.839374319316277*^9, 3.839713966683267*^9, 
   3.849246251010273*^9, 3.849265547023869*^9},
 CellLabel->"Out[809]=",
 CellID->1892788005,ExpressionUUID->"b7ca4c96-a9bb-4f21-9b37-64bf7d228c79"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"ExpressionFor", "[", "qc", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"out", ",", 
   RowBox[{"S", "@", "all"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"result", "=", 
  RowBox[{"Readout", "[", 
   RowBox[{"S", "[", 
    RowBox[{"cc", ",", "3"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.818904790025478*^9, 3.818904832825738*^9}, {
   3.8189051241846123`*^9, 3.818905147875737*^9}, {3.818977896310096*^9, 
   3.818977896669578*^9}, 3.830132248502214*^9, {3.8492462600687723`*^9, 
   3.84924626483484*^9}},
 CellLabel->
  "In[818]:=",ExpressionUUID->"675d0aa5-0422-45d6-bf13-d1bac9d8465b"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   SqrtBox["2"]], "+", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   SqrtBox["2"]]}]], "Output",
 CellChangeTimes->{{3.818904813285017*^9, 3.81890486434695*^9}, {
   3.8189051253179617`*^9, 3.8189051585431623`*^9}, 3.818977897189589*^9, 
   3.8196825569866953`*^9, 3.8196826106393957`*^9, 3.819803887311562*^9, 
   3.819804207693643*^9, 3.8198042878003473`*^9, {3.8205815036260643`*^9, 
   3.8205815247493896`*^9}, 3.8239197085313463`*^9, 3.8240013318755903`*^9, 
   3.826341589410653*^9, 3.82634247087998*^9, {3.8297790856813993`*^9, 
   3.829779093154599*^9}, 3.830132501947054*^9, 3.830142133585362*^9, 
   3.839374320992667*^9, 3.839713968146144*^9, {3.84924625532722*^9, 
   3.849246265503931*^9}, {3.84926554902098*^9, 3.849265560832602*^9}},
 CellLabel->"Out[819]=",
 CellID->2008320979,ExpressionUUID->"e5a97a42-8d74-4aa9-a480-917192c71a5e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.818904813285017*^9, 3.81890486434695*^9}, {
   3.8189051253179617`*^9, 3.8189051585431623`*^9}, 3.818977897189589*^9, 
   3.8196825569866953`*^9, 3.8196826106393957`*^9, 3.819803887311562*^9, 
   3.819804207693643*^9, 3.8198042878003473`*^9, {3.8205815036260643`*^9, 
   3.8205815247493896`*^9}, 3.8239197085313463`*^9, 3.8240013318755903`*^9, 
   3.826341589410653*^9, 3.82634247087998*^9, {3.8297790856813993`*^9, 
   3.829779093154599*^9}, 3.830132501947054*^9, 3.830142133585362*^9, 
   3.839374320992667*^9, 3.839713968146144*^9, {3.84924625532722*^9, 
   3.849246265503931*^9}, {3.84926554902098*^9, 3.849265560839913*^9}},
 CellLabel->"Out[820]=",
 CellID->1850214154,ExpressionUUID->"93628b13-fda3-4142-9f15-8b8b648e6226"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqs", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ExpressionFor", "[", 
      RowBox[{
       RowBox[{"Matrix", "[", "qc", "]"}], ",", 
       RowBox[{"S", "@", "all"}]}], "]"}], ";", 
     RowBox[{"Readout", "[", 
      RowBox[{"S", "[", 
       RowBox[{"cc", ",", "3"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", "2", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.818904790025478*^9, 3.818904832825738*^9}, {
   3.8189051241846123`*^9, 3.818905215586441*^9}, {3.823919719444059*^9, 
   3.823919723782661*^9}, 3.8301322485071697`*^9, {3.849246271658368*^9, 
   3.849246282025985*^9}},
 CellLabel->
  "In[821]:=",ExpressionUUID->"56187403-9428-4aff-be77-ba2e1647d23e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8189052134477863`*^9, 3.8189052165380707`*^9}, 
   3.8189052806594467`*^9, {3.818977904213007*^9, 3.818977907219247*^9}, 
   3.819682558006394*^9, 3.819682612488873*^9, 3.8198038902186527`*^9, 
   3.819804207957123*^9, 3.819804288059783*^9, {3.8205815061763983`*^9, 
   3.8205815700234747`*^9}, {3.823919710370219*^9, 3.8239197256179047`*^9}, 
   3.8240013333757067`*^9, 3.826341589737027*^9, 3.8263424726383343`*^9, 
   3.829779101860836*^9, 3.830132504903571*^9, 3.83014213536446*^9, 
   3.83937432303791*^9, 3.8397139702580767`*^9, {3.8492462673110027`*^9, 
   3.849246285944352*^9}, {3.849265550816825*^9, 3.8492655624044657`*^9}},
 CellLabel->"Out[821]=",
 CellID->960942719,ExpressionUUID->"946e77c1-682d-4742-b575-09e17a92d97f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Now let us examine a lager system. Suppose that we are given a secrete bit \
string.\
\>", "MathCaption",
 CellChangeTimes->{{3.818904468841568*^9, 3.818904477638376*^9}, {
  3.823919664810712*^9, 3.823919665383595*^9}, {3.829810076269121*^9, 
  3.829810140245269*^9}},
 CellID->1555491913,ExpressionUUID->"43705915-bfca-450c-94b2-4ea4ee8a0bfd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"string", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.818904479394968*^9, 3.818904486648967*^9}, {
   3.8189045779726343`*^9, 3.818904578522773*^9}, 3.8239196693215714`*^9, {
   3.8297779181082687`*^9, 3.829777918457204*^9}},
 CellLabel->"In[822]:=",
 CellID->1834146860,ExpressionUUID->"ade458f6-cea1-4951-97d7-19fadc48a610"],

Cell["\<\
This is a function consistent with the above secrete bit string.\
\>", "Text",
 CellChangeTimes->{{3.818667068937937*^9, 3.818667100857731*^9}, {
  3.818904425228112*^9, 3.818904426228716*^9}, {3.818904530128048*^9, 
  3.818904540241255*^9}, {3.8189045945983677`*^9, 3.8189046183567533`*^9}, {
  3.829810147816004*^9, 3.829810183398014*^9}},
 CellID->1526006982,ExpressionUUID->"a6f85606-cc16-4b5b-80f1-35c79eaef247"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "f", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "0", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "1", ",", "0"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "1"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "0", ",", "1"}], "]"}], "=", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "1", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "1", ",", "1"}], "]"}], "=", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "0", ",", "1"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8186508164773283`*^9, 3.818650885233067*^9}, {
  3.818651470688508*^9, 3.818651533211761*^9}, {3.820581492666233*^9, 
  3.820581497412994*^9}, {3.823919672438292*^9, 3.823919683305297*^9}, {
  3.8297779306294613`*^9, 3.82977796686373*^9}, {3.8297780048201227`*^9, 
  3.8297780977432423`*^9}, {3.839375383674952*^9, 3.839375386035431*^9}},
 CellLabel->"In[823]:=",
 CellID->202150353,ExpressionUUID->"93cfef95-f9c8-4880-90d6-91776ae0aa6a"],

Cell["\<\
Here is an implementation of the corresponding quantum oracle.\
\>", "Text",
 CellChangeTimes->{{3.818667106879932*^9, 3.818667130610606*^9}},
 CellID->221853317,ExpressionUUID->"c0f3c799-38da-4469-a049-58ea7e1c8bcb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5", ",", "6"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"all", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"cc", ",", "tt"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qc1", "=", 
   RowBox[{"QuantumCircuit", "[", 
    RowBox[{
     RowBox[{"LogicalForm", "[", 
      RowBox[{
       RowBox[{"Ket", "[", "]"}], ",", 
       RowBox[{"S", "@", "all"}]}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"cc", ",", "6"}], "]"}], ",", 
     RowBox[{"Oracle", "[", 
      RowBox[{"f", ",", 
       RowBox[{"S", "@", "cc"}], ",", 
       RowBox[{"S", "@", "tt"}]}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"cc", ",", "6"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"qc1", ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", 
      RowBox[{"cc", ",", "3"}], "]"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.818657304343545*^9, 3.818657362073503*^9}, {
   3.818657566718795*^9, 3.818657575098328*^9}, {3.8186656344167633`*^9, 
   3.818665646880411*^9}, 3.818667002511541*^9, {3.8189046330493393`*^9, 
   3.818904782249652*^9}, {3.8196825458067217`*^9, 3.819682546637857*^9}, {
   3.823919698875877*^9, 3.823919705625057*^9}, {3.829778992280254*^9, 
   3.8297790338476477`*^9}, {3.829779112786602*^9, 3.829779112999728*^9}, {
   3.829779302531023*^9, 3.8297793215192842`*^9}, {3.829808701866789*^9, 
   3.829808701867301*^9}, {3.849246296000062*^9, 3.84924629863197*^9}},
 CellLabel->"In[828]:=",
 CellID->657087627,ExpressionUUID->"8d7979e8-ce3b-42e7-a245-3e8bff9880cf"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{4, -1}, {5, -1}}, {{4, -2}, {5, -2}}, {{4, -3}, {5, -3}}}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
    0, -4}, {5, -4}}, {{0, -5}, {5, -5}}, {{0, -6}, {5, -6}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -5}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -6}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -2}, {2, -3}, {2, -4}, {2, -5}, {2, -6}}], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     FilledCurveBox[{
      BezierCurve[{{2.4, -1}, {2.4, -0.47439999999999993`}, {
         1.6, -0.47439999999999993`}, {1.6, -1}}], 
       Line[{{1.6, -1}, {1.6, -3}}], 
       BezierCurve[{{1.6, -3.5256}, {2.4, -3.5256}, {2.4, -3}}]}]}, InsetBox[
     StyleBox["\<\"f\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light",
      FontSlant->Italic], {2, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]], {
     CircleBox[{2, -4}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -4}, {2.2666666666666666`, -4}}, {{
        2, -4.266666666666667}, {2, -3.7333333333333334`}}}]}, {
     CircleBox[{2, -5}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -5}, {2.2666666666666666`, -5}}, {{
        2, -5.266666666666667}, {2, -4.733333333333333}}}]}, {
     CircleBox[{2, -6}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -6}, {2.2666666666666666`, -6}}, {{
        2, -6.266666666666667}, {2, -5.733333333333333}}}]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {3, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {3, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, 
     CircleBox[{4, -1.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -1.2}, {4.24, -0.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, 
     CircleBox[{4, -2.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -2.2}, {4.24, -1.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, 
     CircleBox[{4, -3.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -3.2}, {4.24, -2.76}}]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->226.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.81866699288649*^9, 3.818667004777478*^9}, 
   3.818667082015224*^9, 3.8186671327204657`*^9, 3.8188342149783154`*^9, 
   3.818904641791965*^9, {3.818904698263281*^9, 3.818904782722649*^9}, 
   3.818977888320998*^9, 3.819682553944664*^9, 3.81968260926081*^9, 
   3.819803884408242*^9, 3.819804207556581*^9, 3.819804287666625*^9, {
   3.820581500838455*^9, 3.8205815235013742`*^9}, 3.823919706737158*^9, 
   3.824001328691001*^9, 3.82634158923775*^9, 3.826342467527625*^9, 
   3.829779003430479*^9, {3.829779036725359*^9, 3.829779039200865*^9}, {
   3.8297791071325703`*^9, 3.829779115144308*^9}, {3.829779304526758*^9, 
   3.8297793256691847`*^9}, 3.82977988286736*^9, 3.829780055508788*^9, 
   3.829810187351988*^9, 3.8301325121789713`*^9, 3.830142139628044*^9, 
   3.839374327477293*^9, 3.839713974208346*^9, {3.849246290748356*^9, 
   3.849246299686885*^9}, 3.849265567250548*^9},
 CellLabel->"Out[832]=",
 CellID->28068165,ExpressionUUID->"47a869cf-0469-4b8a-873f-74b01e73aea4"]
}, Open  ]],

Cell["This is one way to get the measurement outcome.", "Text",
 CellChangeTimes->{{3.8297801729388533`*^9, 3.829780191205616*^9}},
 CellID->1617894012,ExpressionUUID->"dc774785-2c92-4f57-880d-715206081e05"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"ExpressionFor", "[", "qc2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"out", ",", 
   RowBox[{"S", "@", "all"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"result", "=", 
  RowBox[{"Readout", "[", 
   RowBox[{"S", "[", 
    RowBox[{"cc", ",", "3"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.818904790025478*^9, 3.818904832825738*^9}, {
   3.8189051241846123`*^9, 3.818905147875737*^9}, {3.818977896310096*^9, 
   3.818977896669578*^9}, 3.8297793348614264`*^9, {3.829779458369731*^9, 
   3.829779458405448*^9}, 3.830132248516824*^9, {3.849246312470994*^9, 
   3.849246317083935*^9}},
 CellLabel->"In[833]:=",
 CellID->154236232,ExpressionUUID->"cb95b0e4-43b0-458d-8765-c94403bcb5ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{{3.82978016881574*^9, 3.829780196946645*^9}, 
   3.829810192841991*^9, 3.8301325296358547`*^9, 3.8301325670697317`*^9, 
   3.83014214174179*^9, 3.8393743294858*^9, 3.839713976220484*^9, 
   3.84924632272578*^9, 3.849265568839024*^9},
 CellLabel->"Out[834]=",
 CellID->1294780154,ExpressionUUID->"6a9db25d-50c2-4b66-86dc-b0b7e10fb9e8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.82978016881574*^9, 3.829780196946645*^9}, 
   3.829810192841991*^9, 3.8301325296358547`*^9, 3.8301325670697317`*^9, 
   3.83014214174179*^9, 3.8393743294858*^9, 3.839713976220484*^9, 
   3.84924632272578*^9, 3.849265568849482*^9},
 CellLabel->"Out[835]=",
 CellID->918253227,ExpressionUUID->"aa3d4721-98dc-4a38-9abc-349ab3cc38e3"]
}, Open  ]],

Cell["\<\
To make repeated measurements, it is more efficient to first compute the \
state just before the measurement.\
\>", "Text",
 CellChangeTimes->{{3.8297802035917473`*^9, 3.829780267041131*^9}},
 CellID->494273051,ExpressionUUID->"01a85adc-869d-402e-8b87-51b03226a8b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"ExpressionFor", "[", "qc1", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.829779610754354*^9, 3.829779612182993*^9}, {
   3.8297804738380957`*^9, 3.829780473966215*^9}, 3.8301322485260057`*^9, {
   3.830132972245831*^9, 3.830132974697197*^9}, {3.83014215356872*^9, 
   3.8301421542882633`*^9}},
 CellLabel->"In[836]:=",
 CellID->289243815,ExpressionUUID->"109edc96-fcee-4275-a86c-899e1d860841"],

Cell["Now we perform the measurement repeatedly.", "Text",
 CellChangeTimes->{{3.829780271293535*^9, 3.829780282273882*^9}},
 CellID->929134592,ExpressionUUID->"9f13f585-92e9-4df9-a83f-7bcb65519ad5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Measurement", "[", 
        RowBox[{"S", "[", 
         RowBox[{"cc", ",", "3"}], "]"}], "]"}], "@", "new"}], ";", 
      RowBox[{"Readout", "[", 
       RowBox[{"S", "[", 
        RowBox[{"cc", ",", "3"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", "12", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"data", "//", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.8297796172694473`*^9, 3.829779623152055*^9}, {
  3.8297800628837214`*^9, 3.8297801463514853`*^9}, {3.829780291769129*^9, 
  3.8297803117932587`*^9}, {3.8297803594266872`*^9, 3.8297803596279907`*^9}, {
  3.829780481003681*^9, 3.829780489935849*^9}, {3.849246331283135*^9, 
  3.849246350159231*^9}},
 CellLabel->"In[837]:=",
 CellID->612895729,ExpressionUUID->"dc17c73d-0ebf-4b94-8754-a734c316e40c"],

Cell[BoxData[
 TagBox[GridBox[{
    {"1", "1", "0"},
    {"0", "0", "1"},
    {"0", "0", "1"},
    {"0", "0", "1"},
    {"1", "1", "0"},
    {"0", "0", "1"},
    {"1", "1", "0"},
    {"1", "1", "1"},
    {"1", "1", "0"},
    {"1", "1", "0"},
    {"1", "1", "1"},
    {"1", "1", "1"}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.829779623570291*^9, 3.82977977129375*^9, 3.829779888909697*^9, 
   3.829780080268927*^9, {3.829780122196973*^9, 3.829780147115911*^9}, {
   3.829780284730556*^9, 3.8297803124775543`*^9}, 3.829780361521147*^9, 
   3.8297804910134983`*^9, 3.829810202381242*^9, 3.830132610641554*^9, 
   3.8301421578640633`*^9, 3.83937433495476*^9, 3.839713979005825*^9, {
   3.84924632767859*^9, 3.849246352296427*^9}, 3.849265572761498*^9},
 CellLabel->"Out[838]//TableForm=",
 CellID->1999113749,ExpressionUUID->"c8ea72e0-6e0f-4fa6-b879-1890f8914e1b"]
}, Open  ]],

Cell["\<\
As two linearly independent vectors (bit strings), we choose these:\
\>", "Text",
 CellChangeTimes->{{3.829810208091785*^9, 3.829810243167761*^9}},
 CellID->701716311,ExpressionUUID->"26c3c285-eee4-42fe-a604-65eaaafd90ee"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mat", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.829810252417053*^9, 3.829810285252356*^9}},
 CellLabel->"In[839]:=",
 CellID->1789090274,ExpressionUUID->"5d3d409c-2546-4eb8-89cb-d4acd272dbfe"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8298102767429857`*^9, 3.8298102855782423`*^9}, 
   3.830142161856237*^9, 3.839374338024187*^9, 3.839713980660551*^9, 
   3.849246355450486*^9, 3.849265610365129*^9},
 CellLabel->"Out[839]=",
 CellID->703117647,ExpressionUUID->"55ad3937-f236-4d22-a403-7ed896ee4fb2"]
}, Open  ]],

Cell[TextData[{
 "Then, the linear equation, ",
 StyleBox["mat.ss=0 (mod 2)", "Input"],
 ", for the Boolean variables ",
 StyleBox["ss:={s1,s2,s3}", "Input"],
 " is given by the following, which agrees with the given secrete bit \
string."
}], "Text",
 CellChangeTimes->{{3.829810304905257*^9, 3.829810433375836*^9}, {
  3.829810493303297*^9, 3.82981049560874*^9}},
 CellID->721731118,ExpressionUUID->"4d943bd4-0a6e-44f1-adbc-d59dc73936cb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ss", "=", 
  RowBox[{"{", 
   RowBox[{"1", ",", "1", ",", "0"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.829810363641958*^9, 3.829810391099534*^9}},
 CellLabel->"In[840]:=",
 CellID->371146945,ExpressionUUID->"9b290f7d-43c6-4784-8e54-64cede99cdbc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.8298104235916243`*^9, 3.829810511333975*^9, 
  3.83014216341708*^9, 3.839374339685855*^9, 3.839713982627954*^9, 
  3.849246357204947*^9, 3.849265611810956*^9},
 CellLabel->"Out[840]=",
 CellID->739339214,ExpressionUUID->"d7606b63-b97b-43a4-92bf-cb459efd06cf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Mod", "[", 
  RowBox[{
   RowBox[{"mat", ".", "ss"}], ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.8298104545294447`*^9, 3.829810471928103*^9}},
 CellLabel->"In[841]:=",
 CellID->799014800,ExpressionUUID->"0d32a973-6aba-4828-af5a-d791bcc70279"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.8298104561997557`*^9, 3.8298104797237577`*^9}, 
   3.829810512065343*^9, 3.830142164092483*^9, 3.8393743406147614`*^9, 
   3.839713983733306*^9, 3.849246357985105*^9, 3.849265612499036*^9},
 CellLabel->"Out[841]=",
 CellID->1188126650,ExpressionUUID->"252fc1f5-bba8-406a-a6a6-781dc19ce523"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Quantum Fourier Transform", "Section",
 CellChangeTimes->{{3.8186783783482513`*^9, 3.818678385862735*^9}},
 CellTags->"Section53",
 CellID->113928457,ExpressionUUID->"376ce1dd-bff8-4080-bc22-db5ee7488fe0"],

Cell["Definition and Physical Meaning", "Subsection",
 CellChangeTimes->{{3.821351001768704*^9, 3.821351007820595*^9}},
 CellTags->"Section54",
 CellID->1387647322,ExpressionUUID->"aea805f3-b3a6-49e8-85a8-06304c126a6e"],

Cell[CellGroupData[{

Cell["Quantum Implementation", "Subsection",
 CellChangeTimes->{{3.8213510481060534`*^9, 3.821351057858974*^9}},
 CellTags->"Section55",
 CellID->516134434,ExpressionUUID->"3181692c-1196-4295-9e8d-4bb3d0cd9808"],

Cell[CellGroupData[{

Cell["\<\
Here we simulate the quantum Fourier transform on a quantum register of 4 \
qubits.\
\>", "MathCaption",
 CellChangeTimes->{{3.818752062652533*^9, 3.818752077254423*^9}, {
  3.830423158725339*^9, 
  3.830423234188532*^9}},ExpressionUUID->"1983da86-023b-423d-900e-\
0de28421caec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "4"}], ";"}]], "Input",
 CellChangeTimes->{{3.7594476343156214`*^9, 3.7594476407822723`*^9}, {
  3.759543542877948*^9, 3.759543544147127*^9}, {3.785207187421732*^9, 
  3.7852071989731913`*^9}, {3.7852080243826437`*^9, 3.785208024456031*^9}, {
  3.7852080805154057`*^9, 3.785208080673696*^9}, {3.7852081205835342`*^9, 
  3.7852081206614027`*^9}, {3.785208190357152*^9, 3.785208190427886*^9}, {
  3.785208740837468*^9, 3.78520874092059*^9}, {3.7852090551567917`*^9, 
  3.78520905523431*^9}, {3.786141511401209*^9, 3.786141511512052*^9}, {
  3.8187516966604*^9, 3.8187516983805428`*^9}, {3.818752058907992*^9, 
  3.818752058962665*^9}, {3.830423084958654*^9, 3.830423090368937*^9}, {
  3.830423143848132*^9, 3.8304231441623077`*^9}, {3.830423238677456*^9, 
  3.8304232389245443`*^9}},
 CellLabel->
  "In[842]:=",ExpressionUUID->"a18fc597-8779-4e54-9df0-9bd0fbe90a06"],

Cell["Here defined are the controlled-phase gates.", "Text",
 CellChangeTimes->{{3.818752091439775*^9, 3.818752113005087*^9}, {
  3.830423276216241*^9, 
  3.8304232850467863`*^9}},ExpressionUUID->"7490a608-ee1d-4fd9-b334-\
4ca4561da508"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CP", "[", 
   RowBox[{"j_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"S", "[", 
   RowBox[{"j", ",", "6"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CP", "[", 
   RowBox[{"j_", ",", "k_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "[", "j", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Phase", "[", 
      RowBox[{
       RowBox[{"Pi", " ", 
        RowBox[{"Power", "[", 
         RowBox[{"2", ",", 
          RowBox[{"k", "-", "j"}]}], "]"}]}], ",", 
       RowBox[{"S", "[", "k", "]"}], ",", 
       RowBox[{"\"\<Label\>\"", "\[Rule]", 
        RowBox[{"Subscript", "[", 
         RowBox[{"\"\<T\>\"", ",", 
          RowBox[{"j", "-", "k"}]}], "]"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "/;", 
   RowBox[{"j", ">", "k"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CP", "[", 
   RowBox[{"j_", ",", "k_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "[", "j", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Phase", "[", 
      RowBox[{
       RowBox[{"Pi", " ", 
        RowBox[{"Power", "[", 
         RowBox[{"2", ",", 
          RowBox[{"j", "-", "k"}]}], "]"}]}], ",", 
       RowBox[{"S", "[", "k", "]"}], ",", 
       RowBox[{"\"\<Label\>\"", "\[Rule]", 
        RowBox[{"Subscript", "[", 
         RowBox[{"\"\<T\>\"", ",", 
          RowBox[{"k", "-", "j"}]}], "]"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "/;", 
   RowBox[{"j", "<", "k"}]}]}]}], "Input",
 CellChangeTimes->{{3.759820447989932*^9, 3.75982048821699*^9}, {
   3.7598205205046673`*^9, 3.7598206286907377`*^9}, {3.759820739083046*^9, 
   3.759820808300682*^9}, {3.759820946783554*^9, 3.759820973917048*^9}, 
   3.759821011602481*^9, {3.759821068998357*^9, 3.759821070437039*^9}, {
   3.759821276451549*^9, 3.759821296293956*^9}, {3.7598214373655777`*^9, 
   3.7598214388257217`*^9}, {3.759821941747143*^9, 3.759822000986926*^9}, {
   3.78520861801999*^9, 3.7852086431043158`*^9}, {3.818751721217849*^9, 
   3.818751751535943*^9}, {3.818834050234736*^9, 3.8188340509011497`*^9}, {
   3.818834083011331*^9, 3.8188340870717163`*^9}, {3.830423258195738*^9, 
   3.830423288974337*^9}},
 CellLabel->
  "In[843]:=",ExpressionUUID->"677d686f-c975-4c46-903c-1613f5d9b6f9"],

Cell[TextData[{
 "We denote by the label ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", "k"], TraditionalForm]],ExpressionUUID->
  "5f046948-edae-453b-9980-86a47c70e3a7"],
 " the relative phase shift by ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Pi]", "/", 
    SuperscriptBox["2", "k"]}], TraditionalForm]],ExpressionUUID->
  "e52fada9-dc27-45fe-99f9-3f76554f992c"],
 ": ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "k"], ":=", 
    RowBox[{"(", GridBox[{
       {"1", "0"},
       {"0", 
        SuperscriptBox["e", 
         RowBox[{"i\[Pi]", "/", 
          SuperscriptBox["2", "k"]}]]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "a743711a-3814-47c2-81a6-55684948c43e"],
 "."
}], "Text",
 CellChangeTimes->{{3.83042406491896*^9, 3.830424197645823*^9}, {
  3.8304242340136013`*^9, 3.8304242846148863`*^9}},
 CellID->861360871,ExpressionUUID->"6bc97654-e8a3-4208-ad03-0a0166dcab46"],

Cell["This is just a short-hand function.", "Text",
 CellChangeTimes->{{3.830423291245283*^9, 3.830423319627192*^9}},
 CellID->335866686,ExpressionUUID->"4c1331d8-ff4f-43ef-97ce-99ecb1303c7f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SW", "[", "j_", "]"}], ":=", 
  RowBox[{"SWAP", "[", 
   RowBox[{
    RowBox[{"S", "[", "j", "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"$n", "-", "j", "+", "1"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SW", "[", "All", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"SW", "[", "j", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", 
      RowBox[{"$n", "/", "2"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.759820447989932*^9, 3.75982048821699*^9}, {
   3.7598205205046673`*^9, 3.7598206286907377`*^9}, {3.759820739083046*^9, 
   3.759820808300682*^9}, {3.759820946783554*^9, 3.759820973917048*^9}, 
   3.759821011602481*^9, {3.759821068998357*^9, 3.759821070437039*^9}, {
   3.759821276451549*^9, 3.759821296293956*^9}, {3.7598214373655777`*^9, 
   3.7598214388257217`*^9}, {3.759821941747143*^9, 3.759822000986926*^9}, {
   3.78520861801999*^9, 3.7852086431043158`*^9}, {3.818751721217849*^9, 
   3.818751751535943*^9}, {3.818834050234736*^9, 3.8188340509011497`*^9}, {
   3.818834083011331*^9, 3.8188340870717163`*^9}, {3.830423258195738*^9, 
   3.830423288974337*^9}, {3.8304233230250053`*^9, 3.830423346637089*^9}},
 CellLabel->"In[846]:=",
 CellID->308286410,ExpressionUUID->"731b514a-38c4-4b9d-9535-9bb6abc5b8d9"],

Cell["\<\
This is the standard implementation, which can be seen commonly in textbooks.\
\
\>", "Text",
 CellChangeTimes->{{3.8187517601631737`*^9, 
  3.818751793970254*^9}},ExpressionUUID->"b5fb0824-b3cd-4365-bf78-\
e7e95d1cca0c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gates", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"CP", "[", 
       RowBox[{"j", ",", "k"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "$n", ",", "1", ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "k", ",", "1", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Sequence", "@@", 
     RowBox[{"SW", "[", "All", "]"}]}], ",", 
    RowBox[{"Sequence", "@@", "gates"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.759821602455901*^9, 3.759821715507547*^9}, {
   3.759821776796034*^9, 3.7598218000143833`*^9}, {3.759821830895533*^9, 
   3.759821841895565*^9}, {3.759821906987432*^9, 3.759821923939027*^9}, {
   3.75982202304778*^9, 3.759822072285696*^9}, {3.759822433372991*^9, 
   3.759822437431732*^9}, {3.77684106455268*^9, 3.776841068931573*^9}, {
   3.776841283804262*^9, 3.776841331180581*^9}, {3.776845750440116*^9, 
   3.776845760389566*^9}, {3.785206760081921*^9, 3.785206770708784*^9}, {
   3.785206802181602*^9, 3.785206867409318*^9}, {3.7852082030537148`*^9, 
   3.785208205301676*^9}, {3.7852085169853563`*^9, 3.7852085170610228`*^9}, {
   3.785208961017174*^9, 3.785208966114057*^9}, 3.8263425028500443`*^9, 
   3.829808701887732*^9, {3.830423376740892*^9, 3.830423455733982*^9}, {
   3.830423505040366*^9, 3.830423509055299*^9}},
 CellLabel->"In[848]:=",
 CellID->522705560,ExpressionUUID->"93e9d1fe-17f9-4ed5-af87-9bd2e6fa8cd6"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {13, -1}}, {{0, -2}, {13, -2}}, {{0, -3}, {13, -3}}, {{
    0, -4}, {13, -4}}}], {LineBox[{{1, -1}, {1, -4}}], 
    LineBox[{{{0.91, -1.09}, {1.09, -0.91}}, {{0.91, -0.91}, {1.09, -1.09}}}],
     LineBox[{{{0.91, -4.09}, {1.09, -3.91}}, {{0.91, -3.91}, {
     1.09, -4.09}}}]}, {LineBox[{{2, -2}, {2, -3}}], 
    LineBox[{{{1.91, -2.09}, {2.09, -1.91}}, {{1.91, -1.91}, {2.09, -2.09}}}],
     LineBox[{{{1.91, -3.09}, {2.09, -2.91}}, {{1.91, -2.91}, {
     2.09, -3.09}}}]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {3, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -3}, {4, -4}}], DiskBox[{4, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {4, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{5, -2}, {5, -4}}], DiskBox[{5, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {5, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{6, -1}, {6, -4}}], DiskBox[{6, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -4.4}, {6.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "3"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {6, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {7, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{8, -2}, {8, -3}}], DiskBox[{8, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {8, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{9, -1}, {9, -3}}], DiskBox[{9, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {9, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -2.4}, {10.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {10, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{11, -1}, {11, -2}}], DiskBox[{11, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{10.6, -2.4}, {11.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {11, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{11.6, -1.4}, {12.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {12, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->514.8000000000001,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.830423418729184*^9, 3.8304234594326353`*^9}, 
   3.830423509695138*^9, 3.8304235571338663`*^9, 3.8304238552812443`*^9, {
   3.830424302644917*^9, 3.830424308461959*^9}, 3.839374351906166*^9, 
   3.839713991454533*^9, 3.849246371202592*^9, 3.849265620991056*^9},
 CellLabel->"Out[849]=",
 CellID->735491973,ExpressionUUID->"6dec7733-859b-4cb0-97a1-303c052c1274"]
}, Open  ]],

Cell["\<\
To verify the above quantum circuit model, we compare its matrix \
representation with the matrix for the discrete Fourier transform.\
\>", "Text",
 CellChangeTimes->{{3.830423564975721*^9, 3.830423644261702*^9}},
 CellID->2097976484,ExpressionUUID->"3e375e2d-68f7-49d2-bab7-366ed99b9d26"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{
    RowBox[{"Matrix", "[", "qc1", "]"}], "//", "TrigToExp"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"FourierMatrix", "[", 
    RowBox[{"Power", "[", 
     RowBox[{"2", ",", "$n"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"DeleteCases", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"new", "-", "mat"}], "//", "Simplify"}], "//", "Flatten"}], ",", 
   "0"}], "]"}]}], "Input",
 CellChangeTimes->{{3.830423465839005*^9, 3.8304234900214376`*^9}, {
  3.830423520304961*^9, 3.830423546943096*^9}, {3.839374389671351*^9, 
  3.839374413439988*^9}, {3.839374455174741*^9, 3.8393744614255333`*^9}},
 CellLabel->"In[850]:=",
 CellID->288131012,ExpressionUUID->"6a6f53c5-6b34-4af7-bb69-da239165f1a3"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.8304235473649387`*^9, 3.830423560168357*^9}, 
   3.830423646057189*^9, 3.830423856732312*^9, 3.8304243096161957`*^9, 
   3.8393743538963327`*^9, {3.8393743940621223`*^9, 3.8393744236782*^9}, {
   3.839374461907*^9, 3.839374463745606*^9}, 3.8397139935636797`*^9, 
   3.8492463731481028`*^9, 3.849265622894299*^9},
 CellLabel->"Out[852]=",
 CellID->1337056867,ExpressionUUID->"6964db09-2280-4581-adf4-edd753c6fc38"]
}, Open  ]],

Cell["\<\
One can also reverse the order of qubits later to get the following quantum \
circuit model for the quantum Fourier transform.\
\>", "Text",
 CellChangeTimes->{{3.8304236599439707`*^9, 3.830423715650235*^9}, {
   3.830424337521689*^9, 3.830424390493836*^9}, 3.830425431111252*^9},
 CellID->1298258680,ExpressionUUID->"1f5ec8bc-dae2-48fd-a551-b3234ca96287"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gates", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"CP", "[", 
       RowBox[{"j", ",", "k"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "$n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "k", ",", "$n"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Sequence", "@@", "gates"}], ",", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"SW", "[", "All", "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.759821602455901*^9, 3.759821715507547*^9}, {
   3.759821776796034*^9, 3.7598218000143833`*^9}, {3.759821830895533*^9, 
   3.759821841895565*^9}, {3.759821906987432*^9, 3.759821923939027*^9}, {
   3.75982202304778*^9, 3.759822072285696*^9}, {3.759822433372991*^9, 
   3.759822437431732*^9}, {3.77684106455268*^9, 3.776841068931573*^9}, {
   3.776841283804262*^9, 3.776841331180581*^9}, {3.776845750440116*^9, 
   3.776845760389566*^9}, {3.785206760081921*^9, 3.785206770708784*^9}, {
   3.785206802181602*^9, 3.785206867409318*^9}, {3.7852082030537148`*^9, 
   3.785208205301676*^9}, {3.7852085169853563`*^9, 3.7852085170610228`*^9}, {
   3.785208961017174*^9, 3.785208966114057*^9}, 3.8263425028500443`*^9, 
   3.829808701887732*^9, {3.830423376740892*^9, 3.830423455733982*^9}, {
   3.830423505040366*^9, 3.830423509055299*^9}, {3.830423656479158*^9, 
   3.830423656557136*^9}, {3.8304237365967484`*^9, 3.830423787646267*^9}},
 CellLabel->"In[853]:=",
 CellID->299138695,ExpressionUUID->"3d48f2f2-18b6-4d36-94c9-b9f28d7e2862"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {13, -1}}, {{0, -2}, {13, -2}}, {{0, -3}, {13, -3}}, {{
    0, -4}, {13, -4}}}], {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{2, -2}, {2, -1}}], DiskBox[{2, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {2, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{3, -3}, {3, -1}}], DiskBox[{3, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {3, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -4}, {4, -1}}], DiskBox[{4, -4}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "3"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {4, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {5, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{6, -3}, {6, -2}}], DiskBox[{6, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {6, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{7, -4}, {7, -2}}], DiskBox[{7, -4}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {7, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {8, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{9, -4}, {9, -3}}], DiskBox[{9, -4}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {9, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03076923076923077],
      FontWeight->"Light",
      FontSlant->Italic], {10, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{11, -1}, {11, -4}}], 
    LineBox[{{{10.91, -1.09}, {11.09, -0.91}}, {{10.91, -0.91}, {
     11.09, -1.09}}}], 
    LineBox[{{{10.91, -4.09}, {11.09, -3.91}}, {{10.91, -3.91}, {
     11.09, -4.09}}}]}, {LineBox[{{12, -2}, {12, -3}}], 
    LineBox[{{{11.91, -2.09}, {12.09, -1.91}}, {{11.91, -1.91}, {
     12.09, -2.09}}}], 
    LineBox[{{{11.91, -3.09}, {12.09, -2.91}}, {{11.91, -2.91}, {
     12.09, -3.09}}}]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->514.8000000000001,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.830423654693582*^9, 3.830423656891087*^9}, 
   3.8304237453592663`*^9, {3.8304237815241537`*^9, 3.8304237943518057`*^9}, 
   3.83042385806248*^9, 3.8304243108866377`*^9, {3.8304243920169563`*^9, 
   3.830424408590538*^9}, 3.830425432856759*^9, 3.8393743562028503`*^9, 
   3.839374465542285*^9, 3.8397139950005608`*^9, 3.849246374758788*^9, 
   3.849265624528936*^9},
 CellLabel->"Out[854]=",
 CellID->465107838,ExpressionUUID->"c0827eb2-237c-4447-acd5-5bd513bcb01e"]
}, Open  ]],

Cell["\<\
Again, verify it by comparing the matrix representation with the matrix for \
the discrete Fourier transform.\
\>", "Text",
 CellChangeTimes->{{3.830423808019693*^9, 3.830423838357912*^9}},
 CellID->1841970781,ExpressionUUID->"c7e96b8d-8f94-421a-9f5d-894010c01f10"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{
    RowBox[{"Matrix", "[", "qc2", "]"}], "//", "TrigToExp"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"FourierMatrix", "[", 
    RowBox[{"Power", "[", 
     RowBox[{"2", ",", "$n"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"DeleteCases", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"new", "-", "mat"}], "//", "Simplify"}], "//", "Flatten"}], ",", 
   "0"}], "]"}]}], "Input",
 CellChangeTimes->{{3.830423465839005*^9, 3.8304234900214376`*^9}, {
  3.830423520304961*^9, 3.830423546943096*^9}, {3.83042384266722*^9, 
  3.830423842722424*^9}, {3.839374430225967*^9, 3.839374449216239*^9}},
 CellLabel->"In[855]:=",
 CellID->1739494450,ExpressionUUID->"deb5d729-da3c-468b-964e-a84a5a4c95a3"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.830423843255322*^9, 3.830423859543366*^9}, 
   3.8304243126057*^9, {3.830424401359424*^9, 3.830424409881806*^9}, 
   3.830425434414352*^9, 3.839374359965501*^9, {3.839374433418395*^9, 
   3.839374467040494*^9}, 3.839713996580326*^9, 3.849246376139282*^9, 
   3.8492656260524683`*^9},
 CellLabel->"Out[857]=",
 CellID->1459939420,ExpressionUUID->"f10a06e0-97ff-44c5-9a6c-40e465f57a04"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Semiclassical Implementation", "Subsection",
 CellChangeTimes->{{3.821351036473692*^9, 3.82135107062739*^9}, {
  3.8230570284887667`*^9, 3.823057034382341*^9}},
 CellTags->"Section56",
 CellID->984982005,ExpressionUUID->"30e1877f-644c-48f1-ae88-4c536fd2c397"],

Cell[CellGroupData[{

Cell["\<\
Here we simulate the semiclassical implementation of the quantum Fourier \
transform. Again, we consider a quantum register of four qubits.\
\>", "MathCaption",
 CellChangeTimes->{{3.830428056247672*^9, 3.830428072889504*^9}, {
  3.8304285767175293`*^9, 3.830428595649918*^9}},
 CellID->1649159624,ExpressionUUID->"953f7388-d6e2-4cce-a095-b78ec295b2ec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SS", "=", 
   RowBox[{"S", "[", 
    RowBox[{
     RowBox[{"Range", "[", "$n", "]"}], ",", "None"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7594476343156214`*^9, 3.7594476407822723`*^9}, {
  3.759543542877948*^9, 3.759543544147127*^9}, {3.785207187421732*^9, 
  3.7852071989731913`*^9}, {3.7852080243826437`*^9, 3.785208024456031*^9}, {
  3.7852080805154057`*^9, 3.785208080673696*^9}, {3.7852081205835342`*^9, 
  3.7852081206614027`*^9}, {3.785208190357152*^9, 3.785208190427886*^9}, {
  3.785208740837468*^9, 3.78520874092059*^9}, {3.7852090551567917`*^9, 
  3.78520905523431*^9}, {3.786141511401209*^9, 3.786141511512052*^9}, {
  3.8187516966604*^9, 3.8187516983805428`*^9}, {3.818752058907992*^9, 
  3.818752058962665*^9}, {3.830423084958654*^9, 3.830423090368937*^9}, {
  3.830423143848132*^9, 3.8304231441623077`*^9}, {3.830423238677456*^9, 
  3.8304232389245443`*^9}, {3.830428794629384*^9, 3.830428803673441*^9}},
 CellLabel->"In[858]:=",
 CellID->72871740,ExpressionUUID->"1bb1ac33-481a-4fa2-ab0c-bfb955d1a93e"],

Cell["Here defined are the controlled-phase gates.", "Text",
 CellChangeTimes->{{3.818752091439775*^9, 3.818752113005087*^9}, {
  3.830423276216241*^9, 3.8304232850467863`*^9}},
 CellID->689655390,ExpressionUUID->"ab95829b-2987-4e36-b870-5ff2ca60b1a7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CP", "[", 
   RowBox[{"j_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"S", "[", 
   RowBox[{"j", ",", "6"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CP", "[", 
   RowBox[{"j_", ",", "k_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "[", "j", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Phase", "[", 
      RowBox[{
       RowBox[{"Pi", " ", 
        RowBox[{"Power", "[", 
         RowBox[{"2", ",", 
          RowBox[{"k", "-", "j"}]}], "]"}]}], ",", 
       RowBox[{"S", "[", "k", "]"}], ",", 
       RowBox[{"\"\<Label\>\"", "\[Rule]", 
        RowBox[{"Subscript", "[", 
         RowBox[{"\"\<T\>\"", ",", 
          RowBox[{"j", "-", "k"}]}], "]"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "/;", 
   RowBox[{"j", ">", "k"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CP", "[", 
   RowBox[{"j_", ",", "k_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "[", "j", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Phase", "[", 
      RowBox[{
       RowBox[{"Pi", " ", 
        RowBox[{"Power", "[", 
         RowBox[{"2", ",", 
          RowBox[{"j", "-", "k"}]}], "]"}]}], ",", 
       RowBox[{"S", "[", "k", "]"}], ",", 
       RowBox[{"\"\<Label\>\"", "\[Rule]", 
        RowBox[{"Subscript", "[", 
         RowBox[{"\"\<T\>\"", ",", 
          RowBox[{"k", "-", "j"}]}], "]"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "/;", 
   RowBox[{"j", "<", "k"}]}]}]}], "Input",
 CellChangeTimes->{{3.759820447989932*^9, 3.75982048821699*^9}, {
   3.7598205205046673`*^9, 3.7598206286907377`*^9}, {3.759820739083046*^9, 
   3.759820808300682*^9}, {3.759820946783554*^9, 3.759820973917048*^9}, 
   3.759821011602481*^9, {3.759821068998357*^9, 3.759821070437039*^9}, {
   3.759821276451549*^9, 3.759821296293956*^9}, {3.7598214373655777`*^9, 
   3.7598214388257217`*^9}, {3.759821941747143*^9, 3.759822000986926*^9}, {
   3.78520861801999*^9, 3.7852086431043158`*^9}, {3.818751721217849*^9, 
   3.818751751535943*^9}, {3.818834050234736*^9, 3.8188340509011497`*^9}, {
   3.818834083011331*^9, 3.8188340870717163`*^9}, {3.830423258195738*^9, 
   3.830423288974337*^9}},
 CellLabel->"In[860]:=",
 CellID->1068896871,ExpressionUUID->"c800ce6a-e00a-4d2c-a906-fd3933925a0a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Ket", "@@", 
    RowBox[{"Thread", "[", 
     RowBox[{"SS", "->", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", "$n"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"in", ",", "SS"}], "]"}]}], "Input",
 CellChangeTimes->{{3.830428748914798*^9, 3.8304288246983337`*^9}},
 CellLabel->"In[863]:=",
 CellID->344851506,ExpressionUUID->"2f0a5cfe-227c-4531-84ad-20cee51b9cf2"],

Cell[BoxData[
 TemplateBox[{
   TagBox[
    TemplateBox[{
      SubscriptBox["1", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"]]], 
      SubscriptBox["1", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"]]], 
      SubscriptBox["1", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"]]], 
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
  "Ket"]], "Output",
 CellChangeTimes->{{3.8304288249876623`*^9, 3.830428828998253*^9}, 
   3.8304884351612377`*^9, 3.830489027957066*^9, 3.830489850929689*^9, 
   3.839374470617695*^9, 3.8397140017756166`*^9, 3.849246381526956*^9, 
   3.8492656310835953`*^9},
 CellLabel->"Out[864]=",
 CellID->1871256179,ExpressionUUID->"22f68e87-7595-4903-b353-bfd3685a6570"]
}, Open  ]],

Cell["\<\
This is a quantum circuit model for the quantum Fourier transformation.\
\>", "Text",
 CellChangeTimes->{{3.830428202372069*^9, 3.830428214105185*^9}},
 CellID->68827890,ExpressionUUID->"d2d9cd85-4898-4780-815a-9b87e34fb300"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gates", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"CP", "[", 
       RowBox[{"j", ",", "k"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "$n", ",", "1", ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "k", ",", "1", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"swaps", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"SWAP", "[", 
      RowBox[{
       RowBox[{"S", "[", "k", "]"}], ",", 
       RowBox[{"S", "[", 
        RowBox[{"$n", "-", "k", "+", "1"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"$n", "/", "2"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{"in", ",", "SS"}], "]"}], ",", 
    RowBox[{"Sequence", "@@", "swaps"}], ",", 
    RowBox[{"Sequence", "@@", "gates"}], ",", 
    RowBox[{"Measurement", "@", 
     RowBox[{"Through", "[", 
      RowBox[{"SS", "[", "3", "]"}], "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.83042808557161*^9, 3.830428196759181*^9}, {
  3.830428258600827*^9, 3.830428300737174*^9}, {3.8304288376358643`*^9, 
  3.830428846399362*^9}, {3.830428963113995*^9, 3.830428973092464*^9}, {
  3.849246391647625*^9, 3.849246401727923*^9}},
 CellLabel->"In[865]:=",
 CellID->398682067,ExpressionUUID->"ce199269-89cb-4a5e-94e6-350d5cdf9545"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{13, -1}, {14, -1}}, {{13, -2}, {14, -2}}, {{13, -3}, {
     14, -3}}, {{13, -4}, {14, -4}}}]}, 
   LineBox[{{{0, -1}, {13, -1}}, {{0, -2}, {13, -2}}, {{0, -3}, {13, -3}}, {{
    0, -4}, {13, -4}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"1"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.022857142857142857`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"1"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.022857142857142857`],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"1"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.022857142857142857`],
      FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.022857142857142857`],
      FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, Rational[1, 2]}]]}, {
    LineBox[{{1, -1}, {1, -4}}], 
    LineBox[{{{0.91, -1.09}, {1.09, -0.91}}, {{0.91, -0.91}, {1.09, -1.09}}}],
     LineBox[{{{0.91, -4.09}, {1.09, -3.91}}, {{0.91, -3.91}, {
     1.09, -4.09}}}]}, {LineBox[{{2, -2}, {2, -3}}], 
    LineBox[{{{1.91, -2.09}, {2.09, -1.91}}, {{1.91, -1.91}, {2.09, -2.09}}}],
     LineBox[{{{1.91, -3.09}, {2.09, -2.91}}, {{1.91, -2.91}, {
     2.09, -3.09}}}]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {3, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -3}, {4, -4}}], DiskBox[{4, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {4, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{5, -2}, {5, -4}}], DiskBox[{5, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {5, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{6, -1}, {6, -4}}], DiskBox[{6, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -4.4}, {6.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "3"],
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {6, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {7, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{8, -2}, {8, -3}}], DiskBox[{8, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {8, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{9, -1}, {9, -3}}], DiskBox[{9, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {9, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -2.4}, {10.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {10, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{11, -1}, {11, -2}}], DiskBox[{11, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{10.6, -2.4}, {11.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {11, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{11.6, -1.4}, {12.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {12, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{12.6, -1.4}, {13.4, -0.6}]}, 
     CircleBox[{13, -1.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{13, -1.2}, {13.24, -0.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{12.6, -2.4}, {13.4, -1.6}]}, 
     CircleBox[{13, -2.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{13, -2.2}, {13.24, -1.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{12.6, -3.4}, {13.4, -2.6}]}, 
     CircleBox[{13, -3.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{13, -3.2}, {13.24, -2.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{12.6, -4.4}, {13.4, -3.6}]}, 
     CircleBox[{13, -4.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{13, -4.2}, {13.24, -3.76}}]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->550.8000000000001,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.8304281357364073`*^9, 3.8304281461880817`*^9}, {
   3.830428197106008*^9, 3.8304282153427277`*^9}, 3.8304283010310507`*^9, 
   3.8304286023114243`*^9, {3.830428831187853*^9, 3.830428872455635*^9}, 
   3.8304289264019127`*^9, {3.830428973532559*^9, 3.830428975681631*^9}, 
   3.8304884395511427`*^9, 3.8304890291740637`*^9, 3.830489852111637*^9, 
   3.839374472188339*^9, 3.839714003135257*^9, 3.8492464037256117`*^9, 
   3.8492656325447693`*^9},
 CellLabel->"Out[867]=",
 CellID->1705643605,ExpressionUUID->"1a12c065-88c3-40b4-b4c7-eb3658f92e70"]
}, Open  ]],

Cell["\<\
This is the semiclassical implementation of the quantum Fourier transform.\
\>", "Text",
 CellChangeTimes->{{3.8304286070114613`*^9, 3.830428634763953*^9}},
 CellID->1803885280,ExpressionUUID->"2e33a73e-240a-455d-b37b-f61382633610"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gates", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"CP", "[", 
      RowBox[{"j", ",", "k"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "$n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "k"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gates", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"MapIndexed", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{"#1", ",", 
         RowBox[{"Measurement", "@", 
          RowBox[{"S", "[", 
           RowBox[{"#2", ",", "3"}], "]"}]}]}], "]"}], "&"}], ",", "gates"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"swaps", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"SWAP", "[", 
      RowBox[{
       RowBox[{"S", "[", "k", "]"}], ",", 
       RowBox[{"S", "[", 
        RowBox[{"$n", "-", "k", "+", "1"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"$n", "/", "2"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{"in", ",", "SS"}], "]"}], ",", 
    RowBox[{"Sequence", "@@", "gates"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.83042808557161*^9, 3.830428196759181*^9}, {
  3.830428258600827*^9, 3.8304283778177347`*^9}, {3.8304284439750443`*^9, 
  3.830428511437182*^9}, {3.83042886277796*^9, 3.830428868830661*^9}, {
  3.849246415251813*^9, 3.849246415373061*^9}},
 CellLabel->"In[868]:=",
 CellID->198720503,ExpressionUUID->"e31beb56-5477-4dd8-983a-20844c18da7f"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{2, -1}, {15, -1}}, {{5, -2}, {15, -2}}, {{9, -3}, {15, -3}}, {{
     14, -4}, {15, -4}}}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {9, -3}}, {{
    0, -4}, {14, -4}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"1"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.021333333333333336`],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"1"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.021333333333333336`],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"1"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.021333333333333336`],
      FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.021333333333333336`],
      FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, 
    CircleBox[{2, -1.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{2, -1.2}, {2.24, -0.76}}]}, {
    LineBox[{{3, -1}, {3, -2}}], DiskBox[{3, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {3, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {4, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, 
    CircleBox[{5, -2.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{5, -2.2}, {5.24, -1.76}}]}, {
    LineBox[{{6, -1}, {6, -3}}], DiskBox[{6, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {6, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{7, -2}, {7, -3}}], DiskBox[{7, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {7, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {8, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, 
    CircleBox[{9, -3.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{9, -3.2}, {9.24, -2.76}}]}, {
    LineBox[{{10, -1}, {10, -4}}], DiskBox[{10, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "3"],
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {10, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{11, -2}, {11, -4}}], DiskBox[{11, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{10.6, -4.4}, {11.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {11, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{12, -3}, {12, -4}}], DiskBox[{12, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{11.6, -4.4}, {12.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {12, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{12.6, -4.4}, {13.4, -3.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {13, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{13.6, -4.4}, {14.4, -3.6}]}, 
    CircleBox[{14, -4.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{14, -4.2}, {14.24, -3.76}}]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->586.8000000000001,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.830428311765895*^9, 3.8304283782900457`*^9}, {
   3.830428493104554*^9, 3.830428540493146*^9}, 3.83042860301987*^9, {
   3.830428665932849*^9, 3.830428667669606*^9}, {3.830428869139811*^9, 
   3.8304288735252857`*^9}, 3.830428927655192*^9, 3.8304289778165083`*^9, 
   3.8304884412157907`*^9, 3.830489031005103*^9, 3.830489853372408*^9, 
   3.83937447381354*^9, 3.8397140047129517`*^9, 3.849246419055255*^9, 
   3.849265634344928*^9},
 CellLabel->"Out[871]=",
 CellID->1105314625,ExpressionUUID->"5df64a59-afc7-4e27-9def-8bfdbbf88b72"]
}, Open  ]],

Cell["\<\
To verify the equivalence of the two quantum circuit models, we compare the \
probability distributions.\
\>", "Text",
 CellChangeTimes->{{3.830489086993524*^9, 3.8304891803645763`*^9}},
 CellID->2071821703,ExpressionUUID->"8edfdcc0-d877-47cf-bcf0-02df1faa1ea2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"data1", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ExpressionFor", "[", "qc1", "]"}], ";", 
       RowBox[{"FromDigits", "[", 
        RowBox[{
         RowBox[{"Readout", "@", 
          RowBox[{"Through", "[", 
           RowBox[{"SS", "[", "3", "]"}], "]"}]}], ",", "2"}], "]"}]}], ",", 
      RowBox[{"{", "500", "}"}]}], "]"}]}], ";"}], "]"}]], "Input",
 CellChangeTimes->{{3.830428875829096*^9, 3.830428919957456*^9}, {
  3.830428991867786*^9, 3.83042902923871*^9}, {3.83042907462071*^9, 
  3.830429074995887*^9}, {3.830429109495419*^9, 3.8304291095389547`*^9}, {
  3.849246428527651*^9, 3.8492464556266336`*^9}},
 CellLabel->"In[872]:=",
 CellID->1287687905,ExpressionUUID->"ce390bd1-8b10-4281-9b21-d392e1b0bfac"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"32.76023`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.830428920703793*^9, {3.83042898182922*^9, 3.830429047339489*^9}, 
   3.830429096604951*^9, 3.83042917961484*^9, 3.830489098419602*^9, 
   3.839374537277524*^9, 3.839714079422154*^9, 3.849246511150271*^9, 
   3.849265674128517*^9},
 CellLabel->"Out[872]=",
 CellID->579604567,ExpressionUUID->"ffa07c5e-0c94-4875-bf08-9f9d2f1f67db"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Histogram", "[", 
  RowBox[{"data1", ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Measurement Outcome\>\"", ",", "\"\<Counts\>\""}], 
     "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.830429059694537*^9, 3.830429069703466*^9}, {
  3.8304291618730707`*^9, 3.830429184461638*^9}, {3.830429235904291*^9, 
  3.830429237436013*^9}},
 CellLabel->"In[873]:=",
 CellID->585052629,ExpressionUUID->"15f46ffa-a74d-4f36-8bca-b6039512f894"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
    Opacity[0.574], Thickness[Small]}], {}, 
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
     Opacity[0.574], Thickness[Small]}], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{-0.5, 0}, {0.5, 30.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{38.1375, 51.4328125}, {-49.285833384696915`, 
           48.606666461212285`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 30]& ,
        TagBoxNote->"30"],
       StyleBox["30", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[30, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{0.5, 0}, {1.5, 34.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{50.9328125, 64.228125}, {-62.27150003081813, 
           48.606666461212285`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 34]& ,
        TagBoxNote->"34"],
       StyleBox["34", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[34, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{1.5, 0}, {2.5, 33.}, "RoundingRadius" -> 0]},
          ImageSizeCache->{{63.728125000000006`, 
           77.0234375}, {-59.02508336928783, 48.606666461212285`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 33]& ,
        TagBoxNote->"33"],
       StyleBox["33", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[33, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{2.5, 0}, {3.5, 26.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{76.5234375, 
           89.81875000000001}, {-36.30016673857568, 48.606666461212285`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 26]& ,
        TagBoxNote->"26"],
       StyleBox["26", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[26, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{3.5, 0}, {4.5, 30.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{89.31875000000001, 
           102.6140625}, {-49.285833384696915`, 48.606666461212285`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 30]& ,
        TagBoxNote->"30"],
       StyleBox["30", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[30, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{4.5, 0}, {5.5, 30.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{102.1140625, 
           115.40937500000001`}, {-49.285833384696915`, 48.606666461212285`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 30]& ,
        TagBoxNote->"30"],
       StyleBox["30", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[30, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{5.5, 0}, {6.5, 35.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{114.90937500000001`, 
           128.2046875}, {-65.51791669234844, 48.606666461212285`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 35]& ,
        TagBoxNote->"35"],
       StyleBox["35", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[35, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{6.5, 0}, {7.5, 34.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{127.7046875, 141.}, {-62.27150003081813, 
           48.606666461212285`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 34]& ,
        TagBoxNote->"34"],
       StyleBox["34", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[34, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{7.5, 0}, {8.5, 35.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{140.5, 153.79531250000002`}, {-65.51791669234844, 
           48.606666461212285`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 35]& ,
        TagBoxNote->"35"],
       StyleBox["35", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[35, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{8.5, 0}, {9.5, 26.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{153.29531250000002`, 
           166.59062500000002`}, {-36.30016673857568, 48.606666461212285`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 26]& ,
        TagBoxNote->"26"],
       StyleBox["26", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[26, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{9.5, 0}, {10.5, 26.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{166.09062500000002`, 
           179.3859375}, {-36.30016673857568, 48.606666461212285`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 26]& ,
        TagBoxNote->"26"],
       StyleBox["26", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[26, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{10.5, 0}, {11.5, 26.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{178.8859375, 192.18125}, {-36.30016673857568, 
           48.606666461212285`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 26]& ,
        TagBoxNote->"26"],
       StyleBox["26", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[26, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{11.5, 0}, {12.5, 34.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{191.68125, 
           204.97656250000003`}, {-62.27150003081813, 48.606666461212285`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 34]& ,
        TagBoxNote->"34"],
       StyleBox["34", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[34, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{12.5, 0}, {13.5, 32.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{204.47656250000003`, 
           217.77187500000002`}, {-55.77866670775752, 48.606666461212285`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 32]& ,
        TagBoxNote->"32"],
       StyleBox["32", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[32, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{13.5, 0}, {14.5, 29.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{217.27187500000002`, 
           230.56718750000002`}, {-46.03941672316661, 48.606666461212285`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 29]& ,
        TagBoxNote->"29"],
       StyleBox["29", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[29, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{14.5, 0}, {15.5, 40.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{230.06718750000002`, 
           243.3625}, {-81.74999999999997, 48.606666461212285`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 40]& ,
        TagBoxNote->"40"],
       StyleBox["40", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[40, {}], 
       "Tooltip"]& ]}, {}, {}}, {{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{-0.8200000000000001, 0},
  AxesStyle->Automatic,
  Frame->True,
  FrameLabel->{{
     FormBox["\"Counts\"", TraditionalForm], None}, {
     FormBox["\"Measurement Outcome\"", TraditionalForm], None}},
  FrameStyle->Automatic,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->250,
  PlotRange->{{-0.5, 15.5}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {None, 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.830429198716358*^9, 3.8304292075355043`*^9}, 
   3.830429239841963*^9, 3.830489098623538*^9, 3.839374537372706*^9, 
   3.8397140795031757`*^9, 3.849246517561666*^9, 3.84926567419593*^9},
 CellLabel->"Out[873]=",
 CellID->428134777,ExpressionUUID->"3ad11509-0152-40d5-b82a-b9a26ee2d1b4"]
}, Open  ]],

Cell["\<\
Note that the bit strings of the measurement outcomes from the semiclassical \
model must be reversed .\
\>", "Text",
 CellChangeTimes->{{3.8304891839276247`*^9, 3.830489185901847*^9}},
 CellID->1935282369,ExpressionUUID->"f96795c0-f0b1-4ed5-9f2a-1b56ee871378"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"data2", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ExpressionFor", "[", "qc2", "]"}], ";", 
       RowBox[{"FromDigits", "[", 
        RowBox[{
         RowBox[{"Reverse", "@", 
          RowBox[{"Readout", "@", 
           RowBox[{"Through", "[", 
            RowBox[{"SS", "[", "3", "]"}], "]"}]}]}], ",", "2"}], "]"}]}], 
      ",", 
      RowBox[{"{", "500", "}"}]}], "]"}]}], ";"}], "]"}]], "Input",
 CellChangeTimes->{{3.830428875829096*^9, 3.830428919957456*^9}, {
  3.830428991867786*^9, 3.830429047035543*^9}, {3.830429116716856*^9, 
  3.830429116782907*^9}, {3.830489050567514*^9, 3.830489054290867*^9}, {
  3.8492464894521437`*^9, 3.849246505876287*^9}},
 CellLabel->"In[874]:=",
 CellID->1278110699,ExpressionUUID->"57fa34d5-6c6d-4d03-9af3-6f4997de3b65"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"8.823008`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.830429057228755*^9, 3.830429100509481*^9, 
  3.8304291986082687`*^9, 3.830489117582395*^9, 3.839374553257827*^9, 
  3.8397141058478327`*^9, 3.849246530351953*^9, 3.849265683041608*^9},
 CellLabel->"Out[874]=",
 CellID->1590979589,ExpressionUUID->"14eade66-150a-4fb9-ac61-0aba06943f59"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Histogram", "[", 
  RowBox[{"data2", ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Measurement Outcome\>\"", ",", "\"\<Counts\>\""}], 
     "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.830429059694537*^9, 3.830429069703466*^9}, {
  3.8304291618730707`*^9, 3.8304292021568727`*^9}, {3.8304292429840508`*^9, 
  3.830429245794929*^9}},
 CellLabel->"In[875]:=",
 CellID->1295721444,ExpressionUUID->"b851ac61-687a-47c1-928f-4876e087088e"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
    Opacity[0.574], Thickness[Small]}], {}, 
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
     Opacity[0.574], Thickness[Small]}], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{-0.5, 0}, {0.5, 36.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{38.1375, 51.43281250000001}, {-76.58578049291455, 
           46.93632457560234}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 36]& ,
        TagBoxNote->"36"],
       StyleBox["36", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[36, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{0.5, 0}, {1.5, 32.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{50.93281250000001, 
           64.228125}, {-62.91665770752378, 46.93632457560234}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 32]& ,
        TagBoxNote->"32"],
       StyleBox["32", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[32, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{1.5, 0}, {2.5, 30.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{63.72812500000001, 
           77.02343750000001}, {-56.082096314828405`, 46.93632457560234}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 30]& ,
        TagBoxNote->"30"],
       StyleBox["30", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[30, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{2.5, 0}, {3.5, 32.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{76.52343750000001, 
           89.81875000000002}, {-62.91665770752378, 46.93632457560234}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 32]& ,
        TagBoxNote->"32"],
       StyleBox["32", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[32, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{3.5, 0}, {4.5, 26.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{89.31875000000002, 
           102.61406250000002`}, {-42.412973529437636`, 46.93632457560234}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 26]& ,
        TagBoxNote->"26"],
       StyleBox["26", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[26, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{4.5, 0}, {5.5, 35.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{102.11406250000002`, 
           115.40937500000001`}, {-73.16849979656686, 46.93632457560234}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 35]& ,
        TagBoxNote->"35"],
       StyleBox["35", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[35, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{5.5, 0}, {6.5, 31.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{114.90937500000001`, 
           128.20468750000003`}, {-59.499377011176094`, 46.93632457560234}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 31]& ,
        TagBoxNote->"31"],
       StyleBox["31", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[31, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{6.5, 0}, {7.5, 27.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{127.70468750000003`, 
           141.00000000000003`}, {-45.830254225785325`, 46.93632457560234}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 27]& ,
        TagBoxNote->"27"],
       StyleBox["27", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[27, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{7.5, 0}, {8.5, 28.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{140.50000000000003`, 
           153.79531250000002`}, {-49.24753492213301, 46.93632457560234}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 28]& ,
        TagBoxNote->"28"],
       StyleBox["28", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[28, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{8.5, 0}, {9.5, 33.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{153.29531250000002`, 
           166.59062500000005`}, {-66.33393840387147, 46.93632457560234}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 33]& ,
        TagBoxNote->"33"],
       StyleBox["33", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[33, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{9.5, 0}, {10.5, 37.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{166.09062500000005`, 
           179.38593750000004`}, {-80.00306118926224, 46.93632457560234}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 37]& ,
        TagBoxNote->"37"],
       StyleBox["37", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[37, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{10.5, 0}, {11.5, 28.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{178.88593750000004`, 
           192.18125000000003`}, {-49.24753492213301, 46.93632457560234}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 28]& ,
        TagBoxNote->"28"],
       StyleBox["28", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[28, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{11.5, 0}, {12.5, 33.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{191.68125000000003`, 
           204.97656250000003`}, {-66.33393840387147, 46.93632457560234}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 33]& ,
        TagBoxNote->"33"],
       StyleBox["33", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[33, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{12.5, 0}, {13.5, 24.}, "RoundingRadius" -> 0]},
          ImageSizeCache->{{204.47656250000003`, 
           217.77187500000005`}, {-35.578412136742244`, 46.93632457560234}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 24]& ,
        TagBoxNote->"24"],
       StyleBox["24", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[24, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{13.5, 0}, {14.5, 38.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{217.27187500000005`, 
           230.56718750000005`}, {-83.42034188560994, 46.93632457560234}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 38]& ,
        TagBoxNote->"38"],
       StyleBox["38", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[38, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{14.5, 0}, {15.5, 30.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{230.06718750000005`, 
           243.36250000000004`}, {-56.082096314828405`, 46.93632457560234}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 30]& ,
        TagBoxNote->"30"],
       StyleBox["30", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[30, {}], 
       "Tooltip"]& ]}, {}, {}}, {{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{-0.8200000000000001, 0},
  AxesStyle->Automatic,
  Frame->True,
  FrameLabel->{{
     FormBox["\"Counts\"", TraditionalForm], None}, {
     FormBox["\"Measurement Outcome\"", TraditionalForm], None}},
  FrameStyle->Automatic,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->250,
  PlotRange->{{-0.5, 15.5}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {None, 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.8304290635580177`*^9, 3.830429100603094*^9, {3.8304292027654047`*^9, 
   3.830429209560601*^9}, 3.830429246181807*^9, 3.830489117671608*^9, 
   3.839374553365162*^9, 3.839714105928134*^9, 3.8492465303926983`*^9, 
   3.8492656830806026`*^9},
 CellLabel->"Out[875]=",
 CellID->1275063526,ExpressionUUID->"5fab2fe9-15b5-458b-9ea9-3a1c6bc82ba4"]
}, Open  ]],

Cell["\<\
The discrepancy between the two distributions is due to the finite sample \
size.\
\>", "Text",
 CellChangeTimes->{{3.830429263119232*^9, 3.830429293774117*^9}},
 CellID->1424295448,ExpressionUUID->"9741521f-3602-4dd3-a8d1-badaf599e401"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Another way to test the equivalence of the fully quantum and semiclassical \
implementation of the quantum Fourier transformation is to take as the input \
state one that ends up in a product state.\
\>", "MathCaption",
 CellChangeTimes->{{3.830488686020423*^9, 3.830488802812283*^9}},
 CellID->1323225536,ExpressionUUID->"f166c667-3e9c-4699-874f-51185bc68aa3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vecs", "=", 
   RowBox[{
    RowBox[{"FourierMatrix", "[", 
     RowBox[{
      RowBox[{"Power", "[", 
       RowBox[{"2", ",", "$n"}], "]"}], ",", 
      RowBox[{"FourierParameters", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "1"}]}], "}"}]}]}], "]"}], ".", 
    RowBox[{"Basis", "[", "SS", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"RandomChoice", "[", "vecs", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"in", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.830428748914798*^9, 3.8304288246983337`*^9}, {
  3.8304884577464*^9, 3.830488492146538*^9}, {3.830488563694826*^9, 
  3.8304885693631907`*^9}, {3.83048860648785*^9, 3.830488645499526*^9}},
 CellLabel->"In[876]:=",
 CellID->1882411498,ExpressionUUID->"897d828e-a3c2-4dec-979b-4a91fe75d418"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{{3.830488612108776*^9, 3.830488651325718*^9}, 
   3.8304888125832*^9, 3.830489194928732*^9, 3.83048986018675*^9, 
   3.8304899214355383`*^9, 3.8393745579392443`*^9, 3.839714106042591*^9, 
   3.849246541626905*^9, 3.84926569293992*^9},
 CellLabel->"Out[878]=",
 CellID->493404666,ExpressionUUID->"b16123c8-60e9-4422-849c-b3fdeaca9963"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gates", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"CP", "[", 
       RowBox[{"j", ",", "k"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "$n", ",", "1", ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "k", ",", "1", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"swaps", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"SWAP", "[", 
      RowBox[{
       RowBox[{"S", "[", "k", "]"}], ",", 
       RowBox[{"S", "[", 
        RowBox[{"$n", "-", "k", "+", "1"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"$n", "/", "2"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"in", ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", "None"}]}], "}"}], ",", 
    RowBox[{"Sequence", "@@", "swaps"}], ",", 
    RowBox[{"Sequence", "@@", "gates"}], ",", 
    RowBox[{"Measurement", "@", 
     RowBox[{"Through", "[", 
      RowBox[{"SS", "[", "3", "]"}], "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.83042808557161*^9, 3.830428196759181*^9}, {
  3.830428258600827*^9, 3.830428300737174*^9}, {3.8304288376358643`*^9, 
  3.830428846399362*^9}, {3.830428963113995*^9, 3.830428973092464*^9}, {
  3.830488841354693*^9, 3.830488860983571*^9}, {3.830489875046825*^9, 
  3.8304898761152897`*^9}, {3.849246547031839*^9, 3.8492465520050287`*^9}},
 CellLabel->"In[879]:=",
 CellID->1535297063,ExpressionUUID->"388e4669-7fdd-4eba-8eec-c08064346782"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{13, -1}, {14, -1}}, {{13, -2}, {14, -2}}, {{13, -3}, {
     14, -3}}, {{13, -4}, {14, -4}}}]}, 
   LineBox[{{{0, -1}, {13, -1}}, {{0, -2}, {13, -2}}, {{0, -3}, {13, -3}}, {{
    0, -4}, {13, -4}}}], {}, {LineBox[{{1, -1}, {1, -4}}], 
    LineBox[{{{0.91, -1.09}, {1.09, -0.91}}, {{0.91, -0.91}, {1.09, -1.09}}}],
     LineBox[{{{0.91, -4.09}, {1.09, -3.91}}, {{0.91, -3.91}, {
     1.09, -4.09}}}]}, {LineBox[{{2, -2}, {2, -3}}], 
    LineBox[{{{1.91, -2.09}, {2.09, -1.91}}, {{1.91, -1.91}, {2.09, -2.09}}}],
     LineBox[{{{1.91, -3.09}, {2.09, -2.91}}, {{1.91, -2.91}, {
     2.09, -3.09}}}]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {3, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -3}, {4, -4}}], DiskBox[{4, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {4, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{5, -2}, {5, -4}}], DiskBox[{5, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {5, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{6, -1}, {6, -4}}], DiskBox[{6, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -4.4}, {6.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "3"],
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {6, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {7, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{8, -2}, {8, -3}}], DiskBox[{8, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {8, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{9, -1}, {9, -3}}], DiskBox[{9, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {9, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -2.4}, {10.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {10, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{11, -1}, {11, -2}}], DiskBox[{11, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{10.6, -2.4}, {11.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {11, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{11.6, -1.4}, {12.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02857142857142857],
      FontWeight->"Light",
      FontSlant->Italic], {12, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{12.6, -1.4}, {13.4, -0.6}]}, 
     CircleBox[{13, -1.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{13, -1.2}, {13.24, -0.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{12.6, -2.4}, {13.4, -1.6}]}, 
     CircleBox[{13, -2.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{13, -2.2}, {13.24, -1.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{12.6, -3.4}, {13.4, -2.6}]}, 
     CircleBox[{13, -3.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{13, -3.2}, {13.24, -2.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{12.6, -4.4}, {13.4, -3.6}]}, 
     CircleBox[{13, -4.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{13, -4.2}, {13.24, -3.76}}]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->550.8000000000001,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.8304888533508167`*^9, 3.830488867695695*^9}, 
   3.830489198316813*^9, {3.83048986151329*^9, 3.830489878428439*^9}, 
   3.830489922352593*^9, 3.839374559531521*^9, {3.839714106148797*^9, 
   3.8397141171078997`*^9}, 3.849246553898326*^9, 3.849265694536276*^9},
 CellLabel->"Out[881]=",
 CellID->322995953,ExpressionUUID->"10d067f5-6c74-4dd7-9b8e-89fb7d906950"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gates", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"CP", "[", 
      RowBox[{"j", ",", "k"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "$n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "k"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gates", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"MapIndexed", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{"#1", ",", 
         RowBox[{"Measurement", "@", 
          RowBox[{"S", "[", 
           RowBox[{"#2", ",", "3"}], "]"}]}]}], "]"}], "&"}], ",", "gates"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"swaps", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"SWAP", "[", 
      RowBox[{
       RowBox[{"S", "[", "k", "]"}], ",", 
       RowBox[{"S", "[", 
        RowBox[{"$n", "-", "k", "+", "1"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"$n", "/", "2"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"in", ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", "None"}]}], "}"}], ",", 
    RowBox[{"Sequence", "@@", "gates"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.83042808557161*^9, 3.830428196759181*^9}, {
  3.830428258600827*^9, 3.8304283778177347`*^9}, {3.8304284439750443`*^9, 
  3.830428511437182*^9}, {3.83042886277796*^9, 3.830428868830661*^9}, {
  3.8304888888222647`*^9, 3.830488907237514*^9}, {3.830489612189712*^9, 
  3.830489613211972*^9}, {3.849246561973834*^9, 3.84924656203741*^9}},
 CellLabel->"In[882]:=",
 CellID->1158902283,ExpressionUUID->"32b56533-5aad-41d4-9ade-5b354f893e10"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{2, -1}, {15, -1}}, {{5, -2}, {15, -2}}, {{9, -3}, {15, -3}}, {{
     14, -4}, {15, -4}}}]}, 
   LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {9, -3}}, {{
    0, -4}, {14, -4}}}], {}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {1, -1}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, 
    CircleBox[{2, -1.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{2, -1.2}, {2.24, -0.76}}]}, {
    LineBox[{{3, -1}, {3, -2}}], DiskBox[{3, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {3, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {4, -2}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, 
    CircleBox[{5, -2.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{5, -2.2}, {5.24, -1.76}}]}, {
    LineBox[{{6, -1}, {6, -3}}], DiskBox[{6, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {6, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{7, -2}, {7, -3}}], DiskBox[{7, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {7, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {8, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, 
    CircleBox[{9, -3.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{9, -3.2}, {9.24, -2.76}}]}, {
    LineBox[{{10, -1}, {10, -4}}], DiskBox[{10, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "3"],
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {10, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{11, -2}, {11, -4}}], DiskBox[{11, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{10.6, -4.4}, {11.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "2"],
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {11, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{12, -3}, {12, -4}}], DiskBox[{12, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{11.6, -4.4}, {12.4, -3.6}]}, InsetBox[
     StyleBox[
      SubscriptBox["\<\"T\"\>", "1"],
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {12, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{12.6, -4.4}, {13.4, -3.6}]}, InsetBox[
     StyleBox["\<\"H\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.02666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {13, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{13.6, -4.4}, {14.4, -3.6}]}, 
    CircleBox[{14, -4.2}, 0.4, 
     NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
      2.6179938779914944`}]], LineBox[{{14, -4.2}, {14.24, -3.76}}]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->586.8000000000001,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.830488899925899*^9, 3.8304889077663317`*^9}, 
   3.830489200600028*^9, {3.83048961360623*^9, 3.830489615691202*^9}, {
   3.83048967130506*^9, 3.830489673757285*^9}, 3.830489746658061*^9, {
   3.830489865112949*^9, 3.830489879744137*^9}, 3.8304899231665077`*^9, 
   3.839374560952056*^9, 3.839714117874001*^9, 3.849246562531787*^9, 
   3.849265696271305*^9},
 CellLabel->"Out[885]=",
 CellID->2088795736,ExpressionUUID->"9e7b1d93-a49a-4051-9a13-8260117c9735"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out1", "=", 
   RowBox[{"ExpressionFor", "[", "qc1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"out1", ",", "SS"}], "]"}]}], "Input",
 CellChangeTimes->{{3.830488655256483*^9, 3.8304886665359907`*^9}, {
  3.830488914808613*^9, 3.830488927127572*^9}, {3.830489351289949*^9, 
  3.8304893589167233`*^9}},
 CellLabel->"In[886]:=",
 CellID->1469523285,ExpressionUUID->"1ab87145-45b2-421a-a424-127127525f6c"],

Cell[BoxData[
 TemplateBox[{
   TagBox[
    TemplateBox[{
      SubscriptBox["1", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"1"}, "RowDefault"]]], 
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"2"}, "RowDefault"]]], 
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"3"}, "RowDefault"]]], 
      SubscriptBox["0", 
       SubscriptBox[
        TemplateBox[{"S"}, "RowDefault"], 
        TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
  "Ket"]], "Output",
 CellChangeTimes->{3.8304889282481327`*^9, 3.830489202352674*^9, 
  3.830489359425809*^9, 3.830489925727684*^9, 3.8393745631461143`*^9, 
  3.8397141192178583`*^9, 3.84924656645724*^9, 3.849265698970633*^9},
 CellLabel->"Out[887]=",
 CellID->446590752,ExpressionUUID->"b20cdb2c-13da-4f0a-85f4-6edfd613ac5a"]
}, Open  ]],

Cell["\<\
Again, recall that the order of qubits are reversed in the semiclassical \
implementation.\
\>", "Text",
 CellChangeTimes->{{3.830489931901167*^9, 3.830489965199729*^9}},
 CellID->1980347370,ExpressionUUID->"68ac3203-61f5-4801-acfc-38bc59d65051"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out2", "=", 
   RowBox[{
    RowBox[{"ExpressionFor", "[", 
     RowBox[{"N", "@", "qc2"}], "]"}], "//", "Chop"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"out2", ",", "SS"}], "]"}]}], "Input",
 CellChangeTimes->{{3.830488655256483*^9, 3.8304886665359907`*^9}, {
  3.830488914808613*^9, 3.830488952572825*^9}, {3.830489224196497*^9, 
  3.830489253564618*^9}, {3.830489303490584*^9, 3.830489384554166*^9}},
 CellLabel->"In[888]:=",
 CellID->1806758675,ExpressionUUID->"dea1d3e8-f459-4195-835c-559b5ced5793"],

Cell[BoxData[
 RowBox[{"1.`", " ", 
  TemplateBox[{
    TagBox[
     TemplateBox[{
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"]]], 
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"]]], 
       SubscriptBox["0", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"]]], 
       SubscriptBox["1", 
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
   "Ket"]}]], "Output",
 CellChangeTimes->{{3.830488661923862*^9, 3.830488673230839*^9}, {
   3.830488909367045*^9, 3.830488954733336*^9}, {3.8304892413182373`*^9, 
   3.830489271243001*^9}, {3.830489312476808*^9, 3.830489341615369*^9}, {
   3.830489384992498*^9, 3.83048938683875*^9}, 3.830489927031692*^9, 
   3.830489966907658*^9, 3.839374564513998*^9, 3.839714120690062*^9, 
   3.849246567801046*^9, 3.849265701638891*^9},
 CellLabel->"Out[889]=",
 CellID->1713013487,ExpressionUUID->"bd771b91-7e48-490d-8d95-72f5027973dd"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Quantum Phase Estimation", "Section",
 CellChangeTimes->{{3.818678388303872*^9, 3.8186783956161346`*^9}},
 CellTags->"Section57",
 CellID->1788606959,ExpressionUUID->"7b1be872-4718-438c-a460-480b0a261bd7"],

Cell["Definition", "Subsection",
 CellChangeTimes->{{3.820302363204175*^9, 3.820302369964678*^9}},
 CellTags->"Section58",
 CellID->641069207,ExpressionUUID->"ccf2212c-ee95-4476-b2a9-071d627d2562"],

Cell[CellGroupData[{

Cell["Implementation", "Subsection",
 CellChangeTimes->{{3.820302377108142*^9, 3.820302380617959*^9}},
 CellTags->"Section59",
 CellID->524705050,ExpressionUUID->"184f5541-c30e-4363-96f7-66eb6a8781bf"],

Cell[CellGroupData[{

Cell["\<\
We take an ancillary register consisting of four qubits, which we call the \
\[OpenCurlyDoubleQuote]probe\[CloseCurlyDoubleQuote] register.\
\>", "MathCaption",
 CellChangeTimes->{{3.8187435261988697`*^9, 3.818743550394718*^9}, {
  3.831063032279653*^9, 
  3.8310630459925423`*^9}},ExpressionUUID->"4ec0c88b-5433-4713-ad78-\
5134fa5cb44c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$m", "=", "4"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "the", " ", "number", " ", "of", " ", "qubits", " ", "in", " ", "the", 
    " ", "\"\<probe\>\"", " ", "register"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"prb", "=", 
    RowBox[{"Range", "[", "$m", "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"the", " ", "\"\<probe\>\"", " ", "register"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sys", "=", 
    RowBox[{"$m", "+", "1"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"the", " ", "\"\<system\>\"", " ", "register"}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.818742545252225*^9, 3.818742575749165*^9}, {
   3.8187428560364122`*^9, 3.818742872178891*^9}, {3.818744194660828*^9, 
   3.81874419937315*^9}, {3.823919846893076*^9, 3.82391984824258*^9}, {
   3.8310622459488497`*^9, 3.831062265117094*^9}, {3.831062331468424*^9, 
   3.831062331714706*^9}, {3.831062946380271*^9, 3.831062946671286*^9}, {
   3.831062981331336*^9, 3.83106301753172*^9}, {3.8311493227293663`*^9, 
   3.831149323267743*^9}, {3.831149389128488*^9, 3.831149389228911*^9}, 
   3.8366806446769*^9},
 CellLabel->"In[4]:=",ExpressionUUID->"95677b7c-0169-4029-a274-91abdcf147a6"],

Cell["\<\
We consider a rotation around the z-axis for the unitary operator. In this \
case, the logical basis consists of the eigenstates of the unitary operator.\
\>", "Text",
 CellChangeTimes->{{3.818743472233326*^9, 3.8187434954070797`*^9}, {
  3.8187437119599037`*^9, 
  3.818743753874928*^9}},ExpressionUUID->"3a0b0e2e-689d-4b21-b088-\
0a1e929d7091"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]", "=", 
   RowBox[{"18", "/", "25"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8187426400329933`*^9, 3.818742744994976*^9}, {
   3.818742779991997*^9, 3.818742814852911*^9}, {3.8187431103507957`*^9, 
   3.818743164459857*^9}, {3.8187432387956543`*^9, 3.81874324877393*^9}, {
   3.818743299524045*^9, 3.8187433083011713`*^9}, {3.818743385050221*^9, 
   3.818743414749383*^9}, 3.81874346959093*^9, {3.8310622777284317`*^9, 
   3.831062280833091*^9}, {3.831148208467906*^9, 3.831148208949852*^9}, {
   3.8311487352001543`*^9, 3.831148736426013*^9}, {3.8311488356021357`*^9, 
   3.831148860306183*^9}, {3.831149257965145*^9, 3.831149258684291*^9}, {
   3.831149309218137*^9, 3.831149310083241*^9}, {3.8311496667176943`*^9, 
   3.831149666973267*^9}, {3.83114988318943*^9, 3.831149883548815*^9}, {
   3.836680650808556*^9, 3.83668065438479*^9}, {3.836680690420719*^9, 
   3.836680692308783*^9}},
 CellLabel->"In[7]:=",
 CellID->2041353880,ExpressionUUID->"b04da24a-544f-49db-b8c6-4b75c5d97cef"],

Cell[TextData[{
 "Here is the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"controlled", "-", 
    SuperscriptBox["U", 
     SuperscriptBox["2", 
      RowBox[{"m", "-", "j"}]]]}], TraditionalForm]],ExpressionUUID->
  "61db0249-370f-461a-afb8-68438a0243c2"],
 " operator to be used in the phase estimation algorithm."
}], "Text",
 CellChangeTimes->{{3.818743606877872*^9, 
  3.818743643044842*^9}},ExpressionUUID->"c36dde83-2e78-416f-bd78-\
dabe650dd7b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ctrlU", "[", "j_", "]"}], ":=", 
  RowBox[{"ControlledU", "[", 
   RowBox[{
    RowBox[{"S", "[", "j", "]"}], ",", 
    RowBox[{"Phase", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], "Pi", " ", "\[Phi]", "*", 
       RowBox[{"Power", "[", 
        RowBox[{"2", ",", 
         RowBox[{"$m", "-", "j"}]}], "]"}]}], ",", 
      RowBox[{"S", "[", "sys", "]"}]}], "]"}], ",", 
    RowBox[{"\"\<Label\>\"", "\[Rule]", 
     RowBox[{"Superscript", "[", 
      RowBox[{"\"\<U\>\"", ",", 
       RowBox[{"Superscript", "[", 
        RowBox[{"\"\<2\>\"", ",", 
         RowBox[{"ToString", "[", 
          RowBox[{"$m", "-", "j"}], "]"}]}], "]"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<LabelSize\>\"", "\[Rule]", "0.65"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8187426400329933`*^9, 3.818742744994976*^9}, {
   3.818742779991997*^9, 3.818742814852911*^9}, {3.8187431103507957`*^9, 
   3.818743164459857*^9}, {3.8187432387956543`*^9, 3.81874324877393*^9}, {
   3.818743299524045*^9, 3.8187433083011713`*^9}, {3.818743385050221*^9, 
   3.818743414749383*^9}, 3.81874346959093*^9, {3.8187435752909937`*^9, 
   3.8187435976422586`*^9}, 3.818834051868576*^9, {3.819796766729814*^9, 
   3.819796773580491*^9}, 3.826342560099493*^9, {3.831062296391025*^9, 
   3.8310622991361113`*^9}, {3.831148243576722*^9, 3.8311482837032137`*^9}, {
   3.831148352427329*^9, 3.831148352887697*^9}, 3.831148492177722*^9, {
   3.8311485236769323`*^9, 3.831148555309902*^9}, {3.831148867124178*^9, 
   3.831148875200405*^9}, {3.8366806992168007`*^9, 3.836680704223077*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"df9a4d6f-bd66-4857-ba55-c8fe55b1dc29"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"S", "@", "prb"}]}], "]"}], ",", 
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", "sys", "]"}], "\[Rule]", "1"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"prb", ",", "6"}], "]"}], ",", 
      RowBox[{"\"\<LabelSize\>\"", "\[Rule]", "0.8"}]}], "}"}], ",", 
    RowBox[{"ctrlU", "[", "1", "]"}], ",", 
    RowBox[{"ctrlU", "[", "2", "]"}], ",", 
    RowBox[{"ctrlU", "[", "3", "]"}], ",", 
    RowBox[{"ctrlU", "[", "4", "]"}], ",", 
    RowBox[{"QFT", "[", 
     RowBox[{"S", "@", "prb"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.818742425522031*^9, 3.8187424317628107`*^9}, {
   3.818742484311056*^9, 3.8187425284999027`*^9}, {3.818742580677137*^9, 
   3.818742604806177*^9}, {3.818743315024571*^9, 3.8187433188716*^9}, {
   3.8187433719575167`*^9, 3.818743451523568*^9}, {3.818743580735165*^9, 
   3.818743594458509*^9}, {3.818743765574943*^9, 3.8187437782190113`*^9}, {
   3.818744213121214*^9, 3.8187442249657917`*^9}, {3.8187451503047*^9, 
   3.818745160585781*^9}, {3.818745316559771*^9, 3.818745331553199*^9}, {
   3.823919859785193*^9, 3.823919865128253*^9}, 3.8298087019080687`*^9, {
   3.83106234103679*^9, 3.831062342651025*^9}, {3.8310623732725763`*^9, 
   3.831062410464069*^9}, {3.8310630585489492`*^9, 3.831063067288766*^9}, {
   3.83114839240758*^9, 3.831148398549128*^9}, {3.831148722432313*^9, 
   3.831148723242015*^9}, {3.852084541908491*^9, 3.852084542310556*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"14e8ed5f-72ee-462c-b0cd-cc91ebfad36f"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {7, -2}}, {{0, -3}, {7, -3}}, {{
    0, -4}, {7, -4}}, {{0, -5}, {7, -5}}}], {{InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.045714285714285714`],
       FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.045714285714285714`],
       FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.045714285714285714`],
       FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.045714285714285714`],
       FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, Rational[1, 2]}]]}, 
    InsetBox[
     StyleBox[
      TemplateBox[{"1"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.045714285714285714`],
      FontWeight->"Light"], {-0.1, -5}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.045714285714285714`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.045714285714285714`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.045714285714285714`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.045714285714285714`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -5}}], DiskBox[{2, -1}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -5.4}, {2.4, -4.6}]}, InsetBox[
     StyleBox[
      TemplateBox[{"\"U\"", 
        TemplateBox[{"\"2\"", "\"3\""}, "Superscript", SyntaxForm -> 
         SuperscriptBox]},
       "Superscript"],
      StripOnInput->False,
      FontSize->Scaled[0.037142857142857144`],
      FontWeight->"Light",
      FontSlant->Italic], {2, -5}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{3, -2}, {3, -5}}], DiskBox[{3, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -5.4}, {3.4, -4.6}]}, InsetBox[
     StyleBox[
      TemplateBox[{"\"U\"", 
        TemplateBox[{"\"2\"", "\"2\""}, "Superscript", SyntaxForm -> 
         SuperscriptBox]},
       "Superscript"],
      StripOnInput->False,
      FontSize->Scaled[0.037142857142857144`],
      FontWeight->"Light",
      FontSlant->Italic], {3, -5}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{4, -3}, {4, -5}}], DiskBox[{4, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3.6, -5.4}, {4.4, -4.6}]}, InsetBox[
     StyleBox[
      TemplateBox[{"\"U\"", 
        TemplateBox[{"\"2\"", "\"1\""}, "Superscript", SyntaxForm -> 
         SuperscriptBox]},
       "Superscript"],
      StripOnInput->False,
      FontSize->Scaled[0.037142857142857144`],
      FontWeight->"Light",
      FontSlant->Italic], {4, -5}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    LineBox[{{5, -4}, {5, -5}}], DiskBox[{5, -4}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -5.4}, {5.4, -4.6}]}, InsetBox[
     StyleBox[
      TemplateBox[{"\"U\"", 
        TemplateBox[{"\"2\"", "\"0\""}, "Superscript", SyntaxForm -> 
         SuperscriptBox]},
       "Superscript"],
      StripOnInput->False,
      FontSize->Scaled[0.037142857142857144`],
      FontWeight->"Light",
      FontSlant->Italic], {5, -5}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5.6, -4.4}, {6.4, -0.6}]}, InsetBox[
     StyleBox[
      RotationBox["\<\"QFT\"\>",
       BoxRotation->1.5707963267948966`],
      StripOnInput->False,
      FontSize->Scaled[0.05714285714285714],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{6, Rational[-5, 2]}, {6, -2.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->298.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{
  3.818742528885425*^9, {3.8187425822836647`*^9, 3.8187426091009817`*^9}, {
   3.818743311933858*^9, 3.818743320315392*^9}, {3.818743380606806*^9, 
   3.8187434159811172`*^9}, {3.818743451847126*^9, 3.818743454849667*^9}, 
   3.818743499842695*^9, 3.818743645254384*^9, {3.818743778571032*^9, 
   3.818743781017764*^9}, 3.818743883597103*^9, 3.818744076806739*^9, 
   3.818744226294116*^9, 3.818744268900242*^9, 3.818744368678122*^9, 
   3.818744968623699*^9, {3.81874516094093*^9, 3.818745187938205*^9}, {
   3.8187453227844553`*^9, 3.818745332031316*^9}, 3.8187454120360003`*^9, 
   3.818745460128068*^9, 3.818745512162929*^9, 3.818834109744969*^9, 
   3.818977944547256*^9, 3.819682641605607*^9, {3.819796749089797*^9, 
   3.819796775733391*^9}, {3.819798283742365*^9, 3.819798292303955*^9}, 
   3.81980391068215*^9, 3.8198042084045057`*^9, 3.819804289570404*^9, 
   3.820302392747643*^9, {3.823919855869385*^9, 3.823919865973839*^9}, 
   3.824001355074217*^9, 3.82634159077402*^9, {3.826342541145718*^9, 
   3.826342577305209*^9}, 3.830142187824366*^9, 3.8310623114927607`*^9, {
   3.8310623431094513`*^9, 3.83106237608375*^9}, {3.831062413719719*^9, 
   3.83106241676593*^9}, {3.8310630526638327`*^9, 3.831063069699174*^9}, 
   3.831063128415698*^9, 3.831063198446656*^9, 3.831148292035385*^9, {
   3.831148359821863*^9, 3.831148401936041*^9}, 3.831148439454566*^9, {
   3.831148496598267*^9, 3.831148556738378*^9}, 3.8311486721927357`*^9, {
   3.831148723747109*^9, 3.831148739141355*^9}, 3.831148839300908*^9, 
   3.831148878864809*^9, 3.831149260893948*^9, {3.831149301685494*^9, 
   3.831149327390263*^9}, 3.831149393608922*^9, 3.831149669322929*^9, 
   3.831149886113439*^9, 3.8311504606055593`*^9, 3.831150799510055*^9, 
   3.836680657743025*^9, {3.8366807107927027`*^9, 3.83668071523461*^9}, 
   3.836680769580583*^9, 3.839374571417802*^9, 3.839714126421061*^9, 
   3.849246578885858*^9, 3.8492466309044647`*^9, 3.849247012797443*^9, 
   3.849265739811817*^9, {3.852084537068487*^9, 3.8520845455357122`*^9}},
 CellLabel->"Out[11]=",
 CellID->177915444,ExpressionUUID->"4abeb085-2742-4c7d-84b1-009ac30956ae"]
}, Open  ]],

Cell["\<\
In this particular example, we already know that the \
\[OpenCurlyDoubleQuote]system\[CloseCurlyDoubleQuote] register remains in its \
initial state and what the initial state is. To make the process general, \
however, we take the partial trace over the system register to focus on the \
\[OpenCurlyDoubleQuote]probe\[CloseCurlyDoubleQuote] register.\
\>", "Text",
 CellChangeTimes->{{3.831062839969534*^9, 3.831062936355098*^9}},
 CellID->1982401651,ExpressionUUID->"1acffdd7-666c-4abc-a88e-c8743f0786cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"N", "@", "qc"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rho", "=", 
   RowBox[{"PartialTrace", "[", 
    RowBox[{"out", ",", 
     RowBox[{"{", "sys", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8187446763019037`*^9, 3.818744748801853*^9}, 
   3.830132248555395*^9, {3.831062382441103*^9, 3.8310623835994587`*^9}, {
   3.831062433019649*^9, 3.83106243439229*^9}, {3.83106248158292*^9, 
   3.8310624873993797`*^9}, {3.831062527763239*^9, 3.831062539586035*^9}, {
   3.831062626431952*^9, 3.831062675164941*^9}, {3.831063079426746*^9, 
   3.831063090158881*^9}, {3.831063148566024*^9, 3.831063162931263*^9}},
 CellLabel->"In[12]:=",
 CellID->630451150,ExpressionUUID->"10b3b9db-92c4-4a4e-9804-b5389ec8c77a"],

Cell["\<\
From the density matrix of the probe register, we can get the probability to \
read out the possible values of the normalized phase.\
\>", "Text",
 CellChangeTimes->{{3.831063211483848*^9, 3.831063265017455*^9}},
 CellID->1227825708,ExpressionUUID->"51c68ded-8ac1-4b24-a3d3-3b9d02c9fd26"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"probability", "=", 
   RowBox[{"Transpose", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"2", "^", "$m"}], "-", "1"}]}], "]"}], "/", 
       RowBox[{"2", "^", "$m"}]}], ",", 
      RowBox[{"Normal", "@", 
       RowBox[{"Chop", "@", 
        RowBox[{"Diagonal", "@", "rho"}]}]}]}], "}"}]}]}], ";", 
  RowBox[{"g", "=", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"probability", ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", "All"}], "}"}]}], ",", 
     RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<\[Phi]\>\"", ",", "\"\<Probability\>\""}], "}"}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8187441364684134`*^9, 3.81874416869645*^9}, {
   3.818744906282579*^9, 3.818744909668273*^9}, {3.818834052773019*^9, 
   3.818834061467946*^9}, {3.81979938191483*^9, 3.819799388460472*^9}, {
   3.819799531643135*^9, 3.819799556267354*^9}, {3.823919878065881*^9, 
   3.8239198832632313`*^9}, {3.831062733223485*^9, 3.831062735169963*^9}, {
   3.8310627856691008`*^9, 3.831062787749937*^9}, {3.8310631809533377`*^9, 
   3.831063182529636*^9}, {3.8310632834461813`*^9, 3.831063315628969*^9}, {
   3.831148578202558*^9, 3.83114857895592*^9}, {3.83114982424228*^9, 
   3.8311498646382933`*^9}, 3.83114993621067*^9, 3.831150001868655*^9, {
   3.831150064295277*^9, 3.831150075634701*^9}, {3.8311508060122223`*^9, 
   3.8311508095664062`*^9}, 3.836680667739236*^9},
 CellLabel->"In[14]:=",
 CellID->1513843396,ExpressionUUID->"1719471f-962f-4643-9a52-6daac5d72843"],

Cell[BoxData[
 GraphicsBox[{{}, {{{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       NCache[
        Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6], 
      LineBox[{{0., 0.0065536638958519355`}, {0.0625, 0.005023617445523694}, {
       0.125, 0.004259088603741179}, {0.1875, 0.0039316937993277646`}, {0.25, 
       0.003925615749760346}, {0.3125, 0.004238842383881606}, {0.375, 
       0.004981615042027737}, {0.4375, 0.00646972085758781}, {0.5, 
       0.009576075706458246}, {0.5625, 0.017255192418975728`}, {0.625, 
       0.04500187309415121}, {0.6875, 0.3745308333263608}, {0.75, 
       0.4393275110947006}, {0.8125, 0.047393708493006}, {0.875, 
       0.01776981657796506}, {0.9375, 0.00976113151067961}}]}}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      NCache[
       Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6], 
     GeometricTransformationBox[InsetBox[
       FormBox[
        StyleBox[
         GraphicsBox[
          {EdgeForm[None], DiskBox[{0, 0}]},
          AxesStyle->Automatic,
          FrameStyle->Automatic,
          ImageSize->250,
          PlotRangePadding->Scaled[0.025]],
         StripOnInput->False,
         GraphicsBoxOptions->{DefaultBaseStyle->Directive[
           PointSize[
            Rational[7, 360]], 
           RGBColor[0.368417, 0.506779, 0.709798], 
           AbsoluteThickness[1.6]]}],
        TraditionalForm], {0., 0.}, Automatic, Offset[6.272]], {{{0., 
      0.0065536638958519355`}}, {{0.0625, 0.005023617445523694}}, {{0.125, 
      0.004259088603741179}}, {{0.1875, 0.0039316937993277646`}}, {{0.25, 
      0.003925615749760346}}, {{0.3125, 0.004238842383881606}}, {{0.375, 
      0.004981615042027737}}, {{0.4375, 0.00646972085758781}}, {{0.5, 
      0.009576075706458246}}, {{0.5625, 0.017255192418975728`}}, {{0.625, 
      0.04500187309415121}}, {{0.6875, 0.3745308333263608}}, {{0.75, 
      0.4393275110947006}}, {{0.8125, 0.047393708493006}}, {{0.875, 
      0.01776981657796506}}, {{0.9375, 0.00976113151067961}}}]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  AxesStyle->Automatic,
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{
     FormBox["\"Probability\"", TraditionalForm], None}, {
     FormBox["\"\[Phi]\"", TraditionalForm], None}},
  FrameStyle->Automatic,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->250,
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 1.}, {0, 0.4393275110947006}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {
     Scaled[0.025], 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.831062735626627*^9, 3.831062793211609*^9, {3.831063173236084*^9, 
   3.831063185308166*^9}, {3.8310632500279207`*^9, 3.83106333287078*^9}, 
   3.831148409940687*^9, {3.8311484449940987`*^9, 3.831148459033525*^9}, {
   3.831148516202078*^9, 3.831148579275289*^9}, 3.8311486472345963`*^9, 
   3.831148677776668*^9, {3.831148729739093*^9, 3.831148743742545*^9}, 
   3.831148843801852*^9, 3.83114888316215*^9, 3.831149265474297*^9, {
   3.831149305788177*^9, 3.8311493165520887`*^9}, 3.831149347742428*^9, {
   3.83114939910973*^9, 3.8311494016613483`*^9}, 3.831149673488756*^9, {
   3.831149849794079*^9, 3.831149890529098*^9}, {3.831150004070088*^9, 
   3.831150006009598*^9}, {3.831150071724455*^9, 3.831150078312954*^9}, 
   3.8311501152385902`*^9, 3.831150465247283*^9, 3.831150810109515*^9, 
   3.836680668784203*^9, 3.836680720597458*^9, 3.8366807879303427`*^9, 
   3.839374576644208*^9, 3.839714130457296*^9, 3.8492470497519836`*^9, 
   3.849265747799199*^9, 3.85208454889032*^9},
 CellLabel->"Out[14]=",
 CellID->1974615916,ExpressionUUID->"9e7fe94e-b037-41e0-899a-96a07e955320"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell["Accuracy", "Subsection",
 CellChangeTimes->{{3.836797445753645*^9, 3.8367974469913054`*^9}},
 CellTags->"Section14",
 CellID->387810204,ExpressionUUID->"55f6e05c-5ec8-41eb-8c0f-b0dbb03b68dd"],

Cell["Simulation of von Neumann Measurement", "Subsection",
 CellChangeTimes->{{3.836797473720622*^9, 3.8367974800425158`*^9}},
 CellTags->"Section15",
 CellID->1945118114,ExpressionUUID->"96d37673-2be5-47ba-a811-9636f6cbcb65"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Applications", "Section",
 CellChangeTimes->{{3.830665375742956*^9, 3.830665377283504*^9}},
 CellTags->"Section11",
 CellID->523633377,ExpressionUUID->"878b9975-2b9b-45a6-b67b-780598258563"],

Cell[CellGroupData[{

Cell["The Period-Finding Algorithm", "Subsection",
 CellChangeTimes->{{3.8306653808725357`*^9, 3.8306653849781523`*^9}, {
  3.830666176695677*^9, 3.830666190341254*^9}},
 CellTags->"Section12",
 CellID->1070104587,ExpressionUUID->"532a30cc-1ff4-4e16-96f6-61b1ade29564"],

Cell[CellGroupData[{

Cell["\<\
We demonstrate the basic ideas in the period-finding algorithm. More complete \
example follows below.\
\>", "MathCaption",
 CellChangeTimes->{{3.830665487945771*^9, 3.830665628238142*^9}, {
  3.830665712035281*^9, 3.8306657488320913`*^9}, {3.830766084498836*^9, 
  3.830766094588037*^9}, {3.836707724512843*^9, 3.836707776980063*^9}},
 CellID->1865024231,ExpressionUUID->"93d23a6b-4173-44fd-89ac-81e407c55849"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$N", "=", 
   RowBox[{"Power", "[", 
    RowBox[{"2", ",", "$n"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.830579151277104*^9, 3.830579156225788*^9}, {
   3.8305791878496857`*^9, 3.8305791934731197`*^9}, {3.830579292592862*^9, 
   3.830579328657638*^9}, {3.830582070414658*^9, 3.83058209994473*^9}, {
   3.830582161887287*^9, 3.830582194690209*^9}, {3.8305822739451857`*^9, 
   3.8305822740118103`*^9}, {3.830582336888534*^9, 3.8305823524681664`*^9}, {
   3.830654303134918*^9, 3.8306543031899157`*^9}, {3.830658324854459*^9, 
   3.8306583398255987`*^9}, {3.830663856710087*^9, 3.830663856788022*^9}, {
   3.8306647731975946`*^9, 3.830664773308934*^9}, {3.830665632276498*^9, 
   3.830665662823287*^9}, {3.830668164685409*^9, 3.830668164999557*^9}, {
   3.8307595746141148`*^9, 3.830759574977209*^9}, {3.836797582571507*^9, 
   3.836797595925873*^9}, 3.8367976297073174`*^9},
 CellLabel->"In[906]:=",
 CellID->993225010,ExpressionUUID->"f4926b58-455b-4fa9-8f6f-b2610a0d4453"],

Cell[TextData[{
 "We take an example of the modular exponential function, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", "(", "x", ")"}], "=", 
    RowBox[{
     SuperscriptBox["a", "x"], " ", 
     RowBox[{"(", 
      RowBox[{"mod", " ", "L"}], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "7741449c-4527-4525-9876-b9cfd5940591"],
 " for a fixed ",
 StyleBox["a",
  FontSlant->"Italic"],
 " and ",
 StyleBox["L",
  FontSlant->"Italic"],
 ". Here ",
 StyleBox["a",
  FontSlant->"Italic"],
 " and ",
 StyleBox["L",
  FontSlant->"Italic"],
 " are assumed to be co-primes."
}], "Text",
 CellChangeTimes->{{3.830665487945771*^9, 3.830665628238142*^9}, {
   3.830665712035281*^9, 3.8306657488320913`*^9}, {3.830766084498836*^9, 
   3.830766094588037*^9}, {3.836707724512843*^9, 3.836707816376254*^9}, 
   3.836709039368423*^9, 3.8367090757733917`*^9, 3.839714139563826*^9},
 CellID->494769004,ExpressionUUID->"5fe5b7f6-d58c-4e15-b6df-26f5ff1bef1d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$a", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "f", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "[", "k_", "]"}], ":=", 
  RowBox[{"PowerMod", "[", 
   RowBox[{"$a", ",", "k", ",", "$N"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.830579151277104*^9, 3.830579156225788*^9}, {
   3.8305791878496857`*^9, 3.8305791934731197`*^9}, {3.830579292592862*^9, 
   3.830579328657638*^9}, {3.830582070414658*^9, 3.83058209994473*^9}, {
   3.830582161887287*^9, 3.830582194690209*^9}, {3.8305822739451857`*^9, 
   3.8305822740118103`*^9}, {3.830582336888534*^9, 3.8305823524681664`*^9}, {
   3.830654303134918*^9, 3.8306543031899157`*^9}, {3.830658324854459*^9, 
   3.8306583398255987`*^9}, {3.830663856710087*^9, 3.830663856788022*^9}, {
   3.8306647731975946`*^9, 3.830664773308934*^9}, {3.830665632276498*^9, 
   3.830665662823287*^9}, {3.830668164685409*^9, 3.830668164999557*^9}, {
   3.8307595746141148`*^9, 3.830759574977209*^9}, {3.836797582571507*^9, 
   3.836797595925873*^9}, 3.8367976297073174`*^9, {3.8393754880298357`*^9, 
   3.839375489141697*^9}},
 CellLabel->"In[908]:=",
 CellID->1115707455,ExpressionUUID->"16530d5f-84c9-4fca-aa3b-06f41dcef96d"],

Cell["The function is periodic.", "Text",
 CellChangeTimes->{{3.830665675170656*^9, 3.83066570239421*^9}, {
  3.8306657672472486`*^9, 3.830665798375084*^9}},
 CellID->1841005005,ExpressionUUID->"2c02e3d0-d676-42d4-b315-2e54c614dedf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"f", "[", "k", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", 
       RowBox[{"$N", "-", "1"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<x\>\"", ",", 
      RowBox[{"HoldForm", "@", 
       RowBox[{"f", "[", "x", "]"}]}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8305792020793743`*^9, 3.8305792424200172`*^9}, {
  3.83057947605145*^9, 3.83057955759638*^9}, {3.830582306423663*^9, 
  3.830582314072611*^9}, {3.83058236278535*^9, 3.8305824061293287`*^9}, {
  3.8306533428522243`*^9, 3.830653376116254*^9}, {3.830653415230996*^9, 
  3.8306534418458033`*^9}, {3.8306681725936003`*^9, 3.830668172896776*^9}},
 CellLabel->"In[911]:=",
 CellID->2026954350,ExpressionUUID->"fcc63aab-4416-44f5-9b55-f77535a12576"],

Cell[BoxData[
 GraphicsBox[{{}, {{{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      LineBox[{{0., 1.}, {1., 3.}, {2., 9.}, {3., 11.}, {4., 1.}, {5., 3.}, {
       6., 9.}, {7., 11.}, {8., 1.}, {9., 3.}, {10., 9.}, {11., 11.}, {12., 
       1.}, {13., 3.}, {14., 9.}, {15., 11.}}]}}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], GeometricTransformationBox[InsetBox[
       FormBox[
        StyleBox[
         GraphicsBox[
          {EdgeForm[None], DiskBox[{0, 0}]},
          AxesStyle->Automatic,
          FrameStyle->Automatic,
          ImageSize->250,
          PlotRangePadding->Scaled[0.025]],
         StripOnInput->False,
         GraphicsBoxOptions->{DefaultBaseStyle->Directive[
           PointSize[0.012833333333333334`], 
           RGBColor[0.368417, 0.506779, 0.709798], 
           AbsoluteThickness[1.6]]}],
        TraditionalForm], {0., 0.}, Automatic, Offset[6.272]], {{{0., 1.}}, {{
      1., 3.}}, {{2., 9.}}, {{3., 11.}}, {{4., 1.}}, {{5., 3.}}, {{6., 
      9.}}, {{7., 11.}}, {{8., 1.}}, {{9., 3.}}, {{10., 9.}}, {{11., 11.}}, {{
      12., 1.}}, {{13., 3.}}, {{14., 9.}}, {{15., 11.}}}]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  AxesStyle->Automatic,
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{
     FormBox[
      TagBox[
       RowBox[{"f", "(", "x", ")"}], HoldForm], TraditionalForm], None}, {
     FormBox["\"x\"", TraditionalForm], None}},
  FrameStyle->Automatic,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->250,
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 15.}, {0, 11.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {
     Scaled[0.025], 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.83076610309577*^9, 3.830767572012486*^9, 3.8367078202807713`*^9, 
   3.83670788822974*^9, {3.8367976372777157`*^9, 3.836797645619424*^9}, 
   3.839374583903048*^9, 3.839714143057152*^9, 3.849247058437204*^9, 
   3.849248798619824*^9, 3.849265755401141*^9},
 CellLabel->"Out[911]=",
 CellID->751014217,ExpressionUUID->"ae46c3fe-d4ed-44f9-8e88-95235cb99e9a"]
}, Open  ]],

Cell["\<\
The classical oracle (in the binary form) corresponding to the function f \
(expressed in usual integers).\
\>", "Text",
 CellChangeTimes->{{3.8306537133410873`*^9, 3.830653758597693*^9}},
 CellID->1860084273,ExpressionUUID->"1d7253e1-d67a-43f3-a58d-98f2aeb32c4b"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "g", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "[", "x__", "]"}], ":=", 
  RowBox[{"IntegerDigits", "[", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"FromDigits", "[", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", "2"}], "]"}], "]"}], ",", "2", ",", 
    "$n"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.830653474965775*^9, 3.830653489870476*^9}, {
  3.830653552665742*^9, 3.8306535836013823`*^9}, {3.839374591124816*^9, 
  3.839374592339447*^9}},
 CellLabel->"In[912]:=",
 CellID->1516926932,ExpressionUUID->"53c02f5f-f414-4416-9189-e6361d8d69d8"],

Cell["Here is the quantum circuit model of the algorithm.", "Text",
 CellChangeTimes->{{3.830665807790572*^9, 3.830665824192319*^9}},
 CellID->1085392239,ExpressionUUID->"e6feac76-3b6f-4ad6-a21d-d80f5669a6f8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"Range", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"$n", "+", "1"}], ",", 
     RowBox[{"$n", "+", "$n"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qc0", "=", 
   RowBox[{"QuantumCircuit", "[", 
    RowBox[{
     RowBox[{"LogicalForm", "[", 
      RowBox[{
       RowBox[{"Ket", "[", "]"}], ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"S", "@", "cc"}], ",", 
         RowBox[{"S", "@", "tt"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"cc", ",", "6"}], "]"}], ",", 
     RowBox[{"Oracle", "[", 
      RowBox[{"g", ",", 
       RowBox[{"S", "@", "cc"}], ",", 
       RowBox[{"S", "@", "tt"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"QFT", "[", 
      RowBox[{"S", "@", "cc"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"qc0", ",", 
    RowBox[{"Measurement", "@", 
     RowBox[{"S", "[", 
      RowBox[{"cc", ",", "3"}], "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.830653649063695*^9, 3.830653708774403*^9}, {
   3.830653765860044*^9, 3.830653853951942*^9}, {3.830655137056566*^9, 
   3.830655168104241*^9}, {3.830655219841648*^9, 3.83065524686158*^9}, {
   3.830656004274881*^9, 3.830656026683696*^9}, {3.8306639050076733`*^9, 
   3.830663913771208*^9}, {3.83066485289002*^9, 3.830664877817803*^9}, {
   3.830766126149666*^9, 3.8307661630039663`*^9}, {3.8492470712781467`*^9, 
   3.849247074034896*^9}, 3.856390579326804*^9},
 CellID->65088940,ExpressionUUID->"26d63ccb-face-4989-b726-dbfc3bc95f00"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{4, -1}, {5, -1}}, {{4, -2}, {5, -2}}, {{4, -3}, {5, -3}}, {{
     4, -4}, {5, -4}}}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
    0, -4}, {4, -4}}, {{0, -5}, {5, -5}}, {{0, -6}, {5, -6}}, {{0, -7}, {
    5, -7}}, {{0, -8}, {5, -8}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -5}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -6}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -7}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -8}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -2}, {2, -3}, {2, -4}, {2, -5}, {2, -6}, {2, -7}, {
     2, -8}}], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     FilledCurveBox[{
      BezierCurve[{{2.4, -1}, {2.4, -0.47439999999999993`}, {
         1.6, -0.47439999999999993`}, {1.6, -1}}], 
       Line[{{1.6, -1}, {1.6, -4}}], 
       BezierCurve[{{1.6, -4.5256}, {2.4, -4.5256}, {2.4, -4}}]}]}, InsetBox[
     StyleBox["\<\"f\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{2, Rational[-5, 2]}, {2, -2.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]], {
     CircleBox[{2, -5}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -5}, {2.2666666666666666`, -5}}, {{
        2, -5.266666666666667}, {2, -4.733333333333333}}}]}, {
     CircleBox[{2, -6}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -6}, {2.2666666666666666`, -6}}, {{
        2, -6.266666666666667}, {2, -5.733333333333333}}}]}, {
     CircleBox[{2, -7}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -7}, {2.2666666666666666`, -7}}, {{
        2, -7.266666666666667}, {2, -6.733333333333333}}}]}, {
     CircleBox[{2, -8}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -8}, {2.2666666666666666`, -8}}, {{
        2, -8.266666666666667}, {2, -7.733333333333333}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -4.4}, {3.4, -0.6}]}, InsetBox[
     StyleBox[
      RotationBox["\<\"QFT\"\>",
       BoxRotation->1.5707963267948966`],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{3, Rational[-5, 2]}, {3, -2.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, 
     CircleBox[{4, -1.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -1.2}, {4.24, -0.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, 
     CircleBox[{4, -2.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -2.2}, {4.24, -1.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, 
     CircleBox[{4, -3.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -3.2}, {4.24, -2.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, 
     CircleBox[{4, -4.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -4.2}, {4.24, -3.76}}]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->226.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.8307661634718103`*^9, 3.830766166144909*^9}, 
   3.830767574152717*^9, 3.836707822733473*^9, 3.836707898045925*^9, 
   3.839374595308669*^9, 3.8397141461872272`*^9, 3.849247075687992*^9, 
   3.849247108533423*^9, {3.849247165598527*^9, 3.849247189532675*^9}, 
   3.849248214636036*^9, 3.849248319360478*^9, 3.849248738536805*^9, 
   3.849248801333243*^9, 3.849265758397167*^9},
 CellLabel->"Out[917]=",
 CellID->371090296,ExpressionUUID->"db90d9d9-4983-4a3d-a962-32a3a99abc89"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"ExpressionFor", "[", "qc", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"out", ",", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"S", "@", "cc"}], ",", 
     RowBox[{"S", "@", "tt"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"result", "=", 
  RowBox[{"Readout", "@", 
   RowBox[{"S", "[", 
    RowBox[{"cc", ",", "3"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.830663762477562*^9, 3.830663892440249*^9}, {
   3.830663930073258*^9, 3.830663938139436*^9}, {3.830665863273905*^9, 
   3.830665864094347*^9}, {3.830759937167453*^9, 3.83075994785098*^9}, {
   3.8307661830144157`*^9, 3.830766188360477*^9}, {3.84924709640886*^9, 
   3.8492471031456833`*^9}, 3.849247183625107*^9, {3.849248335394918*^9, 
   3.849248335801476*^9}},
 CellLabel->"In[918]:=",
 CellID->973138747,ExpressionUUID->"64bdd6d6-f4fe-4263-bdff-7c4f43ba5960"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"7"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"8"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"7"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"8"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"7"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"8"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"7"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"8"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{{3.830663871419807*^9, 3.830663955239018*^9}, 
   3.830664782486376*^9, 3.8306648833457127`*^9, {3.830665830198003*^9, 
   3.83066586726429*^9}, 3.8306659069813843`*^9, 3.830668183740142*^9, 
   3.830759951531209*^9, 3.830766192235608*^9, 3.830767578924375*^9, 
   3.830767637691473*^9, {3.83670782674755*^9, 3.8367078365116796`*^9}, {
   3.836707867649946*^9, 3.836707904826689*^9}, 3.836707958265277*^9, 
   3.839374599854704*^9, {3.839714150287928*^9, 3.839714163396161*^9}, 
   3.849247104694152*^9, 3.849247146856303*^9, 3.84924822770243*^9, 
   3.849248337595065*^9, 3.849248749475666*^9, 3.8492488062113523`*^9, 
   3.849265762271927*^9},
 CellLabel->"Out[919]=",
 CellID->546706760,ExpressionUUID->"258178bf-cd64-4580-958f-d80e26d19860"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.830663871419807*^9, 3.830663955239018*^9}, 
   3.830664782486376*^9, 3.8306648833457127`*^9, {3.830665830198003*^9, 
   3.83066586726429*^9}, 3.8306659069813843`*^9, 3.830668183740142*^9, 
   3.830759951531209*^9, 3.830766192235608*^9, 3.830767578924375*^9, 
   3.830767637691473*^9, {3.83670782674755*^9, 3.8367078365116796`*^9}, {
   3.836707867649946*^9, 3.836707904826689*^9}, 3.836707958265277*^9, 
   3.839374599854704*^9, {3.839714150287928*^9, 3.839714163396161*^9}, 
   3.849247104694152*^9, 3.849247146856303*^9, 3.84924822770243*^9, 
   3.849248337595065*^9, 3.849248749475666*^9, 3.8492488062113523`*^9, 
   3.8492657622852793`*^9},
 CellLabel->"Out[920]=",
 CellID->1565473454,ExpressionUUID->"a2ea20da-7a5b-4a8e-8f61-c76e7f2a71c8"]
}, Open  ]],

Cell["\<\
From the measurement outcome, one can find the period. In this case, the \
period is 4.\
\>", "Text",
 CellChangeTimes->{{3.830665915178424*^9, 3.830665957217306*^9}, {
  3.836708977946938*^9, 3.836708988620261*^9}},
 CellID->1412489576,ExpressionUUID->"d40780ea-f8b8-4f98-955d-17a991f2ee42"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"frac", "=", 
  RowBox[{
   RowBox[{"FromDigits", "[", 
    RowBox[{"result", ",", "2"}], "]"}], "/", "$N"}]}]], "Input",
 CellChangeTimes->{{3.8306658686758432`*^9, 3.830665899361479*^9}, {
  3.83066818926486*^9, 3.830668189556933*^9}},
 CellLabel->"In[921]:=",
 CellID->1672335628,ExpressionUUID->"53c80939-2143-430c-8c9e-9d1ba0958cff"],

Cell[BoxData[
 FractionBox["1", "2"]], "Output",
 CellChangeTimes->{{3.830665887189498*^9, 3.830665908436322*^9}, 
   3.8306659658185253`*^9, 3.830668189924097*^9, 3.8307599575264273`*^9, 
   3.830766199365036*^9, 3.8307675800715303`*^9, 3.830767639179274*^9, {
   3.8367078277409573`*^9, 3.8367078382720346`*^9}, 3.836707907607255*^9, 
   3.836707959768023*^9, 3.836708990108807*^9, 3.839374600780507*^9, {
   3.839714151135351*^9, 3.839714163465691*^9}, 3.8492483391482143`*^9, 
   3.849248812064294*^9, 3.849265765095964*^9},
 CellLabel->"Out[921]=",
 CellID->1578029012,ExpressionUUID->"63dbc5cd-886e-4c7f-a8b2-4d3bf8985b8a"]
}, Open  ]],

Cell["\<\
For a more complete overview, let us examine all possible outcomes.\
\>", "Text",
 CellChangeTimes->{{3.8306659717411537`*^9, 3.830666014310914*^9}, {
  3.836709005067636*^9, 3.836709011738249*^9}},
 CellID->1446570629,ExpressionUUID->"3796fa38-beb4-4ccd-b270-7296e0acda43"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"ExpressionFor", "[", "qc0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"new", ",", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"S", "@", "cc"}], ",", 
     RowBox[{"S", "@", "tt"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.830663762477562*^9, 3.830663892440249*^9}, {
   3.830663930073258*^9, 3.830663938139436*^9}, {3.8306648970765142`*^9, 
   3.830664919878819*^9}, 3.8307599795020247`*^9, {3.830766212685865*^9, 
   3.830766216264635*^9}},
 CellLabel->"In[922]:=",
 CellID->1610368862,ExpressionUUID->"515b0bc5-16d2-453c-939d-07e0830c9b71"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"7"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"8"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"7"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"8"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"7"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"8"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"7"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"8"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"7"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"8"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"7"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"8"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"7"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"8"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"7"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"8"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"7"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"8"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"7"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"8"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"7"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"8"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"7"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"8"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"7"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"8"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"7"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"8"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"7"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"8"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]], 
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"6"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"7"}, "RowDefault"]]], 
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"8"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{{3.830664908682658*^9, 3.830664923397258*^9}, 
   3.8306660191044827`*^9, 3.830668195280119*^9, {3.830759962427581*^9, 
   3.830759983019731*^9}, 3.83076622153719*^9, 3.830767584935254*^9, 
   3.830767706208003*^9, 3.8367078541407146`*^9, 3.836708700107545*^9, 
   3.836709017927459*^9, 3.839374605257039*^9, 3.839714167999757*^9, {
   3.84924834191922*^9, 3.849248370871525*^9}, 3.849248815672543*^9, 
   3.8492657694473763`*^9},
 CellLabel->"Out[923]=",
 CellID->987454171,ExpressionUUID->"7bc420c6-66dc-41d6-973d-a207237a5731"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"data", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Measurement", "[", 
       RowBox[{"S", "[", 
        RowBox[{"cc", ",", "3"}], "]"}], "]"}], "@", "new"}], ";", 
     RowBox[{"FromDigits", "[", 
      RowBox[{
       RowBox[{"Readout", "[", 
        RowBox[{"S", "[", 
         RowBox[{"cc", ",", "3"}], "]"}], "]"}], ",", "2"}], "]"}]}], ",", 
    RowBox[{"{", "15", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.83066499300228*^9, 3.830665036086207*^9}, {
  3.83076627471845*^9, 3.830766285317018*^9}, {3.8307663352527437`*^9, 
  3.830766346548559*^9}, {3.8492483480445147`*^9, 3.849248360854895*^9}, {
  3.849248401569713*^9, 3.849248414866177*^9}},
 CellLabel->"In[924]:=",
 CellID->434023012,ExpressionUUID->"f562f3a3-339f-40fc-adf3-8abd809f046c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "4", ",", "0", ",", "8", ",", "4", ",", "4", ",", "4", ",", "8", ",", "4", 
   ",", "4", ",", "0", ",", "0", ",", "12", ",", "0", ",", "4", ",", "8"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.830665029558507*^9, 3.830665036814906*^9}, 
   3.830666030052149*^9, 3.830668198306261*^9, {3.8307599856806297`*^9, 
   3.830760034611866*^9}, 3.8307662240559273`*^9, {3.830766268931307*^9, 
   3.8307662864817677`*^9}, {3.8307663426841707`*^9, 3.8307663477244377`*^9}, 
   3.830767589961178*^9, 3.830767707960389*^9, 3.8367078560554132`*^9, 
   3.836708713951984*^9, 3.836709020220902*^9, 3.8393746071144943`*^9, 
   3.839714168919026*^9, {3.849248344459566*^9, 3.849248370934764*^9}, 
   3.849248418091324*^9, 3.849248818504219*^9, 3.8492657718819323`*^9},
 CellLabel->"Out[924]=",
 CellID->1620907220,ExpressionUUID->"0a056dc0-2fe9-485a-b4fc-f32f2c27a0d3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sec", "=", 
  RowBox[{"Union", "[", 
   RowBox[{"data", "/", "$N"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.830665047281432*^9, 3.830665055254807*^9}, {
  3.8306650909150887`*^9, 3.830665093233302*^9}, {3.8306651247878237`*^9, 
  3.8306651293553667`*^9}, {3.830665163386449*^9, 3.830665223042458*^9}, {
  3.830668200751082*^9, 3.830668201762815*^9}, {3.8307662405981703`*^9, 
  3.8307662625870457`*^9}, {3.830766353362575*^9, 3.830766359511857*^9}},
 CellLabel->"In[925]:=",
 CellID->3682719,ExpressionUUID->"7993f7de-3a0f-4b82-8d1f-795881ea5d4a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   FractionBox["1", "4"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["3", "4"]}], "}"}]], "Output",
 CellChangeTimes->{{3.8307662629673243`*^9, 3.8307662874878187`*^9}, {
   3.830766360055746*^9, 3.830766361558619*^9}, 3.830767591032366*^9, 
   3.830767708960101*^9, 3.83670785624802*^9, 3.836708714988783*^9, 
   3.836709021618482*^9, 3.839374607636669*^9, 3.839714168955517*^9, {
   3.849248363546031*^9, 3.84924837231365*^9}, 3.849248419210726*^9, 
   3.84924881962822*^9, 3.8492657730615053`*^9},
 CellLabel->"Out[925]=",
 CellID->1505040733,ExpressionUUID->"93262854-6322-4269-b4de-43b04469b7af"]
}, Open  ]],

Cell["The period must be 4, which agrees with the true value.", "Text",
 CellChangeTimes->{{3.8306653275722857`*^9, 3.830665342297305*^9}},
 CellID->1528176879,ExpressionUUID->"69e6e1b4-ca5f-4c7f-8cd8-e13789372f6c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Now we consider a full period-finding problem. We consider a four-qubit \
system.\
\>", "MathCaption",
 CellChangeTimes->{{3.830665487945771*^9, 3.830665628238142*^9}, {
  3.830665712035281*^9, 3.8306657488320913`*^9}, {3.830766084498836*^9, 
  3.830766094588037*^9}, {3.836707724512843*^9, 3.836707776980063*^9}, {
  3.836797778943245*^9, 3.836797842678637*^9}},
 CellID->1856381102,ExpressionUUID->"c5b33436-c9d6-453f-ba03-6dfa1c1635fb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$N", "=", 
   RowBox[{"Power", "[", 
    RowBox[{"2", ",", "$n"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.830579151277104*^9, 3.830579156225788*^9}, {
   3.8305791878496857`*^9, 3.8305791934731197`*^9}, {3.830579292592862*^9, 
   3.830579328657638*^9}, {3.830582070414658*^9, 3.83058209994473*^9}, {
   3.830582161887287*^9, 3.830582194690209*^9}, {3.8305822739451857`*^9, 
   3.8305822740118103`*^9}, {3.830582336888534*^9, 3.8305823524681664`*^9}, {
   3.830654303134918*^9, 3.8306543031899157`*^9}, {3.830658324854459*^9, 
   3.8306583398255987`*^9}, {3.830663856710087*^9, 3.830663856788022*^9}, {
   3.8306647731975946`*^9, 3.830664773308934*^9}, {3.830665632276498*^9, 
   3.830665662823287*^9}, {3.830668164685409*^9, 3.830668164999557*^9}, {
   3.8307595746141148`*^9, 3.830759574977209*^9}, 3.8367975397672873`*^9},
 CellLabel->"In[120]:=",
 CellID->1554757698,ExpressionUUID->"5761bce2-d5ff-46eb-9b92-d3d45a3e7494"],

Cell["We define an arbitrary function with period 3.", "Text",
 CellChangeTimes->{{3.830665675170656*^9, 3.83066570239421*^9}, {
  3.8306657672472486`*^9, 3.830665798375084*^9}, {3.836797858878478*^9, 
  3.836797872321681*^9}},
 CellID->231613590,ExpressionUUID->"feebb437-0b4d-428b-ba74-9033ca162bb5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "f", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "0", "]"}], "=", "1"}], ";", 
  RowBox[{
   RowBox[{"f", "[", "1", "]"}], "=", "5"}], ";", 
  RowBox[{
   RowBox[{"f", "[", "2", "]"}], "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "[", "x_", "]"}], ":=", 
  RowBox[{"f", "[", 
   RowBox[{"Mod", "[", 
    RowBox[{"x", ",", "3"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8367975487578783`*^9, 3.836797564504259*^9}, {
  3.836797659855768*^9, 3.836797757130322*^9}, {3.83937551002387*^9, 
  3.839375512339449*^9}, {3.849249628921906*^9, 3.849249635673009*^9}, {
  3.849254963072275*^9, 3.849254963159603*^9}},
 CellLabel->"In[122]:=",
 CellID->1489238766,ExpressionUUID->"ee02c63a-e4ca-4815-925f-f93cafa4368e"],

Cell["\<\
This plot illustrates that the function is indeed periodic with period 3.\
\>", "Text",
 CellChangeTimes->{{3.8367986590668716`*^9, 3.83679869119532*^9}},
 CellID->587524040,ExpressionUUID->"d0937d90-e7ed-4e5a-8b2d-9fbd66c40992"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"f", "[", "k", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", 
       RowBox[{"$N", "-", "1"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<x\>\"", ",", 
      RowBox[{"HoldForm", "@", 
       RowBox[{"f", "[", "x", "]"}]}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8305792020793743`*^9, 3.8305792424200172`*^9}, {
  3.83057947605145*^9, 3.83057955759638*^9}, {3.830582306423663*^9, 
  3.830582314072611*^9}, {3.83058236278535*^9, 3.8305824061293287`*^9}, {
  3.8306533428522243`*^9, 3.830653376116254*^9}, {3.830653415230996*^9, 
  3.8306534418458033`*^9}, {3.8306681725936003`*^9, 3.830668172896776*^9}},
 CellLabel->"In[125]:=",
 CellID->714034377,ExpressionUUID->"2cad7b83-a4d3-4108-8ab0-b6b6507c677f"],

Cell[BoxData[
 GraphicsBox[{{}, {{{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      LineBox[{{0., 1.}, {1., 5.}, {2., 4.}, {3., 1.}, {4., 5.}, {5., 4.}, {
       6., 1.}, {7., 5.}, {8., 4.}, {9., 1.}, {10., 5.}, {11., 4.}, {12., 
       1.}, {13., 5.}, {14., 4.}, {15., 1.}}]}}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], GeometricTransformationBox[InsetBox[
       FormBox[
        StyleBox[
         GraphicsBox[
          {EdgeForm[None], DiskBox[{0, 0}]},
          AxesStyle->Automatic,
          FrameStyle->Automatic,
          ImageSize->250,
          PlotRangePadding->Scaled[0.025]],
         StripOnInput->False,
         GraphicsBoxOptions->{DefaultBaseStyle->Directive[
           PointSize[0.012833333333333334`], 
           RGBColor[0.368417, 0.506779, 0.709798], 
           AbsoluteThickness[1.6]]}],
        TraditionalForm], {0., 0.}, Automatic, Offset[6.272]], {{{0., 1.}}, {{
      1., 5.}}, {{2., 4.}}, {{3., 1.}}, {{4., 5.}}, {{5., 4.}}, {{6., 1.}}, {{
      7., 5.}}, {{8., 4.}}, {{9., 1.}}, {{10., 5.}}, {{11., 4.}}, {{12., 
      1.}}, {{13., 5.}}, {{14., 4.}}, {{15., 1.}}}]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0.8947368421052653},
  AxesStyle->Automatic,
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{
     FormBox[
      TagBox[
       RowBox[{"f", "(", "x", ")"}], HoldForm], TraditionalForm], None}, {
     FormBox["\"x\"", TraditionalForm], None}},
  FrameStyle->Automatic,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->250,
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 15.}, {0.8947368421052653, 5.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {
     Scaled[0.025], 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.836798640633443*^9, 3.836798646711256*^9}, {
   3.836798677377297*^9, 3.836798692627976*^9}, 3.839374612920556*^9, 
   3.839714172866433*^9, {3.849248424784881*^9, 3.8492484452734947`*^9}, 
   3.849248824866293*^9, 3.8492490982853413`*^9, {3.849249632292264*^9, 
   3.849249637224853*^9}, 3.8492497045855017`*^9, 3.8492549648250427`*^9, 
   3.8492657788644457`*^9, 3.8493074763943987`*^9},
 CellLabel->"Out[125]=",
 CellID->1194741420,ExpressionUUID->"3296713b-6c13-4433-b0dc-b6f507a683ca"]
}, Open  ]],

Cell["\<\
The classical oracle (in the binary form) corresponding to the function f \
(expressed in usual integers).\
\>", "Text",
 CellChangeTimes->{{3.8306537133410873`*^9, 3.830653758597693*^9}},
 CellID->1307310079,ExpressionUUID->"eae0e54f-dfb3-4720-bf76-125e85a78b6d"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "g", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "[", "x__", "]"}], ":=", 
  RowBox[{"IntegerDigits", "[", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"FromDigits", "[", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", "2"}], "]"}], "]"}], ",", "2", ",", 
    "$n"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.830653474965775*^9, 3.830653489870476*^9}, {
  3.830653552665742*^9, 3.8306535836013823`*^9}, {3.836797908771595*^9, 
  3.8367979093438673`*^9}, {3.83679795379211*^9, 3.8367979542852583`*^9}, {
  3.836798032111224*^9, 3.836798032256085*^9}, {3.839375522960164*^9, 
  3.839375524275388*^9}},
 CellLabel->"In[126]:=",
 CellID->1055305296,ExpressionUUID->"ddc86537-b3d8-4c45-a45b-c0dbf058d525"],

Cell["Here is the quantum circuit model of the algorithm.", "Text",
 CellChangeTimes->{{3.830665807790572*^9, 3.830665824192319*^9}},
 CellID->448669299,ExpressionUUID->"faa94551-e3ce-481d-9eed-18fc6055361c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"Range", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"$n", "+", "1"}], ",", 
     RowBox[{"$n", "+", "$n"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qc0", "=", 
   RowBox[{"QuantumCircuit", "[", 
    RowBox[{
     RowBox[{"LogicalForm", "[", 
      RowBox[{
       RowBox[{"Ket", "[", "]"}], ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"S", "@", "cc"}], ",", 
         RowBox[{"S", "@", "tt"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"cc", ",", "6"}], "]"}], ",", 
     RowBox[{"Oracle", "[", 
      RowBox[{"g", ",", 
       RowBox[{"S", "@", "cc"}], ",", 
       RowBox[{"S", "@", "tt"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"QFT", "[", 
      RowBox[{
       RowBox[{"S", "@", "cc"}], ",", 
       RowBox[{"N", "->", "True"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"qc0", ",", 
    RowBox[{"Measurement", "@", 
     RowBox[{"S", "[", 
      RowBox[{"cc", ",", "3"}], "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.830653649063695*^9, 3.830653708774403*^9}, {
   3.830653765860044*^9, 3.830653853951942*^9}, {3.830655137056566*^9, 
   3.830655168104241*^9}, {3.830655219841648*^9, 3.83065524686158*^9}, {
   3.830656004274881*^9, 3.830656026683696*^9}, {3.8306639050076733`*^9, 
   3.830663913771208*^9}, {3.83066485289002*^9, 3.830664877817803*^9}, {
   3.830766126149666*^9, 3.8307661630039663`*^9}, {3.8492484554682827`*^9, 
   3.849248461441328*^9}, {3.8492657914213257`*^9, 3.849265834933049*^9}, {
   3.849307481138453*^9, 3.8493074885615883`*^9}, 3.856390580105711*^9},
 CellID->969823676,ExpressionUUID->"cdc7edeb-bbe4-400d-bfaa-371b3574f628"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], 
    LineBox[{{{4, -1}, {5, -1}}, {{4, -2}, {5, -2}}, {{4, -3}, {5, -3}}, {{
     4, -4}, {5, -4}}}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
    0, -4}, {4, -4}}, {{0, -5}, {5, -5}}, {{0, -6}, {5, -6}}, {{0, -7}, {
    5, -7}}, {{0, -8}, {5, -8}}}], {InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -5}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -6}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -7}, ImageScaled[{1, Rational[1, 2]}]], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.06400000000000002],
      FontWeight->"Light"], {-0.1, -8}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -2}, {2, -3}, {2, -4}, {2, -5}, {2, -6}, {2, -7}, {
     2, -8}}], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     FilledCurveBox[{
      BezierCurve[{{2.4, -1}, {2.4, -0.47439999999999993`}, {
         1.6, -0.47439999999999993`}, {1.6, -1}}], 
       Line[{{1.6, -1}, {1.6, -4}}], 
       BezierCurve[{{1.6, -4.5256}, {2.4, -4.5256}, {2.4, -4}}]}]}, InsetBox[
     StyleBox["\<\"f\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{2, Rational[-5, 2]}, {2, -2.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]], {
     CircleBox[{2, -5}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -5}, {2.2666666666666666`, -5}}, {{
        2, -5.266666666666667}, {2, -4.733333333333333}}}]}, {
     CircleBox[{2, -6}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -6}, {2.2666666666666666`, -6}}, {{
        2, -6.266666666666667}, {2, -5.733333333333333}}}]}, {
     CircleBox[{2, -7}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -7}, {2.2666666666666666`, -7}}, {{
        2, -7.266666666666667}, {2, -6.733333333333333}}}]}, {
     CircleBox[{2, -8}, 0.26666666666666666], 
     LineBox[{{{1.7333333333333334`, -8}, {2.2666666666666666`, -8}}, {{
        2, -8.266666666666667}, {2, -7.733333333333333}}}]}}, {
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -4.4}, {3.4, -0.6}]}, InsetBox[
     StyleBox[
      RotationBox["\<\"QFT\"\>",
       BoxRotation->1.5707963267948966`],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{3, Rational[-5, 2]}, {3, -2.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, 
     CircleBox[{4, -1.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -1.2}, {4.24, -0.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, 
     CircleBox[{4, -2.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -2.2}, {4.24, -1.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, 
     CircleBox[{4, -3.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -3.2}, {4.24, -2.76}}]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, 
     CircleBox[{4, -4.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{4, -4.2}, {4.24, -3.76}}]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->226.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.8307661634718103`*^9, 3.830766166144909*^9}, 
   3.830767574152717*^9, 3.836707822733473*^9, 3.836707898045925*^9, 
   3.836797924301072*^9, 3.836797957926812*^9, 3.8367980424893837`*^9, 
   3.8367982261683903`*^9, 3.836798698126116*^9, 3.8393746165210457`*^9, 
   3.8397141753964767`*^9, {3.849248447913748*^9, 3.849248467107551*^9}, {
   3.849248568574067*^9, 3.849248606506909*^9}, 3.849248829633893*^9, 
   3.849249101163711*^9, 3.8492496417434597`*^9, 3.849249712819109*^9, 
   3.849254969899579*^9, {3.849265781987307*^9, 3.8492658353808928`*^9}, {
   3.849307483437014*^9, 3.849307489027338*^9}},
 CellLabel->"Out[135]=",
 CellID->930788634,ExpressionUUID->"207b5d5c-61a1-4487-bfed-ac94272e823b"]
}, Open  ]],

Cell["This is a full run of the above quantum circuit model.", "Text",
 CellChangeTimes->{{3.836798725729127*^9, 3.836798769900797*^9}},
 CellID->1586572829,ExpressionUUID->"d12a3e76-505f-449d-8bdf-16b74d3e30f8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"out", "=", 
    RowBox[{"ExpressionFor", "[", "qc", "]"}]}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"result", "=", 
  RowBox[{"Readout", "@", 
   RowBox[{"S", "[", 
    RowBox[{"cc", ",", "3"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.830663762477562*^9, 3.830663892440249*^9}, {
   3.830663930073258*^9, 3.830663938139436*^9}, {3.830665863273905*^9, 
   3.830665864094347*^9}, {3.830759937167453*^9, 3.83075994785098*^9}, {
   3.8307661830144157`*^9, 3.830766188360477*^9}, {3.836798705134177*^9, 
   3.836798714931476*^9}, {3.849248477055747*^9, 3.8492484845582533`*^9}, {
   3.849248620395564*^9, 3.849248625614045*^9}, {3.849248884051647*^9, 
   3.849248886588518*^9}, 3.849254997149453*^9},
 CellLabel->"In[136]:=",
 CellID->493738057,ExpressionUUID->"3101c1c5-55b6-42e8-a948-cc4cc1b5410d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.036626`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.830663871419807*^9, 3.830663955239018*^9}, 
   3.830664782486376*^9, 3.8306648833457127`*^9, {3.830665830198003*^9, 
   3.83066586726429*^9}, 3.8306659069813843`*^9, 3.830668183740142*^9, 
   3.830759951531209*^9, 3.830766192235608*^9, 3.830767578924375*^9, 
   3.830767637691473*^9, {3.83670782674755*^9, 3.8367078365116796`*^9}, {
   3.836707867649946*^9, 3.836707904826689*^9}, 3.836707958265277*^9, {
   3.8367979415444727`*^9, 3.8367979641559553`*^9}, 3.836798048186554*^9, 
   3.8367982345089293`*^9, {3.836798711999545*^9, 3.836798719587501*^9}, 
   3.836798778305167*^9, 3.839374625497678*^9, 3.839714183717925*^9, {
   3.849248559675305*^9, 3.849248575531807*^9}, 3.849248731126173*^9, {
   3.849248875684751*^9, 3.849248894303688*^9}, 3.8492496895538473`*^9, {
   3.849255002866922*^9, 3.849255008353324*^9}, {3.8492658405878963`*^9, 
   3.849265852463552*^9}, 3.849307494592944*^9},
 CellLabel->"Out[136]=",
 CellID->1438319851,ExpressionUUID->"a0114328-3c93-4fec-9200-ebe28527ab05"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{{3.830663871419807*^9, 3.830663955239018*^9}, 
   3.830664782486376*^9, 3.8306648833457127`*^9, {3.830665830198003*^9, 
   3.83066586726429*^9}, 3.8306659069813843`*^9, 3.830668183740142*^9, 
   3.830759951531209*^9, 3.830766192235608*^9, 3.830767578924375*^9, 
   3.830767637691473*^9, {3.83670782674755*^9, 3.8367078365116796`*^9}, {
   3.836707867649946*^9, 3.836707904826689*^9}, 3.836707958265277*^9, {
   3.8367979415444727`*^9, 3.8367979641559553`*^9}, 3.836798048186554*^9, 
   3.8367982345089293`*^9, {3.836798711999545*^9, 3.836798719587501*^9}, 
   3.836798778305167*^9, 3.839374625497678*^9, 3.839714183717925*^9, {
   3.849248559675305*^9, 3.849248575531807*^9}, 3.849248731126173*^9, {
   3.849248875684751*^9, 3.849248894303688*^9}, 3.8492496895538473`*^9, {
   3.849255002866922*^9, 3.849255008353324*^9}, {3.8492658405878963`*^9, 
   3.849265852463552*^9}, 3.849307494593988*^9},
 CellLabel->"Out[137]=",
 CellID->1765805125,ExpressionUUID->"e6af9139-17b4-43ee-848d-53b747e11703"]
}, Open  ]],

Cell["\<\
In order to check more random results, it is more efficient to first \
calculate the output state right before the measurement.\
\>", "Text",
 CellChangeTimes->{{3.83679879349194*^9, 3.8367988535646963`*^9}},
 CellID->1276748348,ExpressionUUID->"4ea384ab-fa2c-4602-a6db-2bc6dbd8b072"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"new", "=", 
    RowBox[{"ExpressionFor", "[", "qc0", "]"}]}], ";"}], "]"}]], "Input",
 CellChangeTimes->{{3.830663762477562*^9, 3.830663892440249*^9}, {
   3.830663930073258*^9, 3.830663938139436*^9}, {3.8306648970765142`*^9, 
   3.830664919878819*^9}, 3.8307599795020247`*^9, {3.830766212685865*^9, 
   3.830766216264635*^9}, {3.836798333213977*^9, 3.836798369370235*^9}, {
   3.836798858585292*^9, 3.836798860404882*^9}},
 CellLabel->"In[138]:=",
 CellID->863398109,ExpressionUUID->"908f099f-17ed-492b-86ce-3f78f3fa4fa3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.053779`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.8367988638330517`*^9, 3.83937462871163*^9, 
  3.839714186953917*^9, 3.849255011986156*^9, 3.849265856499839*^9, 
  3.849307500608292*^9},
 CellLabel->"Out[138]=",
 CellID->672623044,ExpressionUUID->"e742ff3f-00be-46e3-88da-732f4f44d6bc"]
}, Open  ]],

Cell["\<\
From the above output state, we perform measurements (as many times as we \
like) to get random results.\
\>", "Text",
 CellChangeTimes->{{3.836798868020276*^9, 3.836798904153769*^9}},
 CellID->1629395466,ExpressionUUID->"f58baee8-4ae4-44a6-a8fc-40f2aab5891b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"Measurement", "[", 
     RowBox[{"S", "[", 
      RowBox[{"cc", ",", "3"}], "]"}], "]"}], "@", 
    RowBox[{"N", "[", "new", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"phi", "=", 
  RowBox[{
   RowBox[{"FromDigits", "[", 
    RowBox[{
     RowBox[{"Readout", "@", 
      RowBox[{"S", "[", 
       RowBox[{"cc", ",", "3"}], "]"}]}], ",", "2"}], "]"}], "/", 
   "$N"}]}]}], "Input",
 CellChangeTimes->{{3.830663762477562*^9, 3.830663892440249*^9}, {
   3.830663930073258*^9, 3.830663938139436*^9}, {3.8306648970765142`*^9, 
   3.830664919878819*^9}, 3.8307599795020247`*^9, {3.830766212685865*^9, 
   3.830766216264635*^9}, {3.836798333213977*^9, 3.8367984183609056`*^9}, {
   3.836798450400075*^9, 3.836798460333316*^9}, {3.849255024712586*^9, 
   3.849255055670166*^9}, {3.849265900295257*^9, 3.849265902094018*^9}},
 CellLabel->"In[145]:=",
 CellID->585015184,ExpressionUUID->"266f7d0b-d22b-4931-870f-d618b9e6d76f"],

Cell[BoxData[
 FractionBox["5", "16"]], "Output",
 CellChangeTimes->{{3.836798367298564*^9, 3.8367983836014557`*^9}, 
   3.836798433856642*^9, {3.8367984643410378`*^9, 3.8367985165830193`*^9}, {
   3.836798914729272*^9, 3.8367989178333273`*^9}, {3.839374634652339*^9, 
   3.839374649508629*^9}, 3.839714190494913*^9, 3.849255017783959*^9, 
   3.849255070079131*^9, {3.849265893953936*^9, 3.849265902631701*^9}, {
   3.849307501318387*^9, 3.8493075092181263`*^9}},
 CellLabel->"Out[146]=",
 CellID->2023029166,ExpressionUUID->"955781e8-07c1-4f71-b205-bdd6d0a8b787"]
}, Open  ]],

Cell["\<\
From the above random result, we determine the period of the function by \
utilizing the continued fraction representation of the estimated phase.\
\>", "Text",
 CellChangeTimes->{{3.8367989208250647`*^9, 3.836798972347999*^9}},
 CellID->209396844,ExpressionUUID->"1fb39b84-e162-4908-9ca7-de4723d05a7c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"cnt", "=", 
  RowBox[{"ContinuedFraction", "[", "phi", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"candidates", "=", 
  RowBox[{"Convergents", "[", "cnt", "]"}]}]}], "Input",
 CellChangeTimes->{{3.836798476252532*^9, 3.836798483946494*^9}, {
  3.836798548879678*^9, 3.836798576687022*^9}},
 CellLabel->"In[147]:=",
 CellID->716244675,ExpressionUUID->"021bf6a6-3575-4ec5-ae3b-9c722fc53421"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "3", ",", "5"}], "}"}]], "Output",
 CellChangeTimes->{{3.8367984846311903`*^9, 3.836798517799758*^9}, {
   3.836798552945032*^9, 3.8367985769495573`*^9}, 3.836798973770368*^9, {
   3.839374635879034*^9, 3.839374651508222*^9}, 3.839714190527226*^9, 
   3.849255073038834*^9, 3.849265905199051*^9, {3.849307503089489*^9, 
   3.849307510811722*^9}},
 CellLabel->"Out[147]=",
 CellID->2112217151,ExpressionUUID->"85385aaf-ffd5-4bf8-a664-9c7964a1e929"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   FractionBox["1", "3"], ",", 
   FractionBox["5", "16"]}], "}"}]], "Output",
 CellChangeTimes->{{3.8367984846311903`*^9, 3.836798517799758*^9}, {
   3.836798552945032*^9, 3.8367985769495573`*^9}, 3.836798973770368*^9, {
   3.839374635879034*^9, 3.839374651508222*^9}, 3.839714190527226*^9, 
   3.849255073038834*^9, 3.849265905199051*^9, {3.849307503089489*^9, 
   3.849307510814098*^9}},
 CellLabel->"Out[148]=",
 CellID->2128971947,ExpressionUUID->"2ae797c5-9dd5-4550-98fc-d71128e5eedd"]
}, Open  ]],

Cell["\<\
From the above convergents, we have two candidates 3 (and its multiples 6, 9, \
12, 15 are also candidates) and 16. Evaluation of the function for some \
arguments confirms that 3 is the period of the function.\
\>", "Text",
 CellChangeTimes->{{3.8367989823037767`*^9, 3.836799129042099*^9}},
 CellID->638836156,ExpressionUUID->"7449c919-ab81-4359-a364-4e7da88ccf4f"]
}, Open  ]]
}, Open  ]],

Cell["The Order-Finding Algorithm", "Subsection",
 CellChangeTimes->{{3.830665387734605*^9, 3.830665394473123*^9}, {
  3.830666195989367*^9, 3.83066620166975*^9}},
 CellTags->"Section13",
 CellID->2091554196,ExpressionUUID->"e287b045-1d6a-48a7-9974-1db8f8a346e8"],

Cell["Quantum Factorization Algorithm", "Subsection",
 CellChangeTimes->{{3.8368168100100307`*^9, 3.836816814486772*^9}, {
   3.836816860284185*^9, 3.836816865166461*^9}, 3.8370340261931953`*^9},
 CellTags->"Section16",
 CellID->113725620,ExpressionUUID->"3205a79a-5b6b-46b6-ba07-b98f7be9455b"],

Cell[CellGroupData[{

Cell["Quantum Search Algorithm", "Subsection",
 CellChangeTimes->{{3.836816853567988*^9, 3.8368168577301903`*^9}},
 CellTags->"Section17",
 CellID->1872307380,ExpressionUUID->"ddd4ceb2-38d0-4e70-996c-324ca3967159"],

Cell[CellGroupData[{

Cell["\<\
Here is a quantum circuit model for Grover\[CloseCurlyQuote]s diffusion \
operator.\
\>", "MathCaption",
 CellChangeTimes->{{3.836817055519401*^9, 3.8368170919452753`*^9}},
 CellID->36883450,ExpressionUUID->"4ff4e37d-19e9-41bb-bfc9-6c40ea0985b2"],

Cell[TextData[{
 "We first implement ",
 Cell[BoxData[
  RowBox[{"(", 
   RowBox[{"1", "-", 
    RowBox[{"2", 
     TemplateBox[{"0"},
      "Ket"], 
     TemplateBox[{"0"},
      "Bra"]}]}], ")"}]],ExpressionUUID->
  "46bb9c91-c211-4554-b2f8-73dcfe05c543"],
 "."
}], "Text",
 CellChangeTimes->{{3.836817248347658*^9, 3.83681733261902*^9}},
 CellID->2080521275,ExpressionUUID->"6b3e92f0-394c-4fc3-9ac5-8d8d6f31efb0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jj", "=", 
   RowBox[{"Range", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ss", "=", 
   RowBox[{"S", "[", 
    RowBox[{"jj", ",", "None"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cz", "=", 
   RowBox[{"CZ", "@@@", 
    RowBox[{"Subsets", "[", 
     RowBox[{"ss", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cz", "=", 
   RowBox[{"Successive", "[", 
    RowBox[{"CZ", ",", "ss"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cz", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"CZ", "[", 
      RowBox[{
       RowBox[{"S", "[", "1", "]"}], ",", "#"}], "]"}], "&"}], "/@", 
    RowBox[{"Rest", "@", "ss"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"jj", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"Most", "@", "jj"}], "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"$n", ",", "3"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"jj", ",", "1"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.836814657174183*^9, 3.836814697941927*^9}, {
  3.836814781606224*^9, 3.836814876461711*^9}, {3.8368149111221952`*^9, 
  3.836815101700732*^9}, {3.836815208864813*^9, 3.836815232925209*^9}, {
  3.836816076956949*^9, 3.836816112032034*^9}, {3.836816150697929*^9, 
  3.8368161883151617`*^9}, {3.836816433568364*^9, 3.8368164784752502`*^9}, {
  3.836816643922119*^9, 3.836816644011882*^9}, {3.836816741962318*^9, 
  3.8368167436827993`*^9}, {3.836817106942017*^9, 3.83681710705369*^9}},
 CellLabel->"In[963]:=",
 CellID->1584251975,ExpressionUUID->"4d8b2e7e-44c8-4f2e-aa83-b1f3364499ce"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{2, -1}, {2, -2}, {2, -3}}], DiskBox[{2, -1}, 0.09], 
    DiskBox[{2, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1.6, -3.4}, {2.4, -2.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.1],
      FontWeight->"Light",
      FontSlant->Italic], {2, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->190.79999999999998`,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.836816078050955*^9, 3.83681611668216*^9}, {
   3.836816166765177*^9, 3.836816188654504*^9}, {3.8368164440003023`*^9, 
   3.8368164789183893`*^9}, 3.836816539329916*^9, 3.8368166444442987`*^9, 
   3.836816744064302*^9, {3.836817107434111*^9, 3.836817119817541*^9}, {
   3.836817339013856*^9, 3.8368173525354958`*^9}, 3.8393746552449503`*^9, 
   3.839714196164981*^9, 3.8492551166136303`*^9, 3.849265917353924*^9},
 CellLabel->"Out[969]=",
 CellID->459030869,ExpressionUUID->"72e17df4-5d19-4cbd-95f1-838bdd9f1ed5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "[", "jj", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qc", "**", "bs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"bs", "->", "out"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.8368147016665277`*^9, 3.836814730846468*^9}},
 CellLabel->"In[970]:=",
 CellID->1402183775,ExpressionUUID->"449a7549-440c-4372-8e88-bcdc9f6e5ebb"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       RowBox[{"-", 
        TemplateBox[{
          TagBox[
           TemplateBox[{
             SubscriptBox["0", 
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]]], 
             SubscriptBox["0", 
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]]], 
             SubscriptBox["0", 
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
           DisplayForm]},
         "Ket"]}]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["0", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]},
     {
      RowBox[{
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"], "\[Rule]", 
       TemplateBox[{
         TagBox[
          TemplateBox[{
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]]], 
            SubscriptBox["1", 
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], 
          DisplayForm]},
        "Ket"]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.836817108424156*^9, 3.83681711188349*^9}, 
   3.836817165611539*^9, 3.836817353321349*^9, 3.839374657108906*^9, 
   3.8397141974727917`*^9, 3.849255117586196*^9, 3.849265918696069*^9},
 CellLabel->"Out[972]//TableForm=",
 CellID->2070254441,ExpressionUUID->"9777293c-4664-4e08-a45d-0df3cf54067b"]
}, Open  ]],

Cell[TextData[{
 "This is Grover\[CloseCurlyQuote]s diffusion operator (up to an irrelevant \
global phase factor of ",
 StyleBox["-1", "Input"],
 ")."
}], "Text",
 CellChangeTimes->{{3.8368173886291437`*^9, 3.836817424582707*^9}},
 CellID->1841454813,ExpressionUUID->"a0c586a4-810f-4b17-b276-1e322679d4ac"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"jj", ",", "6"}], "]"}], ",", "qc", ",", 
    RowBox[{"S", "[", 
     RowBox[{"jj", ",", "6"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.836817362321454*^9, 3.836817380417324*^9}},
 CellLabel->"In[973]:=",
 CellID->1289821143,ExpressionUUID->"98e7694b-571d-4781-a3b1-65603ec321fd"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}}], {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {2, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -3.4}, {2.4, -2.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {2, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{3, -1}, {3, -2}, {3, -3}}], DiskBox[{3, -1}, 0.09], 
    DiskBox[{3, -2}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.06666666666666667],
      FontWeight->"Light",
      FontSlant->Italic], {3, -3}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {4, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {4, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {4, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {5, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {5, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {5, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
  ImageSize->262.8,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.836817381009779*^9, 3.8368173832671957`*^9}, 
   3.836817430551097*^9, 3.839374658556054*^9, 3.839714198921276*^9, 
   3.849255118871374*^9, 3.8492659204953623`*^9},
 CellLabel->"Out[973]=",
 CellID->2015595243,ExpressionUUID->"6f8457a9-b796-441e-9719-46fcbc76a649"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Here we demonstrate the quantum search algorithm.", "MathCaption",
 CellChangeTimes->{{3.837492516964958*^9, 3.837492557361765*^9}},
 CellID->406638749,ExpressionUUID->"324edde9-0dfa-4937-85fa-4ed77ffb8bad"],

Cell["\<\
We work with 4 (system) qubits and one ancillary qubit. The ancillary qubit \
is for the quantum oracle.\
\>", "Text",
 CellChangeTimes->{{3.8374947395910673`*^9, 3.837494786480091*^9}},
 CellID->994254636,ExpressionUUID->"77b08221-606c-4755-8e91-52cf82db8ca6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"$n", "-", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", "$n"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jj", "=", 
   RowBox[{"Range", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{"$n", "+", "1"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.83749256015464*^9, 3.837492596341297*^9}, {
  3.8374947022322903`*^9, 3.837494737509346*^9}},
 CellLabel->"In[974]:=",
 CellID->215354860,ExpressionUUID->"cbc9caeb-c7d6-4198-a1b7-68d81abc4046"],

Cell[TextData[{
 "Here we specify a classical oracle. The function ",
 StyleBox["f", "Input"],
 " is more human readable. The function ",
 StyleBox["g", "Input"],
 " will be used in the actual quantum oracle."
}], "Text",
 CellChangeTimes->{{3.8374947905640574`*^9, 3.837494858626302*^9}},
 CellID->1204678952,ExpressionUUID->"edf77351-4b4e-4fe3-81bb-ab61bba93e77"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "f", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "3", "]"}], "=", "1"}], ";", 
  RowBox[{
   RowBox[{"f", "[", "_", "]"}], "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "[", "x__", "]"}], ":=", 
  RowBox[{"f", "@", 
   RowBox[{"FromDigits", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", "2"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.837492614836894*^9, 3.837492615015562*^9}, {
  3.8374926531293373`*^9, 3.837492711052444*^9}, {3.8393753187370043`*^9, 
  3.839375323616893*^9}},
 CellLabel->"In[979]:=",
 CellID->867337255,ExpressionUUID->"c5d31846-6e4b-41da-bef5-033630339b2e"],

Cell["The ancilla qubit is prepared in the following state.", "Text",
 CellChangeTimes->{{3.837492868349494*^9, 3.8374928922888517`*^9}},
 CellID->489040982,ExpressionUUID->"5d45f090-3d8e-423b-ab2e-2cc755f4e3c4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"ProductState", "[", 
    RowBox[{
     RowBox[{"S", "[", "aa", "]"}], "->", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "1"}]}], "}"}], "/", 
      RowBox[{"Sqrt", "[", "2", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"in", "//", "Elaborate"}], "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.837492805144306*^9, 3.8374928610593023`*^9}, {
  3.837493050543415*^9, 3.837493053276722*^9}, {3.8374932533690577`*^9, 
  3.837493256979186*^9}},
 CellLabel->"In[982]:=",
 CellID->275964604,ExpressionUUID->"eeffc507-834c-4d4b-acee-b4faf8355249"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["0", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   SqrtBox["2"]], "-", 
  FractionBox[
   TemplateBox[{
     TagBox[
      TemplateBox[{
        SubscriptBox["1", 
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
    "Ket"], 
   SqrtBox["2"]]}]], "Output",
 CellChangeTimes->{{3.837492827918107*^9, 3.837492893472851*^9}, {
   3.8374930393275843`*^9, 3.837493061701779*^9}, {3.837493257368308*^9, 
   3.837493269927703*^9}, 3.837493800796294*^9, 3.837494868022626*^9, 
   3.839374663650646*^9, 3.83937475213155*^9, 3.839375325278007*^9, 
   3.839375547035619*^9, 3.839714203795388*^9, 3.849255123526663*^9, 
   3.849265925516924*^9},
 CellLabel->"Out[983]=",
 CellID->1156987826,ExpressionUUID->"10675593-9188-4f7c-b7eb-fe29df5965de"]
}, Open  ]],

Cell["This is a quantum circuit for the Grover rotation.", "Text",
 CellChangeTimes->{{3.837494871169742*^9, 3.83749488690825*^9}},
 CellID->1882657478,ExpressionUUID->"0df73a9b-58df-452b-8d75-93129dddf77a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"grv", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Oracle", "[", 
     RowBox[{"g", ",", 
      RowBox[{"S", "[", "jj", "]"}], ",", 
      RowBox[{"S", "[", "aa", "]"}]}], "]"}], ",", "\"\<Separator\>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"jj", ",", "6"}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"jj", ",", "1"}], "]"}], ",", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{"S", "[", "cc", "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"tt", ",", "3"}], "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"jj", ",", "1"}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"jj", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", 
     RowBox[{"{", 
      RowBox[{"0.5", ",", "0.2"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.837492600663477*^9, 3.837492610414283*^9}, {
   3.837492726380577*^9, 3.837492799938766*^9}, {3.837492896868479*^9, 
   3.837492946435594*^9}, 3.837492986700235*^9, {3.837493107513118*^9, 
   3.837493109909417*^9}},
 CellLabel->"In[984]:=",
 CellID->254452149,ExpressionUUID->"9b37f1b1-3647-4440-a2b7-cbb193eb3b55"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}, {{0, -3}, {8, -3}}, {{
    0, -4}, {8, -4}}, {{0, -5}, {8, -5}}}], {
    LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}, {1, -5}}], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     FilledCurveBox[{
      BezierCurve[{{1.4, -1}, {1.4, -0.47439999999999993`}, {
         0.6, -0.47439999999999993`}, {0.6, -1}}], 
       Line[{{0.6, -1}, {0.6, -4}}], 
       BezierCurve[{{0.6, -4.5256}, {1.4, -4.5256}, {1.4, -4}}]}]}, InsetBox[
     StyleBox["\<\"f\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{1, Rational[-5, 2]}, {1, -2.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]], {
     CircleBox[{1, -5}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -5}, {1.2666666666666666`, -5}}, {{
        1, -5.266666666666667}, {1, -4.733333333333333}}}]}}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{2, Rational[-11, 2]}, {2, Rational[-1, 2]}}, {{
       2, -5.5}, {2, -0.5}}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{5, -1}, {5, -2}, {5, -3}, {5, -4}}], DiskBox[{5, -1}, 0.09], 
    DiskBox[{5, -2}, 0.09], DiskBox[{5, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], {5, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.6, -1.4}, {6.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {6, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {6, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {6, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.6, -4.4}, {6.4, -3.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {6, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {7, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {7, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {7, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {7, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{18., 7.2}, {5, 5}},
  ImageSize->313.2,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{
  3.8374927436430483`*^9, 3.837492787506915*^9, {3.837492894880632*^9, 
   3.837492950857358*^9}, {3.837492987581603*^9, 3.837492989635*^9}, {
   3.8374930631306*^9, 3.837493110596478*^9}, {3.837493261644256*^9, 
   3.8374932721809998`*^9}, 3.837493807841728*^9, 3.837493885223947*^9, {
   3.837494888262363*^9, 3.837494891934276*^9}, 3.8393746650745707`*^9, 
   3.8393747533285513`*^9, 3.839375326438624*^9, 3.839375548050434*^9, 
   3.839714205204398*^9, 3.849255129221703*^9, 3.849265926865677*^9},
 CellLabel->"Out[984]=",
 CellID->1714799261,ExpressionUUID->"f8ae321a-728b-4ff2-83a6-836dcc8ef926"]
}, Open  ]],

Cell["We apply the Grover rotation once on the input state.", "Text",
 CellChangeTimes->{{3.8374948965274076`*^9, 3.837494931187827*^9}},
 CellID->32473192,ExpressionUUID->"4ad6b414-34c7-4662-af43-19097a227be5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"S", "[", "jj", "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"in", ",", 
      RowBox[{
      "\"\<Label\>\"", "->", 
       "\"\<\!\(\*TemplateBox[{\"-\"},\"Ket\"]\)\>\""}]}], "}"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"jj", ",", "6"}], "]"}], ",", "\"\<Separator\>\"", ",", "grv"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.837493112712563*^9, 3.83749323711259*^9}, {
   3.8374932941837063`*^9, 3.837493344831046*^9}, {3.837493381371217*^9, 
   3.8374933933458433`*^9}, {3.837493445002882*^9, 3.837493451830474*^9}, 
   3.837493907625808*^9},
 CellLabel->"In[985]:=",
 CellID->1257594333,ExpressionUUID->"da69d5cc-b5ab-4d62-93f9-2b76fbb9cfe0"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {10, -1}}, {{0, -2}, {10, -2}}, {{0, -3}, {10, -3}}, {{
    0, -4}, {10, -4}}, {{0, -5}, {10, -5}}}], {{InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.03200000000000001],
       FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.03200000000000001],
       FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.03200000000000001],
       FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, Rational[1, 2]}]], 
     InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.03200000000000001],
       FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, Rational[1, 2]}]]}, 
    InsetBox[
     StyleBox["\<\"\\!\\(\\*TemplateBox[{\\\"-\\\"},\\\"Ket\\\"]\\)\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.03200000000000001],
      FontWeight->"Light"], {-0.1, -5}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{2, Rational[-11, 2]}, {2, Rational[-1, 2]}}, {{
       2, -5.5}, {2, -0.5}}]]}, {
    LineBox[{{3, -1}, {3, -2}, {3, -3}, {3, -4}, {3, -5}}], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     FilledCurveBox[{
      BezierCurve[{{3.4, -1}, {3.4, -0.47439999999999993`}, {
         2.6, -0.47439999999999993`}, {2.6, -1}}], 
       Line[{{2.6, -1}, {2.6, -4}}], 
       BezierCurve[{{2.6, -4.5256}, {3.4, -4.5256}, {3.4, -4}}]}]}, InsetBox[
     StyleBox["\<\"f\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{3, Rational[-5, 2]}, {3, -2.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]], {
     CircleBox[{3, -5}, 0.26666666666666666], 
     LineBox[{{{2.7333333333333334`, -5}, {3.2666666666666666`, -5}}, {{
        3, -5.266666666666667}, {3, -4.733333333333333}}}]}}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{4, Rational[-11, 2]}, {4, Rational[-1, 2]}}, {{
       4, -5.5}, {4, -0.5}}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.6, -1.4}, {6.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {6, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {6, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {6, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.6, -4.4}, {6.4, -3.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {6, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{7, -1}, {7, -2}, {7, -3}, {7, -4}}], DiskBox[{7, -1}, 0.09], 
    DiskBox[{7, -2}, 0.09], DiskBox[{7, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Italic], {7, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{7.6, -1.4}, {8.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {8, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{7.6, -2.4}, {8.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {8, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {8, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{7.6, -4.4}, {8.4, -3.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {8, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.6, -1.4}, {9.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {9, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.6, -2.4}, {9.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {9, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {9, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.6, -4.4}, {9.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {9, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{18., 7.2}, {5, 5}},
  ImageSize->385.2,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.837493177970471*^9, 3.837493199391754*^9}, {
   3.837493237481812*^9, 3.8374932390240507`*^9}, {3.837493307443159*^9, 
   3.837493402908443*^9}, {3.837493446043805*^9, 3.8374934530285997`*^9}, 
   3.83749381029557*^9, {3.8374938860389137`*^9, 3.837493908216215*^9}, 
   3.837494932942889*^9, 3.839374666528578*^9, 3.83937475495933*^9, 
   3.8393753277395163`*^9, 3.8393755491795397`*^9, 3.839714206655562*^9, 
   3.849255130973023*^9, 3.849265928431271*^9},
 CellLabel->"Out[985]=",
 CellID->1564610725,ExpressionUUID->"57ee4e76-12f6-4841-b287-998178a8be36"]
}, Open  ]],

Cell["Here is the result of it.", "Text",
 CellChangeTimes->{{3.837494942798222*^9, 3.837494948422676*^9}, {
  3.8393747558267403`*^9, 3.8393747570186234`*^9}},
 CellID->1021716225,ExpressionUUID->"867d26ab-6efd-4ac4-a065-f2c02a82e7a3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out1", "=", 
  RowBox[{"Elaborate", "[", "qc1", "]"}]}]], "Input",
 CellChangeTimes->{{3.837493404413398*^9, 3.837493410237941*^9}, {
  3.83749390950323*^9, 3.8374939104253893`*^9}},
 CellLabel->"In[986]:=",
 CellID->1161547237,ExpressionUUID->"be494283-1744-4f4d-aa9a-bba4abc7c962"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"3", " ", 
     TemplateBox[{"\"\[SpaceIndicator]\""},
      "Ket"]}], 
    RowBox[{"16", " ", 
     SqrtBox["2"]}]]}], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"11", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"11", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellChangeTimes->{
  3.837493413722673*^9, 3.837493458672635*^9, 3.837493818445734*^9, {
   3.837493893642376*^9, 3.837493912411518*^9}, {3.837494938964921*^9, 
   3.83749495136884*^9}, 3.8393746723000402`*^9, 3.839374763066787*^9, 
   3.839375330976452*^9, 3.839375559861661*^9, 3.8397142096960506`*^9, 
   3.849255133423019*^9, 3.849265930683703*^9},
 CellLabel->"Out[986]=",
 CellID->1354512776,ExpressionUUID->"57ad0f77-0e5f-4d76-b805-d992eb2c6422"]
}, Open  ]],

Cell["\<\
We apply the Grover rotation again on the above output state.\
\>", "Text",
 CellChangeTimes->{{3.837494954677731*^9, 3.837494967626872*^9}},
 CellID->484486733,ExpressionUUID->"38ad7588-3f25-4c53-a44d-da8eb8848904"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"out1", ",", 
      RowBox[{
      "\"\<Label\>\"", "->", 
       "\"\<\!\(\*TemplateBox[{\"\[Psi]\"},\"Ket\"]\)\>\""}]}], "}"}], ",", 
    "grv"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.837493591725869*^9, 3.8374936701572027`*^9}, {
  3.8374939146784077`*^9, 3.837493917895629*^9}},
 CellLabel->"In[987]:=",
 CellID->1744020104,ExpressionUUID->"681ad7b8-d016-45e8-ab71-b124f5aec3c8"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}, {{0, -3}, {8, -3}}, {{
    0, -4}, {8, -4}}, {{0, -5}, {8, -5}}}], {
    LineBox[{{-0.1, -5}, {-0.2, -5.}, {-0.2, -1.}, {-0.1, -1}}], InsetBox[
     StyleBox["\<\"\\!\\(\\*TemplateBox[{\\\"\[Psi]\\\"},\\\"Ket\\\"]\\)\"\>",
      
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light"], {-0.30000000000000004, -3.}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {
    LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}, {1, -5}}], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     FilledCurveBox[{
      BezierCurve[{{1.4, -1}, {1.4, -0.47439999999999993`}, {
         0.6, -0.47439999999999993`}, {0.6, -1}}], 
       Line[{{0.6, -1}, {0.6, -4}}], 
       BezierCurve[{{0.6, -4.5256}, {1.4, -4.5256}, {1.4, -4}}]}]}, InsetBox[
     StyleBox["\<\"f\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{1, Rational[-5, 2]}, {1, -2.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]], {
     CircleBox[{1, -5}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -5}, {1.2666666666666666`, -5}}, {{
        1, -5.266666666666667}, {1, -4.733333333333333}}}]}}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{2, Rational[-11, 2]}, {2, Rational[-1, 2]}}, {{
       2, -5.5}, {2, -0.5}}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{5, -1}, {5, -2}, {5, -3}, {5, -4}}], DiskBox[{5, -1}, 0.09], 
    DiskBox[{5, -2}, 0.09], DiskBox[{5, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], {5, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.6, -1.4}, {6.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {6, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {6, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {6, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.6, -4.4}, {6.4, -3.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {6, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {7, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {7, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {7, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {7, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{18., 7.2}, {5, 5}},
  ImageSize->313.2,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{3.837493923027267*^9, 3.837494969090844*^9, 
  3.839375334686393*^9, 3.839375560007147*^9, 3.839714209812339*^9, 
  3.8492551370674133`*^9, 3.8492659319896708`*^9},
 CellLabel->"Out[987]=",
 CellID->1512984293,ExpressionUUID->"0575b0ad-1414-43ad-9204-d7ab78859e5a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out2", "=", 
  RowBox[{"Elaborate", "[", "qc2", "]"}]}]], "Input",
 CellChangeTimes->{{3.837493404413398*^9, 3.837493410237941*^9}, 
   3.837493487142555*^9, {3.837493537194298*^9, 3.837493537249546*^9}, 
   3.8374935823859777`*^9},
 CellLabel->"In[988]:=",
 CellID->1156473617,ExpressionUUID->"8426bb01-3ac7-4591-870a-ccbe2b946da5"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{"\"\[SpaceIndicator]\""},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"61", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"61", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"5", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"64", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellChangeTimes->{3.837493491243925*^9, 3.837493540679186*^9, 
  3.837493585861949*^9, 3.837493931830456*^9, 3.8374949744366703`*^9, 
  3.839375338606072*^9, 3.839375561930875*^9, 3.839714213492869*^9, 
  3.84925513954671*^9, 3.849265934148265*^9},
 CellLabel->"Out[988]=",
 CellID->63595576,ExpressionUUID->"bf517356-87f8-4184-8d66-c6bbb099d795"]
}, Open  ]],

Cell["We repeat the same procedure.", "Text",
 CellChangeTimes->{{3.837494976064229*^9, 3.8374949825887947`*^9}},
 CellID->1752880784,ExpressionUUID->"13ef91f6-a84e-408f-8812-3e462e24f03e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc3", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"out2", ",", 
      RowBox[{
      "\"\<Label\>\"", "->", 
       "\"\<\!\(\*TemplateBox[{\"\[Psi]\"},\"Ket\"]\)\>\""}]}], "}"}], ",", 
    "grv"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.837493591725869*^9, 3.8374936701572027`*^9}},
 CellLabel->"In[989]:=",
 CellID->942757313,ExpressionUUID->"1afa1637-a0d6-4552-8e24-72df7113ef1e"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}, {{0, -3}, {8, -3}}, {{
    0, -4}, {8, -4}}, {{0, -5}, {8, -5}}}], {
    LineBox[{{-0.1, -5}, {-0.2, -5.}, {-0.2, -1.}, {-0.1, -1}}], InsetBox[
     StyleBox["\<\"\\!\\(\\*TemplateBox[{\\\"\[Psi]\\\"},\\\"Ket\\\"]\\)\"\>",
      
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light"], {-0.30000000000000004, -3.}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {
    LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}, {1, -5}}], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     FilledCurveBox[{
      BezierCurve[{{1.4, -1}, {1.4, -0.47439999999999993`}, {
         0.6, -0.47439999999999993`}, {0.6, -1}}], 
       Line[{{0.6, -1}, {0.6, -4}}], 
       BezierCurve[{{0.6, -4.5256}, {1.4, -4.5256}, {1.4, -4}}]}]}, InsetBox[
     StyleBox["\<\"f\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{1, Rational[-5, 2]}, {1, -2.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]], {
     CircleBox[{1, -5}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -5}, {1.2666666666666666`, -5}}, {{
        1, -5.266666666666667}, {1, -4.733333333333333}}}]}}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{2, Rational[-11, 2]}, {2, Rational[-1, 2]}}, {{
       2, -5.5}, {2, -0.5}}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{5, -1}, {5, -2}, {5, -3}, {5, -4}}], DiskBox[{5, -1}, 0.09], 
    DiskBox[{5, -2}, 0.09], DiskBox[{5, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], {5, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.6, -1.4}, {6.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {6, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {6, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {6, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.6, -4.4}, {6.4, -3.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {6, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {7, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {7, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {7, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {7, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{18., 7.2}, {5, 5}},
  ImageSize->313.2,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{{3.837493607692707*^9, 3.837493637412656*^9}, {
   3.837493672953861*^9, 3.837493693530334*^9}, 3.8374939484868927`*^9, 
   3.8374949838260593`*^9, 3.839375339386558*^9, 3.839375562095592*^9, 
   3.83971421360483*^9, 3.849255141184767*^9, 3.8492659362199287`*^9},
 CellLabel->"Out[989]=",
 CellID->437891486,ExpressionUUID->"5de2fe7f-5460-4d6d-becd-9e2c3e776bad"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out3", "=", 
  RowBox[{"Elaborate", "[", "qc3", "]"}]}]], "Input",
 CellChangeTimes->{{3.8374936960014067`*^9, 3.837493701319461*^9}},
 CellLabel->"In[990]:=",
 CellID->122695161,ExpressionUUID->"08c290a7-3ea1-420f-9073-8d30a364ef3f"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{"\"\[SpaceIndicator]\""},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"251", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"251", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"13", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"256", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellChangeTimes->{3.8374937032052813`*^9, 3.837493952608431*^9, 
  3.8374949865126266`*^9, 3.839375342848578*^9, 3.839375565325365*^9, 
  3.8397142167551613`*^9, 3.8492551435842457`*^9, 3.849265938421382*^9},
 CellLabel->"Out[990]=",
 CellID->1938020292,ExpressionUUID->"f96e24fa-1c79-422b-91ee-690e97c4b452"]
}, Open  ]],

Cell["\<\
In this case, the optimal number of applications of the Grover algorithm is \
four. So, this is supposed to be the last step.\
\>", "Text",
 CellChangeTimes->{{3.837494990880415*^9, 3.837495059549554*^9}},
 CellID->1267255046,ExpressionUUID->"a78ddac0-44d0-40e5-aa47-920a11174aab"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc4", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"out3", ",", 
      RowBox[{
      "\"\<Label\>\"", "->", 
       "\"\<\!\(\*TemplateBox[{\"\[Psi]\"},\"Ket\"]\)\>\""}]}], "}"}], ",", 
    "grv"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.837493591725869*^9, 3.8374936701572027`*^9}, {
  3.837493715652439*^9, 3.8374937208048687`*^9}},
 CellLabel->"In[991]:=",
 CellID->1682375797,ExpressionUUID->"2e371800-083b-4777-9d88-13edeef7abcf"],

Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}, {{0, -3}, {8, -3}}, {{
    0, -4}, {8, -4}}, {{0, -5}, {8, -5}}}], {
    LineBox[{{-0.1, -5}, {-0.2, -5.}, {-0.2, -1.}, {-0.1, -1}}], InsetBox[
     StyleBox["\<\"\\!\\(\\*TemplateBox[{\\\"\[Psi]\\\"},\\\"Ket\\\"]\\)\"\>",
      
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light"], {-0.30000000000000004, -3.}, 
     ImageScaled[{1, Rational[1, 2]}]]}, {
    LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}, {1, -5}}], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     FilledCurveBox[{
      BezierCurve[{{1.4, -1}, {1.4, -0.47439999999999993`}, {
         0.6, -0.47439999999999993`}, {0.6, -1}}], 
       Line[{{0.6, -1}, {0.6, -4}}], 
       BezierCurve[{{0.6, -4.5256}, {1.4, -4.5256}, {1.4, -4}}]}]}, InsetBox[
     StyleBox["\<\"f\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{1, Rational[-5, 2]}, {1, -2.5}], 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]], {
     CircleBox[{1, -5}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -5}, {1.2666666666666666`, -5}}, {{
        1, -5.266666666666667}, {1, -4.733333333333333}}}]}}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{2, Rational[-11, 2]}, {2, Rational[-1, 2]}}, {{
       2, -5.5}, {2, -0.5}}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {
    LineBox[{{5, -1}, {5, -2}, {5, -3}, {5, -4}}], DiskBox[{5, -1}, 0.09], 
    DiskBox[{5, -2}, 0.09], DiskBox[{5, -3}, 0.09], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], {5, -4}, 
     ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.6, -1.4}, {6.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {6, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {6, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {6, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.6, -4.4}, {6.4, -3.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {6, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}, {{
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {7, -1}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {7, -2}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {7, -3}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {7, -4}, 
      ImageScaled[{Rational[1, 2], Rational[1, 2]}]]}}},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{18., 7.2}, {5, 5}},
  ImageSize->313.2,
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellChangeTimes->{3.8374937287496758`*^9, 3.8374939536398077`*^9, 
  3.837495061014967*^9, 3.839375343534642*^9, 3.8393755654645243`*^9, 
  3.839714216869467*^9, 3.849255145978677*^9, 3.849265939302301*^9},
 CellLabel->"Out[991]=",
 CellID->1705148470,ExpressionUUID->"ac71248a-6388-48d3-b437-7c5a1d3a3e5a"]
}, Open  ]],

Cell["This is the final state.", "Text",
 CellChangeTimes->{{3.83749506846003*^9, 3.837495071755538*^9}},
 CellID->1630399353,ExpressionUUID->"c71d10da-fd0f-4cb5-88b7-9d57a416ddcd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out4", "=", 
  RowBox[{"Elaborate", "[", "qc4", "]"}]}]], "Input",
 CellChangeTimes->{{3.8374936960014067`*^9, 3.837493701319461*^9}, {
  3.8374937380575657`*^9, 3.837493739498126*^9}},
 CellLabel->"In[992]:=",
 CellID->723586098,ExpressionUUID->"8ce2ab95-2562-4ada-ba89-831d3cccfb36"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"171", " ", 
     TemplateBox[{"\"\[SpaceIndicator]\""},
      "Ket"]}], 
    RowBox[{"1024", " ", 
     SqrtBox["2"]}]]}], "-", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"781", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"781", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]]], 
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"171", " ", 
    TemplateBox[{
      TagBox[
       TemplateBox[{
         SubscriptBox["1", 
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]]]}, "RowDefault"], DisplayForm]},
     "Ket"]}], 
   RowBox[{"1024", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellChangeTimes->{3.837493741451068*^9, 3.837493956373843*^9, 
  3.8374941902475643`*^9, 3.837494406962172*^9, 3.8374944804833307`*^9, 
  3.837495063420232*^9, 3.839375346894435*^9, 3.839375568427609*^9, 
  3.839714219887685*^9, 3.849255148651091*^9, 3.849265941753871*^9},
 CellLabel->"Out[992]=",
 CellID->1446663740,ExpressionUUID->"8c12c98f-e7eb-4160-96b3-5b58e93de970"]
}, Open  ]],

Cell["\<\
To analyze the result, we ignore the ancillary qubit. Note that the result is \
a density matrix.\
\>", "Text",
 CellChangeTimes->{{3.8374950809468822`*^9, 3.837495125260929*^9}},
 CellID->2003803216,ExpressionUUID->"ac8dee16-1054-49df-abf5-015c58f733b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"Matrix", "@", 
    RowBox[{"PartialTrace", "[", 
     RowBox[{"out4", ",", 
      RowBox[{"S", "[", "aa", "]"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.837494489992004*^9, 3.837494512579013*^9}},
 CellLabel->"In[993]:=",
 CellID->528506718,ExpressionUUID->"1b7aa103-d70d-44cf-9841-023310ca6008"],

Cell["\<\
The diagonal elements of the density matrix are the probability in the \
logical basis.\
\>", "Text",
 CellChangeTimes->{{3.8374950997394457`*^9, 3.837495148323084*^9}},
 CellID->386816352,ExpressionUUID->"cbe6ba90-7b74-49c2-9b1d-c22cf83ed37b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"prb", "=", 
   RowBox[{"Diagonal", "[", "new", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8374945231550903`*^9, 3.837494540422616*^9}, {
  3.8374945977993813`*^9, 3.8374945992819233`*^9}},
 CellLabel->"In[994]:=",
 CellID->1776881829,ExpressionUUID->"8addb7a7-ff00-40ce-a748-0bb393d48ea5"],

Cell["\<\
As you can see below, the probability for x=3 is the highest. We conclude \
that the quantum search algorithm works reasonably well.\
\>", "Text",
 CellChangeTimes->{{3.837495156546731*^9, 3.837495209500238*^9}},
 CellID->925300932,ExpressionUUID->"0ecad7c1-12c4-45b8-9dbc-5b5d73b5ae32"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"Transpose", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"2", "^", "$n"}], "-", "1"}]}], "]"}], ",", "prb"}], "}"}]}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<x\>\"", ",", "\"\<Probability\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.837494601310604*^9, 3.837494659109144*^9}},
 CellLabel->"In[995]:=",
 CellID->1869627664,ExpressionUUID->"d308c5c5-f92f-4186-8fd5-7c6945b0c92f"],

Cell[BoxData[
 GraphicsBox[{{}, {{{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       NCache[
        Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6], 
      LineBox[{{0., 0.027886390686035156`}, {1., 0.027886390686035156`}, {2., 
       0.027886390686035156`}, {3., 0.5817041397094727}, {4., 
       0.027886390686035156`}, {5., 0.027886390686035156`}, {6., 
       0.027886390686035156`}, {7., 0.027886390686035156`}, {8., 
       0.027886390686035156`}, {9., 0.027886390686035156`}, {10., 
       0.027886390686035156`}, {11., 0.027886390686035156`}, {12., 
       0.027886390686035156`}, {13., 0.027886390686035156`}, {14., 
       0.027886390686035156`}, {15., 0.027886390686035156`}}]}}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      NCache[
       Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6], 
     GeometricTransformationBox[InsetBox[
       FormBox[
        StyleBox[
         GraphicsBox[
          {EdgeForm[None], DiskBox[{0, 0}]},
          AxesStyle->Automatic,
          FrameStyle->Automatic,
          ImageSize->250,
          PlotRangePadding->Scaled[0.025]],
         StripOnInput->False,
         GraphicsBoxOptions->{DefaultBaseStyle->Directive[
           PointSize[
            Rational[7, 360]], 
           RGBColor[0.368417, 0.506779, 0.709798], 
           AbsoluteThickness[1.6]]}],
        TraditionalForm], {0., 0.}, Automatic, Offset[6.272]], {{{0., 
      0.027886390686035156`}}, {{1., 0.027886390686035156`}}, {{2., 
      0.027886390686035156`}}, {{3., 0.5817041397094727}}, {{4., 
      0.027886390686035156`}}, {{5., 0.027886390686035156`}}, {{6., 
      0.027886390686035156`}}, {{7., 0.027886390686035156`}}, {{8., 
      0.027886390686035156`}}, {{9., 0.027886390686035156`}}, {{10., 
      0.027886390686035156`}}, {{11., 0.027886390686035156`}}, {{12., 
      0.027886390686035156`}}, {{13., 0.027886390686035156`}}, {{14., 
      0.027886390686035156`}}, {{15., 0.027886390686035156`}}}]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  AxesStyle->Automatic,
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{
     FormBox["\"Probability\"", TraditionalForm], None}, {
     FormBox["\"x\"", TraditionalForm], None}},
  FrameStyle->Automatic,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->250,
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 15.}, {0, 0.5817041397094727}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {
     Scaled[0.025], 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.837494626034878*^9, 3.8374946676282177`*^9}, 
   3.8374951508386927`*^9, 3.8374951850856953`*^9, 3.839375571837432*^9, 
   3.839714223344154*^9, 3.849255154541975*^9, 3.849265946338504*^9},
 CellLabel->"Out[995]=",
 CellID->901160145,ExpressionUUID->"b6da2275-49b7-4a91-b6a2-93a84873402e"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
Saveable->False,
WindowSize->{843, 1179},
WindowMargins->{{453, Automatic}, {Automatic, 0}},
DockedCells->Cell[
 "Quantum Computation Workbook", "Text", Background -> GrayLevel[0.9], 
  FontSize -> 12, CellFrameMargins -> {{22, 8}, {8, 8}}],
PageFooters->{{
   Cell["Quantum Computation Workbook", "Footer", CellMargins -> 4], None, 
   None}, {None, None, 
   Cell["Quantum Computation Workbook", "Footer", CellMargins -> 4]}},
PageFooterLines->{True, True},
TaggingRules->{
 "DocuToolsSettings" -> {
   "$ApplicationName" -> "Q3", "$LinkBase" -> "Q3", "$DocumentationDirectory" -> 
    "/Users/Masso/Math/Apples/Q3App/Q3/Documentation/English/", 
    "$ApplicationDirectory" -> "/Users/Masso/Math/Apples/Q3App/Q3"}, 
  "TryRealOnly" -> False},
CreateCellID->True,
FrontEndVersion->"13.1 for Mac OS X ARM (64-bit) (June 16, 2022)",
StyleDefinitions->"Playbook.nb",
ExpressionUUID->"a9b5e516-22bb-4dc2-98c0-90d5a5075e92"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "TableOfContents"->{
  Cell[1729, 49, 12404, 368, 631, "Text",ExpressionUUID->"12ed387c-ee8a-42a2-bc06-9be8217a49e4",
   CellTags->"TableOfContents",
   CellID->1638414179]},
 "Section45"->{
  Cell[14158, 421, 208, 3, 67, "Section",ExpressionUUID->"3886c840-ec60-4cdc-b383-7657a1c495b8",
   CellTags->"Section45",
   CellID->2095711634]},
 "Section46"->{
  Cell[21467, 640, 266, 4, 54, "Subsection",ExpressionUUID->"35a44857-9ee4-4e9a-8a3a-5b79ccff192d",
   CellTags->"Section46",
   CellID->1746138191]},
 "Section47"->{
  Cell[43127, 1190, 227, 3, 54, "Subsection",ExpressionUUID->"44fd6f9e-cfc5-46eb-aa98-4c5faf2af388",
   CellTags->"Section47",
   CellID->1980539882]},
 "Section48"->{
  Cell[100095, 2718, 256, 4, 67, "Section",ExpressionUUID->"147d10ce-32ef-4c90-adce-43267f63c000",
   CellTags->"Section48",
   CellID->937268274]},
 "Section49"->{
  Cell[100376, 2726, 301, 5, 54, "Subsection",ExpressionUUID->"25bade32-d675-4545-a640-24c6cbd9b899",
   CellTags->"Section49",
   CellID->875330373]},
 "Section50"->{
  Cell[205702, 5784, 213, 3, 54, "Subsection",ExpressionUUID->"6137aaa5-3d2a-4794-a331-4532a2a3e483",
   CellTags->"Section50",
   CellID->1414597061]},
 "Section51"->{
  Cell[214718, 6023, 268, 4, 54, "Subsection",ExpressionUUID->"0144cad6-22c0-4d32-aac1-b2a20db1544f",
   CellTags->"Section51",
   CellID->341348290]},
 "Section52"->{
  Cell[227541, 6351, 224, 3, 54, "Subsection",ExpressionUUID->"241c7854-4cba-419d-943e-669ba872fff9",
   CellTags->"Section52",
   CellID->1111888893]},
 "Section53"->{
  Cell[265451, 7345, 211, 3, 67, "Section",ExpressionUUID->"376ce1dd-bff8-4080-bc22-db5ee7488fe0",
   CellTags->"Section53",
   CellID->113928457]},
 "Section54"->{
  Cell[265665, 7350, 219, 3, 54, "Subsection",ExpressionUUID->"aea805f3-b3a6-49e8-85a8-06304c126a6e",
   CellTags->"Section54",
   CellID->1387647322]},
 "Section55"->{
  Cell[265909, 7357, 211, 3, 38, "Subsection",ExpressionUUID->"3181692c-1196-4295-9e8d-4bb3d0cd9808",
   CellTags->"Section55",
   CellID->516134434]},
 "Section56"->{
  Cell[289381, 7938, 265, 4, 54, "Subsection",ExpressionUUID->"30e1877f-644c-48f1-ae88-4c536fd2c397",
   CellTags->"Section56",
   CellID->984982005]},
 "Section57"->{
  Cell[374302, 10272, 211, 3, 67, "Section",ExpressionUUID->"7b1be872-4718-438c-a460-480b0a261bd7",
   CellTags->"Section57",
   CellID->1788606959]},
 "Section58"->{
  Cell[374516, 10277, 197, 3, 54, "Subsection",ExpressionUUID->"ccf2212c-ee95-4476-b2a9-071d627d2562",
   CellTags->"Section58",
   CellID->641069207]},
 "Section59"->{
  Cell[374738, 10284, 201, 3, 38, "Subsection",ExpressionUUID->"184f5541-c30e-4363-96f7-66eb6a8781bf",
   CellTags->"Section59",
   CellID->524705050]},
 "Section14"->{
  Cell[397192, 10799, 197, 3, 54, "Subsection",ExpressionUUID->"55f6e05c-5ec8-41eb-8c0f-b0dbb03b68dd",
   CellTags->"Section14",
   CellID->387810204]},
 "Section15"->{
  Cell[397392, 10804, 227, 3, 38, "Subsection",ExpressionUUID->"96d37673-2be5-47ba-a811-9636f6cbcb65",
   CellTags->"Section15",
   CellID->1945118114]},
 "Section11"->{
  Cell[397656, 10812, 196, 3, 67, "Section",ExpressionUUID->"878b9975-2b9b-45a6-b67b-780598258563",
   CellTags->"Section11",
   CellID->523633377]},
 "Section12"->{
  Cell[397877, 10819, 269, 4, 54, "Subsection",ExpressionUUID->"532a30cc-1ff4-4e16-96f6-61b1ade29564",
   CellTags->"Section12",
   CellID->1070104587]},
 "Section13"->{
  Cell[476299, 12840, 263, 4, 54, "Subsection",ExpressionUUID->"e287b045-1d6a-48a7-9974-1db8f8a346e8",
   CellTags->"Section13",
   CellID->2091554196]},
 "Section16"->{
  Cell[476565, 12846, 294, 4, 38, "Subsection",ExpressionUUID->"3205a79a-5b6b-46b6-ba07-b98f7be9455b",
   CellTags->"Section16",
   CellID->113725620]},
 "Section17"->{
  Cell[476884, 12854, 214, 3, 38, "Subsection",ExpressionUUID->"ddd4ceb2-38d0-4e70-996c-324ca3967159",
   CellTags->"Section17",
   CellID->1872307380]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"TableOfContents", 629131, 17279},
 {"Section45", 629301, 17283},
 {"Section46", 629465, 17287},
 {"Section47", 629632, 17291},
 {"Section48", 629800, 17295},
 {"Section49", 629965, 17299},
 {"Section50", 630133, 17303},
 {"Section51", 630302, 17307},
 {"Section52", 630470, 17311},
 {"Section53", 630639, 17315},
 {"Section54", 630804, 17319},
 {"Section55", 630973, 17323},
 {"Section56", 631141, 17327},
 {"Section57", 631309, 17331},
 {"Section58", 631476, 17335},
 {"Section59", 631645, 17339},
 {"Section14", 631814, 17343},
 {"Section15", 631983, 17347},
 {"Section11", 632153, 17351},
 {"Section12", 632319, 17355},
 {"Section13", 632489, 17359},
 {"Section16", 632659, 17363},
 {"Section17", 632828, 17367}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 271, 4, 98, "Title",ExpressionUUID->"b9269d85-53e8-4b1a-8e3e-227531db259b",
 CellID->181742063],
Cell[854, 28, 378, 6, 30, "Input",ExpressionUUID->"461ddb1f-d118-47e8-96bb-6e4be8172a11",
 CellID->817106807],
Cell[1235, 36, 231, 4, 30, "Input",ExpressionUUID->"d69ce98c-fbd2-4f2c-9529-43b1fbb7afb1",
 CellID->2103666331],
Cell[1469, 42, 257, 5, 30, "Input",ExpressionUUID->"f2adc606-2818-4529-98db-e2af57b7ac6d",
 CellID->2069736141],
Cell[1729, 49, 12404, 368, 631, "Text",ExpressionUUID->"12ed387c-ee8a-42a2-bc06-9be8217a49e4",
 CellTags->"TableOfContents",
 CellID->1638414179],
Cell[CellGroupData[{
Cell[14158, 421, 208, 3, 67, "Section",ExpressionUUID->"3886c840-ec60-4cdc-b383-7657a1c495b8",
 CellTags->"Section45",
 CellID->2095711634],
Cell[CellGroupData[{
Cell[14391, 428, 273, 6, 38, "MathCaption",ExpressionUUID->"8253e7cd-3585-427b-bcaf-270c233ab8b3",
 CellID->149260909],
Cell[CellGroupData[{
Cell[14689, 438, 1647, 43, 94, "Input",ExpressionUUID->"db0223f3-0f26-44f0-b237-b88ca9a274c7",
 CellID->367197867],
Cell[16339, 483, 2730, 83, 66, "Output",ExpressionUUID->"6dbf2b37-67e8-47df-a13f-79ecbf8e67f0",
 CellID->254795820]
}, Open  ]],
Cell[CellGroupData[{
Cell[19106, 571, 449, 9, 30, "Input",ExpressionUUID->"d67a6af1-c5f4-43d2-b409-067f197dcd89",
 CellID->1207554891],
Cell[19558, 582, 1860, 52, 38, "Output",ExpressionUUID->"1f554a42-3fbb-4a8f-a36d-6fb35a325d90",
 CellID->1606730912]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[21467, 640, 266, 4, 54, "Subsection",ExpressionUUID->"35a44857-9ee4-4e9a-8a3a-5b79ccff192d",
 CellTags->"Section46",
 CellID->1746138191],
Cell[CellGroupData[{
Cell[21758, 648, 290, 7, 38, "MathCaption",ExpressionUUID->"3a9f9482-813e-4fa8-9668-8c5dac04f70f",
 CellID->1654588887],
Cell[CellGroupData[{
Cell[22073, 659, 976, 23, 30, "Input",ExpressionUUID->"3cf3fcd2-d078-4c71-8a92-674a346c6bc1",
 CellID->909678806],
Cell[23052, 684, 1807, 41, 85, "Output",ExpressionUUID->"7d705847-df50-47e1-b477-cdc158b4656f",
 CellID->857955628]
}, Open  ]],
Cell[24874, 728, 233, 4, 35, "Text",ExpressionUUID->"47c8d4be-3006-4d6f-af0d-70bafce3546b",
 CellID->1375495557],
Cell[CellGroupData[{
Cell[25132, 736, 577, 12, 52, "Input",ExpressionUUID->"1cd7be62-287b-4b9a-a4da-32b541e752f3",
 CellID->1035609449],
Cell[25712, 750, 1606, 40, 60, "Output",ExpressionUUID->"78fa5936-0b68-4042-bde9-467eeba6fd5f",
 CellID->1004364066]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[27367, 796, 226, 4, 38, "MathCaption",ExpressionUUID->"dc115596-55cc-4aaa-933d-90a60121dc70",
 CellID->133050408],
Cell[CellGroupData[{
Cell[27618, 804, 580, 12, 30, "Input",ExpressionUUID->"41955f4b-3b09-41f4-83a8-90ac145fa2a8",
 CellID->647730729],
Cell[28201, 818, 2087, 46, 91, "Output",ExpressionUUID->"0c6ffe10-e501-41fa-936d-cc01fbf44e15",
 CellID->397812618]
}, Open  ]],
Cell[30303, 867, 196, 3, 35, "Text",ExpressionUUID->"542e65b5-34bc-494c-9716-43f33e9576e5",
 CellID->815755660],
Cell[CellGroupData[{
Cell[30524, 874, 1454, 30, 52, "Input",ExpressionUUID->"6f49f58c-e127-441c-853b-e72267b401b9",
 CellID->869775172],
Cell[31981, 906, 2718, 73, 182, "Output",ExpressionUUID->"b8a787e5-ced1-4ff6-8cb7-7c9e72b567a0",
 CellID->1296764807]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[34748, 985, 300, 7, 38, "MathCaption",ExpressionUUID->"877b7a67-7b67-4bc3-b690-9148b574f47e",
 CellID->390130675],
Cell[CellGroupData[{
Cell[35073, 996, 709, 15, 30, "Input",ExpressionUUID->"98c9ed68-3059-4b85-99b9-3ac9c69e552a",
 CellID->658680434],
Cell[35785, 1013, 2542, 55, 98, "Output",ExpressionUUID->"241e5ffc-d6ae-403a-9064-b9af15f29fdc",
 CellID->1311056077]
}, Open  ]],
Cell[38342, 1071, 431, 8, 58, "Text",ExpressionUUID->"fce603a3-39c5-4781-9594-8cd35c1a6302",
 CellID->163853953],
Cell[CellGroupData[{
Cell[38798, 1083, 1912, 40, 52, "Input",ExpressionUUID->"11671a1e-7fdb-4f7d-a1af-4a9a4f40d956",
 CellID->819352617],
Cell[40713, 1125, 2353, 58, 185, "Output",ExpressionUUID->"555c4768-6745-4bfb-9530-cb5f0777d94a",
 CellID->505099217]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[43127, 1190, 227, 3, 54, "Subsection",ExpressionUUID->"44fd6f9e-cfc5-46eb-aa98-4c5faf2af388",
 CellTags->"Section47",
 CellID->1980539882],
Cell[CellGroupData[{
Cell[43379, 1197, 275, 6, 38, "MathCaption",ExpressionUUID->"20ec431c-c846-45f3-90fa-8cbdd5f934ba",
 CellID->1194289355],
Cell[43657, 1205, 284, 5, 35, "Text",ExpressionUUID->"aabd563e-2e41-4f82-b262-3ee4c5268142",
 CellID->89151289],
Cell[CellGroupData[{
Cell[43966, 1214, 856, 20, 73, "Input",ExpressionUUID->"56c1fb4d-55b6-4edd-a586-5941bf77075c",
 CellID->2039024623],
Cell[44825, 1236, 1199, 37, 38, "Output",ExpressionUUID->"e9dfc927-e038-4ef9-a6a1-59bdf41358a8",
 CellID->832036843]
}, Open  ]],
Cell[CellGroupData[{
Cell[46061, 1278, 634, 16, 52, "Input",ExpressionUUID->"034c6148-eb2c-443f-a21a-f2a06afb16ab",
 CellID->342799935],
Cell[46698, 1296, 3608, 108, 60, "Output",ExpressionUUID->"4211c717-4086-4270-8b34-2ec61c47014c",
 CellID->580363400]
}, Open  ]],
Cell[50321, 1407, 349, 10, 35, "Text",ExpressionUUID->"5e2ff89d-fc0e-4362-b128-78c644cf3812",
 CellID->1887366291],
Cell[CellGroupData[{
Cell[50695, 1421, 860, 24, 94, "Input",ExpressionUUID->"3dd3cde4-82f6-4c9a-ac6b-fd1635c2d802",
 CellID->484303000],
Cell[51558, 1447, 10278, 295, 170, "Output",ExpressionUUID->"5c499933-69d3-45ef-9173-39bebdad5ede",
 CellID->1501340363]
}, Open  ]],
Cell[61851, 1745, 447, 10, 35, "Text",ExpressionUUID->"5377a36f-9701-43c7-9b69-092ef0195e08",
 CellID->717498870],
Cell[CellGroupData[{
Cell[62323, 1759, 1611, 37, 73, "Input",ExpressionUUID->"405f8952-b853-4831-ae4e-525ecd8ddd34",
 CellID->882830185],
Cell[63937, 1798, 2598, 57, 167, "Output",ExpressionUUID->"557147fa-e840-4bba-b75d-ef2494635fab",
 CellID->1123852585]
}, Open  ]],
Cell[66550, 1858, 354, 9, 35, "Text",ExpressionUUID->"81ae4a7a-4bd8-4df8-bec8-e16f3b69febb",
 CellID->762402172],
Cell[CellGroupData[{
Cell[66929, 1871, 1804, 42, 115, "Input",ExpressionUUID->"6ce1e810-3eac-4926-a097-24db81f269cf",
 CellID->1805866802],
Cell[68736, 1915, 6923, 200, 170, "Output",ExpressionUUID->"e99131e1-ab98-4b1a-ac07-6b69106eccf7",
 CellID->1461761368]
}, Open  ]],
Cell[75674, 2118, 192, 3, 35, "Text",ExpressionUUID->"9afda341-25b0-48c4-b566-5e947d183f57",
 CellID->816958163],
Cell[CellGroupData[{
Cell[75891, 2125, 1480, 27, 52, "Input",ExpressionUUID->"4d7ec85a-14c6-4605-a3ca-e7ef18a8f5be",
 CellID->1752890270],
Cell[77374, 2154, 3119, 55, 171, "Output",ExpressionUUID->"260bd750-c009-4ed8-8890-a0ad5d002ede",
 CellID->1016209443]
}, Open  ]],
Cell[80508, 2212, 657, 14, 81, "Text",ExpressionUUID->"7712b946-da0a-40d8-93fe-79fd869f046b",
 CellID->1646098344],
Cell[CellGroupData[{
Cell[81190, 2230, 1788, 37, 52, "Input",ExpressionUUID->"5d37941d-b2fd-4052-b581-456e6c5db41a",
 CellID->1612209499],
Cell[82981, 2269, 2145, 45, 171, "Output",ExpressionUUID->"98ae65e5-180c-4607-9f37-d92338ab66fc",
 CellID->1127749299]
}, Open  ]],
Cell[85141, 2317, 467, 8, 35, "Text",ExpressionUUID->"f7f90dab-359f-4d47-9b82-5192a9601fd1",
 CellID->158133487],
Cell[CellGroupData[{
Cell[85633, 2329, 2842, 72, 115, "Input",ExpressionUUID->"f00faa65-2b56-46a3-b23e-2cb8c35f59e9",
 CellID->2090526954],
Cell[88478, 2403, 4183, 97, 168, "Output",ExpressionUUID->"0fb8433c-92eb-4051-9c93-731a4519f4ae",
 CellID->2071485807]
}, Open  ]],
Cell[92676, 2503, 161, 3, 35, "Text",ExpressionUUID->"c433d0fc-5610-44c8-9814-3a55bed8feb8",
 CellID->506567311],
Cell[CellGroupData[{
Cell[92862, 2510, 959, 26, 52, "Input",ExpressionUUID->"3770f1ec-e968-4fd7-bc24-b89f2537b55e",
 CellID->629111375],
Cell[93824, 2538, 1502, 45, 38, "Output",ExpressionUUID->"31f74d59-92d7-49ca-b061-92388ce5d6e6",
 CellID->937707500]
}, Open  ]],
Cell[95341, 2586, 194, 2, 35, "Text",ExpressionUUID->"d0315347-7644-4340-8496-d2a12cee028c",
 CellID->1767478406],
Cell[CellGroupData[{
Cell[95560, 2592, 1100, 27, 73, "Input",ExpressionUUID->"73247977-8429-4591-aa70-8c068b2cf3f7",
 CellID->1251619269],
Cell[96663, 2621, 3359, 89, 65, "Output",ExpressionUUID->"e9552531-8e7a-4a28-877e-aac3094995c8",
 CellID->965959337]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[100095, 2718, 256, 4, 67, "Section",ExpressionUUID->"147d10ce-32ef-4c90-adce-43267f63c000",
 CellTags->"Section48",
 CellID->937268274],
Cell[CellGroupData[{
Cell[100376, 2726, 301, 5, 54, "Subsection",ExpressionUUID->"25bade32-d675-4545-a640-24c6cbd9b899",
 CellTags->"Section49",
 CellID->875330373],
Cell[CellGroupData[{
Cell[100702, 2735, 227, 5, 38, "MathCaption",ExpressionUUID->"5bfdb562-9ae7-484c-8c48-5f465405351e",
 CellID->1362731718],
Cell[100932, 2742, 476, 11, 35, "Text",ExpressionUUID->"587bb975-3f3f-44b1-88ae-074d6937023a",
 CellID->518889171],
Cell[101411, 2755, 962, 25, 73, "Input",ExpressionUUID->"6ddfe543-ec47-493b-840b-65e7af264000",
 CellID->39206530],
Cell[102376, 2782, 185, 3, 35, "Text",ExpressionUUID->"01626fc4-125c-47f5-8c4b-5f41628a16f7",
 CellID->1814153728],
Cell[CellGroupData[{
Cell[102586, 2789, 675, 17, 73, "Input",ExpressionUUID->"c850b8fa-65fe-41f1-95ad-3e6b68f47540",
 CellID->508886390],
Cell[103264, 2808, 1431, 30, 128, "Output",ExpressionUUID->"91a3ed16-f3a0-47b0-bc38-fe4839a3df9a",
 CellID->454802627]
}, Open  ]],
Cell[CellGroupData[{
Cell[104732, 2843, 340, 7, 30, "Input",ExpressionUUID->"be2053d7-6a9b-4e34-a133-f9ddb233f8aa",
 CellID->1573674376],
Cell[105075, 2852, 2277, 65, 52, "Output",ExpressionUUID->"59e8b094-78ab-4b92-aef6-1cedca6f24c4",
 CellID->768515850]
}, Open  ]],
Cell[CellGroupData[{
Cell[107389, 2922, 397, 10, 52, "Input",ExpressionUUID->"e7cb7f3e-785f-4f3b-b37a-a134e7e106ce",
 CellID->336640980],
Cell[107789, 2934, 4817, 139, 63, "Output",ExpressionUUID->"5987f4c7-7234-4b29-a055-9e0678fbdbdc",
 CellID->669939798]
}, Open  ]],
Cell[CellGroupData[{
Cell[112643, 3078, 310, 7, 52, "Input",ExpressionUUID->"0efa830c-e112-46d8-a612-2e3f6510c697",
 CellID->1453024662],
Cell[112956, 3087, 4817, 139, 63, "Output",ExpressionUUID->"134af486-0021-49b2-80bb-df19df049480",
 CellID->886753315]
}, Open  ]],
Cell[CellGroupData[{
Cell[117810, 3231, 314, 8, 30, "Input",ExpressionUUID->"d412f9fa-5d50-41bf-8686-34bfb9254ce1",
 CellID->1948944197],
Cell[118127, 3241, 10831, 311, 218, "Output",ExpressionUUID->"3fea937a-41fa-47f9-9d2a-5d6f38a7f138",
 CellID->1929799839]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[129007, 3558, 275, 7, 38, "MathCaption",ExpressionUUID->"1de127be-6045-4115-af7b-07356f9bf72b",
 CellID->337051288],
Cell[129285, 3567, 195, 3, 35, "Text",ExpressionUUID->"5c10a6e7-d503-4387-89f0-942ea65dbba3",
 CellID->1906620277],
Cell[129483, 3572, 908, 26, 73, "Input",ExpressionUUID->"63c7fd9e-d1a7-44c2-8aed-fc6088d2751d",
 CellID->1963498652],
Cell[130394, 3600, 212, 5, 35, "Text",ExpressionUUID->"f03d2935-2471-4f83-86a2-d11af88fe7a6",
 CellID->140640715],
Cell[CellGroupData[{
Cell[130631, 3609, 773, 20, 73, "Input",ExpressionUUID->"4f460cfc-a4fc-4134-ac88-b815cae52b06",
 CellID->1516485305],
Cell[131407, 3631, 1930, 37, 164, "Output",ExpressionUUID->"b10d6665-41d3-4d28-ae10-65fc3155ea5d",
 CellID->630144415]
}, Open  ]],
Cell[CellGroupData[{
Cell[133374, 3673, 479, 10, 30, "Input",ExpressionUUID->"6cfadacc-2806-448d-9541-2529de8dc1b6",
 CellID->1232598539],
Cell[133856, 3685, 3286, 99, 52, "Output",ExpressionUUID->"32e36d63-6c21-40df-8014-cf1f9b362897",
 CellID->574483153]
}, Open  ]],
Cell[CellGroupData[{
Cell[137179, 3789, 571, 12, 52, "Input",ExpressionUUID->"62d46754-e89c-4e76-83fc-32ad62252ca2",
 CellID->1656386011],
Cell[137753, 3803, 11452, 334, 88, "Output",ExpressionUUID->"382d8bf0-0444-498c-ba31-bc551e6d3eae",
 CellID->780916396]
}, Open  ]],
Cell[CellGroupData[{
Cell[149242, 4142, 312, 7, 52, "Input",ExpressionUUID->"752c6e32-e938-44a2-85a3-d7051261f35d",
 CellID->1049170816],
Cell[149557, 4151, 11294, 331, 88, "Output",ExpressionUUID->"2a2714df-13ea-4137-ad94-5cd0cad8f42c",
 CellID->312286360]
}, Open  ]],
Cell[CellGroupData[{
Cell[160888, 4487, 541, 15, 52, "Input",ExpressionUUID->"2d0878c3-2104-47c8-81b6-fad14c347f16",
 CellID->425678995],
Cell[161432, 4504, 13309, 375, 218, "Output",ExpressionUUID->"4ccdc9b7-c371-4fe1-81a2-25f8d6870fc5",
 CellID->641457973]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[174790, 4885, 307, 5, 59, "MathCaption",ExpressionUUID->"b9bbfa87-21e4-469b-a635-7ad30d05fece",
 CellID->1089484095],
Cell[175100, 4892, 308, 5, 58, "Text",ExpressionUUID->"0a6cfb8b-58a5-453f-97dd-aa11edd077ff",
 CellID->1334404591],
Cell[175411, 4899, 1000, 30, 115, "Input",ExpressionUUID->"75a513cd-ee2b-4264-b733-c0e7d6027bf8",
 CellID->219138262],
Cell[CellGroupData[{
Cell[176436, 4933, 934, 27, 94, "Input",ExpressionUUID->"201e9610-5958-4732-9551-ec53893ee997",
 CellID->1528492484],
Cell[177373, 4962, 3136, 77, 159, "Output",ExpressionUUID->"63f140e9-2568-4bbf-8c12-f86bad467d32",
 CellID->870465674]
}, Open  ]],
Cell[180524, 5042, 285, 6, 35, "Text",ExpressionUUID->"7b4209c1-a5a1-47e0-b357-5d5efd91e144",
 CellID->1245720949],
Cell[CellGroupData[{
Cell[180834, 5052, 484, 13, 52, "Input",ExpressionUUID->"d1210a33-dff3-4b6f-83b9-2d7d3883ec99",
 CellID->1881044746],
Cell[181321, 5067, 3160, 94, 49, "Output",ExpressionUUID->"55dac68c-04d3-481f-88a0-f33f0f736e20",
 CellID->778700642]
}, Open  ]],
Cell[184496, 5164, 339, 6, 58, "Text",ExpressionUUID->"d72a2f14-45a3-411f-a251-dd38e4b752fc",
 CellID->254930395],
Cell[CellGroupData[{
Cell[184860, 5174, 340, 8, 30, "Input",ExpressionUUID->"57958642-d929-460d-abf0-1dda3bb8d0dd",
 CellID->427420082],
Cell[185203, 5184, 4251, 138, 49, "Output",ExpressionUUID->"beabd85d-40af-4e1b-b0af-cd929cc016e4",
 CellID->2039437969]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[189503, 5328, 399, 8, 38, "MathCaption",ExpressionUUID->"7a513a07-14e9-49ab-9551-7f23b4dffe2a",
 CellID->1118840808],
Cell[189905, 5338, 301, 9, 35, "Text",ExpressionUUID->"1019f323-5d42-4e4b-951f-265f64107e55",
 CellID->990646924],
Cell[190209, 5349, 784, 21, 52, "Input",ExpressionUUID->"2550c51d-10b5-42d3-9beb-3a91fea1afe6",
 CellID->362136477],
Cell[190996, 5372, 640, 9, 35, "Text",ExpressionUUID->"f0ec82fb-1e6a-4392-959d-1e96af5354bf",
 CellID->459113341],
Cell[CellGroupData[{
Cell[191661, 5385, 1369, 35, 115, "Input",ExpressionUUID->"828812a7-a3ab-4121-86a1-4c4005ea4bb0",
 CellID->409178516],
Cell[193033, 5422, 3382, 85, 130, "Output",ExpressionUUID->"c368218f-7241-4b10-8b8e-4d837cebd32c",
 CellID->636449805]
}, Open  ]],
Cell[CellGroupData[{
Cell[196452, 5512, 695, 15, 52, "Input",ExpressionUUID->"c488cc91-fda1-4982-9983-c538e6e5cdd4",
 CellID->820680718],
Cell[197150, 5529, 2302, 62, 49, "Output",ExpressionUUID->"1f03c22c-45fa-4600-a42e-84dd2ea28ccb",
 CellID->1062945456]
}, Open  ]],
Cell[199467, 5594, 205, 4, 35, "Text",ExpressionUUID->"580fd625-e958-413a-93be-db1bc6d9d5e7",
 CellID->2040846392],
Cell[CellGroupData[{
Cell[199697, 5602, 967, 27, 73, "Input",ExpressionUUID->"6417ab25-238a-4a31-bdd9-4a3d34246c75",
 CellID->896500460],
Cell[200667, 5631, 2118, 62, 38, "Output",ExpressionUUID->"353f8afe-89f4-49f9-89f2-6287242bdd2d",
 CellID->1849324419]
}, Open  ]],
Cell[CellGroupData[{
Cell[202822, 5698, 598, 15, 52, "Input",ExpressionUUID->"e00f4fbb-5dac-4148-b2df-32f1f55ee51f",
 CellID->737963868],
Cell[203423, 5715, 2218, 62, 49, "Output",ExpressionUUID->"f869dae0-2b23-4323-84a9-add01c8ee68d",
 CellID->1176676157]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[205702, 5784, 213, 3, 54, "Subsection",ExpressionUUID->"6137aaa5-3d2a-4794-a331-4532a2a3e483",
 CellTags->"Section50",
 CellID->1414597061],
Cell[CellGroupData[{
Cell[205940, 5791, 243, 4, 38, "MathCaption",ExpressionUUID->"b45446c7-744a-4b2a-a32e-e51174a7d807",
 CellID->1240668051],
Cell[206186, 5797, 906, 24, 73, "Input",ExpressionUUID->"9830c86f-95aa-4f30-b862-950499eb46b2",
 CellID->1989204434],
Cell[207095, 5823, 390, 8, 58, "Text",ExpressionUUID->"70e9111a-4a79-4dca-97fc-6ed5e0d6591b",
 CellID->533505742],
Cell[CellGroupData[{
Cell[207510, 5835, 1369, 36, 115, "Input",ExpressionUUID->"c29c2fa8-f4fd-476f-97a9-b8b6981d0e31",
 CellID->886779569],
Cell[208882, 5873, 4453, 106, 130, "Output",ExpressionUUID->"0aa100b9-65c7-4937-9c7c-1fbd39b02d31",
 CellID->1459290829]
}, Open  ]],
Cell[CellGroupData[{
Cell[213372, 5984, 267, 6, 30, "Input",ExpressionUUID->"4e9e1446-0ecb-48cf-b741-704a43c93b0e",
 CellID->567706003],
Cell[213642, 5992, 1015, 24, 38, "Output",ExpressionUUID->"b891a8b8-7f24-4506-85bb-0858f67534ad",
 CellID->1714949992]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[214718, 6023, 268, 4, 54, "Subsection",ExpressionUUID->"0144cad6-22c0-4d32-aac1-b2a20db1544f",
 CellTags->"Section51",
 CellID->341348290],
Cell[CellGroupData[{
Cell[215011, 6031, 328, 6, 38, "MathCaption",ExpressionUUID->"0d6da1ed-84a9-4701-9a2e-073a5443510e",
 CellID->164948800],
Cell[215342, 6039, 298, 8, 30, "Input",ExpressionUUID->"8ea712e3-eb33-491f-9b5f-27f77fff50a1",
 CellID->2040576970],
Cell[215643, 6049, 480, 10, 35, "Text",ExpressionUUID->"acb4a83b-2de2-4598-9c36-5bc90599cd30",
 CellID->663292200],
Cell[216126, 6061, 668, 16, 52, "Input",ExpressionUUID->"b74733ba-dcd3-4286-9bcf-36564a2917a4",
 CellID->364393823],
Cell[216797, 6079, 361, 8, 35, "Text",ExpressionUUID->"f03f4611-e65c-4e09-85b9-8e97544a249e",
 CellID->224738400],
Cell[CellGroupData[{
Cell[217183, 6091, 443, 8, 30, "Input",ExpressionUUID->"930f2837-f261-4fcb-bb56-99d0c4df062e",
 CellID->1599000074],
Cell[217629, 6101, 463, 7, 34, "Output",ExpressionUUID->"ef6acd8c-ee46-4f88-a703-590b03a114c9",
 CellID->173960086]
}, Open  ]],
Cell[218107, 6111, 437, 8, 58, "Text",ExpressionUUID->"fc3c1f12-4ce9-4b61-98dd-c54008cc63b9",
 CellID->1891105564],
Cell[CellGroupData[{
Cell[218569, 6123, 1367, 36, 115, "Input",ExpressionUUID->"0ba36037-2522-4b52-aa50-5f184f614949",
 CellID->1053238548],
Cell[219939, 6161, 4531, 107, 130, "Output",ExpressionUUID->"c15fbe0b-3f1e-4e6b-9bd5-8348c1e8d5a2",
 CellID->156179771]
}, Open  ]],
Cell[CellGroupData[{
Cell[224507, 6273, 579, 13, 52, "Input",ExpressionUUID->"a5535642-5409-4f72-8ff9-1c63801349a3",
 CellID->72574015],
Cell[225089, 6288, 1252, 27, 38, "Output",ExpressionUUID->"812e0a2c-0720-4952-930e-38e3e9c79c30",
 CellID->1375228138]
}, Open  ]],
Cell[226356, 6318, 240, 4, 35, "Text",ExpressionUUID->"6bc5583d-3f49-4c2e-bf43-13c893ef56f5",
 CellID->2128242256],
Cell[CellGroupData[{
Cell[226621, 6326, 260, 6, 30, "Input",ExpressionUUID->"9360ad6b-a03c-4fb6-852d-28923d6c0f52",
 CellID->879972160],
Cell[226884, 6334, 596, 10, 34, "Output",ExpressionUUID->"b92ccb72-8708-43bc-a79f-6e6af92ebb7f",
 CellID->748991817]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[227541, 6351, 224, 3, 54, "Subsection",ExpressionUUID->"241c7854-4cba-419d-943e-669ba872fff9",
 CellTags->"Section52",
 CellID->1111888893],
Cell[CellGroupData[{
Cell[227790, 6358, 234, 4, 38, "MathCaption",ExpressionUUID->"c9458ad1-85e5-4819-97ba-ae56d927e586",
 CellID->2119699878],
Cell[228027, 6364, 346, 8, 30, "Input",ExpressionUUID->"713d4ff2-220e-45e9-bacf-338b049f1714",
 CellID->1189629463],
Cell[228376, 6374, 396, 8, 35, "Text",ExpressionUUID->"b2ee20e5-59b3-42bb-b099-270f84147052",
 CellID->1029631071],
Cell[228775, 6384, 907, 26, 73, "Input",ExpressionUUID->"4cbeb37b-2b67-444d-ae1a-b45fd31496a9",
 CellID->586182771],
Cell[229685, 6412, 212, 5, 35, "Text",ExpressionUUID->"87907545-3afc-4ca1-a5d8-0f8a4ac1c82d",
 CellID->1466343408],
Cell[CellGroupData[{
Cell[229922, 6421, 1495, 38, 115, "Input",ExpressionUUID->"e9427b1e-e7fb-4bca-a01f-2b9e7291b5d2",
 CellID->311325284],
Cell[231420, 6461, 4892, 111, 161, "Output",ExpressionUUID->"b7ca4c96-a9bb-4f21-9b37-64bf7d228c79",
 CellID->1892788005]
}, Open  ]],
Cell[CellGroupData[{
Cell[236349, 6577, 700, 17, 73, "Input",ExpressionUUID->"675d0aa5-0422-45d6-bf13-d1bac9d8465b",
 CellID->1173884096],
Cell[237052, 6596, 2183, 56, 60, "Output",ExpressionUUID->"e5a97a42-8d74-4aa9-a480-917192c71a5e",
 CellID->2008320979],
Cell[239238, 6654, 826, 13, 34, "Output",ExpressionUUID->"93628b13-fda3-4142-9f15-8b8b648e6226",
 CellID->1850214154]
}, Open  ]],
Cell[CellGroupData[{
Cell[240101, 6672, 719, 18, 30, "Input",ExpressionUUID->"56187403-9428-4aff-be77-ba2e1647d23e",
 CellID->537736483],
Cell[240823, 6692, 929, 17, 34, "Output",ExpressionUUID->"946e77c1-682d-4742-b575-09e17a92d97f",
 CellID->960942719]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[241801, 6715, 355, 7, 38, "MathCaption",ExpressionUUID->"43705915-bfca-450c-94b2-4ea4ee8a0bfd",
 CellID->1555491913],
Cell[242159, 6724, 426, 9, 30, "Input",ExpressionUUID->"ade458f6-cea1-4951-97d7-19fadc48a610",
 CellID->1834146860],
Cell[242588, 6735, 427, 7, 35, "Text",ExpressionUUID->"a6f85606-cc16-4b5b-80f1-35c79eaef247",
 CellID->1526006982],
Cell[243018, 6744, 1680, 48, 115, "Input",ExpressionUUID->"93cfef95-f9c8-4880-90d6-91776ae0aa6a",
 CellID->202150353],
Cell[244701, 6794, 227, 4, 35, "Text",ExpressionUUID->"c0f3c799-38da-4469-a049-58ea7e1c8bcb",
 CellID->221853317],
Cell[CellGroupData[{
Cell[244953, 6802, 1832, 47, 136, "Input",ExpressionUUID->"8d7979e8-ce3b-42e7-a245-3e8bff9880cf",
 CellID->657087627],
Cell[246788, 6851, 6693, 152, 231, "Output",ExpressionUUID->"47a869cf-0469-4b8a-873f-74b01e73aea4",
 CellID->28068165]
}, Open  ]],
Cell[253496, 7006, 207, 2, 35, "Text",ExpressionUUID->"dc774785-2c92-4f57-880d-715206081e05",
 CellID->1617894012],
Cell[CellGroupData[{
Cell[253728, 7012, 788, 17, 73, "Input",ExpressionUUID->"cb95b0e4-43b0-458d-8765-c94403bcb5ab",
 CellID->154236232],
Cell[254519, 7031, 4364, 127, 49, "Output",ExpressionUUID->"6a9db25d-50c2-4b66-86dc-b0b7e10fb9e8",
 CellID->1294780154],
Cell[258886, 7160, 436, 8, 34, "Output",ExpressionUUID->"aa3d4721-98dc-4a38-9abc-349ab3cc38e3",
 CellID->918253227]
}, Open  ]],
Cell[259337, 7171, 276, 5, 35, "Text",ExpressionUUID->"01a85adc-869d-402e-8b87-51b03226a8b2",
 CellID->494273051],
Cell[259616, 7178, 455, 9, 30, "Input",ExpressionUUID->"109edc96-fcee-4275-a86c-899e1d860841",
 CellID->289243815],
Cell[260074, 7189, 199, 2, 35, "Text",ExpressionUUID->"9f13f585-92e9-4df9-a83f-7bcb65519ad5",
 CellID->929134592],
Cell[CellGroupData[{
Cell[260298, 7195, 903, 21, 52, "Input",ExpressionUUID->"dc17c73d-0ebf-4b94-8754-a734c316e40c",
 CellID->612895729],
Cell[261204, 7218, 1213, 33, 230, "Output",ExpressionUUID->"c8ea72e0-6e0f-4fa6-b879-1890f8914e1b",
 CellID->1999113749]
}, Open  ]],
Cell[262432, 7254, 232, 4, 35, "Text",ExpressionUUID->"26c3c285-eee4-42fe-a604-65eaaafd90ee",
 CellID->701716311],
Cell[CellGroupData[{
Cell[262689, 7262, 387, 10, 30, "Input",ExpressionUUID->"5d3d409c-2546-4eb8-89cb-d4acd272dbfe",
 CellID->1789090274],
Cell[263079, 7274, 479, 11, 34, "Output",ExpressionUUID->"55ad3937-f236-4d22-a403-7ed896ee4fb2",
 CellID->703117647]
}, Open  ]],
Cell[263573, 7288, 440, 10, 58, "Text",ExpressionUUID->"4d943bd4-0a6e-44f1-adbc-d59dc73936cb",
 CellID->721731118],
Cell[CellGroupData[{
Cell[264038, 7302, 273, 6, 30, "Input",ExpressionUUID->"9b290f7d-43c6-4784-8e54-64cede99cdbc",
 CellID->371146945],
Cell[264314, 7310, 364, 7, 34, "Output",ExpressionUUID->"d7606b63-b97b-43a4-92bf-cb459efd06cf",
 CellID->739339214]
}, Open  ]],
Cell[CellGroupData[{
Cell[264715, 7322, 274, 6, 30, "Input",ExpressionUUID->"0d32a973-6aba-4828-af5a-d791bcc70279",
 CellID->799014800],
Cell[264992, 7330, 386, 7, 34, "Output",ExpressionUUID->"252fc1f5-bba8-406a-a6a6-781dc19ce523",
 CellID->1188126650]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[265451, 7345, 211, 3, 67, "Section",ExpressionUUID->"376ce1dd-bff8-4080-bc22-db5ee7488fe0",
 CellTags->"Section53",
 CellID->113928457],
Cell[265665, 7350, 219, 3, 54, "Subsection",ExpressionUUID->"aea805f3-b3a6-49e8-85a8-06304c126a6e",
 CellTags->"Section54",
 CellID->1387647322],
Cell[CellGroupData[{
Cell[265909, 7357, 211, 3, 38, "Subsection",ExpressionUUID->"3181692c-1196-4295-9e8d-4bb3d0cd9808",
 CellTags->"Section55",
 CellID->516134434],
Cell[CellGroupData[{
Cell[266145, 7364, 289, 7, 38, "MathCaption",ExpressionUUID->"1983da86-023b-423d-900e-0de28421caec",
 CellID->1125883205],
Cell[266437, 7373, 909, 15, 30, "Input",ExpressionUUID->"a18fc597-8779-4e54-9df0-9bd0fbe90a06",
 CellID->1240612718],
Cell[267349, 7390, 237, 4, 35, "Text",ExpressionUUID->"7490a608-ee1d-4fd9-b334-4ca4561da508",
 CellID->1059222703],
Cell[267589, 7396, 2310, 57, 157, "Input",ExpressionUUID->"677d686f-c975-4c46-903c-1613f5d9b6f9",
 CellID->1864019338],
Cell[269902, 7455, 918, 29, 63, "Text",ExpressionUUID->"6bc97654-e8a3-4208-ad03-0a0166dcab46",
 CellID->861360871],
Cell[270823, 7486, 192, 2, 35, "Text",ExpressionUUID->"4c1331d8-ff4f-43ef-97ce-99ecb1303c7f",
 CellID->335866686],
Cell[271018, 7490, 1332, 28, 52, "Input",ExpressionUUID->"731b514a-38c4-4b9d-9535-9bb6abc5b8d9",
 CellID->308286410],
Cell[272353, 7520, 231, 6, 35, "Text",ExpressionUUID->"b5fb0824-b3cd-4365-bf78-e7e95d1cca0c",
 CellID->1081571330],
Cell[CellGroupData[{
Cell[272609, 7530, 1609, 34, 52, "Input",ExpressionUUID->"93e9d1fe-17f9-4ed5-af87-9bd2e6fa8cd6",
 CellID->522705560],
Cell[274221, 7566, 4847, 113, 164, "Output",ExpressionUUID->"6dec7733-859b-4cb0-97a1-303c052c1274",
 CellID->735491973]
}, Open  ]],
Cell[279083, 7682, 299, 5, 58, "Text",ExpressionUUID->"3e375e2d-68f7-49d2-bab7-366ed99b9d26",
 CellID->2097976484],
Cell[CellGroupData[{
Cell[279407, 7691, 816, 21, 73, "Input",ExpressionUUID->"6a6f53c5-6b34-4af7-bb69-da239165f1a3",
 CellID->288131012],
Cell[280226, 7714, 481, 8, 34, "Output",ExpressionUUID->"6964db09-2280-4581-adf4-edd753c6fc38",
 CellID->1337056867]
}, Open  ]],
Cell[280722, 7725, 366, 6, 58, "Text",ExpressionUUID->"1f5ec8bc-dae2-48fd-a551-b3234ca96287",
 CellID->1298258680],
Cell[CellGroupData[{
Cell[281113, 7735, 1640, 33, 52, "Input",ExpressionUUID->"3d48f2f2-18b6-4d36-94c9-b9f28d7e2862",
 CellID->299138695],
Cell[282756, 7770, 4980, 118, 164, "Output",ExpressionUUID->"c0827eb2-237c-4447-acd5-5bd513bcb01e",
 CellID->465107838]
}, Open  ]],
Cell[287751, 7891, 275, 5, 35, "Text",ExpressionUUID->"c7e96b8d-8f94-421a-9f5d-894010c01f10",
 CellID->1841970781],
Cell[CellGroupData[{
Cell[288051, 7900, 814, 21, 73, "Input",ExpressionUUID->"deb5d729-da3c-468b-964e-a84a5a4c95a3",
 CellID->1739494450],
Cell[288868, 7923, 452, 8, 34, "Output",ExpressionUUID->"f10a06e0-97ff-44c5-9a6c-40e465f57a04",
 CellID->1459939420]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[289381, 7938, 265, 4, 54, "Subsection",ExpressionUUID->"30e1877f-644c-48f1-ae88-4c536fd2c397",
 CellTags->"Section56",
 CellID->984982005],
Cell[CellGroupData[{
Cell[289671, 7946, 363, 6, 59, "MathCaption",ExpressionUUID->"953f7388-d6e2-4cce-a095-b78ec295b2ec",
 CellID->1649159624],
Cell[290037, 7954, 1138, 21, 52, "Input",ExpressionUUID->"1bb1ac33-481a-4fa2-ab0c-bfb955d1a93e",
 CellID->72871740],
Cell[291178, 7977, 252, 3, 35, "Text",ExpressionUUID->"ab95829b-2987-4e36-b870-5ff2ca60b1a7",
 CellID->689655390],
Cell[291433, 7982, 2328, 57, 157, "Input",ExpressionUUID->"c800ce6a-e00a-4d2c-a906-fd3933925a0a",
 CellID->1068896871],
Cell[CellGroupData[{
Cell[293786, 8043, 552, 15, 52, "Input",ExpressionUUID->"2f0a5cfe-227c-4531-84ad-20cee51b9cf2",
 CellID->344851506],
Cell[294341, 8060, 985, 26, 38, "Output",ExpressionUUID->"22f68e87-7595-4903-b353-bfd3685a6570",
 CellID->1871256179]
}, Open  ]],
Cell[295341, 8089, 235, 4, 35, "Text",ExpressionUUID->"d2d9cd85-4898-4780-815a-9b87e34fb300",
 CellID->68827890],
Cell[CellGroupData[{
Cell[295601, 8097, 1572, 43, 94, "Input",ExpressionUUID->"ce199269-89cb-4a5e-94e6-350d5cdf9545",
 CellID->398682067],
Cell[297176, 8142, 7113, 166, 163, "Output",ExpressionUUID->"1a12c065-88c3-40b4-b4c7-eb3658f92e70",
 CellID->1705643605]
}, Open  ]],
Cell[304304, 8311, 242, 4, 35, "Text",ExpressionUUID->"2e33a73e-240a-455d-b37b-f61382633610",
 CellID->1803885280],
Cell[CellGroupData[{
Cell[304571, 8319, 1681, 48, 94, "Input",ExpressionUUID->"e31beb56-5477-4dd8-983a-20844c18da7f",
 CellID->198720503],
Cell[306255, 8369, 6668, 159, 163, "Output",ExpressionUUID->"5df64a59-afc7-4e27-9def-8bfdbbf88b72",
 CellID->1105314625]
}, Open  ]],
Cell[312938, 8531, 272, 5, 35, "Text",ExpressionUUID->"8edfdcc0-d877-47cf-bcf0-02df1faa1ea2",
 CellID->2071821703],
Cell[CellGroupData[{
Cell[313235, 8540, 817, 19, 30, "Input",ExpressionUUID->"ce390bd1-8b10-4281-9b21-d392e1b0bfac",
 CellID->1287687905],
Cell[314055, 8561, 439, 9, 34, "Output",ExpressionUUID->"ffa07c5e-0c94-4875-bf08-9f9d2f1f67db",
 CellID->579604567]
}, Open  ]],
Cell[CellGroupData[{
Cell[314531, 8575, 490, 11, 30, "Input",ExpressionUUID->"15f46ffa-a74d-4f36-8bca-b6039512f894",
 CellID->585052629],
Cell[315024, 8588, 12346, 368, 189, "Output",ExpressionUUID->"3ad11509-0152-40d5-b82a-b9a26ee2d1b4",
 CellID->428134777]
}, Open  ]],
Cell[327385, 8959, 271, 5, 35, "Text",ExpressionUUID->"f96795c0-f0b1-4ed5-9f2a-1b56ee871378",
 CellID->1935282369],
Cell[CellGroupData[{
Cell[327681, 8968, 863, 21, 52, "Input",ExpressionUUID->"57fa34d5-6c6d-4d03-9af3-6f4997de3b65",
 CellID->1278110699],
Cell[328547, 8991, 391, 7, 34, "Output",ExpressionUUID->"14eade66-150a-4fb9-ac61-0aba06943f59",
 CellID->1590979589]
}, Open  ]],
Cell[CellGroupData[{
Cell[328975, 9003, 495, 11, 30, "Input",ExpressionUUID->"b851ac61-687a-47c1-928f-4876e087088e",
 CellID->1295721444],
Cell[329473, 9016, 12511, 370, 187, "Output",ExpressionUUID->"5fab2fe9-15b5-458b-9ea9-3a1c6bc82ba4",
 CellID->1275063526]
}, Open  ]],
Cell[341999, 9389, 247, 5, 35, "Text",ExpressionUUID->"9741521f-3602-4dd3-a8d1-badaf599e401",
 CellID->1424295448]
}, Open  ]],
Cell[CellGroupData[{
Cell[342283, 9399, 371, 6, 59, "MathCaption",ExpressionUUID->"f166c667-3e9c-4699-874f-51185bc68aa3",
 CellID->1323225536],
Cell[CellGroupData[{
Cell[342679, 9409, 881, 21, 73, "Input",ExpressionUUID->"897d828e-a3c2-4dec-979b-4a91fe75d418",
 CellID->1882411498],
Cell[343563, 9432, 11760, 359, 163, "Output",ExpressionUUID->"b16123c8-60e9-4422-849c-b3fdeaca9963",
 CellID->493404666]
}, Open  ]],
Cell[CellGroupData[{
Cell[355360, 9796, 1704, 45, 94, "Input",ExpressionUUID->"388e4669-7fdd-4eba-8eec-c08064346782",
 CellID->1535297063],
Cell[357067, 9843, 6053, 135, 164, "Output",ExpressionUUID->"10d067f5-6c74-4dd7-9b8e-89fb7d906950",
 CellID->322995953]
}, Open  ]],
Cell[CellGroupData[{
Cell[363157, 9983, 1810, 50, 94, "Input",ExpressionUUID->"32b56533-5aad-41d4-9ade-5b354f893e10",
 CellID->1158902283],
Cell[364970, 10035, 5723, 131, 164, "Output",ExpressionUUID->"9e7b1d93-a49a-4051-9a13-8260117c9735",
 CellID->2088795736]
}, Open  ]],
Cell[CellGroupData[{
Cell[370730, 10171, 476, 10, 52, "Input",ExpressionUUID->"1ab87145-45b2-421a-a424-127127525f6c",
 CellID->1469523285],
Cell[371209, 10183, 951, 25, 38, "Output",ExpressionUUID->"b20cdb2c-13da-4f0a-85f4-6edfd613ac5a",
 CellID->446590752]
}, Open  ]],
Cell[372175, 10211, 256, 5, 35, "Text",ExpressionUUID->"68ac3203-61f5-4801-acfc-38bc59d65051",
 CellID->1980347370],
Cell[CellGroupData[{
Cell[372456, 10220, 578, 13, 52, "Input",ExpressionUUID->"dea1d3e8-f459-4195-835c-559b5ced5793",
 CellID->1806758675],
Cell[373037, 10235, 1192, 29, 38, "Output",ExpressionUUID->"bd771b91-7e48-490d-8d95-72f5027973dd",
 CellID->1713013487]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[374302, 10272, 211, 3, 67, "Section",ExpressionUUID->"7b1be872-4718-438c-a460-480b0a261bd7",
 CellTags->"Section57",
 CellID->1788606959],
Cell[374516, 10277, 197, 3, 54, "Subsection",ExpressionUUID->"ccf2212c-ee95-4476-b2a9-071d627d2562",
 CellTags->"Section58",
 CellID->641069207],
Cell[CellGroupData[{
Cell[374738, 10284, 201, 3, 38, "Subsection",ExpressionUUID->"184f5541-c30e-4363-96f7-66eb6a8781bf",
 CellTags->"Section59",
 CellID->524705050],
Cell[CellGroupData[{
Cell[374964, 10291, 349, 7, 38, "MathCaption",ExpressionUUID->"4ec0c88b-5433-4713-ad78-5134fa5cb44c",
 CellID->1527589289],
Cell[375316, 10300, 1308, 31, 73, "Input",ExpressionUUID->"95677b7c-0169-4029-a274-91abdcf147a6",
 CellID->1026180338],
Cell[376627, 10333, 356, 7, 58, "Text",ExpressionUUID->"3a0b0e2e-689d-4b21-b088-0a1e929d7091",
 CellID->571771709],
Cell[376986, 10342, 1031, 17, 30, "Input",ExpressionUUID->"b04da24a-544f-49db-b8c6-4b75c5d97cef",
 CellID->2041353880],
Cell[378020, 10361, 450, 13, 39, "Text",ExpressionUUID->"c36dde83-2e78-416f-bd78-dabe650dd7b7",
 CellID->1925276485],
Cell[378473, 10376, 1696, 34, 73, "Input",ExpressionUUID->"df9a4d6f-bd66-4857-ba55-c8fe55b1dc29",
 CellID->1985774046],
Cell[CellGroupData[{
Cell[380194, 10414, 1714, 34, 52, "Input",ExpressionUUID->"14e8ed5f-72ee-462c-b0cd-cc91ebfad36f",
 CellID->861033095],
Cell[381911, 10450, 7432, 169, 197, "Output",ExpressionUUID->"4abeb085-2742-4c7d-84b1-009ac30956ae",
 CellID->177915444]
}, Open  ]],
Cell[389358, 10622, 517, 8, 81, "Text",ExpressionUUID->"1acffdd7-666c-4abc-a88e-c8743f0786cf",
 CellID->1982401651],
Cell[389878, 10632, 829, 17, 52, "Input",ExpressionUUID->"10b3b9db-92c4-4a4e-9804-b5389ec8c77a",
 CellID->630451150],
Cell[390710, 10651, 298, 5, 58, "Text",ExpressionUUID->"51c68ded-8ac1-4b24-a3d3-3b9d02c9fd26",
 CellID->1227825708],
Cell[CellGroupData[{
Cell[391033, 10660, 1816, 41, 73, "Input",ExpressionUUID->"1719471f-962f-4643-9a52-6daac5d72843",
 CellID->1513843396],
Cell[392852, 10703, 4301, 91, 184, "Output",ExpressionUUID->"9e7fe94e-b037-41e0-899a-96a07e955320",
 CellID->1974615916]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[397192, 10799, 197, 3, 54, "Subsection",ExpressionUUID->"55f6e05c-5ec8-41eb-8c0f-b0dbb03b68dd",
 CellTags->"Section14",
 CellID->387810204],
Cell[397392, 10804, 227, 3, 38, "Subsection",ExpressionUUID->"96d37673-2be5-47ba-a811-9636f6cbcb65",
 CellTags->"Section15",
 CellID->1945118114]
}, Open  ]],
Cell[CellGroupData[{
Cell[397656, 10812, 196, 3, 67, "Section",ExpressionUUID->"878b9975-2b9b-45a6-b67b-780598258563",
 CellTags->"Section11",
 CellID->523633377],
Cell[CellGroupData[{
Cell[397877, 10819, 269, 4, 54, "Subsection",ExpressionUUID->"532a30cc-1ff4-4e16-96f6-61b1ade29564",
 CellTags->"Section12",
 CellID->1070104587],
Cell[CellGroupData[{
Cell[398171, 10827, 421, 7, 38, "MathCaption",ExpressionUUID->"93d23a6b-4173-44fd-89ac-81e407c55849",
 CellID->1865024231],
Cell[398595, 10836, 1089, 19, 52, "Input",ExpressionUUID->"f4926b58-455b-4fa9-8f6f-b2610a0d4453",
 CellID->993225010],
Cell[399687, 10857, 957, 29, 58, "Text",ExpressionUUID->"5fe5b7f6-d58c-4e15-b6df-26f5ff1bef1d",
 CellID->494769004],
Cell[400647, 10888, 1242, 22, 73, "Input",ExpressionUUID->"16530d5f-84c9-4fca-aa3b-06f41dcef96d",
 CellID->1115707455],
Cell[401892, 10912, 233, 3, 35, "Text",ExpressionUUID->"2c02e3d0-d676-42d4-b315-2e54c614dedf",
 CellID->1841005005],
Cell[CellGroupData[{
Cell[402150, 10919, 1055, 24, 52, "Input",ExpressionUUID->"fcc63aab-4416-44f5-9b55-f77535a12576",
 CellID->2026954350],
Cell[403208, 10945, 2795, 69, 187, "Output",ExpressionUUID->"ae46c3fe-d4ed-44f9-8e88-95235cb99e9a",
 CellID->751014217]
}, Open  ]],
Cell[406018, 11017, 274, 5, 35, "Text",ExpressionUUID->"1d7253e1-d67a-43f3-a58d-98f2aeb32c4b",
 CellID->1860084273],
Cell[406295, 11024, 613, 15, 52, "Input",ExpressionUUID->"53c02f5f-f414-4416-9189-e6361d8d69d8",
 CellID->1516926932],
Cell[406911, 11041, 209, 2, 35, "Text",ExpressionUUID->"e6feac76-3b6f-4ad6-a21d-d80f5669a6f8",
 CellID->1085392239],
Cell[CellGroupData[{
Cell[407145, 11047, 1715, 43, 136, "Input",ExpressionUUID->"26d63ccb-face-4989-b726-dbfc3bc95f00",
 CellID->65088940],
Cell[408863, 11092, 6962, 164, 302, "Output",ExpressionUUID->"db90d9d9-4983-4a3d-a962-32a3a99abc89",
 CellID->371090296]
}, Open  ]],
Cell[CellGroupData[{
Cell[415862, 11261, 942, 22, 73, "Input",ExpressionUUID->"64bdd6d6-f4fe-4263-bdff-7c4f43ba5960",
 CellID->973138747],
Cell[416807, 11285, 5911, 165, 87, "Output",ExpressionUUID->"258178bf-cd64-4580-958f-d80e26d19860",
 CellID->546706760],
Cell[422721, 11452, 861, 14, 34, "Output",ExpressionUUID->"a2ea20da-7a5b-4a8e-8f61-c76e7f2a71c8",
 CellID->1565473454]
}, Open  ]],
Cell[423597, 11469, 302, 6, 35, "Text",ExpressionUUID->"d40780ea-f8b8-4f98-955d-17a991f2ee42",
 CellID->1412489576],
Cell[CellGroupData[{
Cell[423924, 11479, 361, 8, 30, "Input",ExpressionUUID->"53c80939-2143-430c-8c9e-9d1ba0958cff",
 CellID->1672335628],
Cell[424288, 11489, 629, 10, 49, "Output",ExpressionUUID->"63dbc5cd-886e-4c7f-a8b2-4d3bf8985b8a",
 CellID->1578029012]
}, Open  ]],
Cell[424932, 11502, 284, 5, 35, "Text",ExpressionUUID->"3796fa38-beb4-4ccd-b270-7296e0acda43",
 CellID->1446570629],
Cell[CellGroupData[{
Cell[425241, 11511, 658, 15, 52, "Input",ExpressionUUID->"515b0bc5-16d2-453c-939d-07e0830c9b71",
 CellID->1610368862],
Cell[425902, 11528, 21132, 618, 239, "Output",ExpressionUUID->"7bc420c6-66dc-41d6-973d-a207237a5731",
 CellID->987454171]
}, Open  ]],
Cell[CellGroupData[{
Cell[447071, 12151, 824, 20, 30, "Input",ExpressionUUID->"f562f3a3-339f-40fc-adf3-8abd809f046c",
 CellID->434023012],
Cell[447898, 12173, 895, 15, 34, "Output",ExpressionUUID->"0a056dc0-2fe9-485a-b4fc-f32f2c27a0d3",
 CellID->1620907220]
}, Open  ]],
Cell[CellGroupData[{
Cell[448830, 12193, 573, 10, 30, "Input",ExpressionUUID->"7993f7de-3a0f-4b82-8d1f-795881ea5d4a",
 CellID->3682719],
Cell[449406, 12205, 661, 13, 49, "Output",ExpressionUUID->"93262854-6322-4269-b4de-43b04469b7af",
 CellID->1505040733]
}, Open  ]],
Cell[450082, 12221, 215, 2, 35, "Text",ExpressionUUID->"69e6e1b4-ca5f-4c7f-8cd8-e13789372f6c",
 CellID->1528176879]
}, Open  ]],
Cell[CellGroupData[{
Cell[450334, 12228, 449, 8, 38, "MathCaption",ExpressionUUID->"c5b33436-c9d6-453f-ba03-6dfa1c1635fb",
 CellID->1856381102],
Cell[450786, 12238, 1040, 18, 52, "Input",ExpressionUUID->"5761bce2-d5ff-46eb-9b92-d3d45a3e7494",
 CellID->1554757698],
Cell[451829, 12258, 302, 4, 35, "Text",ExpressionUUID->"feebb437-0b4d-428b-ba74-9033ca162bb5",
 CellID->231613590],
Cell[452134, 12264, 824, 20, 73, "Input",ExpressionUUID->"ee02c63a-e4ca-4815-925f-f93cafa4368e",
 CellID->1489238766],
Cell[452961, 12286, 239, 4, 35, "Text",ExpressionUUID->"d0937d90-e7ed-4e5a-8b2d-9fbd66c40992",
 CellID->587524040],
Cell[CellGroupData[{
Cell[453225, 12294, 1054, 24, 52, "Input",ExpressionUUID->"2cad7b83-a4d3-4108-8ab0-b6b6507c677f",
 CellID->714034377],
Cell[454282, 12320, 2952, 70, 192, "Output",ExpressionUUID->"3296713b-6c13-4433-b0dc-b6f507a683ca",
 CellID->1194741420]
}, Open  ]],
Cell[457249, 12393, 274, 5, 35, "Text",ExpressionUUID->"eae0e54f-dfb3-4720-bf76-125e85a78b6d",
 CellID->1307310079],
Cell[457526, 12400, 760, 17, 52, "Input",ExpressionUUID->"ddc86537-b3d8-4c45-a45b-c0dbf058d525",
 CellID->1055305296],
Cell[458289, 12419, 208, 2, 35, "Text",ExpressionUUID->"faa94551-e3ce-481d-9eed-18fc6055361c",
 CellID->448669299],
Cell[CellGroupData[{
Cell[458522, 12425, 1876, 46, 136, "Input",ExpressionUUID->"cdc7edeb-bbe4-400d-bfaa-371b3574f628",
 CellID->969823676],
Cell[460401, 12473, 7188, 167, 302, "Output",ExpressionUUID->"207b5d5c-61a1-4487-bfed-ac94272e823b",
 CellID->930788634]
}, Open  ]],
Cell[467604, 12643, 212, 2, 35, "Text",ExpressionUUID->"d12a3e76-505f-449d-8bdf-16b74d3e30f8",
 CellID->1586572829],
Cell[CellGroupData[{
Cell[467841, 12649, 873, 18, 52, "Input",ExpressionUUID->"3101c1c5-55b6-42e8-a948-cc4cc1b5410d",
 CellID->493738057],
Cell[468717, 12669, 1101, 17, 34, "Output",ExpressionUUID->"a0114328-3c93-4fec-9200-ebe28527ab05",
 CellID->1438319851],
Cell[469821, 12688, 1110, 17, 34, "Output",ExpressionUUID->"e6af9139-17b4-43ee-848d-53b747e11703",
 CellID->1765805125]
}, Open  ]],
Cell[470946, 12708, 294, 5, 58, "Text",ExpressionUUID->"4ea384ab-fa2c-4602-a6db-2bc6dbd8b072",
 CellID->1276748348],
Cell[CellGroupData[{
Cell[471265, 12717, 585, 11, 30, "Input",ExpressionUUID->"908f099f-17ed-492b-86ce-3f78f3fa4fa3",
 CellID->863398109],
Cell[471853, 12730, 343, 7, 34, "Output",ExpressionUUID->"e742ff3f-00be-46e3-88da-732f4f44d6bc",
 CellID->672623044]
}, Open  ]],
Cell[472211, 12740, 270, 5, 35, "Text",ExpressionUUID->"f58baee8-4ae4-44a6-a8fc-40f2aab5891b",
 CellID->1629395466],
Cell[CellGroupData[{
Cell[472506, 12749, 998, 23, 52, "Input",ExpressionUUID->"266f7d0b-d22b-4931-870f-d618b9e6d76f",
 CellID->585015184],
Cell[473507, 12774, 564, 9, 50, "Output",ExpressionUUID->"955781e8-07c1-4f71-b205-bdd6d0a8b787",
 CellID->2023029166]
}, Open  ]],
Cell[474086, 12786, 313, 5, 58, "Text",ExpressionUUID->"1fb39b84-e162-4908-9ca7-de4723d05a7c",
 CellID->209396844],
Cell[CellGroupData[{
Cell[474424, 12795, 413, 8, 52, "Input",ExpressionUUID->"021bf6a6-3575-4ec5-ae3b-9c722fc53421",
 CellID->716244675],
Cell[474840, 12805, 496, 9, 34, "Output",ExpressionUUID->"85385aaf-ffd5-4bf8-a664-9c7964a1e929",
 CellID->2112217151],
Cell[475339, 12816, 541, 11, 50, "Output",ExpressionUUID->"2ae797c5-9dd5-4550-98fc-d71128e5eedd",
 CellID->2128971947]
}, Open  ]],
Cell[475895, 12830, 377, 6, 58, "Text",ExpressionUUID->"7449c919-ab81-4359-a364-4e7da88ccf4f",
 CellID->638836156]
}, Open  ]]
}, Open  ]],
Cell[476299, 12840, 263, 4, 54, "Subsection",ExpressionUUID->"e287b045-1d6a-48a7-9974-1db8f8a346e8",
 CellTags->"Section13",
 CellID->2091554196],
Cell[476565, 12846, 294, 4, 38, "Subsection",ExpressionUUID->"3205a79a-5b6b-46b6-ba07-b98f7be9455b",
 CellTags->"Section16",
 CellID->113725620],
Cell[CellGroupData[{
Cell[476884, 12854, 214, 3, 38, "Subsection",ExpressionUUID->"ddd4ceb2-38d0-4e70-996c-324ca3967159",
 CellTags->"Section17",
 CellID->1872307380],
Cell[CellGroupData[{
Cell[477123, 12861, 256, 5, 38, "MathCaption",ExpressionUUID->"4ff4e37d-19e9-41bb-bfc9-6c40ea0985b2",
 CellID->36883450],
Cell[477382, 12868, 416, 14, 39, "Text",ExpressionUUID->"6b3e92f0-394c-4fc3-9ac5-8d8d6f31efb0",
 CellID->2080521275],
Cell[CellGroupData[{
Cell[477823, 12886, 1938, 49, 199, "Input",ExpressionUUID->"4d8b2e7e-44c8-4f2e-aa83-b1f3364499ce",
 CellID->1584251975],
Cell[479764, 12937, 3144, 74, 128, "Output",ExpressionUUID->"72e17df4-5d19-4cbd-95f1-838bdd9f1ed5",
 CellID->459030869]
}, Open  ]],
Cell[CellGroupData[{
Cell[482945, 13016, 559, 15, 73, "Input",ExpressionUUID->"449a7549-440c-4372-8e88-bcdc9f6e5ebb",
 CellID->1402183775],
Cell[483507, 13033, 10574, 308, 218, "Output",ExpressionUUID->"9777293c-4664-4e08-a45d-0df3cf54067b",
 CellID->2070254441]
}, Open  ]],
Cell[494096, 13344, 307, 7, 35, "Text",ExpressionUUID->"a0c586a4-810f-4b17-b276-1e322679d4ac",
 CellID->1841454813],
Cell[CellGroupData[{
Cell[494428, 13355, 408, 10, 30, "Input",ExpressionUUID->"98e7694b-571d-4781-a3b1-65603ec321fd",
 CellID->1289821143],
Cell[494839, 13367, 4956, 119, 128, "Output",ExpressionUUID->"6f8457a9-b796-441e-9719-46fcbc76a649",
 CellID->2015595243]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[499844, 13492, 213, 2, 38, "MathCaption",ExpressionUUID->"324edde9-0dfa-4937-85fa-4ed77ffb8bad",
 CellID->406638749],
Cell[500060, 13496, 271, 5, 35, "Text",ExpressionUUID->"77b08221-606c-4755-8e91-52cf82db8ca6",
 CellID->994254636],
Cell[500334, 13503, 681, 18, 115, "Input",ExpressionUUID->"cbc9caeb-c7d6-4198-a1b7-68d81abc4046",
 CellID->215354860],
Cell[501018, 13523, 365, 8, 58, "Text",ExpressionUUID->"edf77351-4b4e-4fe3-81bb-ab61bba93e77",
 CellID->1204678952],
Cell[501386, 13533, 680, 17, 73, "Input",ExpressionUUID->"c5d31846-6e4b-41da-bef5-033630339b2e",
 CellID->867337255],
Cell[502069, 13552, 212, 2, 35, "Text",ExpressionUUID->"5d45f090-3d8e-423b-ab2e-2cc755f4e3c4",
 CellID->489040982],
Cell[CellGroupData[{
Cell[502306, 13558, 673, 18, 52, "Input",ExpressionUUID->"eeffc507-834c-4d4b-acee-b4faf8355249",
 CellID->275964604],
Cell[502982, 13578, 1056, 29, 60, "Output",ExpressionUUID->"10675593-9188-4f7c-b7eb-fe29df5965de",
 CellID->1156987826]
}, Open  ]],
Cell[504053, 13610, 207, 2, 35, "Text",ExpressionUUID->"0df73a9b-58df-452b-8d75-93129dddf77a",
 CellID->1882657478],
Cell[CellGroupData[{
Cell[504285, 13616, 1254, 31, 115, "Input",ExpressionUUID->"9b37f1b1-3647-4440-a2b7-cbb193eb3b55",
 CellID->254452149],
Cell[505542, 13649, 7287, 176, 208, "Output",ExpressionUUID->"f8ae321a-728b-4ff2-83a6-836dcc8ef926",
 CellID->1714799261]
}, Open  ]],
Cell[512844, 13828, 211, 2, 35, "Text",ExpressionUUID->"4ad6b414-34c7-4662-af43-19097a227be5",
 CellID->32473192],
Cell[CellGroupData[{
Cell[513080, 13834, 845, 21, 57, "Input",ExpressionUUID->"da69d5cc-b5ab-4d62-93f9-2b76fbb9cfe0",
 CellID->1257594333],
Cell[513928, 13857, 10091, 243, 206, "Output",ExpressionUUID->"57ee4e76-12f6-4841-b287-998178a8be36",
 CellID->1564610725]
}, Open  ]],
Cell[524034, 14103, 236, 3, 35, "Text",ExpressionUUID->"867d26ab-6efd-4ac4-a065-f2c02a82e7a3",
 CellID->1021716225],
Cell[CellGroupData[{
Cell[524295, 14110, 307, 6, 30, "Input",ExpressionUUID->"be494283-1744-4f4d-aa9a-bba4abc7c962",
 CellID->1161547237],
Cell[524605, 14118, 18103, 584, 268, "Output",ExpressionUUID->"57ad0f77-0e5f-4d76-b805-d992eb2c6422",
 CellID->1354512776]
}, Open  ]],
Cell[542723, 14705, 226, 4, 35, "Text",ExpressionUUID->"38ad7588-3f25-4c53-a44d-da8eb8848904",
 CellID->484486733],
Cell[CellGroupData[{
Cell[542974, 14713, 500, 13, 34, "Input",ExpressionUUID->"681ad7b8-d016-45e8-ab71-b124f5aec3c8",
 CellID->1744020104],
Cell[543477, 14728, 7283, 178, 201, "Output",ExpressionUUID->"0575b0ad-1414-43ad-9204-d7ab78859e5a",
 CellID->1512984293]
}, Open  ]],
Cell[CellGroupData[{
Cell[550797, 14911, 357, 7, 30, "Input",ExpressionUUID->"8426bb01-3ac7-4591-870a-ccbe2b946da5",
 CellID->1156473617],
Cell[551157, 14920, 17973, 581, 268, "Output",ExpressionUUID->"bf517356-87f8-4184-8d66-c6bbb099d795",
 CellID->63595576]
}, Open  ]],
Cell[569145, 15504, 189, 2, 35, "Text",ExpressionUUID->"13ef91f6-a84e-408f-8812-3e462e24f03e",
 CellID->1752880784],
Cell[CellGroupData[{
Cell[569359, 15510, 448, 12, 34, "Input",ExpressionUUID->"1afa1637-a0d6-4552-8e24-72df7113ef1e",
 CellID->942757313],
Cell[569810, 15524, 7381, 179, 201, "Output",ExpressionUUID->"5de2fe7f-5460-4d6d-becd-9e2c3e776bad",
 CellID->437891486]
}, Open  ]],
Cell[CellGroupData[{
Cell[577228, 15708, 258, 5, 30, "Input",ExpressionUUID->"08c290a7-3ea1-420f-9073-8d30a364ef3f",
 CellID->122695161],
Cell[577489, 15715, 17999, 580, 320, "Output",ExpressionUUID->"f96e24fa-1c79-422b-91ee-690e97c4b452",
 CellID->1938020292]
}, Open  ]],
Cell[595503, 16298, 291, 5, 58, "Text",ExpressionUUID->"a78ddac0-44d0-40e5-aa47-920a11174aab",
 CellID->1267255046],
Cell[CellGroupData[{
Cell[595819, 16307, 500, 13, 34, "Input",ExpressionUUID->"2e371800-083b-4777-9d88-13edeef7abcf",
 CellID->1682375797],
Cell[596322, 16322, 7307, 178, 201, "Output",ExpressionUUID->"ac71248a-6388-48d3-b437-7c5a1d3a3e5a",
 CellID->1705148470]
}, Open  ]],
Cell[603644, 16503, 181, 2, 35, "Text",ExpressionUUID->"c71d10da-fd0f-4cb5-88b7-9d57a416ddcd",
 CellID->1630399353],
Cell[CellGroupData[{
Cell[603850, 16509, 309, 6, 30, "Input",ExpressionUUID->"8ce2ab95-2562-4ada-ba89-831d3cccfb36",
 CellID->723586098],
Cell[604162, 16517, 18150, 582, 320, "Output",ExpressionUUID->"8c12c98f-e7eb-4160-96b3-5b58e93de970",
 CellID->1446663740]
}, Open  ]],
Cell[622327, 17102, 265, 5, 35, "Text",ExpressionUUID->"ac8dee16-1054-49df-abf5-015c58f733b2",
 CellID->2003803216],
Cell[622595, 17109, 367, 9, 30, "Input",ExpressionUUID->"1b7aa103-d70d-44cf-9841-023310ca6008",
 CellID->528506718],
Cell[622965, 17120, 254, 5, 35, "Text",ExpressionUUID->"cbe6ba90-7b74-49c2-9b1d-c22cf83ed37b",
 CellID->386816352],
Cell[623222, 17127, 329, 7, 30, "Input",ExpressionUUID->"8addb7a7-ff00-40ce-a748-0bb393d48ea5",
 CellID->1776881829],
Cell[623554, 17136, 297, 5, 58, "Text",ExpressionUUID->"0ecad7c1-12c4-45b8-9dbc-5b5d73b5ae32",
 CellID->925300932],
Cell[CellGroupData[{
Cell[623876, 17145, 695, 19, 73, "Input",ExpressionUUID->"d308c5c5-f92f-4186-8fd5-7c6945b0c92f",
 CellID->1869627664],
Cell[624574, 17166, 3451, 79, 185, "Output",ExpressionUUID->"b6da2275-49b7-4a91-b6a2-93a84873402e",
 CellID->901160145]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

