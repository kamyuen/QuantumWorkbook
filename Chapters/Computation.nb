(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    724824,      19286]
NotebookOptionsPosition[    657091,      17789]
NotebookOutlinePosition[    661043,      17895]
CellTagsIndexPosition[    660559,      17877]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Quantum Computation: Overview", "Title",
 CellChangeTimes->{{3.81848277080221*^9, 3.818482778013246*^9}, {
  3.818621337257331*^9, 
  3.818621344827136*^9}},ExpressionUUID->"b9269d85-53e8-4b1a-8e3e-\
227531db259b"],

Cell[TextData[{
 "The  ",
 ButtonBox["full text of Chapter 2 ",
  BaseStyle->"Link",
  Appearance->"Frameless",
  Evaluator->Automatic,
  Method->"Preemptive",
  ButtonFunction:>SystemOpen[
    PacletObject["QuantumPlaybook"]["AssetLocation", "Chapter2"]]],
 "of the book, ",
 ButtonBox["\[OpenCurlyDoubleQuote]A Quantum Computation Workbook\
\[CloseCurlyDoubleQuote] (Springer, 2022)",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://link.springer.com/book/9783030912130"], None}],
 ", is available free of charge in PDF. To read it, click ",
 ButtonBox["here",
  BaseStyle->"Link",
  Appearance->"Frameless",
  Evaluator->Automatic,
  Method->"Preemptive",
  ButtonFunction:>SystemOpen[
    PacletObject["QuantumPlaybook"]["AssetLocation", "Chapter2"]]],
 "."
}], "Text",
 CellChangeTimes->{{3.826685996136866*^9, 3.8266860852511997`*^9}, {
   3.826686124828341*^9, 3.826686152129993*^9}, {3.82668621593815*^9, 
   3.82668621774926*^9}, {3.870635669929178*^9, 3.870635694377792*^9}, 
   3.8706357958930073`*^9, {3.8706358456189413`*^9, 3.8706358478900137`*^9}},
 Background->GrayLevel[0.95],
 CellID->630101851,ExpressionUUID->"819d51fb-97b0-4eae-9610-287527d4535f"],

Cell[BoxData[
 RowBox[{"<<", "Q3`"}]], "Input",
 CellEpilog:>Get["QuantumPlaybook`Custom`"],
 CellChangeTimes->{{3.81862136736141*^9, 3.818621374064451*^9}, {
  3.819804603089723*^9, 3.819804603474471*^9}, {3.82044708816819*^9, 
  3.820447090260006*^9}, {3.8223628653829613`*^9, 3.822362866135529*^9}, {
  3.8228059408010607`*^9, 3.8228059410543423`*^9}, {3.82384509173897*^9, 
  3.8238450942011337`*^9}, {3.824001730504662*^9, 3.824001734328494*^9}, {
  3.827028329361655*^9, 3.8270283297304153`*^9}, {3.831885511406905*^9, 
  3.8318855117628183`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"461ddb1f-d118-47e8-96bb-6e4be8172a11"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8186213773725233`*^9, 3.8186213801841288`*^9}, {
  3.8257131068437862`*^9, 3.825713111714123*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"d69ce98c-fbd2-4f2c-9529-43b1fbb7afb1"],

Cell[BoxData[
 FormBox[GridBox[{
    {
     ButtonBox[
      StyleBox["\<\"Table of Contents\"\>",
       StripOnInput->False,
       FontWeight->Bold],
      Alignment->Left,
      Appearance->None,
      ButtonFunction:>{},
      Evaluator->None,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"Single-Qubit Gates\"\>", True->
       StyleBox["\<\"Single-Qubit Gates\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 804948658, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tPauli Gates\"\>", True->
       StyleBox["\<\"\\tPauli Gates\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 1537806034, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tHadamard Gates\"\>", True->
       StyleBox["\<\"\\tHadamard Gates\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 1356319152, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tRotations\"\>", True->
       StyleBox["\<\"\\tRotations\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 1968530614, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"Two-Qubit Gates\"\>", True->
       StyleBox["\<\"Two-Qubit Gates\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 1365402155, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tCNOT, CZ, and SWAP\"\>", True->
       StyleBox["\<\"\\tCNOT, CZ, and SWAP\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 693517034, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tControlled-Unitary Gates\"\>", True->
       StyleBox["\<\"\\tControlled-Unitary Gates\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 1934269812, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tGeneral Unitary Gates\"\>", True->
       StyleBox["\<\"\\tGeneral Unitary Gates\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 1510815334, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"Multi-Control Unitary Gates\"\>", True->
       StyleBox["\<\"Multi-Control Unitary Gates\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 882238498, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tGray-Code Method\"\>", True->
       StyleBox["\<\"\\tGray-Code Method\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 1865203558, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"\\tMulti-Control NOT Gate\"\>", True->
       StyleBox["\<\"\\tMulti-Control NOT Gate\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 2106499675, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"Universal Quantum Computation\"\>", True->
       StyleBox["\<\"Universal Quantum Computation\"\>", "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 1817331573, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]},
    {
     ButtonBox[
      PaneSelectorBox[{False->"\<\"Computational Model of Measurement\"\>", 
       True->
       StyleBox["\<\"Computational Model of Measurement\"\>", 
        "HyperlinkActive",
        StripOnInput->False]}, Dynamic[
        CurrentValue["MouseOver"]],
       FrameMargins->0,
       ImageSize->Automatic],
      Alignment->Left,
      Appearance->None,
      BaseStyle->"Hyperlink",
      ButtonFunction:>NotebookFind[
        SelectedNotebook[], 1767938601, All, CellID],
      Evaluator->Automatic,
      Method->"Preemptive"]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
  Column]], "Text",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellMargins->{Inherited, {Inherited, 25}},
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellFrameColor->GrayLevel[0.7],
 CellTags->"TableOfContents",
 CellID->553974589,ExpressionUUID->"7c968048-ded6-4305-9116-145cef563aec"],

Cell[CellGroupData[{

Cell["Single-Qubit Gates", "Section",
 CellChangeTimes->{{3.826965545753907*^9, 3.826965548340925*^9}},
 CellTags->"Section61",
 CellID->804948658,ExpressionUUID->"94082665-6e64-4d6d-8a69-6ad86de08f8d"],

Cell[CellGroupData[{

Cell["Pauli Gates", "Subsection",
 CellChangeTimes->{{3.818624532533708*^9, 3.818624534231947*^9}},
 CellTags->"Section28",
 CellID->1537806034,ExpressionUUID->"d136d46e-6480-487d-bebd-7573dede2891"],

Cell[CellGroupData[{

Cell[TextData[{
 "The Pauli X gate is represented by ",
 StyleBox["S[\[Ellipsis],1]", "Input"],
 "."
}], "MathCaption",
 CellChangeTimes->{{3.818621389465086*^9, 3.818621404291617*^9}, {
   3.818623248350463*^9, 3.818623251578162*^9}, 3.8186236523965263`*^9, {
   3.81862455866608*^9, 3.818624571906344*^9}, {3.823839977926812*^9, 
   3.8238400228684483`*^9}, {3.8257129267045097`*^9, 
   3.8257129390101767`*^9}},ExpressionUUID->"d40d797f-b56b-4c8d-b649-\
45cb89dd8676"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"S", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.81862454665527*^9, 3.818624585529467*^9}, {
  3.8257129435107718`*^9, 3.825712944826384*^9}, {3.825713453938369*^9, 
  3.825713464997376*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"9f04b05c-bb2d-4a40-b996-1f4295e63b61"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"\"x\""}, "RowDefault"]},
   "Superscript"],
  $CellContext`S[1]]], "Output",
 CellChangeTimes->{
  3.8257134661030607`*^9, 3.826326506784478*^9, 3.826329715650999*^9, 
   3.826330658725959*^9, {3.826333643752534*^9, 3.8263336584821453`*^9}, 
   3.8301433312139797`*^9, 3.83621070451976*^9, 3.839372813921949*^9, 
   3.839714251457528*^9, 3.849255541290914*^9, 3.85181018859721*^9, 
   3.869387826370295*^9, 3.885076083532713*^9},
 CellLabel->"Out[4]=",
 CellID->136613171,ExpressionUUID->"45c19c79-2065-4580-a6f9-828cae98c967"]
}, Open  ]],

Cell["It corresponds to the Pauli X matrix.", "Text",
 CellChangeTimes->{{3.825713470723015*^9, 
  3.825713479238593*^9}},ExpressionUUID->"80fb2058-0246-442b-b3e1-\
508dbf47c715"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", 
   RowBox[{"S", "[", "1", "]"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.81862454665527*^9, 3.818624585529467*^9}, {
  3.8257129435107718`*^9, 3.825712944826384*^9}, {3.825713453938369*^9, 
  3.825713464997376*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"aa7af65a-3649-47da-8cf9-a438d55cc478"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1"},
     {"1", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {1, {{0, 1, 2}, {{2}, {1}}}, {1, 1}}]]]]], "Output",\

 CellChangeTimes->{
  3.8186245509055023`*^9, {3.818624585864015*^9, 3.818624595248075*^9}, 
   3.8186479411326227`*^9, 3.8188353220012197`*^9, 3.819804608063644*^9, 
   3.8200219351450253`*^9, 3.822805955548738*^9, 3.823839332576545*^9, {
   3.825712624287004*^9, 3.825712631932041*^9}, {3.825712945471085*^9, 
   3.8257129474264927`*^9}, {3.8257134574077997`*^9, 3.825713484665298*^9}, 
   3.826326508032309*^9, 3.82632971565663*^9, 3.826330660051331*^9, {
   3.826333644810904*^9, 3.826333658512786*^9}, 3.830143332454628*^9, 
   3.836210708296939*^9, 3.8393728150143557`*^9, 3.83971425334825*^9, 
   3.8492555423694143`*^9, 3.851810188602042*^9, 3.869387827504018*^9, 
   3.88507608512932*^9},
 CellLabel->"Out[5]//MatrixForm=",
 CellID->107894941,ExpressionUUID->"25728273-fa53-493f-ad85-7d081509b96f"]
}, Open  ]],

Cell["\<\
In the quantum circuit model, it is denoted by the following quantum circuit \
element.\
\>", "Text",
 CellChangeTimes->{{3.825712645340199*^9, 3.825712702769148*^9}, {
  3.825712954141368*^9, 
  3.825712961127268*^9}},ExpressionUUID->"054c6e66-8b9c-41eb-abf0-\
5b8eaa37e570"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{"S", "[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8257127061020813`*^9, 3.8257127500068817`*^9}, {
   3.82571296812493*^9, 3.8257129685965757`*^9}, 3.826326515516995*^9, 
   3.829808799410262*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"a95d7495-bada-4c60-a336-2108079ab32c"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, LineBox[{{{0, -1}, {2, -1}}}], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-3, 2], 
       Rational[-1, 2]}}, {Full, {-1.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1]]]], "Output",
 CellChangeTimes->{{3.8257127275339813`*^9, 3.825712750355772*^9}, {
   3.82571296976722*^9, 3.825712971537015*^9}, {3.8263265092012043`*^9, 
   3.826326515884384*^9}, 3.826329715690259*^9, 3.826330661120195*^9, 
   3.8263307636632843`*^9, 3.826330827446179*^9, {3.826333645819489*^9, 
   3.826333658518984*^9}, 3.830143334038774*^9, 3.8362107096742477`*^9, 
   3.839372816048465*^9, 3.8397142548461647`*^9, 3.849255543384246*^9, 
   3.8518101886052227`*^9, 3.8693878292548437`*^9, 3.885076086776163*^9},
 CellLabel->"Out[6]=",
 CellID->1351311228,ExpressionUUID->"707f8bb4-41d7-466a-ae94-3f94b5844f15"]
}, Open  ]],

Cell["\<\
Operating on the logical basis states, it flips the states and is similar to \
the classical logical gate NOT.\
\>", "Text",
 CellChangeTimes->{{3.8257130279380407`*^9, 3.825713068886476*^9}, {
  3.8257131493667994`*^9, 
  3.8257131810223*^9}},ExpressionUUID->"6ebc6fee-93f6-4100-ab1d-a3925d832171"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"Basis", "[", "S", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"S", "[", "1", "]"}], "**", "bs"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"bs", "\[Rule]", "out"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.8257127862107267`*^9, 3.825712808504332*^9}, {
  3.82571297791226*^9, 3.8257130053489923`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"ac64401f-2be2-440f-a859-7dda40e2db16"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox["S", 
              $CellContext`S[Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox["S", 
              $CellContext`S[Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox["S", 
              $CellContext`S[Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox["S", 
              $CellContext`S[Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[Q3`$] -> 0|>]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.825712995474132*^9, 3.8257130236885777`*^9}, 
   3.825713081826483*^9, 3.825713183450844*^9, 3.82632651848739*^9, 
   3.826329715696488*^9, 3.826333658548737*^9, 3.8301433352466593`*^9, 
   3.836210710885645*^9, 3.839372817208029*^9, 3.839714256118441*^9, 
   3.849255544370942*^9, 3.851810188609435*^9, 3.8693878308662863`*^9, 
   3.8850760885453377`*^9},
 CellLabel->"Out[9]//TableForm=",
 CellID->587064359,ExpressionUUID->"09da62fb-ab62-4800-8fa3-f43e73f6a338"]
}, Open  ]],

Cell["\<\
Operating on a superposition state, it flips the state \
\[OpenCurlyDoubleQuote]simultaneously\[CloseCurlyDoubleQuote].\
\>", "Text",
 CellChangeTimes->{{3.825713119176529*^9, 3.825713140815971*^9}, {
  3.825713189245635*^9, 
  3.825713193419155*^9}},ExpressionUUID->"2461e8f2-87b4-402e-9cdb-\
0a444be5c840"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Ket", "[", "]"}], 
     RowBox[{"c", "[", "0", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"S", "\[Rule]", "1"}], "]"}], 
     RowBox[{"c", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"in", "//", "LogicalForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"S", "[", "1", "]"}], "**", "in"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.825713197089552*^9, 3.825713230509366*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"e9dc21d0-10de-4c40-ac88-9260c8ff2db3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"c"},
      "RowDefault"], 
     TemplateBox[{"0"},
      "RowDefault"]],
    $CellContext`c[0]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox["S", 
          $CellContext`S[Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"c"},
      "RowDefault"], 
     TemplateBox[{"1"},
      "RowDefault"]],
    $CellContext`c[1]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox["S", 
          $CellContext`S[Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[Q3`$] -> 1|>]]}]}]], "Output",
 CellChangeTimes->{{3.825713206712913*^9, 3.825713245437133*^9}, 
   3.8263265211604757`*^9, 3.826329715728849*^9, 3.826333658555901*^9, 
   3.83014333797785*^9, 3.83621071212919*^9, 3.83937281844604*^9, 
   3.839714257793455*^9, 3.8492555453855677`*^9, 3.851810188621698*^9, 
   3.869387832406088*^9, 3.885076109284874*^9},
 CellLabel->"Out[11]=",
 CellID->136310634,ExpressionUUID->"00c09caf-c8ec-4d65-ac55-48b8ccaf876a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"c"},
      "RowDefault"], 
     TemplateBox[{"1"},
      "RowDefault"]],
    $CellContext`c[1]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox["S", 
          $CellContext`S[Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"c"},
      "RowDefault"], 
     TemplateBox[{"0"},
      "RowDefault"]],
    $CellContext`c[0]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox["S", 
          $CellContext`S[Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[Q3`$] -> 1|>]]}]}]], "Output",
 CellChangeTimes->{{3.825713206712913*^9, 3.825713245437133*^9}, 
   3.8263265211604757`*^9, 3.826329715728849*^9, 3.826333658555901*^9, 
   3.83014333797785*^9, 3.83621071212919*^9, 3.83937281844604*^9, 
   3.839714257793455*^9, 3.8492555453855677`*^9, 3.851810188621698*^9, 
   3.869387832406088*^9, 3.885076109303668*^9},
 CellLabel->"Out[13]=",
 CellID->1755257936,ExpressionUUID->"9698b0a0-33c5-4a3e-bfaf-d3fd4699b0a5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The Pauli Z gate is represented by ",
 StyleBox["S[\[Ellipsis],3]", "Input"],
 "."
}], "MathCaption",
 CellChangeTimes->{{3.818621389465086*^9, 3.818621404291617*^9}, {
   3.818623248350463*^9, 3.818623251578162*^9}, 3.8186236523965263`*^9, {
   3.81862455866608*^9, 3.818624571906344*^9}, {3.823839977926812*^9, 
   3.8238400228684483`*^9}, {3.8257129267045097`*^9, 
   3.8257129390101767`*^9}, {3.82571325909439*^9, 
   3.8257132609617577`*^9}},ExpressionUUID->"a6ac5eb1-d684-4c82-8a9b-\
7174c87b2019"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"S", "[", "3", "]"}]], "Input",
 CellChangeTimes->{{3.81862454665527*^9, 3.818624585529467*^9}, {
   3.8257129435107718`*^9, 3.825712944826384*^9}, {3.825713262942047*^9, 
   3.82571326301998*^9}, {3.825713440653366*^9, 3.825713443903433*^9}, 
   3.8257134989839363`*^9},
 CellLabel->"In[14]:=",ExpressionUUID->"1a85a8d3-1cb7-4325-825c-ee9b21250c1b"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"\"z\""}, "RowDefault"]},
   "Superscript"],
  $CellContext`S[3]]], "Output",
 CellChangeTimes->{3.8257135088430433`*^9, 3.826326523180141*^9, 
  3.826329715736793*^9, 3.8263336585682783`*^9, 3.830143339429049*^9, 
  3.836210713838047*^9, 3.839372820192224*^9, 3.8397142595026827`*^9, 
  3.8492555465061007`*^9, 3.851810188627078*^9, 3.869387834003106*^9, 
  3.885076112347978*^9},
 CellLabel->"Out[14]=",
 CellID->517522599,ExpressionUUID->"e7bf0233-b7e9-4361-a4f6-fe7c228d00ce"]
}, Open  ]],

Cell["It corresponds to the Pauli Z matrix.", "Text",
 CellChangeTimes->{{3.825713470723015*^9, 3.825713479238593*^9}, {
  3.82571351906275*^9, 
  3.825713519400065*^9}},ExpressionUUID->"8720ff9d-2e56-405f-a9c8-\
2d0b67114b55"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", 
   RowBox[{"S", "[", "3", "]"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.81862454665527*^9, 3.818624585529467*^9}, {
  3.8257129435107718`*^9, 3.825712944826384*^9}, {3.825713453938369*^9, 
  3.825713464997376*^9}, {3.825713505620495*^9, 3.8257135056435747`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"ce76741a-8ca8-4bc2-a88d-2561bf01c4e9"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0"},
     {"0", 
      RowBox[{"-", "1"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {1, {{0, 1, 2}, {{1}, {2}}}, {1, -1}}]]]]], "Output",\

 CellChangeTimes->{
  3.8186245509055023`*^9, {3.818624585864015*^9, 3.818624595248075*^9}, 
   3.8186479411326227`*^9, 3.8188353220012197`*^9, 3.819804608063644*^9, 
   3.8200219351450253`*^9, 3.822805955548738*^9, 3.823839332576545*^9, {
   3.825712624287004*^9, 3.825712631932041*^9}, {3.825712945471085*^9, 
   3.8257129474264927`*^9}, 3.825713263330449*^9, 3.825713444260021*^9, {
   3.825713506033587*^9, 3.825713512446046*^9}, 3.826326524530183*^9, 
   3.8263297157421722`*^9, 3.8263336585985413`*^9, 3.830143340662442*^9, 
   3.8362107151677017`*^9, 3.839372822649452*^9, 3.839714260708048*^9, 
   3.849255547567582*^9, 3.851810188637788*^9, 3.8693878355893583`*^9, 
   3.8850761135647163`*^9},
 CellLabel->"Out[15]//MatrixForm=",
 CellID->944725950,ExpressionUUID->"0d9258f1-29fb-4180-8494-f4f1cdde7946"]
}, Open  ]],

Cell["\<\
In the quantum circuit model, it is denoted by the following quantum circuit \
element.\
\>", "Text",
 CellChangeTimes->{{3.825712645340199*^9, 3.825712702769148*^9}, {
  3.825712954141368*^9, 
  3.825712961127268*^9}},ExpressionUUID->"039859f0-c61e-4b04-afa2-\
cf8765ed58c1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{"S", "[", "3", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8257127061020813`*^9, 3.8257127500068817`*^9}, {
   3.82571296812493*^9, 3.8257129685965757`*^9}, {3.825713271458117*^9, 
   3.8257132714799433`*^9}, 3.826326529600905*^9, 3.829808799419291*^9},
 CellLabel->"In[16]:=",ExpressionUUID->"820ac768-ef2a-45c2-afc7-5eb82aa224f1"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, LineBox[{{{0, -1}, {2, -1}}}], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-3, 2], 
       Rational[-1, 2]}}, {Full, {-1.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[3]]]], "Output",
 CellChangeTimes->{{3.8257127275339813`*^9, 3.825712750355772*^9}, {
   3.82571296976722*^9, 3.825712971537015*^9}, 3.825713271835907*^9, 
   3.826326529979529*^9, 3.826329715747568*^9, 3.826330682232589*^9, {
   3.826333658605288*^9, 3.826333671851139*^9}, 3.830143342057622*^9, 
   3.836210716474183*^9, 3.839372824044636*^9, 3.839714262038073*^9, 
   3.849255548690583*^9, 3.8518101886424*^9, 3.869387836965728*^9, 
   3.885076114951474*^9},
 CellLabel->"Out[16]=",
 CellID->720650376,ExpressionUUID->"d427944b-da7a-45bc-bd3b-a946ffa18b57"]
}, Open  ]],

Cell[TextData[{
 "Operating on the logical basis states, it \[OpenCurlyDoubleQuote]flips the \
phase\[CloseCurlyDoubleQuote], that is, it changes the phase factor to ",
 StyleBox["-1", "Input"],
 " of the logical basis state ",
 Cell[BoxData[
  TemplateBox[{"1"},
   "Ket"]],ExpressionUUID->"4b1bf8f5-0d0e-4ec5-99ba-13e32527d87f"],
 "."
}], "Text",
 CellChangeTimes->{{3.8257130279380407`*^9, 3.825713068886476*^9}, {
  3.8257131493667994`*^9, 3.8257131810223*^9}, {3.8257132833259897`*^9, 
  3.825713334872046*^9}},ExpressionUUID->"976291a9-1dfc-4f2f-95f7-\
814fc2a4dc1d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"Basis", "[", "S", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"S", "[", "3", "]"}], "**", "bs"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"bs", "\[Rule]", "out"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.8257127862107267`*^9, 3.825712808504332*^9}, {
  3.82571297791226*^9, 3.8257130053489923`*^9}, {3.825713275260957*^9, 
  3.8257132753387327`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"94f69b26-de8b-4a12-83d9-7b1159fad58b"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox["S", 
              $CellContext`S[Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox["S", 
              $CellContext`S[Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox["S", 
              $CellContext`S[Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[Q3`$] -> 1|>]], "\[Rule]", 
       RowBox[{"-", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{
             SubscriptBox["1", 
              InterpretationBox["S", 
               $CellContext`S[Q3`$]]]}, "RowDefault"]},
          "Ket"],
         Ket[<|$CellContext`S[Q3`$] -> 1|>]]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.825712995474132*^9, 3.8257130236885777`*^9}, 
   3.825713081826483*^9, 3.825713183450844*^9, 3.8257132756940823`*^9, {
   3.825713341943788*^9, 3.825713352702548*^9}, 3.82632653256609*^9, 
   3.826329715778534*^9, 3.826330685259638*^9, 3.826333658612545*^9, 
   3.830143343522386*^9, 3.83621071796611*^9, 3.839372825467156*^9, 
   3.8397142637030363`*^9, 3.8492555501774797`*^9, 3.85181018865381*^9, 
   3.869387838607531*^9, 3.8850761164651947`*^9},
 CellLabel->"Out[19]//TableForm=",
 CellID->729818788,ExpressionUUID->"fef71098-edad-4065-8d67-f95187a63108"]
}, Open  ]],

Cell["\<\
Here is an example how the Pauli Z gate acts on a superposition state.\
\>", "Text",
 CellChangeTimes->{{3.825713361972435*^9, 
  3.825713380690618*^9}},ExpressionUUID->"0915300b-ea63-40a0-b571-\
ba028cd9d6ea"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Ket", "[", "]"}], 
     RowBox[{"c", "[", "0", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"S", "\[Rule]", "1"}], "]"}], 
     RowBox[{"c", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"in", "//", "LogicalForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"S", "[", "3", "]"}], "**", "in"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.825713197089552*^9, 3.825713230509366*^9}, {
  3.8257133856749496`*^9, 3.8257133857416*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"91f59bd1-33ee-493a-869a-37d6dbd4a595"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"c"},
      "RowDefault"], 
     TemplateBox[{"0"},
      "RowDefault"]],
    $CellContext`c[0]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox["S", 
          $CellContext`S[Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"c"},
      "RowDefault"], 
     TemplateBox[{"1"},
      "RowDefault"]],
    $CellContext`c[1]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox["S", 
          $CellContext`S[Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[Q3`$] -> 1|>]]}]}]], "Output",
 CellChangeTimes->{{3.825713206712913*^9, 3.825713245437133*^9}, {
   3.825713353803855*^9, 3.825713390521796*^9}, 3.826326533919094*^9, 
   3.826329715785612*^9, 3.826333658619411*^9, 3.830143345247116*^9, 
   3.836210719607691*^9, 3.8393728270651417`*^9, 3.8397142651449833`*^9, 
   3.849255551820703*^9, 3.851810188659409*^9, 3.869387840039138*^9, 
   3.885076118212929*^9},
 CellLabel->"Out[21]=",
 CellID->835653133,ExpressionUUID->"194a8477-4e75-4388-84c7-10940d5e0ee1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"c"},
      "RowDefault"], 
     TemplateBox[{"0"},
      "RowDefault"]],
    $CellContext`c[0]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox["S", 
          $CellContext`S[Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[Q3`$] -> 0|>]]}], "-", 
  RowBox[{
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"c"},
      "RowDefault"], 
     TemplateBox[{"1"},
      "RowDefault"]],
    $CellContext`c[1]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox["S", 
          $CellContext`S[Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[Q3`$] -> 1|>]]}]}]], "Output",
 CellChangeTimes->{{3.825713206712913*^9, 3.825713245437133*^9}, {
   3.825713353803855*^9, 3.825713390521796*^9}, 3.826326533919094*^9, 
   3.826329715785612*^9, 3.826333658619411*^9, 3.830143345247116*^9, 
   3.836210719607691*^9, 3.8393728270651417`*^9, 3.8397142651449833`*^9, 
   3.849255551820703*^9, 3.851810188659409*^9, 3.869387840039138*^9, 
   3.885076118217617*^9},
 CellLabel->"Out[23]=",
 CellID->279154951,ExpressionUUID->"8970c9eb-b58a-43a8-9052-aefc1b0ddbdd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The Pauli Y gate is represented by ",
 StyleBox["S[\[Ellipsis],2]", "Input"],
 "."
}], "MathCaption",
 CellChangeTimes->{{3.818621389465086*^9, 3.818621404291617*^9}, {
   3.818623248350463*^9, 3.818623251578162*^9}, 3.8186236523965263`*^9, {
   3.81862455866608*^9, 3.818624571906344*^9}, {3.823839977926812*^9, 
   3.8238400228684483`*^9}, {3.8257129267045097`*^9, 
   3.8257129390101767`*^9}, {3.82571325909439*^9, 3.8257132609617577`*^9}, {
   3.825713399736334*^9, 
   3.825713406587365*^9}},ExpressionUUID->"34ec3e66-ffaf-4447-963d-\
07cbb97eb58c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"S", "[", "2", "]"}]], "Input",
 CellChangeTimes->{{3.81862454665527*^9, 3.818624585529467*^9}, {
   3.8257129435107718`*^9, 3.825712944826384*^9}, {3.825713262942047*^9, 
   3.82571326301998*^9}, {3.825713411706872*^9, 3.825713424104177*^9}, 
   3.825713527182322*^9},
 CellLabel->"In[24]:=",ExpressionUUID->"ebb6e219-9b2e-4788-beb7-5d1a35d34947"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"\"y\""}, "RowDefault"]},
   "Superscript"],
  $CellContext`S[2]]], "Output",
 CellChangeTimes->{3.825713528149259*^9, 3.826326536099168*^9, 
  3.826329715819648*^9, 3.826333658651154*^9, 3.830143348942623*^9, 
  3.836210721264502*^9, 3.8393728284197407`*^9, 3.839714266894786*^9, 
  3.849255553460238*^9, 3.851810188671832*^9, 3.885076120994993*^9},
 CellLabel->"Out[24]=",
 CellID->1902231535,ExpressionUUID->"4b866561-df5c-4149-afcb-6c2ace133028"]
}, Open  ]],

Cell["It corresponds to the Pauli Y matrix.", "Text",
 CellChangeTimes->{{3.825713470723015*^9, 3.825713479238593*^9}, {
  3.825713534734255*^9, 
  3.825713535059946*^9}},ExpressionUUID->"7873df99-9826-4131-9179-\
b307bf904799"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", 
   RowBox[{"S", "[", "2", "]"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.81862454665527*^9, 3.818624585529467*^9}, {
  3.8257129435107718`*^9, 3.825712944826384*^9}, {3.825713453938369*^9, 
  3.825713464997376*^9}, {3.8257135389414587`*^9, 3.8257135389857264`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"20673574-c5e0-413d-b784-8929a71b2f36"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"-", "\[ImaginaryI]"}]},
     {"\[ImaginaryI]", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 1, 2}, {{2}, {1}}}, {
      Complex[0, -1], Complex[0, 1]}}]]]]], "Output",
 CellChangeTimes->{
  3.8186245509055023`*^9, {3.818624585864015*^9, 3.818624595248075*^9}, 
   3.8186479411326227`*^9, 3.8188353220012197`*^9, 3.819804608063644*^9, 
   3.8200219351450253`*^9, 3.822805955548738*^9, 3.823839332576545*^9, {
   3.825712624287004*^9, 3.825712631932041*^9}, {3.825712945471085*^9, 
   3.8257129474264927`*^9}, 3.825713263330449*^9, {3.825713408994506*^9, 
   3.825713424368416*^9}, 3.8257135394025373`*^9, 3.826326537559196*^9, 
   3.826329715825872*^9, 3.82633365865774*^9, 3.830143350438354*^9, 
   3.836210722477832*^9, 3.83937282964192*^9, 3.839714268132716*^9, 
   3.849255554541057*^9, 3.8518101886760178`*^9, 3.8693878429208193`*^9, 
   3.885076122210136*^9},
 CellLabel->"Out[25]//MatrixForm=",
 CellID->1595486581,ExpressionUUID->"70898310-b7da-4178-9f8f-108138ea4bc9"]
}, Open  ]],

Cell["\<\
In the quantum circuit model, it is denoted by the following quantum circuit \
element.\
\>", "Text",
 CellChangeTimes->{{3.825712645340199*^9, 3.825712702769148*^9}, {
  3.825712954141368*^9, 
  3.825712961127268*^9}},ExpressionUUID->"59e2dccf-2e45-42c4-a9b4-\
17c6b958522e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{"S", "[", "2", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8257127061020813`*^9, 3.8257127500068817`*^9}, {
   3.82571296812493*^9, 3.8257129685965757`*^9}, {3.825713271458117*^9, 
   3.8257132714799433`*^9}, {3.825713544937821*^9, 3.8257135449609747`*^9}, 
   3.826326544180491*^9, 3.8298087994486732`*^9},
 CellLabel->"In[26]:=",ExpressionUUID->"8f326858-ced0-4ce4-a0ec-a8aa72348012"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, LineBox[{{{0, -1}, {2, -1}}}], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox["\<\"Y\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-3, 2], 
       Rational[-1, 2]}}, {Full, {-1.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[2]]]], "Output",
 CellChangeTimes->{{3.8257127275339813`*^9, 3.825712750355772*^9}, {
   3.82571296976722*^9, 3.825712971537015*^9}, 3.825713271835907*^9, {
   3.825713541006668*^9, 3.8257135454616957`*^9}, 3.826128286029435*^9, {
   3.826326538828508*^9, 3.826326544578589*^9}, 3.826329715857389*^9, 
   3.82633365868841*^9, 3.8301433516881104`*^9, 3.8362107237870197`*^9, 
   3.839372830902912*^9, 3.839714269637443*^9, 3.849255555718796*^9, 
   3.851810188686975*^9, 3.86938784429993*^9, 3.885076123860195*^9},
 CellLabel->"Out[26]=",
 CellID->903431194,ExpressionUUID->"329dbaf8-11fc-4d35-a8e1-71ac4e3800e8"]
}, Open  ]],

Cell["\<\
Pauli Y is a combination of the bit-flip (Pauli X) and phase-flip (Pauli Z) \
operation.\
\>", "Text",
 CellChangeTimes->{{3.826050594979191*^9, 3.8260506232933283`*^9}, {
  3.826050755946941*^9, 
  3.82605075763421*^9}},ExpressionUUID->"19fa5d6e-4835-4fa4-90e5-\
9a2c951f7ea6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", "1", "]"}], ",", 
    RowBox[{"S", "[", "3", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"op", "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}]}], "Input",
 CellChangeTimes->{{3.826050627040928*^9, 3.826050665738103*^9}, {
   3.82612824219531*^9, 3.826128250789013*^9}, 3.826326552358045*^9, 
   3.829808799451557*^9, 3.83014341088877*^9},
 CellLabel->"In[27]:=",ExpressionUUID->"c9e81ac5-8510-4af7-b766-fe5474c8677d"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, LineBox[{{{0, -1}, {3, -1}}}], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, 
     LineBox[{{1.6, -1.4}, {2.4, -1.4}, {2.4, -0.6}, {1.6, -0.6}, {
      1.6, -1.4}}], InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {2, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->154.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-3, 2], 
       Rational[-1, 2]}}, {Full, {-1.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1], 
   $CellContext`S[3]]]], "Output",
 CellChangeTimes->{
  3.826050762759324*^9, {3.826128252295397*^9, 3.826128280818079*^9}, {
   3.826326547371611*^9, 3.826326552786172*^9}, 3.826329715864098*^9, 
   3.826333658696054*^9, 3.830143353285841*^9, 3.836210725024653*^9, 
   3.839372832072011*^9, 3.839714271057438*^9, 3.849255556769809*^9, 
   3.851810188692542*^9, 3.869387845637834*^9, 3.8850761251909437`*^9},
 CellLabel->"Out[27]=",
 CellID->6742353,ExpressionUUID->"3f9dc362-4f15-40df-91bd-d921067beb77"],

Cell[BoxData[
 RowBox[{"\[ImaginaryI]", " ", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Superscript"],
   $CellContext`S[2]]}]], "Output",
 CellChangeTimes->{
  3.826050762759324*^9, {3.826128252295397*^9, 3.826128280818079*^9}, {
   3.826326547371611*^9, 3.826326552786172*^9}, 3.826329715864098*^9, 
   3.826333658696054*^9, 3.830143353285841*^9, 3.836210725024653*^9, 
   3.839372832072011*^9, 3.839714271057438*^9, 3.849255556769809*^9, 
   3.851810188692542*^9, 3.869387845637834*^9, 3.8850761251953373`*^9},
 CellLabel->"Out[28]=",
 CellID->1649577227,ExpressionUUID->"8887f028-b056-490d-8d71-243ea6dee8d9"]
}, Open  ]],

Cell["\<\
This shows more explicitly how Pauli Y \[OpenCurlyDoubleQuote]flips\
\[CloseCurlyDoubleQuote] both the bit and phase of the logical basis states.\
\>", "Text",
 CellChangeTimes->{{3.826050773148386*^9, 
  3.826050832555676*^9}},ExpressionUUID->"e07c1c22-ab65-4dd2-ab0d-\
2aff26f0976d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"Basis", "[", "S", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"S", "[", "2", "]"}], "**", "bs"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"bs", "\[Rule]", "out"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.8257127862107267`*^9, 3.825712808504332*^9}, {
  3.82571297791226*^9, 3.8257130053489923`*^9}, {3.825713275260957*^9, 
  3.8257132753387327`*^9}, {3.825713549358869*^9, 3.8257135494593782`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"435c8fe5-586d-4a98-9cb0-e352c3bb0b5b"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox["S", 
              $CellContext`S[Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[Q3`$] -> 0|>]], "\[Rule]", 
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{
             SubscriptBox["1", 
              InterpretationBox["S", 
               $CellContext`S[Q3`$]]]}, "RowDefault"]},
          "Ket"],
         Ket[<|$CellContext`S[Q3`$] -> 1|>]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox["S", 
              $CellContext`S[Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[Q3`$] -> 1|>]], "\[Rule]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{
             SubscriptBox["0", 
              InterpretationBox["S", 
               $CellContext`S[Q3`$]]]}, "RowDefault"]},
          "Ket"],
         Ket[<|$CellContext`S[Q3`$] -> 0|>]]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.825712995474132*^9, 3.8257130236885777`*^9}, 
   3.825713081826483*^9, 3.825713183450844*^9, 3.8257132756940823`*^9, {
   3.825713341943788*^9, 3.825713352702548*^9}, 3.8257135497945538`*^9, {
   3.826050588431753*^9, 3.826050591436213*^9}, 3.82605069091007*^9, 
   3.826050834113041*^9, 3.826326554271883*^9, 3.82632971589795*^9, 
   3.826333658727742*^9, 3.83014335504953*^9, 3.836210726396016*^9, 
   3.839372833549923*^9, 3.839714272318512*^9, 3.849255557986362*^9, 
   3.851810188705533*^9, 3.869387846972034*^9, 3.885076126594789*^9},
 CellLabel->"Out[31]//TableForm=",
 CellID->968569514,ExpressionUUID->"020da87c-bb5e-4bbc-af89-14e34b596cd4"]
}, Open  ]],

Cell["\<\
Here is an example how the Pauli Y gate acts on a superposition state.\
\>", "Text",
 CellChangeTimes->{{3.825713361972435*^9, 3.825713380690618*^9}, {
  3.826050682601389*^9, 
  3.826050683253064*^9}},ExpressionUUID->"e71f598d-7326-4c0d-99bf-\
cd63e059da65"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Ket", "[", "]"}], 
     RowBox[{"c", "[", "0", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"S", "\[Rule]", "1"}], "]"}], 
     RowBox[{"c", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"in", "//", "LogicalForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"S", "[", "2", "]"}], "**", "in"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.825713197089552*^9, 3.825713230509366*^9}, {
  3.8257133856749496`*^9, 3.8257133857416*^9}, {3.825713556266737*^9, 
  3.825713556333317*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"5c35afb4-3385-4510-916c-2a6ba6834367"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"c"},
      "RowDefault"], 
     TemplateBox[{"0"},
      "RowDefault"]],
    $CellContext`c[0]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox["S", 
          $CellContext`S[Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"c"},
      "RowDefault"], 
     TemplateBox[{"1"},
      "RowDefault"]],
    $CellContext`c[1]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox["S", 
          $CellContext`S[Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[Q3`$] -> 1|>]]}]}]], "Output",
 CellChangeTimes->{{3.825713206712913*^9, 3.825713245437133*^9}, {
   3.825713353803855*^9, 3.825713390521796*^9}, {3.82571355189587*^9, 
   3.825713563167523*^9}, 3.826050684768147*^9, 3.826050836073306*^9, 
   3.826326555758396*^9, 3.8263297159050417`*^9, 3.826333658736106*^9, 
   3.830143363315546*^9, 3.8362107278542128`*^9, 3.8393728349159613`*^9, 
   3.83971427361604*^9, 3.849255559269494*^9, 3.8518101887103987`*^9, 
   3.869387848600642*^9, 3.8850761280326633`*^9},
 CellLabel->"Out[33]=",
 CellID->1424026939,ExpressionUUID->"5a0f79b9-30ea-4a71-92e2-39bdaa7797bb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "\[ImaginaryI]"}], " ", 
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"c"},
      "RowDefault"], 
     TemplateBox[{"1"},
      "RowDefault"]],
    $CellContext`c[1]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox["S", 
          $CellContext`S[Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[Q3`$] -> 0|>]]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"c"},
      "RowDefault"], 
     TemplateBox[{"0"},
      "RowDefault"]],
    $CellContext`c[0]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox["S", 
          $CellContext`S[Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[Q3`$] -> 1|>]]}]}]], "Output",
 CellChangeTimes->{{3.825713206712913*^9, 3.825713245437133*^9}, {
   3.825713353803855*^9, 3.825713390521796*^9}, {3.82571355189587*^9, 
   3.825713563167523*^9}, 3.826050684768147*^9, 3.826050836073306*^9, 
   3.826326555758396*^9, 3.8263297159050417`*^9, 3.826333658736106*^9, 
   3.830143363315546*^9, 3.8362107278542128`*^9, 3.8393728349159613`*^9, 
   3.83971427361604*^9, 3.849255559269494*^9, 3.8518101887103987`*^9, 
   3.869387848600642*^9, 3.885076128036734*^9},
 CellLabel->"Out[35]=",
 CellID->2063001605,ExpressionUUID->"b0d60584-e897-420a-a1f5-5c7542042db1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The Pauli gates also correspond, up to a global phase factor (",
 Cell[BoxData[
  FormBox[
   RowBox[{"-", "i"}], TraditionalForm]],ExpressionUUID->
  "9bf9124c-9402-4a43-93b4-222a57daa433"],
 "), to rotations by the corresponding axes by angle \[Pi]. Here ",
 StyleBox["Rotation[\[Phi],S[\[Ellipsis],\[Mu]]]", "Input"],
 " represents the rotation operator around the \[Mu]-axis by angle \[Phi]."
}], "MathCaption",
 CellChangeTimes->{{3.826050889511829*^9, 3.826050993073821*^9}, {
  3.826051025787265*^9, 3.8260511106636677`*^9}, {3.836210764565318*^9, 
  3.836210770999948*^9}},ExpressionUUID->"e92b7fcd-10a8-4e75-b8b1-\
7af847a1dc0f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Rotation", "[", 
  RowBox[{"Pi", ",", 
   RowBox[{"S", "[", "1", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rotation", "[", 
   RowBox[{"Pi", ",", 
    RowBox[{"S", "[", "1", "]"}]}], "]"}], "//", "Elaborate"}]}], "Input",
 CellChangeTimes->{{3.826050924578861*^9, 3.826050934194028*^9}, {
  3.8362107347102003`*^9, 3.836210747185883*^9}, {3.836210777221483*^9, 
  3.836210787941616*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"40194263-cb82-4031-9c80-cb57644eedd4"],

Cell[BoxData[
 RowBox[{"Rotation", "[", 
  RowBox[{"\[Pi]", ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Superscript"],
    $CellContext`S[1]]}], "]"}]], "Output",
 CellChangeTimes->{{3.826050934824108*^9, 3.8260509467506723`*^9}, {
   3.826050994614525*^9, 3.82605101257932*^9}, 3.826051085794194*^9, 
   3.8263265578432302`*^9, 3.82632971593931*^9, 3.8263336587711477`*^9, 
   3.830143365386825*^9, {3.836210729442032*^9, 3.836210809158897*^9}, 
   3.83937283683071*^9, 3.839714275208117*^9, 3.849255560668499*^9, 
   3.851810188722797*^9, 3.869387850573304*^9, 3.885076129764413*^9},
 CellLabel->"Out[36]=",
 CellID->1565924886,ExpressionUUID->"80a32e78-5a39-4e88-b14f-914a69bf0fa6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "\[ImaginaryI]"}], " ", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"\"x\""}, "RowDefault"]},
    "Superscript"],
   $CellContext`S[1]]}]], "Output",
 CellChangeTimes->{{3.826050934824108*^9, 3.8260509467506723`*^9}, {
   3.826050994614525*^9, 3.82605101257932*^9}, 3.826051085794194*^9, 
   3.8263265578432302`*^9, 3.82632971593931*^9, 3.8263336587711477`*^9, 
   3.830143365386825*^9, {3.836210729442032*^9, 3.836210809158897*^9}, 
   3.83937283683071*^9, 3.839714275208117*^9, 3.849255560668499*^9, 
   3.851810188722797*^9, 3.869387850573304*^9, 3.885076129767805*^9},
 CellLabel->"Out[37]=",
 CellID->1087465017,ExpressionUUID->"cb81c886-eba9-4e00-8c1a-2bf919408c2e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Rotation", "[", 
   RowBox[{"Pi", ",", 
    RowBox[{"S", "[", "2", "]"}]}], "]"}], "//", "Elaborate"}]], "Input",
 CellChangeTimes->{{3.8260509960242653`*^9, 3.826051002140452*^9}, {
  3.8362107934879436`*^9, 3.836210795692326*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"77b6cd2e-cbee-44ad-9d20-25c06d263e23"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "\[ImaginaryI]"}], " ", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Superscript"],
   $CellContext`S[2]]}]], "Output",
 CellChangeTimes->{{3.82605100271344*^9, 3.826051013276938*^9}, 
   3.8260510865227423`*^9, 3.8263265585346413`*^9, 3.826329715945683*^9, 
   3.826333658779913*^9, 3.8301433662007627`*^9, 3.836210796019306*^9, 
   3.839372838127408*^9, 3.839714277097005*^9, 3.8492555620083942`*^9, 
   3.85181018872752*^9, 3.8693878526387653`*^9, 3.885076131796608*^9},
 CellLabel->"Out[38]=",
 CellID->507867996,ExpressionUUID->"96a049ba-67e8-4df9-b9d6-4bad1709c269"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Rotation", "[", 
   RowBox[{"Pi", ",", 
    RowBox[{"S", "[", "3", "]"}]}], "]"}], "//", "Elaborate"}]], "Input",
 CellChangeTimes->{{3.826051009532477*^9, 3.826051009609573*^9}, {
  3.836210799045615*^9, 3.83621080298223*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"177acc05-085b-463a-bae7-2522109e4b9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "\[ImaginaryI]"}], " ", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Superscript"],
   $CellContext`S[3]]}]], "Output",
 CellChangeTimes->{{3.826051009961281*^9, 3.826051013885168*^9}, 
   3.826051087163536*^9, 3.8263265593294973`*^9, 3.826329715976301*^9, 
   3.826333658814295*^9, 3.8301433672194242`*^9, 3.8362108033840322`*^9, 
   3.839372838929961*^9, 3.8397142785762444`*^9, 3.8492555627541313`*^9, 
   3.8518101887386*^9, 3.8693878534394608`*^9, 3.885076132836844*^9},
 CellLabel->"Out[39]=",
 CellID->427294717,ExpressionUUID->"e177a38e-ae31-4801-8c52-55ee2412b211"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Hadamard Gates", "Subsection",
 CellChangeTimes->{{3.818624536999832*^9, 3.818624539924034*^9}},
 CellTags->"Section29",
 CellID->1356319152,ExpressionUUID->"476e1422-a4ae-450f-b26d-d6d62170e06c"],

Cell[CellGroupData[{

Cell["The Hadamard gate is represented by S[..., 6] .", "MathCaption",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.818621389465086*^9, 3.818621404291617*^9}, {
   3.818623248350463*^9, 3.818623251578162*^9}, 3.8186236523965263`*^9, {
   3.818626536239739*^9, 3.818626536588682*^9}, {3.824001743846092*^9, 
   3.824001756075741*^9}},ExpressionUUID->"f769a5e3-bf2f-4e09-92a4-\
b93206f50249"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"S", "[", 
  RowBox[{"1", ",", "6"}], "]"}]], "Input",
 CellChangeTimes->{{3.818623254481566*^9, 3.818623265764312*^9}, {
   3.8186241154423428`*^9, 3.8186241321127787`*^9}, 3.818624169226514*^9},
 CellLabel->"In[40]:=",ExpressionUUID->"47f3a970-fafe-4050-812a-e1f285709a34"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"1"}, "RowDefault"], 
    TemplateBox[{"\"H\""}, "RowDefault"]},
   "Subsuperscript"],
  $CellContext`S[1, 6]]], "Output",
 CellChangeTimes->{3.818624172442634*^9, 3.818624221756383*^9, 
  3.8186479426419067`*^9, 3.818835323489685*^9, 3.819804609828603*^9, 
  3.8200219378568153`*^9, 3.8228059569377832`*^9, 3.8238393340072813`*^9, 
  3.82632656148142*^9, 3.826329715982497*^9, 3.826333658821361*^9, 
  3.830143369694047*^9, 3.836210812924984*^9, 3.839372841020885*^9, 
  3.83971428039113*^9, 3.849255564835472*^9, 3.84925609577255*^9, 
  3.8518101887431192`*^9, 3.869387855367879*^9, 3.885076134624864*^9},
 CellLabel->"Out[40]=",
 CellID->867347770,ExpressionUUID->"efc48c70-0d1b-4c08-9e1e-51c4bb2aa7b6"]
}, Open  ]],

Cell["Let us consider all the logical basis states.", "Text",
 CellChangeTimes->{{3.8238393724442253`*^9, 
  3.8238394009278727`*^9}},ExpressionUUID->"e4dd0856-6164-478e-9665-\
3afc13159e36"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"bs", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.818623778213904*^9, 3.818623817302516*^9}, 
   3.823839345717217*^9},
 CellLabel->"In[41]:=",ExpressionUUID->"04b6ea28-31d2-40b7-a99d-54c71b6141d7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}], "}"}]], "Output",
 CellChangeTimes->{3.823839349162426*^9, 3.82383940215973*^9, 
  3.8263265627095222`*^9, 3.8263297160151367`*^9, 3.826333658854739*^9, 
  3.8301433709201813`*^9, 3.836210814397835*^9, 3.839372842431964*^9, 
  3.839714281600767*^9, 3.8492555659352303`*^9, 3.8492560967337637`*^9, 
  3.85181018875399*^9, 3.869387856540475*^9, 3.88507613591645*^9},
 CellLabel->"Out[42]=",
 CellID->1656570076,ExpressionUUID->"08cf0f92-c389-48f2-bfab-6a66cf8b464f"]
}, Open  ]],

Cell["\<\
Operating the Hadamard gate on them gives the two superposition states.\
\>", "Text",
 CellChangeTimes->{{3.8238394090851507`*^9, 
  3.8238394358580513`*^9}},ExpressionUUID->"739ff9df-a0e3-45d7-b955-\
463b615443e9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], "**", "bs"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.818623778213904*^9, 3.818623817302516*^9}, 
   3.823839345717217*^9},
 CellLabel->"In[43]:=",ExpressionUUID->"1be73668-5869-47f8-af91-31634c0e24fb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox[
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
       "Ket"],
      Ket[<|$CellContext`S[1, Q3`$] -> 0|>]], 
     SqrtBox["2"]], "+", 
    FractionBox[
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
       "Ket"],
      Ket[<|$CellContext`S[1, Q3`$] -> 1|>]], 
     SqrtBox["2"]]}], ",", 
   RowBox[{
    FractionBox[
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
       "Ket"],
      Ket[<|$CellContext`S[1, Q3`$] -> 0|>]], 
     SqrtBox["2"]], "-", 
    FractionBox[
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
       "Ket"],
      Ket[<|$CellContext`S[1, Q3`$] -> 1|>]], 
     SqrtBox["2"]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.818623784387833*^9, 3.818623823385322*^9}, 
   3.8186242224002647`*^9, 3.818647943238207*^9, 3.818835324016183*^9, 
   3.819804617256995*^9, 3.8228059575206823`*^9, 3.823839341729044*^9, {
   3.823839437132477*^9, 3.823839439213262*^9}, 3.8263265641419897`*^9, 
   3.8263297160253687`*^9, 3.826333658888667*^9, 3.83014337220163*^9, 
   3.836210815704649*^9, 3.839372843926406*^9, 3.839714282902471*^9, 
   3.849255567192113*^9, 3.8492560978725348`*^9, 3.851810188768008*^9, 
   3.869387857785273*^9, 3.8850761372658377`*^9},
 CellLabel->"Out[44]=",
 CellID->1381440742,ExpressionUUID->"8719c5c5-3cfa-4d8e-baf6-7008bd149814"]
}, Open  ]],

Cell["\<\
In the quantum circuit model, it is denoted by the following circuit element.\
\
\>", "Text",
 CellChangeTimes->{{3.81862417666151*^9, 
  3.8186242040754137`*^9}},ExpressionUUID->"96104f7d-8059-4047-87e8-\
d6b041f591b5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{"S", "[", 
   RowBox[{"1", ",", "6"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.818623254481566*^9, 3.818623265764312*^9}, {
   3.8186241154423428`*^9, 3.8186241321127787`*^9}, 3.818624169226514*^9, {
   3.818626366978307*^9, 3.818626375267912*^9}, {3.8186264234299383`*^9, 
   3.818626425082181*^9}, 3.826326569918501*^9, 3.829808799466827*^9},
 CellLabel->"In[45]:=",ExpressionUUID->"e5bf2746-cb4f-41e2-8a75-e4ee262cb69d"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, LineBox[{{{0, -1}, {2, -1}}}], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-3, 2], 
       Rational[-1, 2]}}, {Full, {-1.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 6]]]], "Output",
 CellChangeTimes->{{3.818623255939554*^9, 3.818623267650558*^9}, 
   3.818624132446986*^9, 3.818624206038434*^9, {3.818626369569408*^9, 
   3.818626425365265*^9}, 3.818647944577664*^9, 3.818835326211357*^9, 
   3.8198046190538197`*^9, 3.822805958895524*^9, 3.823839442145761*^9, {
   3.826326565490086*^9, 3.8263265702990427`*^9}, 3.8263297160591183`*^9, 
   3.82633365889781*^9, 3.830143373505151*^9, 3.836210817034535*^9, 
   3.839372845165196*^9, 3.839714284297298*^9, 3.849255568382976*^9, 
   3.849256099153433*^9, 3.851810188775157*^9, 3.869387859119309*^9, 
   3.885076138796606*^9},
 CellLabel->"Out[45]=",
 CellID->1968947556,ExpressionUUID->"7c11486d-657d-4d47-bfde-0ff72be65571"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Geometrically, the Hadamard gate can be regarded as a rotation around the \
axis ",
 StyleBox["(1,0,1)", "Input"],
 " in the Pauli space by angle \[Pi]."
}], "MathCaption",
 CellChangeTimes->{{3.8260524842996693`*^9, 3.826052530805764*^9}, {
  3.826052662885573*^9, 
  3.826052666843919*^9}},ExpressionUUID->"225048a0-0443-4fc4-8b86-\
1db97d08705d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"op", "=", 
  RowBox[{
   RowBox[{"I", " ", 
    RowBox[{"Rotation", "[", 
     RowBox[{"\[Pi]", ",", "S", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "//", 
   "Elaborate"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "[", "op", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.826052532552526*^9, 3.826052603138674*^9}, {
  3.836210825595029*^9, 3.8362108306220503`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"26e4ef14-b02c-409c-b9a7-60883d5c07b5"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Superscript"],
    $CellContext`S[1]], 
   SqrtBox["2"]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Superscript"],
    $CellContext`S[3]], 
   SqrtBox["2"]]}]], "Output",
 CellChangeTimes->{{3.82605255199437*^9, 3.8260526185430403`*^9}, {
   3.8260526776615963`*^9, 3.8260526825712547`*^9}, 3.82632657207556*^9, 
   3.826329716065509*^9, 3.826330834371745*^9, 3.826333658928131*^9, 
   3.8301433749049377`*^9, {3.8362108192673683`*^9, 3.836210834434935*^9}, 
   3.839372846442567*^9, 3.839714285647355*^9, {3.849255744051284*^9, 
   3.8492557648705273`*^9}, 3.8492561006380987`*^9, 3.851810188786409*^9, 
   3.869387860772677*^9, 3.885076140264566*^9},
 CellLabel->"Out[46]=",
 CellID->417860374,ExpressionUUID->"6240bc47-877e-400d-a9b7-a7714d926544"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       SqrtBox["2"]], 
      FractionBox["1", 
       SqrtBox["2"]]},
     {
      FractionBox["1", 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {2}, {1}}}, {
      2^Rational[-1, 2], 2^Rational[-1, 2], -2^Rational[-1, 2], 2^
       Rational[-1, 2]}}]]]]], "Output",
 CellChangeTimes->{{3.82605255199437*^9, 3.8260526185430403`*^9}, {
   3.8260526776615963`*^9, 3.8260526825712547`*^9}, 3.82632657207556*^9, 
   3.826329716065509*^9, 3.826330834371745*^9, 3.826333658928131*^9, 
   3.8301433749049377`*^9, {3.8362108192673683`*^9, 3.836210834434935*^9}, 
   3.839372846442567*^9, 3.839714285647355*^9, {3.849255744051284*^9, 
   3.8492557648705273`*^9}, 3.8492561006380987`*^9, 3.851810188786409*^9, 
   3.869387860772677*^9, 3.885076140269063*^9},
 CellLabel->"Out[48]//MatrixForm=",
 CellID->707780128,ExpressionUUID->"a911a4fb-e832-4220-9cf2-cbd2b4ba537d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Suppose the Hadamard gates are applied to three qubits.", "MathCaption",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.81862314528251*^9, 3.81862317766955*^9}, {
  3.826052449158119*^9, 
  3.826052456423436*^9}},ExpressionUUID->"2f4837d8-be97-403a-8c5c-\
173cb2279e61"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"HoldForm", "@", 
   RowBox[{"Multiply", "[", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "6"}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "6"}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"3", ",", "6"}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.818621967766716*^9, 3.8186220674346027`*^9}, {
   3.818622120466002*^9, 3.818622211309163*^9}, 3.823839447885399*^9},
 CellLabel->"In[49]:=",ExpressionUUID->"ca38990a-0cdc-4826-a204-9f637171dc4f"],

Cell[BoxData[
 TagBox[
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"H\""}, "RowDefault"]}, "Subsuperscript", SyntaxForm -> 
         SubsuperscriptBox], 
        $CellContext`S[1, 6]], 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"], 
          TemplateBox[{"\"H\""}, "RowDefault"]}, "Subsuperscript", SyntaxForm -> 
         SubsuperscriptBox], 
        $CellContext`S[2, 6]], 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"], 
          TemplateBox[{"\"H\""}, "RowDefault"]}, "Subsuperscript", SyntaxForm -> 
         SubsuperscriptBox], 
        $CellContext`S[3, 6]]}, "RowDefault"]},
    "RowDefault"],
   Q3`Multiply[
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6], 
    $CellContext`S[3, 6]]],
  HoldForm]], "Output",
 CellChangeTimes->{3.823839449472801*^9, 3.823839616012266*^9, 
  3.8260653124368343`*^9, 3.826326573817881*^9, 3.826329716099231*^9, 
  3.826330696253277*^9, 3.826330788287939*^9, 3.82633083574472*^9, 
  3.826333658937055*^9, 3.830143376561017*^9, 3.836210836880422*^9, 
  3.8393728477360153`*^9, 3.83971428689939*^9, 3.849256104181534*^9, 
  3.851810188792959*^9, 3.852532857990909*^9, 3.852532902708984*^9, 
  3.869387862504727*^9, 3.885076141710403*^9},
 CellLabel->"Out[49]=",
 CellID->156717585,ExpressionUUID->"eb1c7374-4385-469e-8a52-d0b73948ca6f"]
}, Open  ]],

Cell["\<\
This shows the overall operation in the quantum circuit model.\
\>", "Text",
 CellChangeTimes->{{3.826065352554059*^9, 
  3.8260653792844887`*^9}},ExpressionUUID->"9fb0127a-a410-4390-8586-\
f24c4d7d2157"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"S", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "6"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.826065380871759*^9, 3.8260654050026627`*^9}, {
   3.82632657999852*^9, 3.826326585735145*^9}, 3.829808799472509*^9, {
   3.8525328918745604`*^9, 3.852532892480805*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"b69d0e72-36c6-4e41-98b7-873a1904e2ab"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
      LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
       0.6, -1.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.2],
        FontWeight->"Light",
        FontSlant->Italic], {1, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
      LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
       0.6, -2.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.2],
        FontWeight->"Light",
        FontSlant->Italic], {1, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, 
      LineBox[{{0.6, -3.4}, {1.4, -3.4}, {1.4, -2.6}, {0.6, -2.6}, {
       0.6, -3.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.2],
        FontWeight->"Light",
        FontSlant->Italic], {1, -3}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-7, 2], 
       Rational[-1, 2]}}, {Full, {-3.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[{
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6], 
    $CellContext`S[3, 6]}]]], "Output",
 CellChangeTimes->{{3.8260653929102983`*^9, 3.826065430762723*^9}, {
   3.826326575087737*^9, 3.82632658607876*^9}, 3.826329716106995*^9, 
   3.826330697422243*^9, 3.826330789497633*^9, 3.826330837228321*^9, 
   3.826333658967948*^9, 3.830143378146635*^9, 3.8362108383653593`*^9, 
   3.839372849024279*^9, 3.839714288147653*^9, 3.8492561057197027`*^9, 
   3.851810188804854*^9, {3.852532892878334*^9, 3.852532903795906*^9}, 
   3.869387863741584*^9, 3.885076143132641*^9},
 CellLabel->"Out[50]=",
 CellID->476513231,ExpressionUUID->"4dd4557e-473a-4860-988e-1f4e16a694f0"]
}, Open  ]],

Cell["\<\
Operating the Hadamard gate on each qubit produces a superposition state \
consisting all logical basis states.\
\>", "Text",
 CellChangeTimes->{{3.823839463408526*^9, 3.823839491779254*^9}, {
  3.8238395647884417`*^9, 
  3.823839610372003*^9}},ExpressionUUID->"7e18452a-0569-4adf-a1d9-\
0a2b54f17598"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"ReleaseHold", "[", "op", "]"}], "**", 
    RowBox[{"Ket", "[", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.818621967766716*^9, 3.8186220674346027`*^9}, {
   3.818622120466002*^9, 3.818622211309163*^9}, 3.823839447885399*^9, {
   3.826065424104863*^9, 3.826065427288601*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"94bed628-1c51-4ad9-bafc-34b38a28a9e5"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellChangeTimes->{{3.818622017372534*^9, 3.818622079470892*^9}, {
   3.818622121946135*^9, 3.8186221531650352`*^9}, {3.818622194316663*^9, 
   3.818622211540777*^9}, 3.81862233614688*^9, 3.818623162663619*^9, 
   3.818647946063623*^9, 3.8188353277992783`*^9, 3.819804620943947*^9, 
   3.8228059599757977`*^9, {3.823839613270158*^9, 3.823839617127058*^9}, 
   3.826065427649295*^9, 3.8263265895864697`*^9, 3.826329716140184*^9, 
   3.826333658999794*^9, 3.830143379901704*^9, 3.836210839770988*^9, 
   3.839372850416966*^9, 3.839714289484453*^9, 3.8492561076531677`*^9, 
   3.8518101888172407`*^9, 3.8525329055139017`*^9, 3.8693878653029118`*^9, 
   3.885076144830596*^9},
 CellLabel->"Out[52]=",
 CellID->85695982,ExpressionUUID->"8453eed1-de0a-47a4-9165-c4ad7d9327f0"]
}, Open  ]],

Cell["This show the same result in the quantum circuit model.", "Text",
 CellChangeTimes->{{3.82606545410914*^9, 
  3.826065464638153*^9}},ExpressionUUID->"eb4db5f6-63cf-4ad3-b807-\
39e17b864335"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "6"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpressionFor", "[", "qc", "]"}], "//", "LogicalForm"}]}], "Input",\

 CellChangeTimes->{{3.826065469454503*^9, 3.82606551769351*^9}, 
   3.8263265971874228`*^9, 3.829808799483185*^9, 3.830143410891667*^9},
 CellLabel->"In[53]:=",ExpressionUUID->"ecd7fa40-6853-472e-bdae-fd0c3b6067de"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {
     InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.16000000000000003`],
       FontWeight->"Light"], {-0.1, -1}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.16000000000000003`],
       FontWeight->"Light"], {-0.1, -2}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.16000000000000003`],
       FontWeight->"Light"], {-0.1, -3}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
      LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
       0.6, -1.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.2],
        FontWeight->"Light",
        FontSlant->Italic], {1, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
      LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
       0.6, -2.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.2],
        FontWeight->"Light",
        FontSlant->Italic], {1, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, 
      LineBox[{{0.6, -3.4}, {1.4, -3.4}, {1.4, -2.6}, {0.6, -2.6}, {
       0.6, -3.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.2],
        FontWeight->"Light",
        FontSlant->Italic], {1, -3}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-7, 2], 
       Rational[-1, 2]}}, {Full, {-3.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0|>]], {
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6], 
    $CellContext`S[3, 6]}]]], "Output",
 CellChangeTimes->{{3.826065479330636*^9, 3.826065520426506*^9}, {
   3.826326591514491*^9, 3.826326597600089*^9}, 3.826329716180189*^9, 
   3.826330701879363*^9, 3.82633365903902*^9, 3.8301433815246563`*^9, 
   3.836210841191437*^9, 3.839372851711622*^9, 3.8397142908059273`*^9, 
   3.849256109141179*^9, 3.8518101888383617`*^9, 3.852532907382119*^9, 
   3.869387866554352*^9, 3.885076146289812*^9},
 CellLabel->"Out[53]=",
 CellID->1218136502,ExpressionUUID->"f4674647-d3cc-41c5-a56e-e47172d51bb8"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellChangeTimes->{{3.826065479330636*^9, 3.826065520426506*^9}, {
   3.826326591514491*^9, 3.826326597600089*^9}, 3.826329716180189*^9, 
   3.826330701879363*^9, 3.82633365903902*^9, 3.8301433815246563`*^9, 
   3.836210841191437*^9, 3.839372851711622*^9, 3.8397142908059273`*^9, 
   3.849256109141179*^9, 3.8518101888383617`*^9, 3.852532907382119*^9, 
   3.869387866554352*^9, 3.88507614630844*^9},
 CellLabel->"Out[54]=",
 CellID->1258582263,ExpressionUUID->"7b166c67-9241-4123-9559-559b92e9e37e"]
}, Open  ]],

Cell["\<\
Let us compare it with an explicit construction. To do it first prepare the \
indices of the logical basis states in binary digits.\
\>", "Text",
 CellChangeTimes->{{3.818622997994567*^9, 3.818623031135189*^9}, {
  3.818623163450779*^9, 3.818623164361787*^9}, {3.818627349095077*^9, 
  3.81862735606868*^9}, {3.823839683943412*^9, 3.823839685439266*^9}, {
  3.8238397183552427`*^9, 
  3.823839764917315*^9}},ExpressionUUID->"49a71700-0dcb-4633-aa86-\
3803e2291de7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nn", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"2", "^", "3"}], "-", "1"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"bit", "=", 
  RowBox[{"IntegerDigits", "[", 
   RowBox[{"nn", ",", "2", ",", "3"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.818622236826311*^9, 3.818622325839716*^9}, {
  3.823839692268979*^9, 3.82383971125762*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"e62c0322-d909-4cd3-b091-d1310628f0ea"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.823839695352281*^9, 3.8238397149275312`*^9}, 
   3.823839767204403*^9, 3.826326599318389*^9, 3.826329716196309*^9, 
   3.826333659055791*^9, 3.830143383314674*^9, 3.836210843307827*^9, 
   3.839372853551434*^9, 3.839714292332415*^9, 3.849256111738899*^9, 
   3.85181018885296*^9, 3.8525329107095213`*^9, 3.869387867982026*^9, 
   3.885076147860506*^9},
 CellLabel->"Out[56]=",
 CellID->1186245656,ExpressionUUID->"f730df0b-a94c-4cbf-9d75-c8383a449091"]
}, Open  ]],

Cell["\<\
This gives an explicit construction (unnormalized) of the superposition of \
all local basis states.\
\>", "Text",
 CellChangeTimes->{{3.823839776571801*^9, 
  3.82383986868263*^9}},ExpressionUUID->"04bb896f-583a-43f1-bc24-\
93f3c2ff4058"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{
        RowBox[{"S", "@", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "\[Rule]", "#"}], "]"}],
       "&"}], "/@", "bit"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"vec", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.818622236826311*^9, 3.818622325839716*^9}, 
   3.823839692268979*^9, {3.823839850414407*^9, 3.8238398511356993`*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"7a389b76-cb08-43ea-8403-cbda62c14015"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]], 
         $CellContext`S[1, Q3`$]]], 
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]], 
         $CellContext`S[2, Q3`$]]], 
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]], 
         $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
    "Ket"],
   Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
     0, $CellContext`S[3, Q3`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]], 
         $CellContext`S[1, Q3`$]]], 
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]], 
         $CellContext`S[2, Q3`$]]], 
       SubscriptBox["1", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]], 
         $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
    "Ket"],
   Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
     0, $CellContext`S[3, Q3`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]], 
         $CellContext`S[1, Q3`$]]], 
       SubscriptBox["1", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]], 
         $CellContext`S[2, Q3`$]]], 
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]], 
         $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
    "Ket"],
   Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
     1, $CellContext`S[3, Q3`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]], 
         $CellContext`S[1, Q3`$]]], 
       SubscriptBox["1", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]], 
         $CellContext`S[2, Q3`$]]], 
       SubscriptBox["1", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]], 
         $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
    "Ket"],
   Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
     1, $CellContext`S[3, Q3`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{
       SubscriptBox["1", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]], 
         $CellContext`S[1, Q3`$]]], 
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]], 
         $CellContext`S[2, Q3`$]]], 
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]], 
         $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
    "Ket"],
   Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
     0, $CellContext`S[3, Q3`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{
       SubscriptBox["1", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]], 
         $CellContext`S[1, Q3`$]]], 
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]], 
         $CellContext`S[2, Q3`$]]], 
       SubscriptBox["1", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]], 
         $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
    "Ket"],
   Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
     0, $CellContext`S[3, Q3`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{
       SubscriptBox["1", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]], 
         $CellContext`S[1, Q3`$]]], 
       SubscriptBox["1", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]], 
         $CellContext`S[2, Q3`$]]], 
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]], 
         $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
    "Ket"],
   Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
     1, $CellContext`S[3, Q3`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{
       SubscriptBox["1", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]], 
         $CellContext`S[1, Q3`$]]], 
       SubscriptBox["1", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]], 
         $CellContext`S[2, Q3`$]]], 
       SubscriptBox["1", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"3"}, "RowDefault"]], 
         $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
    "Ket"],
   Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
     1, $CellContext`S[3, Q3`$] -> 1|>]]}]], "Output",
 CellChangeTimes->{
  3.818622245816828*^9, {3.818622276843924*^9, 3.8186223370244493`*^9}, 
   3.818623033645576*^9, 3.818623165599573*^9, 3.818647947609105*^9, 
   3.8188353293069572`*^9, 3.8198046226503687`*^9, 3.8228059615076523`*^9, {
   3.823839697629305*^9, 3.8238397155846567`*^9}, 3.823839768153839*^9, 
   3.823839816089711*^9, 3.8238398700298243`*^9, 3.82632660079144*^9, 
   3.826329716228609*^9, 3.826333659085726*^9, 3.830143385224512*^9, 
   3.836210846261319*^9, 3.8393728548087997`*^9, 3.8397142938471403`*^9, 
   3.849256113242221*^9, 3.851810188864111*^9, 3.852532920950533*^9, 
   3.869387869222416*^9, 3.8850761493495607`*^9},
 CellLabel->"Out[58]=",
 CellID->1202793218,ExpressionUUID->"a0ae0949-faed-4fd4-bd1c-0b7323be9843"]
}, Open  ]],

Cell["\<\
On other elements of the logical basis, the sign of each term is determined \
by the bitwise dot product of the its bit-string with that of the input state.\
\>", "Text",
 CellChangeTimes->{{3.818647775358218*^9, 3.818647932196763*^9}, {
  3.818648171920697*^9, 
  3.818648185733927*^9}},ExpressionUUID->"a34cdfc0-2df5-4237-8347-\
c3e10dab4246"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Ket", "[", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"in", "=", 
  RowBox[{"LogicalForm", "[", 
   RowBox[{"in", ",", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8186479509750853`*^9, 3.818648017512011*^9}, 
   3.823839885715028*^9},
 CellLabel->"In[59]:=",ExpressionUUID->"d2b5a4e7-ed69-4ff9-8110-c7150d0a5e80"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{
    TemplateBox[{
      SubscriptBox["1", 
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"]], 
        $CellContext`S[1, Q3`$]]], 
      SubscriptBox["0", 
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"]], 
        $CellContext`S[2, Q3`$]]], 
      SubscriptBox["1", 
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"3"}, "RowDefault"]], 
        $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
   "Ket"],
  Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
    0, $CellContext`S[3, Q3`$] -> 1|>]]], "Output",
 CellChangeTimes->{{3.823839887116048*^9, 3.823839903383971*^9}, 
   3.8263266030618477`*^9, 3.826329716241003*^9, 3.826333659099058*^9, 
   3.83014338709625*^9, 3.836210848290525*^9, 3.839372856281398*^9, 
   3.839714295904125*^9, 3.849256114881892*^9, 3.851810188877021*^9, 
   3.8525329225628977`*^9, 3.869387870716806*^9, 3.885076151341559*^9},
 CellLabel->"Out[60]=",
 CellID->1919234961,ExpressionUUID->"198735a1-8658-4086-87db-9ea3f9667d2c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"ReleaseHold", "[", "op", "]"}], "**", "in"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.8186479509750853`*^9, 3.818648017512011*^9}, 
   3.823839885715028*^9},
 CellLabel->"In[61]:=",ExpressionUUID->"18d52081-3866-4c2d-90be-9779731acb86"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellChangeTimes->{{3.818647977378962*^9, 3.8186480179753923`*^9}, 
   3.8188353309893713`*^9, 3.819804625138587*^9, 3.822805962974943*^9, {
   3.823839888428165*^9, 3.823839904230537*^9}, 3.826326604053279*^9, 
   3.8263297162749166`*^9, 3.8263336591308727`*^9, 3.830143387983843*^9, 
   3.836210849690072*^9, 3.836210906571504*^9, 3.839372857589981*^9, 
   3.839714297241124*^9, 3.849256116157798*^9, 3.85181018889049*^9, 
   3.852532923895131*^9, 3.869387872187585*^9, 3.885076152895605*^9},
 CellLabel->"Out[62]=",
 CellID->355772000,ExpressionUUID->"5c7500cb-5de6-404e-94ab-3704ca9380ff"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rotations", "Subsection",
 CellChangeTimes->{{3.818624660855891*^9, 3.818624661788609*^9}},
 CellTags->"Section30",
 CellID->1968530614,ExpressionUUID->"1e593bd0-1a30-4962-94f2-9b6fe4016acc"],

Cell[CellGroupData[{

Cell["\<\
The Pauli operators are generators of the rotational transformations in a \
two-dimensional complex vector space, and hence satisfy the fundamental \
commutation relations of angular momentum operators (up to a normalization \
factor).\
\>", "MathCaption",
 CellChangeTimes->{{3.825713761461204*^9, 3.825713864283833*^9}, {
  3.82571394216571*^9, 
  3.8257139524590597`*^9}},ExpressionUUID->"f2f24e04-9fdb-403f-add0-\
d8e929804caa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"S", "[", "All", "]"}]}]], "Input",
 CellChangeTimes->{{3.825713886348961*^9, 3.825713892486732*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"2a54fb18-00e8-4bf7-a7da-686ca3965443"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Superscript"],
    $CellContext`S[1]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Superscript"],
    $CellContext`S[2]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Superscript"],
    $CellContext`S[3]]}], "}"}]], "Output",
 CellChangeTimes->{3.8257138927575617`*^9, 3.82632660609004*^9, 
  3.826329716287725*^9, 3.826333659144226*^9, 3.8301433898778276`*^9, 
  3.836210910199525*^9, 3.839372859550768*^9, 3.8397142991719913`*^9, 
  3.849256118282432*^9, 3.851810188903273*^9, 3.869387874314496*^9, 
  3.885076155146594*^9},
 CellLabel->"Out[63]=",
 CellID->1442955774,ExpressionUUID->"d57b1bc3-6d67-40b3-a92d-dbb6f079a444"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Outer", "[", 
    RowBox[{
     RowBox[{"HoldForm", "@*", "Commutator"}], ",", "op", ",", "op"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"ReleaseHold", "[", "in", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", "in", "]"}], "\[Rule]", 
    RowBox[{"Flatten", "[", "out", "]"}]}], "]"}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.8257140410316477`*^9, 3.825714155246338*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"3cd06a72-4ad6-4c15-82bf-a8c4a29647f5"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       TagBox[
        RowBox[{"Commutator", "[", 
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Superscript"],
           $CellContext`S[1]], ",", 
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Superscript"],
           $CellContext`S[1]]}], "]"}],
        HoldForm], "\[Rule]", "0"}]},
     {
      RowBox[{
       TagBox[
        RowBox[{"Commutator", "[", 
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Superscript"],
           $CellContext`S[1]], ",", 
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]},
            "Superscript"],
           $CellContext`S[2]]}], "]"}],
        HoldForm], "\[Rule]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]},
          "Superscript"],
         $CellContext`S[3]]}]}]},
     {
      RowBox[{
       TagBox[
        RowBox[{"Commutator", "[", 
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Superscript"],
           $CellContext`S[1]], ",", 
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Superscript"],
           $CellContext`S[3]]}], "]"}],
        HoldForm], "\[Rule]", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]},
          "Superscript"],
         $CellContext`S[2]]}]}]},
     {
      RowBox[{
       TagBox[
        RowBox[{"Commutator", "[", 
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]},
            "Superscript"],
           $CellContext`S[2]], ",", 
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Superscript"],
           $CellContext`S[1]]}], "]"}],
        HoldForm], "\[Rule]", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]},
          "Superscript"],
         $CellContext`S[3]]}]}]},
     {
      RowBox[{
       TagBox[
        RowBox[{"Commutator", "[", 
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]},
            "Superscript"],
           $CellContext`S[2]], ",", 
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]},
            "Superscript"],
           $CellContext`S[2]]}], "]"}],
        HoldForm], "\[Rule]", "0"}]},
     {
      RowBox[{
       TagBox[
        RowBox[{"Commutator", "[", 
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]},
            "Superscript"],
           $CellContext`S[2]], ",", 
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Superscript"],
           $CellContext`S[3]]}], "]"}],
        HoldForm], "\[Rule]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]},
          "Superscript"],
         $CellContext`S[1]]}]}]},
     {
      RowBox[{
       TagBox[
        RowBox[{"Commutator", "[", 
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Superscript"],
           $CellContext`S[3]], ",", 
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"\"x\""}, "RowDefault"]},
            "Superscript"],
           $CellContext`S[1]]}], "]"}],
        HoldForm], "\[Rule]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]},
          "Superscript"],
         $CellContext`S[2]]}]}]},
     {
      RowBox[{
       TagBox[
        RowBox[{"Commutator", "[", 
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Superscript"],
           $CellContext`S[3]], ",", 
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"\"y\""}, "RowDefault"]},
            "Superscript"],
           $CellContext`S[2]]}], "]"}],
        HoldForm], "\[Rule]", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]},
          "Superscript"],
         $CellContext`S[1]]}]}]},
     {
      RowBox[{
       TagBox[
        RowBox[{"Commutator", "[", 
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Superscript"],
           $CellContext`S[3]], ",", 
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Superscript"],
           $CellContext`S[3]]}], "]"}],
        HoldForm], "\[Rule]", "0"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8257141288598537`*^9, 3.825714155480908*^9}, 
   3.826326607551297*^9, 3.826329716320489*^9, 3.8263336591769047`*^9, 
   3.830143390691577*^9, 3.8362109130252647`*^9, 3.839372860607725*^9, 
   3.839714300345896*^9, 3.849256119772848*^9, 3.8518101889180613`*^9, 
   3.8693878762878733`*^9, 3.885076157349546*^9},
 CellLabel->"Out[66]//TableForm=",
 CellID->127532265,ExpressionUUID->"4346332d-3f56-47af-994d-b494fb5ab891"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Consider a unitary operator represented by the following matrix.\
\>", "MathCaption",
 CellChangeTimes->{{3.825734679286174*^9, 
  3.825734715768078*^9}},ExpressionUUID->"f2a37467-9d73-47e9-90b1-\
c57fcb5994a3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"3", "-", 
         RowBox[{"I", " ", 
          RowBox[{"Sqrt", "[", "3", "]"}]}]}], ",", 
        RowBox[{"I", "-", 
         RowBox[{"Sqrt", "[", "3", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"I", "+", 
         RowBox[{"Sqrt", "[", "3", "]"}]}], ",", 
        RowBox[{"3", "+", 
         RowBox[{"I", " ", 
          RowBox[{"Sqrt", "[", "3", "]"}]}]}]}], "}"}]}], 
     "\[IndentingNewLine]", "}"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.825734718447136*^9, 3.825734762666945*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"686ac139-226e-4657-ae10-f3f6c796d108"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"3", "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          SqrtBox["3"]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", "-", 
         SqrtBox["3"]}], ")"}]}]},
     {
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", "+", 
         SqrtBox["3"]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SqrtBox["3"]}]}], ")"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.825734762923908*^9, 3.825734765237566*^9}, 
   3.826326610168688*^9, 3.826329716329056*^9, 3.8263336591867113`*^9, 
   3.83014339352663*^9, {3.836210919670936*^9, 3.836210930513582*^9}, 
   3.8393728621373367`*^9, 3.839714302083845*^9, 3.8492561213149137`*^9, 
   3.851810188926763*^9, 3.869387882470941*^9, 3.885076158920012*^9},
 CellLabel->"Out[68]//MatrixForm=",
 CellID->521199372,ExpressionUUID->"7c1307d7-b493-4f4e-adad-1513bed6883b"]
}, Open  ]],

Cell["This gives its expression in terms of the Pauli operators.", "Text",
 CellChangeTimes->{{3.825734790633033*^9, 
  3.825734858287446*^9}},ExpressionUUID->"3397093a-8d5c-400b-9b10-\
8e804271c37d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"Elaborate", "@", 
   RowBox[{"ExpressionFor", "[", 
    RowBox[{"mat", ",", "S"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8257346096890793`*^9, 3.825734620609044*^9}, {
   3.825734780677945*^9, 3.82573481306184*^9}, 3.8301434108966007`*^9, {
   3.836210979273942*^9, 3.8362109860798473`*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"93fb0ed6-df89-44fe-9cd5-ba48c57fc637"],

Cell[BoxData[
 RowBox[{
  FractionBox["3", "4"], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Superscript"],
     $CellContext`S[1]]}], "4"], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   SqrtBox["3"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Superscript"],
    $CellContext`S[2]]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   SqrtBox["3"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Superscript"],
    $CellContext`S[3]]}]}]], "Output",
 CellChangeTimes->{{3.82573461577647*^9, 3.825734620943535*^9}, {
   3.8257346510002203`*^9, 3.825734653216618*^9}, {3.825734781334725*^9, 
   3.825734813917458*^9}, 3.825734859573662*^9, 3.8263266119823017`*^9, 
   3.8263297163615627`*^9, 3.826333659217198*^9, 3.830143395533866*^9, {
   3.836210986487411*^9, 3.83621099035205*^9}, 3.839372863614801*^9, 
   3.8397143034391127`*^9, 3.8492561228555202`*^9, 3.851810188937686*^9, 
   3.869387884281023*^9, 3.885076160260655*^9},
 CellLabel->"Out[69]=",
 CellID->266071936,ExpressionUUID->"0a088b23-d6db-4360-b491-ec335f54d634"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Dagger", "[", "op", "]"}], "**", "op"}]], "Input",
 CellChangeTimes->{{3.8257348628780622`*^9, 3.825734866060289*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"66189222-96c7-43f8-83cf-2e8644a271b4"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.8257348663945837`*^9, 3.825734869303069*^9}, 
   3.8263266128758993`*^9, 3.826329716404234*^9, 3.82633365922854*^9, 
   3.830143396321909*^9, 3.8362109916437387`*^9, 3.839372864577536*^9, 
   3.839714304361045*^9, 3.849256123791189*^9, 3.851810188950429*^9, 
   3.869387886090056*^9, 3.885076162130484*^9},
 CellLabel->"Out[70]=",
 CellID->835429486,ExpressionUUID->"0225e4eb-3dc5-455c-a0ed-b107c39cfa63"]
}, Open  ]],

Cell["This gives the Euler angles of the unitary operator.", "Text",
 CellChangeTimes->{{3.825734901114027*^9, 
  3.82573491303852*^9}},ExpressionUUID->"c3344c8f-0bc2-44ed-b283-\
7bdcd12725d6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"angs", "=", 
  RowBox[{"TheEulerAngles", "[", "mat", "]"}]}]], "Input",
 CellChangeTimes->{{3.825734877234844*^9, 3.8257348987177753`*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"320d0567-bffb-4dbe-872d-654258002135"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["\[Pi]", "3"], ",", 
   FractionBox["\[Pi]", "3"], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.825734885577304*^9, 3.825734914448155*^9}, 
   3.826326614300914*^9, 3.8263297164393597`*^9, 3.826333659258875*^9, 
   3.830143397522378*^9, 3.836210993188979*^9, 3.8393728657724543`*^9, 
   3.839714305649109*^9, 3.849256124990486*^9, 3.8518101889661694`*^9, 
   3.869387887346952*^9, 3.8850761634114113`*^9},
 CellLabel->"Out[71]=",
 CellID->364488769,ExpressionUUID->"92c25bea-1ada-4cc1-bf1a-29dbfc58a9b4"]
}, Open  ]],

Cell["\<\
Indeed, the Euler angles reproduces the original unitary operator.\
\>", "Text",
 CellChangeTimes->{{3.825734951938533*^9, 
  3.825734972097846*^9}},ExpressionUUID->"6acacd65-c3d7-45d4-9030-\
ea5863a1d74d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"new", "=", 
  RowBox[{
   RowBox[{"EulerRotation", "[", 
    RowBox[{"angs", ",", "S"}], "]"}], "//", 
   "Elaborate"}]}], "\[IndentingNewLine]", 
 RowBox[{"op", "-", "new"}]}], "Input",
 CellChangeTimes->{{3.825734916090334*^9, 3.825734946832988*^9}, {
  3.836211000548264*^9, 3.836211004225052*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"f47f8d9d-3a73-418b-92af-38f97d7863c8"],

Cell[BoxData[
 RowBox[{
  FractionBox["3", "4"], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Superscript"],
     $CellContext`S[1]]}], "4"], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   SqrtBox["3"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Superscript"],
    $CellContext`S[2]]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   SqrtBox["3"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Superscript"],
    $CellContext`S[3]]}]}]], "Output",
 CellChangeTimes->{{3.8257349319054117`*^9, 3.825734973532976*^9}, 
   3.826326615803391*^9, 3.826329716446755*^9, 3.826333659266356*^9, 
   3.8301433989227943`*^9, {3.83621099475795*^9, 3.836211006661797*^9}, 
   3.839372867387974*^9, 3.839714306847363*^9, 3.8492561264041147`*^9, 
   3.851810188969817*^9, 3.869387889020707*^9, 3.885076164706501*^9},
 CellLabel->"Out[72]=",
 CellID->74125460,ExpressionUUID->"95f88195-014d-4521-8259-d52140cba72f"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.8257349319054117`*^9, 3.825734973532976*^9}, 
   3.826326615803391*^9, 3.826329716446755*^9, 3.826333659266356*^9, 
   3.8301433989227943`*^9, {3.83621099475795*^9, 3.836211006661797*^9}, 
   3.839372867387974*^9, 3.839714306847363*^9, 3.8492561264041147`*^9, 
   3.851810188969817*^9, 3.869387889020707*^9, 3.885076164710559*^9},
 CellLabel->"Out[73]=",
 CellID->286090960,ExpressionUUID->"d8c93c07-8830-42ad-bd76-1c250bc7f204"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Among (relative) phase gates, the quadrant and octant phase gates are most \
common.\
\>", "MathCaption",
 CellChangeTimes->{{3.835843498503683*^9, 3.835843627228737*^9}},
 CellID->103783938,ExpressionUUID->"bdb7752e-8aef-4e86-ab08-20150eefbf82"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qd", "=", 
  RowBox[{"S", "[", 
   RowBox[{"1", ",", "7"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Matrix", "[", "qd", "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.835843629505772*^9, 3.835843712354549*^9}},
 CellLabel->"In[74]:=",
 CellID->1626811097,ExpressionUUID->"194d7f2a-cdd0-49a9-9eea-c8e2837d273b"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"1"}, "RowDefault"], 
    TemplateBox[{"\"S\""}, "RowDefault"]},
   "Subsuperscript"],
  $CellContext`S[1, 7]]], "Output",
 CellChangeTimes->{{3.835843648754766*^9, 3.835843674330887*^9}, {
   3.835843714489657*^9, 3.835843743717066*^9}, 3.836211009694662*^9, 
   3.8393728688553543`*^9, 3.839714308325519*^9, 3.8492561278373137`*^9, 
   3.851810188984518*^9, 3.869387890422372*^9, 3.885076166397646*^9},
 CellLabel->"Out[74]=",
 CellID->1097510781,ExpressionUUID->"980712a2-f166-4e03-85b2-c4849a29b594"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0"},
     {"0", "\[ImaginaryI]"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 1, 2}, {{1}, {2}}}, {1, Complex[0, 1]}}]]]]], "Output",
 CellChangeTimes->{{3.835843648754766*^9, 3.835843674330887*^9}, {
   3.835843714489657*^9, 3.835843743717066*^9}, 3.836211009694662*^9, 
   3.8393728688553543`*^9, 3.839714308325519*^9, 3.8492561278373137`*^9, 
   3.851810188984518*^9, 3.869387890422372*^9, 3.8850761664012747`*^9},
 CellLabel->"Out[75]//MatrixForm=",
 CellID->1126652184,ExpressionUUID->"bddf400d-c8d4-4fc7-9b9d-a851172c8a72"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qd", "**", "qd"}]], "Input",
 CellChangeTimes->{{3.8358437238865633`*^9, 3.835843725516548*^9}},
 CellLabel->"In[76]:=",
 CellID->2020351583,ExpressionUUID->"725a4fa7-75e6-4b93-b0d8-24cb8e0b562a"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"1"}, "RowDefault"], 
    TemplateBox[{"\"z\""}, "RowDefault"]},
   "Subsuperscript"],
  $CellContext`S[1, 3]]], "Output",
 CellChangeTimes->{{3.8358437258757687`*^9, 3.835843744323681*^9}, 
   3.836211011565894*^9, 3.839372870684119*^9, 3.839714310081538*^9, 
   3.8492561295521393`*^9, 3.851810188992091*^9, 3.86938789223827*^9, 
   3.885076168233214*^9},
 CellLabel->"Out[76]=",
 CellID->55431994,ExpressionUUID->"a6e93658-d0d6-4d74-8310-7ec51cbd9284"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"oc", "=", 
  RowBox[{"S", "[", 
   RowBox[{"1", ",", "8"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Matrix", "[", "oc", "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.835843656842586*^9, 3.8358436854224653`*^9}, {
  3.8358437163596153`*^9, 3.835843720487262*^9}},
 CellLabel->"In[77]:=",
 CellID->961031737,ExpressionUUID->"ee45a873-4863-4942-9ac2-84da084efc53"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{
    TemplateBox[{"S"}, "RowDefault"], 
    TemplateBox[{"1"}, "RowDefault"], 
    TemplateBox[{"\"T\""}, "RowDefault"]},
   "Subsuperscript"],
  $CellContext`S[1, 8]]], "Output",
 CellChangeTimes->{{3.835843659173964*^9, 3.8358436857146807`*^9}, {
   3.835843720884378*^9, 3.8358437448865967`*^9}, 3.836211012399502*^9, 
   3.839372871570631*^9, 3.839714311004549*^9, 3.849256130665711*^9, 
   3.851810189003785*^9, 3.869387893391444*^9, 3.8850761693457403`*^9},
 CellLabel->"Out[77]=",
 CellID->1897803664,ExpressionUUID->"5407d22c-607d-4708-9c80-0e0b6422595b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0"},
     {"0", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 1, 2}, {{1}, {2}}}, {
      1, E^(Complex[0, Rational[1, 4]] Pi)}}]]]]], "Output",
 CellChangeTimes->{{3.835843659173964*^9, 3.8358436857146807`*^9}, {
   3.835843720884378*^9, 3.8358437448865967`*^9}, 3.836211012399502*^9, 
   3.839372871570631*^9, 3.839714311004549*^9, 3.849256130665711*^9, 
   3.851810189003785*^9, 3.869387893391444*^9, 3.885076169349988*^9},
 CellLabel->"Out[78]//MatrixForm=",
 CellID->1959055604,ExpressionUUID->"e5972625-a9f0-4746-bb8b-64f0aa3404c9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"oc", "**", "oc"}]], "Input",
 CellChangeTimes->{{3.8358437344194098`*^9, 3.835843735831594*^9}},
 CellLabel->"In[250]:=",
 CellID->1451468907,ExpressionUUID->"aca25bd0-47a1-451b-b81a-cf937c774330"],

Cell[BoxData[
 TemplateBox[{
   TemplateBox[{"S"}, "RowDefault"], 
   TemplateBox[{"1"}, "RowDefault"], 
   TemplateBox[{"\"S\""}, "RowDefault"]},
  "Subsuperscript"]], "Output",
 CellChangeTimes->{{3.8358437361672792`*^9, 3.835843745786951*^9}, 
   3.836211013748336*^9, 3.839372873141659*^9, 3.851810189009533*^9, 
   3.869387895605031*^9},
 CellLabel->"Out[250]=",
 CellID->1591240861,ExpressionUUID->"280cb43a-30c0-4284-9eb6-f7277ed2402f"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Two-Qubit Gates", "Section",
 CellChangeTimes->{{3.8186213588211613`*^9, 3.818621361667145*^9}},
 CellTags->"Section31",
 CellID->1365402155,ExpressionUUID->"adea6910-792e-4886-8ce4-806c410eb6aa"],

Cell[CellGroupData[{

Cell["CNOT, CZ, and SWAP", "Subsection",
 CellChangeTimes->{{3.819078286654201*^9, 3.819078287305963*^9}, {
  3.826527911248864*^9, 3.8265279125972*^9}, {3.8272617206337423`*^9, 
  3.82726172827146*^9}},
 CellTags->"Section32",
 CellID->693517034,ExpressionUUID->"ed5f99c6-048c-4a53-9423-e7dca2694995"],

Cell[CellGroupData[{

Cell[TextData[{
 "CNOT[",
 StyleBox["control",
  FontSlant->"Italic"],
 ",",
 StyleBox[" target",
  FontSlant->"Italic"],
 "] denotes the CNOT gate in the quantum circuit model."
}], "MathCaption",
 CellChangeTimes->{{3.818622671791256*^9, 3.818622680036644*^9}, {
  3.818626548435519*^9, 3.8186265859538183`*^9}, {3.819942906901557*^9, 
  3.819942917330882*^9}, {3.824366463400527*^9, 
  3.82436648167868*^9}},ExpressionUUID->"3713a507-5340-45ca-a49e-\
2aaf835335d4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"CNOT", "[", 
   RowBox[{
    RowBox[{"S", "[", "1", "]"}], ",", 
    RowBox[{"S", "[", "2", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.818622689751131*^9, 3.8186226942701607`*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"73061649-43ed-4520-b6b7-d009d4ccbf88"],

Cell[BoxData[
 RowBox[{"CNOT", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     InterpretationBox[
      SubscriptBox[
       TemplateBox[{"S"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]],
      $CellContext`S[1, Q3`$]], "}"}], "\[Rule]", 
    RowBox[{"{", "1", "}"}]}], ",", 
   RowBox[{"{", 
    InterpretationBox[
     SubscriptBox[
      TemplateBox[{"S"},
       "RowDefault"], 
      TemplateBox[{"2"},
       "RowDefault"]],
     $CellContext`S[2, Q3`$]], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.818622694615285*^9, 3.818626453003921*^9, 3.818835334367969*^9, 
   3.8190783589214354`*^9, 3.819078411395906*^9, 3.8198046294360037`*^9, 
   3.822805966149784*^9, 3.82574215339258*^9, 3.826326618008523*^9, 
   3.826329716484005*^9, 3.826330854344953*^9, 3.826333659303748*^9, {
   3.830143401159968*^9, 3.83014341784799*^9}, 3.836211020467225*^9, 
   3.8393728753364773`*^9, 3.839714314078601*^9, 3.849256135103981*^9, 
   3.851810189020015*^9, 3.8525349379004097`*^9, 3.852534977731803*^9, 
   3.869387897626346*^9, 3.885076173082546*^9},
 CellLabel->"Out[79]=",
 CellID->2142479741,ExpressionUUID->"36c0c3f6-3808-4af7-b610-c5b764eb1584"]
}, Open  ]],

Cell["This displays a quantum circuit including the CNOT gate.", "Text",
 CellChangeTimes->{{3.8243664886652193`*^9, 3.824366508294939*^9}, {
  3.8525349539552183`*^9, 
  3.852534968450119*^9}},ExpressionUUID->"57dd86fe-cc77-4720-923f-\
bc98a2758b6d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "op", "]"}]}]], "Input",
 CellChangeTimes->{{3.818622707594385*^9, 3.8186227247915287`*^9}, {
   3.818626446086946*^9, 3.8186264466809063`*^9}, {3.825742177412016*^9, 
   3.82574217787372*^9}, 3.826326624200954*^9, 3.82980879952356*^9},
 CellLabel->"In[80]:=",ExpressionUUID->"edccf931-013e-4e31-8d39-49d787084bd2"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}]]]], "Output",
 CellChangeTimes->{{3.8186227128444767`*^9, 3.8186227250838823`*^9}, {
   3.818626446944561*^9, 3.818626453619961*^9}, 3.81883533513256*^9, 
   3.819078412312392*^9, 3.8198046301993017`*^9, 3.822805967373239*^9, {
   3.825742154654841*^9, 3.825742178362797*^9}, 3.82632662463455*^9, 
   3.826329716492647*^9, 3.826330855668758*^9, 3.826333659311335*^9, {
   3.830143402285472*^9, 3.8301434189343224`*^9}, 3.8362110215127277`*^9, 
   3.8393728767526693`*^9, 3.839714315345285*^9, 3.8492561364565077`*^9, 
   3.8518101890261908`*^9, 3.8525349425129757`*^9, 3.852534978978788*^9, 
   3.869387898855739*^9, 3.885076174976097*^9},
 CellLabel->"Out[80]=",
 CellID->1372361754,ExpressionUUID->"98622c08-a5f3-49fc-83f8-ac6fb45af464"]
}, Open  ]],

Cell["\<\
This is the explicit expression of the CNOT gate in terms of the Pauli \
operators.\
\>", "Text",
 CellChangeTimes->{{3.8257421952308893`*^9, 
  3.825742220215493*^9}},ExpressionUUID->"15672d67-45c3-4138-a721-\
87abf506e789"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}]], "Input",
 CellChangeTimes->{{3.8257422228723707`*^9, 3.825742229575902*^9}, 
   3.830143410898466*^9},
 CellLabel->"In[81]:=",ExpressionUUID->"7c1e3e3f-1e75-4912-a7b9-7d54836007ed"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 1]]]}], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[1, 3]], "2"], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"2"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[2, 1]], "2"]}]], "Output",
 CellChangeTimes->{{3.8257422299589243`*^9, 3.8257422314229803`*^9}, 
   3.826326626495455*^9, 3.826329716525732*^9, 3.826333659347484*^9, 
   3.830143420207163*^9, 3.83621102266601*^9, 3.839372878003849*^9, 
   3.839714316679717*^9, 3.8492561376982193`*^9, 3.851810189038023*^9, 
   3.852534986131625*^9, 3.869387900235099*^9, 3.885076176332025*^9},
 CellLabel->"Out[81]=",
 CellID->2147116260,ExpressionUUID->"11c29e27-63b9-4bda-a8b0-1159c76b3734"]
}, Open  ]],

Cell["\<\
This is the matrix representation of the CNOT gate in the logical basis.\
\>", "Text",
 CellChangeTimes->{{3.82574271299806*^9, 
  3.825742726765843*^9}},ExpressionUUID->"62136129-a8d2-4072-b6da-\
5df546df68f9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", "op", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.8257427317505293`*^9, 3.825742736238144*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"675cc0f9-bbcc-419e-880f-85ae0c71c10c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "0", "1"},
     {"0", "0", "1", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {2}, {2}, {1}, {3}, {4}, {4}, {3}}}, {1, 0, 1,
       0, 0, 1, 0, 1}}]]]]], "Output",
 CellChangeTimes->{{3.825742736467511*^9, 3.825742738768428*^9}, 
   3.8263266284358892`*^9, 3.8263297165327787`*^9, 3.8263336593551483`*^9, 
   3.830143421502117*^9, 3.8362110244365807`*^9, 3.839372879240283*^9, 
   3.839714317917265*^9, 3.849256138916717*^9, 3.851810189042803*^9, 
   3.8525349874338303`*^9, 3.869387901554831*^9, 3.885076177681778*^9},
 CellLabel->"Out[82]//MatrixForm=",
 CellID->711566354,ExpressionUUID->"6c4a04d8-ad23-4f94-ab1d-fc3dedfffb35"]
}, Open  ]],

Cell["\<\
This shows how the CNOT gate operates on the logical basis states.\
\>", "Text",
 CellChangeTimes->{{3.8257423088726807`*^9, 
  3.825742326297838*^9}},ExpressionUUID->"2f65ec29-3c79-44cc-bfaf-\
6d817b74308b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"in", "\[Rule]", "out"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.825742155670525*^9, 3.825742167759344*^9}, {
  3.825742279827004*^9, 3.825742304035431*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"5237c434-daa6-46f9-9caa-808e7c7ed4fc"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8257421622159653`*^9, 3.825742168030895*^9}, {
   3.825742272751733*^9, 3.8257423276689577`*^9}, 3.8257427399647503`*^9, 
   3.8263266297999907`*^9, 3.826329716565145*^9, 3.826333659392221*^9, 
   3.830143422642515*^9, 3.836211025706335*^9, 3.8393728804655857`*^9, 
   3.839714319263102*^9, 3.849256140269072*^9, 3.851810189055801*^9, 
   3.8525349888191633`*^9, 3.869387902898237*^9, 3.885076179044272*^9},
 CellLabel->"Out[85]//TableForm=",
 CellID->159592634,ExpressionUUID->"f42b90db-8271-4350-a147-e3d51e4e8bba"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
As an example of the application of the CNOT gate, this shows an entangler \
quantum circuit.\
\>", "MathCaption",
 CellChangeTimes->{{3.824366515730639*^9, 3.824366564621441*^9}, {
  3.82574277191061*^9, 
  3.825742773867064*^9}},ExpressionUUID->"19d7f2f6-e732-4008-add4-\
435ef192f7c9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"entangler", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8190784198223267`*^9, 3.819078447618651*^9}, {
   3.8190785002018003`*^9, 3.819078503171278*^9}, {3.819080152835722*^9, 
   3.819080173636093*^9}, 3.8263266376546507`*^9, 3.8298087995340643`*^9},
 CellLabel->"In[86]:=",ExpressionUUID->"25ac0706-c91a-476b-b4f8-d066587c6aeb"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->154.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}]]]], "Output",
 CellChangeTimes->{{3.819078443211891*^9, 3.819078447885042*^9}, 
   3.8190785222923117`*^9, {3.8190801561547623`*^9, 3.8190801740961657`*^9}, 
   3.819804631120545*^9, 3.8228059683882008`*^9, 3.824366678371805*^9, 
   3.825742778293648*^9, 3.82632663806441*^9, 3.826329716613097*^9, 
   3.8263308603267937`*^9, 3.826333659404598*^9, 3.830143424034545*^9, 
   3.836211027406932*^9, 3.839372881859086*^9, 3.839714320545967*^9, 
   3.849256141702674*^9, 3.851810189067355*^9, 3.852534991328978*^9, 
   3.869387904550948*^9, 3.8850761804942827`*^9},
 CellLabel->"Out[86]=",
 CellID->1447828988,ExpressionUUID->"f6453fc3-cea9-4029-939c-2982c55fb94e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
This demonstrates the generation of an entangled state from a product state.\
\>", "MathCaption",
 CellChangeTimes->{{3.824366578672946*^9, 
  3.8243666140852957`*^9}},ExpressionUUID->"2e13d3e5-2de8-4d2a-8564-\
202c87ea586b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"new", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{
        RowBox[{"S", "@", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], ",", "entangler"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{"ExpressionFor", "[", "new", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"vec", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.819078481844549*^9, 3.81907854459369*^9}, {
   3.819078575284071*^9, 3.819078630127453*^9}, {3.819078667838171*^9, 
   3.8190786729450407`*^9}, 3.829808799537092*^9, 3.830143410899303*^9},
 CellLabel->"In[87]:=",ExpressionUUID->"b80b94c1-159c-4adb-9084-6329740a96ef"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.10666666666666667`],
       FontWeight->"Light"], {-0.1, -1}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.10666666666666667`],
       FontWeight->"Light"], {-0.1, -2}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->154.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], 
   $CellContext`S[1, 6], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}]]]], "Output",
 CellChangeTimes->{{3.819078527129939*^9, 3.81907853023879*^9}, 
   3.8190785813042307`*^9, {3.8190786304391623`*^9, 3.819078637048346*^9}, 
   3.8190786737760468`*^9, 3.819804632481044*^9, 3.822805969301094*^9, 
   3.8243666796037827`*^9, 3.826326641429674*^9, 3.8263297166209517`*^9, 
   3.826330862489051*^9, 3.826333659439912*^9, 3.83014342558545*^9, 
   3.836211028856949*^9, 3.83937288316271*^9, 3.839714321788373*^9, 
   3.849256142985146*^9, 3.851810189080586*^9, 3.8525350050039043`*^9, 
   3.869387906104884*^9, 3.885076181836907*^9},
 CellLabel->"Out[87]=",
 CellID->1749038455,ExpressionUUID->"64d30914-e401-412a-8c74-441ec0e500e0"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], 
   SqrtBox["2"]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 1|>]], 
   SqrtBox["2"]]}]], "Output",
 CellChangeTimes->{{3.819078527129939*^9, 3.81907853023879*^9}, 
   3.8190785813042307`*^9, {3.8190786304391623`*^9, 3.819078637048346*^9}, 
   3.8190786737760468`*^9, 3.819804632481044*^9, 3.822805969301094*^9, 
   3.8243666796037827`*^9, 3.826326641429674*^9, 3.8263297166209517`*^9, 
   3.826330862489051*^9, 3.826333659439912*^9, 3.83014342558545*^9, 
   3.836211028856949*^9, 3.83937288316271*^9, 3.839714321788373*^9, 
   3.849256142985146*^9, 3.851810189080586*^9, 3.8525350050039043`*^9, 
   3.869387906104884*^9, 3.885076181855101*^9},
 CellLabel->"Out[89]=",
 CellID->1333153049,ExpressionUUID->"16088089-3e61-48a7-b847-dfcb7b5c880c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
This lists the mapping between the standard tensor-product basis states and \
the Bell states.\
\>", "MathCaption",
 CellChangeTimes->{{3.8243666391720257`*^9, 
  3.824366671097584*^9}},ExpressionUUID->"3d142bbd-6d0a-42be-92a0-\
5d822e70e255"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"Basis", "@", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ExpressionFor", "[", "entangler", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "bs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"table", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"bs", "\[Rule]", "out"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"table", "//", "LogicalForm"}], "//", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.81907873699475*^9, 3.819078813142408*^9}, 
   3.819080150115711*^9, {3.8190801833335323`*^9, 3.819080184255352*^9}, 
   3.830143410900725*^9},
 CellLabel->"In[90]:=",ExpressionUUID->"0147afec-6f57-4ae9-873a-2960749d7463"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       RowBox[{
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            0|>]], 
         SqrtBox["2"]], "+", 
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            1|>]], 
         SqrtBox["2"]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       RowBox[{
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            1|>]], 
         SqrtBox["2"]], "+", 
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            0|>]], 
         SqrtBox["2"]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       RowBox[{
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            0|>]], 
         SqrtBox["2"]], "-", 
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            1|>]], 
         SqrtBox["2"]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       RowBox[{
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            1|>]], 
         SqrtBox["2"]], "-", 
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            0|>]], 
         SqrtBox["2"]]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8190787618092957`*^9, 3.8190788153771353`*^9}, 
   3.8190801857497883`*^9, 3.8198046342385263`*^9, 3.82280597247996*^9, {
   3.824366673742155*^9, 3.824366681256322*^9}, 3.8263266442759438`*^9, 
   3.826329716686925*^9, 3.82633365958442*^9, 3.830143427183655*^9, 
   3.8362110303187857`*^9, 3.839372884493305*^9, 3.839714323036229*^9, 
   3.849256144312306*^9, 3.851810189100134*^9, 3.852535007296803*^9, 
   3.869387907660231*^9, 3.8850761832173443`*^9},
 CellLabel->"Out[94]//TableForm=",
 CellID->1322465349,ExpressionUUID->"21f2de2b-ea83-401e-92bb-6ca0484b9db7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Here we want to generate a maximally entangled state between two quantum ",
 StyleBox["registers",
  FontSlant->"Italic"],
 " (not just qubits) each of which is consisting of two qubits."
}], "MathCaption",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.8194465988122997`*^9, 3.8194466504802856`*^9}, {
  3.8199481804746723`*^9, 3.819948181294593*^9}, {3.830227655811122*^9, 
  3.830227688490322*^9}, {3.8406575302146797`*^9, 3.84065753046282*^9}, {
  3.840657565686247*^9, 
  3.84065756944353*^9}},ExpressionUUID->"99da444a-e79b-4f22-b4cf-\
69f285e8ab90"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", "6"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "4", "]"}]}], "]"}], ",", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"S", "[", "2.5", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.819446823925454*^9, 3.8194468674925547`*^9}, 
   3.819447084774691*^9, {3.819447780725461*^9, 3.819447818829324*^9}, {
   3.8194478836830797`*^9, 3.819447892120175*^9}, {3.823840890647049*^9, 
   3.823840896597485*^9}, {3.826326650670429*^9, 3.826326651300371*^9}, {
   3.8263310044435*^9, 3.8263311212110453`*^9}, 3.829808799553801*^9, {
   3.840657496821397*^9, 3.840657510417255*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"162b2b9b-998c-482b-a43c-a108917fe950"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -4}, {4, -4}}, {{
     0, -5}, {4, -5}}}], {InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -1}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -2}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -4}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -5}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
      LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
       0.6, -1.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
      LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
       0.6, -2.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}, {LineBox[{{2, -1}, {2, -4}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -4}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -4}, {2.2666666666666666`, -4}}, {{
         2, -4.266666666666667}, {2, -3.7333333333333334`}}}]}}, {
     LineBox[{{3, -2}, {3, -5}}], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -5}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -5}, {3.2666666666666666`, -5}}, {{
         3, -5.266666666666667}, {3, -4.733333333333333}}}]}}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-11, 2], 
       Rational[-1, 2]}}, {Full, {-5.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>]], {
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6]}, 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[3, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[4, Q3`$]}], 
   "Invisible" -> $CellContext`S[2.5]]]], "Output",
 CellChangeTimes->{
  3.8263308919416*^9, {3.8263310099165373`*^9, 3.8263311215775642`*^9}, 
   3.826333659630981*^9, 3.830143428913327*^9, {3.830227689828946*^9, 
   3.830227706738007*^9}, 3.836211032519744*^9, 3.839372886100978*^9, 
   3.83971432444178*^9, {3.8406574823017397`*^9, 3.840657511212346*^9}, {
   3.840657557745653*^9, 3.840657573530014*^9}, 3.8492561463088703`*^9, 
   3.8518101891223783`*^9, 3.86938790966684*^9, 3.885076184868751*^9},
 CellLabel->"Out[95]=",
 CellID->1610294984,ExpressionUUID->"08dc460f-1050-48e5-840e-dc559f5855da"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"ExpressionFor", "[", "qc", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.8194468712183027`*^9, 3.819446884996311*^9}, 
   3.819447087114505*^9, 3.830143410908186*^9},
 CellLabel->"In[96]:=",ExpressionUUID->"49801697-7284-448d-9a55-8d7062c506fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>]]}], 
  "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 0|>]]}], 
  "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
      1|>]]}]}]], "Output",
 CellChangeTimes->{{3.8194468776220713`*^9, 3.819446885275675*^9}, {
   3.819446976530141*^9, 3.819446979350876*^9}, 3.819447087467074*^9, 
   3.8194478222798033`*^9, 3.819804638239019*^9, 3.8228059757978992`*^9, 
   3.8238409017846613`*^9, 3.826326654544339*^9, 3.8263297167649603`*^9, 
   3.826333659675812*^9, 3.8301434334530973`*^9, {3.830227702667199*^9, 
   3.830227707819481*^9}, 3.836211034356791*^9, 3.839372887742502*^9, 
   3.8397143260487137`*^9, {3.840657558961005*^9, 3.840657575278419*^9}, 
   3.8492561480644217`*^9, 3.851810189136735*^9, 3.869387911559216*^9, 
   3.885076186278482*^9},
 CellLabel->"Out[97]=",
 CellID->1104648573,ExpressionUUID->"760ce40f-74cf-4036-a2d0-7f785dd53412"]
}, Open  ]],

Cell["\<\
This example illustrate that the entanglement depends on the partition of the \
system. Indeed, the above system is a product state for the partition (1,3) \
and (2,4) qubits.\
\>", "Text",
 CellChangeTimes->{{3.8194471191522627`*^9, 
  3.819447189494157*^9}},ExpressionUUID->"ca1a3d64-8ee3-4f65-86cc-\
d69c6037c98a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KetFactor", "[", "out", "]"}]], "Input",
 CellChangeTimes->{{3.819447192659738*^9, 3.8194471976503077`*^9}, 
   3.83971424058998*^9},
 CellLabel->"In[98]:=",ExpressionUUID->"9e8ead7d-ff3b-4592-af30-b98845f5770b"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  InterpretationBox[
   TagBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 0|>]], 
       "+", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 
          1|>]]}], ")"}], "\[CircleTimes]", 
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>]], 
       "+", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
          1|>]]}], ")"}]}],
    HoldForm],
   Q3`OTimes[
   Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[3, Q3`$] -> 0|>] + 
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[3, Q3`$] -> 1|>], 
    Ket[<|$CellContext`S[2, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>] + 
    Ket[<|$CellContext`S[2, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
       1|>]]]}]], "Output",
 CellChangeTimes->{3.819447197940336*^9, 3.819447825487113*^9, 
  3.8198046396595078`*^9, 3.8228059772250147`*^9, 3.823840904424131*^9, 
  3.8263266565519753`*^9, 3.826329716776085*^9, 3.826333659717217*^9, 
  3.830143436951926*^9, 3.830227722582941*^9, 3.836211037168654*^9, 
  3.839372889294327*^9, 3.839714327506002*^9, 3.8406575779468718`*^9, 
  3.849256149541129*^9, 3.851810189153911*^9, 3.869387912986261*^9, 
  3.885076187790617*^9},
 CellLabel->"Out[98]=",
 CellID->1378058886,ExpressionUUID->"dae118e2-1771-416e-8afa-d5de9136add2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The above construction can be generalized for a pair of ",
 StyleBox["n",
  FontSlant->"Italic"],
 "-qubit registers."
}], "MathCaption",
 CellChangeTimes->{{3.825743800986895*^9, 3.825743831991061*^9}, {
  3.8406575941829977`*^9, 
  3.840657595395912*^9}},ExpressionUUID->"beedc2b8-0af7-48f7-934d-\
148ce1092bc4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"LogicalForm", "[", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"Range", "[", 
        RowBox[{"2", "n"}], "]"}]}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"Range", "[", "n", "]"}], ",", "6"}], "]"}], ",", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"CNOT", "[", 
        RowBox[{
         RowBox[{"S", "[", "j", "]"}], ",", 
         RowBox[{"S", "[", 
          RowBox[{"n", "+", "j"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"S", "[", 
      RowBox[{"n", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.819446823925454*^9, 3.8194468674925547`*^9}, 
   3.819447084774691*^9, {3.819447780725461*^9, 3.819447818829324*^9}, {
   3.8194478836830797`*^9, 3.819447892120175*^9}, {3.823840890647049*^9, 
   3.823840896597485*^9}, {3.825743846964202*^9, 3.825743896395183*^9}, {
   3.825743942174016*^9, 3.82574401241059*^9}, {3.825744267593985*^9, 
   3.8257442729470463`*^9}, 3.826326663112199*^9, 3.829808799574212*^9, {
   3.840657601541307*^9, 3.840657612272695*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"93d13f21-efdf-46ea-ae94-857a21d2ffcc"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {5, -3}}, {{
     0, -5}, {5, -5}}, {{0, -6}, {5, -6}}, {{0, -7}, {5, -7}}}], {InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.06400000000000002],
       FontWeight->"Light"], {-0.1, -1}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.06400000000000002],
       FontWeight->"Light"], {-0.1, -2}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.06400000000000002],
       FontWeight->"Light"], {-0.1, -3}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.06400000000000002],
       FontWeight->"Light"], {-0.1, -5}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.06400000000000002],
       FontWeight->"Light"], {-0.1, -6}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.06400000000000002],
       FontWeight->"Light"], {-0.1, -7}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
      LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
       0.6, -1.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {1, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
      LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
       0.6, -2.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {1, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, 
      LineBox[{{0.6, -3.4}, {1.4, -3.4}, {1.4, -2.6}, {0.6, -2.6}, {
       0.6, -3.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {1, -3}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}, {LineBox[{{2, -1}, {2, -5}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -5}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -5}, {2.2666666666666666`, -5}}, {{
         2, -5.266666666666667}, {2, -4.733333333333333}}}]}}, {
     LineBox[{{3, -2}, {3, -6}}], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -6}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -6}, {3.2666666666666666`, -6}}, {{
         3, -6.266666666666667}, {3, -5.733333333333333}}}]}}, {
     LineBox[{{4, -3}, {4, -7}}], 
     DiskBox[{4, -3}, 0.09], {CircleBox[{4, -7}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -7}, {4.266666666666667, -7}}, {{
         4, -7.266666666666667}, {4, -6.733333333333333}}}]}}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->226.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-15, 2], 
       Rational[-1, 2]}}, {Full, {-7.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
      0, $CellContext`S[5, Q3`$] -> 0, $CellContext`S[6, Q3`$] -> 0|>]], {
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6], 
    $CellContext`S[3, 6]}, 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[4, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[5, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[3, Q3`$]} -> {1}, {
     $CellContext`S[6, Q3`$]}], "Invisible" -> $CellContext`S[
     Rational[7, 2]]]]], "Output",
 CellChangeTimes->{{3.825743997624267*^9, 3.8257440153173513`*^9}, 
   3.8257442732415533`*^9, {3.826326657717353*^9, 3.826326663710225*^9}, 
   3.826329716819635*^9, 3.826333659758491*^9, 3.830143438925418*^9, 
   3.830227735782058*^9, 3.836211038861361*^9, 3.839372890531464*^9, 
   3.839714328959489*^9, {3.840657597913855*^9, 3.840657629448121*^9}, 
   3.849256151027873*^9, 3.851810189169466*^9, 3.869387914374316*^9, 
   3.88507618925252*^9},
 CellLabel->"Out[100]=",
 CellID->624929922,ExpressionUUID->"23aa6cde-69ff-4d99-8b48-313389fa1010"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"ExpressionFor", "[", "qc", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.82574402963694*^9, 3.8257440426939087`*^9}, 
   3.830143410925644*^9},
 CellLabel->
  "In[101]:=",ExpressionUUID->"b263c9c4-e604-4a79-8d6e-437d1139f391"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`S[4, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]], 
          $CellContext`S[5, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"6"}, "RowDefault"]], 
          $CellContext`S[6, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
      0, $CellContext`S[5, Q3`$] -> 0, $CellContext`S[6, Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`S[4, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]], 
          $CellContext`S[5, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"6"}, "RowDefault"]], 
          $CellContext`S[6, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
      0, $CellContext`S[5, Q3`$] -> 0, $CellContext`S[6, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`S[4, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]], 
          $CellContext`S[5, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"6"}, "RowDefault"]], 
          $CellContext`S[6, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
      0, $CellContext`S[5, Q3`$] -> 1, $CellContext`S[6, Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`S[4, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]], 
          $CellContext`S[5, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"6"}, "RowDefault"]], 
          $CellContext`S[6, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
      0, $CellContext`S[5, Q3`$] -> 1, $CellContext`S[6, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`S[4, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]], 
          $CellContext`S[5, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"6"}, "RowDefault"]], 
          $CellContext`S[6, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
      1, $CellContext`S[5, Q3`$] -> 0, $CellContext`S[6, Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`S[4, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]], 
          $CellContext`S[5, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"6"}, "RowDefault"]], 
          $CellContext`S[6, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
      1, $CellContext`S[5, Q3`$] -> 0, $CellContext`S[6, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`S[4, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]], 
          $CellContext`S[5, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"6"}, "RowDefault"]], 
          $CellContext`S[6, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
      1, $CellContext`S[5, Q3`$] -> 1, $CellContext`S[6, Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`S[4, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"5"}, "RowDefault"]], 
          $CellContext`S[5, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"6"}, "RowDefault"]], 
          $CellContext`S[6, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
      1, $CellContext`S[5, Q3`$] -> 1, $CellContext`S[6, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellChangeTimes->{3.8257440430211163`*^9, 3.8257442759320717`*^9, 
  3.8263266659269323`*^9, 3.826329716896146*^9, 3.82633365983525*^9, 
  3.8301434412719603`*^9, 3.8302277375611*^9, 3.8362110409987373`*^9, 
  3.839372891968382*^9, 3.83971433141138*^9, 3.840657630638047*^9, 
  3.8492561535905724`*^9, 3.851810189207821*^9, 3.869387916371213*^9, 
  3.885076191312385*^9},
 CellLabel->"Out[102]=",
 CellID->800100499,ExpressionUUID->"cf48dd5b-4cec-4890-b381-bba81a5c7de7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The CZ (or controlled-Z) gate is a variant of the CNOT gate.", \
"MathCaption",
 CellChangeTimes->{{3.826529117848213*^9, 
  3.8265291369897337`*^9}},ExpressionUUID->"86311d7b-a13f-419e-b1e8-\
5fe144b9fc85"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"CZ", "[", 
   RowBox[{
    RowBox[{"S", "[", "1", "]"}], ",", 
    RowBox[{"S", "[", "2", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.826529140549799*^9, 3.826529144267613*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"742e4748-dc5d-4586-a8be-384167fd6656"],

Cell[BoxData[
 RowBox[{"CZ", "[", 
  RowBox[{
   RowBox[{"{", 
    InterpretationBox[
     SubscriptBox[
      TemplateBox[{"S"},
       "RowDefault"], 
      TemplateBox[{"1"},
       "RowDefault"]],
     $CellContext`S[1, Q3`$]], "}"}], ",", 
   RowBox[{"{", 
    InterpretationBox[
     SubscriptBox[
      TemplateBox[{"S"},
       "RowDefault"], 
      TemplateBox[{"2"},
       "RowDefault"]],
     $CellContext`S[2, Q3`$]], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.8265291448234463`*^9, 3.826529147101191*^9}, 
   3.826861029292412*^9, 3.826861149084783*^9, 3.830143443149644*^9, 
   3.83621104278379*^9, 3.8393728936028013`*^9, 3.839714332770523*^9, 
   3.840657652519223*^9, 3.8492561593585653`*^9, 3.851810189227056*^9, 
   3.869387918055654*^9, 3.8850761927902*^9},
 CellLabel->"Out[103]=",
 CellID->598675306,ExpressionUUID->"1740f5ba-cf3d-42a7-8f0c-a4c7ed34bf6d"]
}, Open  ]],

Cell["This shows how it transforms the logical basis states.", "Text",
 CellChangeTimes->{{3.826529230878686*^9, 
  3.826529244387602*^9}},ExpressionUUID->"111abc9c-ba2a-4839-b19a-\
18551ebc8ac9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"Basis", "@", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "bs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"bs", "\[Rule]", "out"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.8265291478378057`*^9, 3.826529183573353*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"ef7281d7-95e0-46a1-8049-818e7886a5f0"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       RowBox[{"-", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{
             SubscriptBox["1", 
              InterpretationBox[
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"1"}, "RowDefault"]], 
               $CellContext`S[1, Q3`$]]], 
             SubscriptBox["1", 
              InterpretationBox[
               SubscriptBox[
                TemplateBox[{"S"}, "RowDefault"], 
                TemplateBox[{"2"}, "RowDefault"]], 
               $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
          "Ket"],
         Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
           1|>]]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8265292457276287`*^9, 3.826861030587031*^9, 3.826861150590488*^9, 
   3.830143444448751*^9, 3.836211044012292*^9, 3.839372895106958*^9, 
   3.8397143341893253`*^9, {3.840657659482839*^9, 3.840657663853656*^9}, 
   3.8492561613349543`*^9, 3.8518101892391376`*^9, 3.869387919272655*^9, 
   3.885076194132143*^9},
 CellLabel->"Out[106]//TableForm=",
 CellID->1350625437,ExpressionUUID->"048a0d30-4ad0-4fb4-b06f-d5fef1bd77fd"]
}, Open  ]],

Cell["Here is the matrix representation of the CZ gate.", "Text",
 CellChangeTimes->{{3.82652921706291*^9, 
  3.826529254860557*^9}},ExpressionUUID->"35978355-60c6-4eea-a1cf-\
1bf70781a1af"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"Elaborate", "@", "op"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.826529196974769*^9, 3.8265292114268513`*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"884e58df-4e11-4a5b-bd4f-51534f9b7467"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "1"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {1, 1, 1, -1}}]]]]], "Output",\

 CellChangeTimes->{{3.826529202847073*^9, 3.82652921177357*^9}, {
   3.826529248059108*^9, 3.826529256125996*^9}, 3.826861031797268*^9, 
   3.826861152245582*^9, 3.830143446093111*^9, 3.836211045330554*^9, 
   3.839372896630383*^9, 3.839714335761302*^9, 3.8406576651028233`*^9, 
   3.849256162832324*^9, 3.851810189249777*^9, 3.869387920637994*^9, 
   3.885076195696724*^9},
 CellLabel->"Out[108]//MatrixForm=",
 CellID->2116567763,ExpressionUUID->"6585a36a-3d68-4a98-9e24-cc7712a5b269"]
}, Open  ]],

Cell["This is the quantum circuit model of the CZ gate.", "Text",
 CellChangeTimes->{{3.826529286517199*^9, 
  3.826529298733292*^9}},ExpressionUUID->"5251ee94-36c2-4210-96d4-\
a9e3983ee526"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cz", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"CZ", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.826529261008885*^9, 3.826529280531947*^9}, 
   3.8298087995999603`*^9},
 CellLabel->
  "In[109]:=",ExpressionUUID->"2b2b37e3-421d-401d-9490-b52a20622e4b"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     DiskBox[{1, -2}, 0.09]}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CZ[{
     $CellContext`S[1, Q3`$]}, {
     $CellContext`S[2, Q3`$]}]]]], "Output",
 CellChangeTimes->{{3.8265292815838127`*^9, 3.8265293000307713`*^9}, 
   3.826861033148694*^9, 3.826861153606882*^9, 3.830143447513739*^9, 
   3.836211046662677*^9, 3.839372898013913*^9, 3.839714337037135*^9, 
   3.849256164248374*^9, 3.851810189261074*^9, 3.86938792225266*^9, 
   3.885076197215789*^9},
 CellLabel->"Out[109]=",
 CellID->248116771,ExpressionUUID->"d20aa3f8-0c56-4e86-aa9b-05f9aa657823"]
}, Open  ]],

Cell["Note the following identity.", "Text",
 CellChangeTimes->{{3.8265294195298557`*^9, 
  3.826529425616026*^9}},ExpressionUUID->"4e19c8f7-7036-4bb9-8b9b-\
ff86fea97932"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"expr", "=", 
  RowBox[{"HoldForm", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "6"}], "]"}], "**", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "3"}], "]"}], "**", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "6"}], "]"}]}], "\[Equal]", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReleaseHold", "[", "expr", "]"}], "//", "Elaborate"}]}], "Input",
 CellChangeTimes->{{3.826529305464629*^9, 3.826529401125536*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"954b2d20-aa32-4553-b5aa-7c62004afb2f"],

Cell[BoxData[
 TagBox[
  RowBox[{
   RowBox[{
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"H\""}, "RowDefault"]},
      "Subsuperscript"],
     $CellContext`S[1, 6]], "**", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"z\""}, "RowDefault"]},
      "Subsuperscript"],
     $CellContext`S[1, 3]], "**", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"1"}, "RowDefault"], 
       TemplateBox[{"\"H\""}, "RowDefault"]},
      "Subsuperscript"],
     $CellContext`S[1, 6]]}], "\[Equal]", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[1, 1]]}],
  HoldForm]], "Output",
 CellChangeTimes->{{3.826529318332283*^9, 3.826529428176075*^9}, 
   3.826861034386003*^9, 3.826861154901045*^9, 3.8301434492052317`*^9, 
   3.836211048012104*^9, 3.83937289923925*^9, 3.839714338329688*^9, 
   3.8492561659796457`*^9, 3.851810189265052*^9, 3.8693879237240257`*^9, 
   3.885076198609169*^9},
 CellLabel->"Out[110]=",
 CellID->1649451623,ExpressionUUID->"cef51b13-e529-4b54-99d5-359602530dcf"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.826529318332283*^9, 3.826529428176075*^9}, 
   3.826861034386003*^9, 3.826861154901045*^9, 3.8301434492052317`*^9, 
   3.836211048012104*^9, 3.83937289923925*^9, 3.839714338329688*^9, 
   3.8492561659796457`*^9, 3.851810189265052*^9, 3.8693879237240257`*^9, 
   3.885076198612813*^9},
 CellLabel->"Out[111]=",
 CellID->467028638,ExpressionUUID->"81e1a494-0a2a-4041-bc81-42e2818228c1"]
}, Open  ]],

Cell["\<\
It leads to the following relation between the CNOT gate and CZ gate.\
\>", "Text",
 CellChangeTimes->{{3.826529430760172*^9, 
  3.8265294552133207`*^9}},ExpressionUUID->"5042ed73-c49f-4a83-9bf8-\
e00d3a850ef8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "6"}], "]"}], ",", "cz", ",", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "6"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.826529459065184*^9, 3.8265294872851877`*^9}, 
   3.829808799603917*^9},
 CellLabel->
  "In[112]:=",ExpressionUUID->"72dfe879-0207-4672-8f64-f899d60fec73"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], DiskBox[{2, -2}, 0.09]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, 
     LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -1.6}, {2.6, -1.6}, {
      2.6, -2.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[2, 6], 
   Q3`CZ[{
     $CellContext`S[1, Q3`$]}, {
     $CellContext`S[2, Q3`$]}], 
   $CellContext`S[2, 6]]]], "Output",
 CellChangeTimes->{{3.826529487982183*^9, 3.826529490289905*^9}, 
   3.8265295244044333`*^9, 3.8268610367944927`*^9, 3.8268611566050587`*^9, 
   3.830143450874463*^9, 3.836211049589787*^9, 3.839372900512082*^9, 
   3.839714339836759*^9, 3.84925616743944*^9, 3.851810189270577*^9, 
   3.869387925131468*^9, 3.8850762000429697`*^9},
 CellLabel->"Out[112]=",
 CellID->464217749,ExpressionUUID->"37063ecf-2fbb-466a-b7ea-672285068681"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cnot", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8265294967059803`*^9, 3.8265295066790657`*^9}, 
   3.829808799606641*^9},
 CellLabel->
  "In[113]:=",ExpressionUUID->"8713da6b-c48a-4c57-ab1b-0698748d40d4"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}]]]], "Output",
 CellChangeTimes->{{3.826529507203013*^9, 3.826529525585054*^9}, 
   3.826861037757917*^9, 3.826861157656557*^9, 3.8301434520078287`*^9, 
   3.836211050547866*^9, 3.8393729020837927`*^9, 3.839714341561347*^9, 
   3.849256169017971*^9, 3.851810189286463*^9, 3.8693879266554728`*^9, 
   3.885076201780222*^9},
 CellLabel->"Out[113]=",
 CellID->320331823,ExpressionUUID->"c04074c2-3045-4b78-977e-03bd1cefd8f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Elaborate", "[", 
  RowBox[{"new", "-", "cnot"}], "]"}]], "Input",
 CellChangeTimes->{{3.826529510757115*^9, 3.826529520076939*^9}, {
  3.826861041193499*^9, 3.826861045287882*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"a508780c-24cc-4ba5-80ae-799fcb39cb25"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.8265295204659367`*^9, 3.82652954068167*^9}, {
   3.826861046750609*^9, 3.8268610491428843`*^9}, 3.8268611592178087`*^9, 
   3.830143452989121*^9, 3.83621105140978*^9, 3.839372903020965*^9, 
   3.8397143423300257`*^9, 3.849256169970552*^9, 3.851810189295895*^9, 
   3.8693879281154118`*^9, 3.8850762033506107`*^9},
 CellLabel->"Out[114]=",
 CellID->83729997,ExpressionUUID->"b21763ac-b7a3-4e86-a86e-b81628867080"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The SWAP gate exchanges the states of two qubits.", "MathCaption",
 CellChangeTimes->{{3.8278171004901037`*^9, 3.827817120018779*^9}},
 CellID->774086453,ExpressionUUID->"bfb4feae-4d8a-448b-9cbe-6d324dbbe0a9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"SWAP", "[", 
   RowBox[{
    RowBox[{"S", "[", "1", "]"}], ",", 
    RowBox[{"S", "[", "2", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.815466859662866*^9, 3.815466873667522*^9}, {
  3.827817162002549*^9, 3.827817194142535*^9}},
 CellLabel->"In[115]:=",
 CellID->1456780551,ExpressionUUID->"2662d666-5f3f-4df1-b4b4-ceae4ce6e94e"],

Cell[BoxData[
 RowBox[{"SWAP", "[", 
  RowBox[{
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"S"},
      "RowDefault"], 
     TemplateBox[{"1"},
      "RowDefault"]],
    $CellContext`S[1, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"S"},
      "RowDefault"], 
     TemplateBox[{"2"},
      "RowDefault"]],
    $CellContext`S[2, Q3`$]]}], "]"}]], "Output",
 CellChangeTimes->{{3.815466869152904*^9, 3.815466888239955*^9}, 
   3.8228123315138063`*^9, 3.826915399183448*^9, {3.82781716592656*^9, 
   3.827817196631568*^9}, 3.8301434542954273`*^9, 3.836211052736004*^9, 
   3.83937290413481*^9, 3.839714344131279*^9, 3.8492561712480497`*^9, 
   3.8518101892996473`*^9, 3.869387929325769*^9, 3.885076204924539*^9},
 CellLabel->"Out[115]=",
 CellID->48984789,ExpressionUUID->"0124a8a0-1c4e-43d5-ac2d-b29c7aad3da1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"Basis", "@", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"op", "**", "bs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"bs", "\[Rule]", "new"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.827817199375448*^9, 3.8278172412775917`*^9}},
 CellLabel->"In[116]:=",
 CellID->2038406925,ExpressionUUID->"1b187ddd-1008-498d-aff2-41c4537043ce"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 1|>]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.82781721289013*^9, 3.827817246201005*^9}, 
   3.830143455337682*^9, 3.83621105354526*^9, 3.839372905136586*^9, 
   3.8397143449713593`*^9, 3.8492561724708443`*^9, 3.851810189315889*^9, 
   3.869387930265093*^9, 3.8850762061468983`*^9},
 CellLabel->"Out[118]//TableForm=",
 CellID->1526319740,ExpressionUUID->"7496170e-a56c-43b9-8e3d-0ba681c679c2"]
}, Open  ]],

Cell["\<\
This is the matrix representation of the SWAP gate in the logical basis.\
\>", "Text",
 CellChangeTimes->{{3.827817253550276*^9, 3.82781726942374*^9}},
 CellID->2139433950,ExpressionUUID->"a8e1da40-7f05-42f6-b559-317c8e81d542"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", 
   RowBox[{"Elaborate", "@", "op"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.815466879113161*^9, 3.815466883870758*^9}, {
  3.827817174275639*^9, 3.827817180204249*^9}},
 CellLabel->"In[119]:=",
 CellID->227701226,ExpressionUUID->"0ac910d7-cfe3-48f6-a234-57b5e3d8dbf4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {4}, {2}, {3}, {3}, {2}, {4}, {1}}}, {1, 0, 0,
       1, 0, 1, 1, 0}}]]]]], "Output",
 CellChangeTimes->{{3.815466884123556*^9, 3.815466888903578*^9}, 
   3.822812332109405*^9, 3.826915399950811*^9, {3.827817175063809*^9, 
   3.827817182469223*^9}, 3.8278172713271837`*^9, 3.830143457061171*^9, 
   3.836211054903139*^9, 3.8393729068344707`*^9, 3.839714346762596*^9, 
   3.849256173967664*^9, 3.851810189326756*^9, 3.869387931838797*^9, 
   3.885076208068987*^9},
 CellLabel->"Out[119]//MatrixForm=",
 CellID->1158508109,ExpressionUUID->"fe82a1ac-efbf-4a69-b1e2-5cb49a61f07e"]
}, Open  ]],

Cell["\<\
In the quantum circuit model, the SWAP gate is represented as following.\
\>", "Text",
 CellChangeTimes->{{3.8154668987651377`*^9, 3.815466922389246*^9}, {
  3.8278172838238497`*^9, 3.827817285172759*^9}},
 CellID->313606930,ExpressionUUID->"4bf6d41d-890d-484d-bf66-d6eed6823456"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"SWAP", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8154667658416758`*^9, 3.8154668084424963`*^9}, 
   3.8269154159363613`*^9, 3.82980879961697*^9},
 CellLabel->"In[120]:=",
 CellID->2047491910,ExpressionUUID->"bd4b4c68-02dd-41cd-9d5a-73616cdbc9d5"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     LineBox[{{{0.91, -1.09}, {1.09, -0.91}}, {{0.91, -0.91}, {
      1.09, -1.09}}}], 
     LineBox[{{{0.91, -2.09}, {1.09, -1.91}}, {{0.91, -1.91}, {
      1.09, -2.09}}}]}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`SWAP[
    $CellContext`S[1, Q3`$], 
    $CellContext`S[2, Q3`$]]]]], "Output",
 CellChangeTimes->{{3.815466795497795*^9, 3.8154668087167892`*^9}, 
   3.8228123333471823`*^9, {3.826915401452241*^9, 3.826915416360126*^9}, 
   3.827817296456728*^9, 3.830143458532218*^9, 3.836211056363881*^9, 
   3.839372908083827*^9, 3.839714348085043*^9, 3.849256175203546*^9, 
   3.851810189337723*^9, 3.869387933254129*^9, 3.885076209545993*^9},
 CellLabel->"Out[120]=",
 CellID->1267763858,ExpressionUUID->"f39f8bbc-6f83-47a5-b894-a2d1c78ac4bb"]
}, Open  ]],

Cell["The SWAP gate can be implemented by means of the CNOT gate.", "Text",
 CellChangeTimes->{{3.815466929251943*^9, 3.815466949185629*^9}, 
   3.8278172917879677`*^9},
 CellID->2132820600,ExpressionUUID->"8d47bb6d-8a80-4859-b533-152e7858ae39"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.815466813977044*^9, 3.815466831413885*^9}, {
   3.826915422078354*^9, 3.826915422494761*^9}, {3.827817301935958*^9, 
   3.8278173020860577`*^9}, 3.829808799619722*^9},
 CellLabel->"In[121]:=",
 CellID->1679469749,ExpressionUUID->"f0b4ebd2-9ae2-4fb0-90c4-ff514c1cea8e"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -1}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -1}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -1}, {2.2666666666666666`, -1}}, {{
         2, -1.2666666666666666`}, {2, -0.7333333333333334}}}]}}, {
     LineBox[{{3, -1}, {3, -2}}], 
     DiskBox[{3, -1}, 0.09], {CircleBox[{3, -2}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -2}, {3.2666666666666666`, -2}}, {{
         3, -2.2666666666666666`}, {3, -1.7333333333333334`}}}]}}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[1, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}]]]], "Output",
 CellChangeTimes->{{3.815466831757814*^9, 3.815466833692328*^9}, 
   3.822812334527966*^9, {3.826915406020978*^9, 3.8269154230921164`*^9}, {
   3.8278172977661657`*^9, 3.82781730247786*^9}, 3.830143460546362*^9, 
   3.836211057983169*^9, 3.839372909446294*^9, 3.839714349461314*^9, 
   3.849256177301594*^9, 3.851810189342586*^9, 3.8693879348848124`*^9, 
   3.885076211365568*^9},
 CellLabel->"Out[121]=",
 CellID->405782430,ExpressionUUID->"35bf45e2-4ec5-4fcd-a91e-c2c33bbf580b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Elaborate", "[", 
  RowBox[{"qc", "-", "new"}], "]"}]], "Input",
 CellChangeTimes->{{3.826915427209014*^9, 3.826915430357376*^9}, {
  3.82781730416232*^9, 3.8278173048597507`*^9}},
 CellLabel->"In[122]:=",
 CellID->959973641,ExpressionUUID->"1b4e444f-8870-4385-91ea-5f812d8cbeed"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.8269154307029343`*^9, {3.827817305283375*^9, 3.8278173068144407`*^9}, 
   3.830143462290442*^9, 3.836211059480239*^9, 3.8393729108915997`*^9, 
   3.8397143509305077`*^9, 3.849256178877993*^9, 3.8518101893619013`*^9, 
   3.869387937366784*^9, 3.885076213178461*^9},
 CellLabel->"Out[122]=",
 CellID->538259628,ExpressionUUID->"faa37120-0d85-438f-a6d8-c9aa001f7eda"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Let us construct the CZ gate with the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "c544c5fb-619c-497a-86ba-d3fc1c0f1bcb"],
 "gate. This is the matrix representation of the the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "89f56420-bbda-4d01-8ac0-5492033d145d"],
 "gate."
}], "MathCaption",
 CellChangeTimes->{{3.827822368646575*^9, 3.827822408459424*^9}, 
   3.827823475685623*^9, {3.827867082175722*^9, 3.827867082595558*^9}},
 CellID->1938247085,ExpressionUUID->"bfe441d5-b2cd-43da-9630-5bc8fa995daa"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"Matrix", "@", 
      RowBox[{"Elaborate", "@", 
       RowBox[{"SWAP", "[", 
        RowBox[{
         RowBox[{"S", "[", "1", "]"}], ",", 
         RowBox[{"S", "[", "2", "]"}]}], "]"}]}]}], ",", 
     RowBox[{"1", "/", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.827822423900413*^9, 3.827822466123683*^9}, {
  3.8278670424889812`*^9, 3.827867043825494*^9}},
 CellLabel->"In[123]:=",
 CellID->1040933486,ExpressionUUID->"19ccf822-7ce5-490b-a6fb-49f8e60b5de6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], "+", 
       FractionBox["\[ImaginaryI]", "2"]}], 
      RowBox[{
       FractionBox["1", "2"], "-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], "-", 
       FractionBox["\[ImaginaryI]", "2"]}], 
      RowBox[{
       FractionBox["1", "2"], "+", 
       FractionBox["\[ImaginaryI]", "2"]}], "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.827822461111882*^9, 3.827822466404245*^9}, 
   3.82782347851576*^9, 3.827866785713497*^9, {3.8278670444271603`*^9, 
   3.82786704647188*^9}, 3.827867084346381*^9, 3.830143463921237*^9, 
   3.8362110609843483`*^9, 3.839372912323102*^9, 3.839714352301269*^9, 
   3.849256180089653*^9, 3.851810189373851*^9, 3.852574677222789*^9, 
   3.869387938997342*^9, 3.885076214682577*^9},
 CellLabel->"Out[124]//MatrixForm=",
 CellID->1217449125,ExpressionUUID->"da84ab7b-4097-41e9-bad8-a8b2e2cb6170"]
}, Open  ]],

Cell[TextData[{
 "This is an explicit operator expression of the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "927cba06-bc2d-406b-8f0a-1a7d371b856c"],
 "gate in terms of the Pauli operators."
}], "Text",
 CellChangeTimes->{{3.827867087090748*^9, 3.8278671345863447`*^9}},
 CellID->771058470,ExpressionUUID->"4c588bc8-aa28-4473-b7e9-bbf87a5b3cb5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sqrtSWAP", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ExpressionFor", "[", 
     RowBox[{"mat", ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], ",", 
    RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<\!\(\*SqrtBox[\(U\)]\)\>\""}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.827822477257101*^9, 3.8278224990965242`*^9}, {
   3.8278668081831207`*^9, 3.8278668120640173`*^9}, 3.830143410974454*^9, 
   3.849256566928802*^9, 3.849256786777061*^9, 3.849256963942255*^9},
 CellLabel->"In[125]:=",
 CellID->1895203240,ExpressionUUID->"0339f499-0c88-42b7-bb65-5eff99be5f8b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["3", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "4"], "-", 
       FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[1, 3]], 
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[2, 3]]}, "RowDefault"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3]]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], "-", 
       FractionBox["\[ImaginaryI]", "2"]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"+\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[1, 4]], 
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"-\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[2, 5]]}, "RowDefault"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 5]]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], "-", 
       FractionBox["\[ImaginaryI]", "2"]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"], 
             TemplateBox[{"\"-\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[1, 5]], 
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"+\""}, "RowDefault"]}, "Subsuperscript", 
            SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[2, 4]]}, "RowDefault"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[2, 4]]]}]}], ",", 
   RowBox[{"\<\"Label\"\>", 
    "\[Rule]", "\<\"\\!\\(\\*SqrtBox[\\(U\\)]\\)\"\>"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.827822499540248*^9, 3.827822502534231*^9}, 
   3.827823479339973*^9, {3.827866813326198*^9, 3.827866817401004*^9}, 
   3.827867136141047*^9, 3.8301434655048227`*^9, 3.836211062583006*^9, 
   3.839372913590934*^9, 3.8397143537230587`*^9, 3.8492561816374083`*^9, 
   3.849256567877202*^9, 3.849256787499045*^9, 3.849256964955697*^9, 
   3.8518101893860617`*^9, 3.852574687949662*^9, 3.869387942590749*^9, 
   3.885076216187242*^9},
 CellLabel->"Out[125]=",
 CellID->1935802717,ExpressionUUID->"a4b0a1e0-3871-4983-bdd0-fd0a35b77891"]
}, Open  ]],

Cell[TextData[{
 "This is a quantum circuit model to construct the CZ gate from the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "adb29f3a-9055-44d6-8575-b05b2b67801d"],
 " gate and single-qubit rotation gates. In this diagram, ",
 Cell[BoxData[
  FormBox[
   SqrtBox["U"], TraditionalForm]],ExpressionUUID->
  "a78622bd-2a90-43b6-9871-4da9f653727d"],
 " denotes the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "3c8efa14-eb47-4a1c-8591-0bd970c47e15"],
 "gate and ",
 Cell[BoxData[
  FormBox["S", TraditionalForm]],ExpressionUUID->
  "6654f287-5ef7-48b1-b04a-625dc237e0a0"],
 " the quadrant phase gate (or, equivalently, the rotation around the z-axis \
by angle \[Pi]/2)."
}], "Text",
 CellChangeTimes->{{3.827866852804318*^9, 3.827867017614402*^9}, {
  3.852574708573845*^9, 3.852574711467834*^9}, {3.8525748739723988`*^9, 
  3.852574908299061*^9}},
 CellID->27233292,ExpressionUUID->"611407e5-95ef-4190-a643-0428a6363dce"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"sqrtSWAP", ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "3"}], "]"}], ",", "sqrtSWAP", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"1", ",", "7"}], "]"}], ",", 
      RowBox[{"Dagger", "@", 
       RowBox[{"S", "[", 
        RowBox[{"2", ",", "7"}], "]"}]}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.827822504511054*^9, 3.8278226952172956`*^9}, {
   3.827823054258751*^9, 3.8278230639428053`*^9}, {3.827823130102519*^9, 
   3.827823149540761*^9}, {3.8278233606162043`*^9, 3.82782336485705*^9}, {
   3.827823422555438*^9, 3.8278234250407467`*^9}, {3.827866820985561*^9, 
   3.8278668351258793`*^9}, 3.829808799628273*^9, {3.852574787983262*^9, 
   3.852574843874794*^9}},
 CellLabel->"In[126]:=",
 CellID->1505230369,ExpressionUUID->"367e64ca-807e-42d6-b279-334ee0537f88"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}}], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox["\<\"\\!\\(\\*SqrtBox[\\(U\\)]\\)\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], NCache[{1, Rational[-3, 2]}, {1, -1.5}], NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, 
     LineBox[{{1.6, -1.4}, {2.4, -1.4}, {2.4, -0.6}, {1.6, -0.6}, {
      1.6, -1.4}}], InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {2, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -0.6}]}, 
     LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -0.6}, {2.6, -0.6}, {
      2.6, -2.4}}], InsetBox[
      StyleBox["\<\"\\!\\(\\*SqrtBox[\\(U\\)]\\)\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], NCache[{3, Rational[-3, 2]}, {3, -1.5}], NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, 
      LineBox[{{3.6, -1.4}, {4.4, -1.4}, {4.4, -0.6}, {3.6, -0.6}, {
       3.6, -1.4}}], InsetBox[
       StyleBox["\<\"S\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {4, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, 
      LineBox[{{3.6, -2.4}, {4.4, -2.4}, {4.4, -1.6}, {3.6, -1.6}, {
       3.6, -2.4}}], InsetBox[
       StyleBox[
        TemplateBox[{"\"S\"", "\"\[Dagger]\""},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {4, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->226.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[{Complex[
      Rational[3, 4], 
      Rational[1, 4]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3]] + Complex[
       Rational[1, 2], 
       Rational[-1, 2]] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 5]] + Complex[
       Rational[1, 2], 
       Rational[-1, 2]] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[2, 4]], "Label" -> "\!\(\*SqrtBox[\(U\)]\)"}, 
   $CellContext`S[1, 3], {Complex[
      Rational[3, 4], 
      Rational[1, 4]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3]] + Complex[
       Rational[1, 2], 
       Rational[-1, 2]] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 5]] + Complex[
       Rational[1, 2], 
       Rational[-1, 2]] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[2, 4]], "Label" -> "\!\(\*SqrtBox[\(U\)]\)"}, {
    $CellContext`S[1, 7], 
    $CellContext`S[2, -7]}]]], "Output",
 CellChangeTimes->{{3.827822553949234*^9, 3.827822616357169*^9}, 
   3.8278226596014147`*^9, {3.8278226908200703`*^9, 3.827822700039032*^9}, 
   3.8278227601803293`*^9, {3.82782318990448*^9, 3.827823206854937*^9}, {
   3.827823380492181*^9, 3.827823433869954*^9}, 3.8278234799764967`*^9, 
   3.827866836517818*^9, 3.8278671374890947`*^9, 3.830143467312953*^9, 
   3.836211064365761*^9, 3.839372915026198*^9, 3.839714355084741*^9, {
   3.849256569952425*^9, 3.8492565726470118`*^9}, 3.8492569666657877`*^9, 
   3.849257072147002*^9, 3.851810189393759*^9, 3.852574756653906*^9, {
   3.8525749116501017`*^9, 3.852574922271356*^9}, 3.869387944419712*^9, 
   3.885076218062304*^9},
 CellLabel->"Out[126]=",
 CellID->1583044586,ExpressionUUID->"ded39a1e-9b26-4573-93c3-4645d6993e3c"]
}, Open  ]],

Cell["\<\
To check if it indeed implements the CZ gate, take a look at the matrix \
representation of the quantum circuit model.\
\>", "Text",
 CellChangeTimes->{{3.827867156624036*^9, 3.8278671986516438`*^9}, {
  3.85257476230792*^9, 3.852574764718073*^9}},
 CellID->535686806,ExpressionUUID->"d587331a-e908-4850-b6f3-d78693de12df"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", "qc", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.827822703648591*^9, 3.827822724814498*^9}, {
  3.827823391416233*^9, 3.8278233937892847`*^9}},
 CellLabel->"In[127]:=",
 CellID->851721286,ExpressionUUID->"951a3b0a-5f82-48be-96e4-4c6525b53251"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "1"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {2}, {3}, {4}}}, {1, 1, 0, 0, 
      1, -1}}]]]]], "Output",
 CellChangeTimes->{{3.82782271321039*^9, 3.827822725085293*^9}, 
   3.827822761324458*^9, {3.827823193638101*^9, 3.827823218195565*^9}, {
   3.827823381221888*^9, 3.827823396375064*^9}, {3.8278234270971746`*^9, 
   3.827823434568808*^9}, 3.827823480650531*^9, 3.830143469333046*^9, 
   3.836211065842918*^9, 3.839372918783516*^9, 3.839714356863473*^9, 
   3.849256982131497*^9, {3.84925706923411*^9, 3.849257073779325*^9}, 
   3.8518101894055977`*^9, 3.852574768915516*^9, 3.8525749238478193`*^9, 
   3.869387946208036*^9, 3.885076219848949*^9},
 CellLabel->"Out[127]//MatrixForm=",
 CellID->680315088,ExpressionUUID->"971d2c5b-9997-4a10-9a8d-94411029c15d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Controlled-Unitary Gates", "Subsection",
 CellChangeTimes->{{3.819078292334853*^9, 3.819078296744832*^9}, {
  3.852657537673108*^9, 3.8526575398960333`*^9}},
 CellTags->"Section33",
 CellID->1934269812,ExpressionUUID->"941e53f5-576d-431a-98f9-9e5c9eae5948"],

Cell[CellGroupData[{

Cell[TextData[{
 "Consider a single-qubit rotation acting on the qubit ",
 StyleBox["S[2,$]", "Input"],
 ". It is a rotation around the y-axis by angle \[Phi]."
}], "MathCaption",
 CellChangeTimes->{{3.82574466152496*^9, 3.825744693529607*^9}, {
   3.825744807385701*^9, 3.825744820738614*^9}, 
   3.885076095041732*^9},ExpressionUUID->"ed065515-4cdf-4145-841b-\
4599eca48efe"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Phi]", ",", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "2"}], "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"U", "//", "Elaborate"}], "//", "Matrix"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.825744710403491*^9, 3.8257447130143557`*^9}, {
  3.825744743623795*^9, 3.825744768508255*^9}, {3.839714438643464*^9, 
  3.8397144621822433`*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"f2d04065-a079-42c4-8e45-c96527d55c67"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}], "2"]}]]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}], "2"]]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}], "2"]}]]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}], "2"]]}]}]},
     {
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}], "2"]}]]}], "-", 
       RowBox[{
        FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}], "2"]]}]}], 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}], "2"]}]]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}], "2"]]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {2}, {1}}}, {
      Rational[1, 2] E^(Complex[0, Rational[-1, 2]] $CellContext`\[Phi]) + 
       Rational[1, 2] E^(Complex[0, Rational[1, 2]] $CellContext`\[Phi]), 
       Complex[0, Rational[-1, 2]] 
        E^(Complex[0, Rational[-1, 2]] $CellContext`\[Phi]) + 
       Complex[0, Rational[1, 2]] 
        E^(Complex[0, Rational[1, 2]] $CellContext`\[Phi]), 
       Rational[1, 2] E^(Complex[0, Rational[-1, 2]] $CellContext`\[Phi]) + 
       Rational[1, 2] E^(Complex[0, Rational[1, 2]] $CellContext`\[Phi]), 
       Complex[0, Rational[1, 2]] 
        E^(Complex[0, Rational[-1, 2]] $CellContext`\[Phi]) + 
       Complex[0, Rational[-1, 2]] 
        E^(Complex[0, Rational[1, 2]] $CellContext`\[Phi])}}]]]]], "Output",
 CellChangeTimes->{{3.825744724828266*^9, 3.825744773186768*^9}, {
   3.825744822369238*^9, 3.825744826002254*^9}, 3.8257449670616903`*^9, 
   3.826326668383418*^9, 3.826329716913817*^9, 3.8263336598541307`*^9, 
   3.826851558516809*^9, 3.826852467369998*^9, 3.830143471334269*^9, 
   3.8362110674891863`*^9, 3.8393729203771687`*^9, 3.839714358618279*^9, 
   3.8397144646109858`*^9, 3.849257075590164*^9, 3.851810189409711*^9, 
   3.852657618840207*^9, 3.869387948418078*^9, 3.885076222043748*^9},
 CellLabel->"Out[130]//MatrixForm=",
 CellID->2039980724,ExpressionUUID->"599fed57-41fd-41bf-8ea6-8a0293714283"]
}, Open  ]],

Cell["\<\
This is a quantum circuit featuring the controlled-unitary gate.\
\>", "Text",
 CellChangeTimes->{{3.819685711167118*^9, 3.819685732934691*^9}, {
  3.82574523871229*^9, 3.825745246585534*^9}, {3.852657596695716*^9, 
  3.852657612966797*^9}},ExpressionUUID->"31bdb47d-0746-4087-a416-\
776c5028e602"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", "U"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.819685742858782*^9, 3.819685848589415*^9}, {
   3.8238409178713093`*^9, 3.8238409209415903`*^9}, {3.825744704893298*^9, 
   3.8257447306989937`*^9}, 3.826326676488312*^9, 3.829808799633545*^9},
 CellLabel->
  "In[131]:=",ExpressionUUID->"618f59e3-3c1a-4b9b-b7d9-ad0eedfd9fbf"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`ControlledU[{
      $CellContext`S[1, Q3`$]} -> {1}, 
    Q3`Rotation[$CellContext`\[Phi], 
     $CellContext`S[2, 2], "Label" -> "U"]]]]], "Output",
 CellChangeTimes->{
  3.825744731642995*^9, {3.8257448274859447`*^9, 3.825744849404435*^9}, 
   3.8257449689751587`*^9, 3.825745250303031*^9, {3.826326670548538*^9, 
   3.826326676906917*^9}, 3.826329716945243*^9, 3.8263336598862658`*^9, 
   3.826851560136516*^9, 3.826851705209565*^9, 3.826852468576812*^9, 
   3.8301434728660593`*^9, 3.836211068840753*^9, 3.839372921569737*^9, 
   3.839714359938554*^9, 3.839714467253323*^9, 3.849257077026334*^9, 
   3.851810189420929*^9, {3.852657615646332*^9, 3.852657620776264*^9}, 
   3.869387949912036*^9, 3.885076223466631*^9},
 CellLabel->"Out[131]=",
 CellID->1694729521,ExpressionUUID->"5086567c-73e5-4d10-8835-795436bcb21c"]
}, Open  ]],

Cell["\<\
This is the explicit expression of the controlled-U gate operation in terms \
of the Pauli operators.\
\>", "Text",
 CellChangeTimes->{{3.8268515730329323`*^9, 
  3.826851612235003*^9}},ExpressionUUID->"cdf8bb19-d46b-47ff-b13d-\
68a35c9013cf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"Elaborate", "[", "qc", "]"}]}]], "Input",
 CellChangeTimes->{{3.819685742858782*^9, 3.819685848589415*^9}, {
  3.8238409178713093`*^9, 3.8238409209415903`*^9}, {3.825744704893298*^9, 
  3.8257447306989937`*^9}, {3.826851568396701*^9, 3.8268515692735767`*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"660d6695-82f7-4a57-bb33-05d6e30434e2"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"Cos", "[", 
    FractionBox["\[Phi]", "4"], "]"}], "2"], "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[1, 3]], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Phi]", "4"], "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 2]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 2]]], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"2"}, "RowDefault"], 
      TemplateBox[{"\"y\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[2, 2]], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.819685794673809*^9, 3.819685850174438*^9}, 
   3.8198046412440233`*^9, 3.8228059787977*^9, 3.823840921769371*^9, {
   3.825744727076703*^9, 3.825744735597048*^9}, {3.825744828526429*^9, 
   3.825744850083908*^9}, {3.8257449698051777`*^9, 3.825744971988696*^9}, 
   3.8263266783474092`*^9, 3.826329716955696*^9, 3.826333659915946*^9, 
   3.8268515696514463`*^9, 3.826851613934105*^9, 3.8268517067412453`*^9, 
   3.826852470426242*^9, 3.83014347414594*^9, 3.836211070443843*^9, 
   3.839372922654812*^9, 3.839714361370529*^9, 3.8397144686194353`*^9, 
   3.849257078409536*^9, 3.8518101894303017`*^9, 3.852657634267975*^9, 
   3.869387951362685*^9, 3.8850762249271593`*^9},
 CellLabel->"Out[132]=",
 CellID->1031873099,ExpressionUUID->"1b3dd1ee-0706-4ec8-be07-4d62dbcdd202"]
}, Open  ]],

Cell["\<\
The controlled-U gate maps the logical basis states as follows.\
\>", "Text",
 CellChangeTimes->{{3.826851617131159*^9, 3.8268516291094017`*^9}, {
  3.8268517124909277`*^9, 3.826851737002956*^9}, {3.8533169618377953`*^9, 
  3.853316962862978*^9}},ExpressionUUID->"904720f4-31cd-498b-8988-\
8befba294ccb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"in", "->", "out"}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.8268517413247223`*^9, 3.826851773676296*^9}, {
  3.853316900524519*^9, 3.8533169281777277`*^9}},
 CellLabel->"In[133]:=",
 CellID->1390317228,ExpressionUUID->"155d0ca2-5755-460d-ba24-df161d390819"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            0|>]]}], "+", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            1|>]], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            1|>]]}], "-", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            0|>]], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8268529462539873`*^9, 3.826852951607411*^9}, 
   3.830143477175064*^9, 3.836211073315414*^9, 3.839372924925329*^9, 
   3.839714364105665*^9, 3.839714471946184*^9, 3.849257081132345*^9, 
   3.8518101894682703`*^9, 3.8526576442129583`*^9, 3.853316984671373*^9, 
   3.869387952708268*^9, 3.885076226459646*^9},
 CellLabel->"Out[135]//TableForm=",
 CellID->923818888,ExpressionUUID->"d05285f7-e61b-4311-9348-4f7ba062fc0d"]
}, Open  ]],

Cell[TextData[{
 "Let us take a look at the mapping more closely. When the first qubit is set \
to ",
 StyleBox["Ket[0]", "Input"],
 ", it does nothing."
}], "Text",
 CellChangeTimes->{{3.819686288621647*^9, 3.819686303436763*^9}, {
  3.8268519168597116`*^9, 
  3.826851934206089*^9}},ExpressionUUID->"187be339-214b-4b10-a40f-\
396c310d8b6a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Ket", "[", "]"}], 
     RowBox[{"c", "[", "0", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{
       RowBox[{"S", "[", "2", "]"}], "\[Rule]", "1"}], "]"}], 
     RowBox[{"c", "[", "2", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"vec", ",", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.819686169064335*^9, 3.819686233701758*^9}, {
   3.819686265100257*^9, 3.819686278991638*^9}, {3.8196863713723927`*^9, 
   3.819686372114259*^9}, 3.8238409433970222`*^9},
 CellLabel->
  "In[136]:=",ExpressionUUID->"a6d7a75a-e2d6-489c-a4d0-67f6217085f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"c"},
      "RowDefault"], 
     TemplateBox[{"0"},
      "RowDefault"]],
    $CellContext`c[0]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]]}], 
  "+", 
  RowBox[{
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"c"},
      "RowDefault"], 
     TemplateBox[{"2"},
      "RowDefault"]],
    $CellContext`c[2]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1|>]]}]}]], "Output",
 CellChangeTimes->{
  3.823840944704646*^9, {3.825744832774898*^9, 3.8257448514486237`*^9}, 
   3.825744931727421*^9, 3.825744974420405*^9, 3.826326679685437*^9, 
   3.8263297169886713`*^9, 3.8263336599236813`*^9, 3.826851935837915*^9, 
   3.830143478437397*^9, 3.83621107502586*^9, 3.839372926168128*^9, 
   3.839714366162586*^9, 3.839714473461734*^9, 3.8492570824731913`*^9, 
   3.851810189481352*^9, 3.8526576463550653`*^9, 3.869387954200347*^9, 
   3.885076228499812*^9},
 CellLabel->"Out[138]=",
 CellID->1658655806,ExpressionUUID->"652fba08-2e3f-4aaf-b736-08fd5277ebc2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"op", "**", "vec"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"new", ",", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.819686169064335*^9, 3.819686233701758*^9}, {
   3.819686265100257*^9, 3.819686278991638*^9}, {3.8196863713723927`*^9, 
   3.819686372114259*^9}, 3.8238409433970222`*^9},
 CellLabel->
  "In[139]:=",ExpressionUUID->"0b820882-78fc-4249-8fde-f20dd24dcf7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"c"},
      "RowDefault"], 
     TemplateBox[{"0"},
      "RowDefault"]],
    $CellContext`c[0]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]]}], 
  "+", 
  RowBox[{
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"c"},
      "RowDefault"], 
     TemplateBox[{"2"},
      "RowDefault"]],
    $CellContext`c[2]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1|>]]}]}]], "Output",
 CellChangeTimes->{{3.819686211915139*^9, 3.819686236702231*^9}, {
   3.819686279501033*^9, 3.819686305464808*^9}, 3.819686372500503*^9, 
   3.8198046429066267`*^9, 3.822805980485939*^9, 3.823840945741871*^9, {
   3.825744833975176*^9, 3.825744852314356*^9}, 3.825744934369197*^9, 
   3.825744975522642*^9, 3.826326680653057*^9, 3.8263297170228777`*^9, 
   3.8263336599564247`*^9, 3.83014347975751*^9, 3.83621107595185*^9, 
   3.839372927212337*^9, 3.839714367551077*^9, 3.839714474919903*^9, 
   3.849257083358506*^9, 3.851810189494584*^9, 3.852657648531209*^9, 
   3.869387955544797*^9, 3.885076230368092*^9},
 CellLabel->"Out[140]=",
 CellID->1246130843,ExpressionUUID->"ae33ec12-934e-4d30-921b-078f85a32a38"]
}, Open  ]],

Cell[TextData[{
 "When the control qubit -- the first qubit in this case -- is set to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"1"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "1379f106-f2ec-4c1f-9192-9378621c03b2"],
 ", it operates the unitary operator on the second qubit."
}], "Text",
 CellChangeTimes->{{3.8196863102877283`*^9, 3.8196863290513906`*^9}, {
  3.823841259743166*^9, 3.823841270024321*^9}, {3.8526576659056673`*^9, 
  3.852657678576626*^9}},ExpressionUUID->"f8067e5d-6583-436c-b66a-\
29dc78d3c907"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], "\[Rule]", "1"}], "]"}], "**", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Ket", "[", "]"}], 
       RowBox[{"c", "[", "0", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Ket", "[", 
        RowBox[{
         RowBox[{"S", "[", "2", "]"}], "\[Rule]", "1"}], "]"}], 
       RowBox[{"c", "[", "2", "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"vec", ",", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.819686169064335*^9, 3.819686233701758*^9}, {
  3.819686265100257*^9, 3.819686278991638*^9}, {3.819686341437636*^9, 
  3.819686366039714*^9}, {3.823840957716393*^9, 3.8238409613270187`*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"3a303710-2874-4579-94c7-3d7040ed3d00"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"c"},
      "RowDefault"], 
     TemplateBox[{"0"},
      "RowDefault"]],
    $CellContext`c[0]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]]}], 
  "+", 
  RowBox[{
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"c"},
      "RowDefault"], 
     TemplateBox[{"2"},
      "RowDefault"]],
    $CellContext`c[2]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1|>]]}]}]], "Output",
 CellChangeTimes->{
  3.8238409621993437`*^9, {3.825744841728447*^9, 3.825744853654954*^9}, 
   3.8257449358765373`*^9, 3.825744976624728*^9, 3.8263266822296553`*^9, 
   3.826329717056851*^9, 3.826333659989854*^9, 3.8301434810632973`*^9, 
   3.836211078156011*^9, 3.83937292907635*^9, 3.83971436914609*^9, 
   3.8397144765340223`*^9, 3.8492570849743357`*^9, 3.8518101895004177`*^9, 
   3.852657661414888*^9, 3.869387956979587*^9, 3.885076231972666*^9},
 CellLabel->"Out[142]=",
 CellID->246294671,ExpressionUUID->"ae698ae3-406b-4592-9634-389307020743"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"op", "**", "vec"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"new", ",", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.819686169064335*^9, 3.819686233701758*^9}, {
   3.819686265100257*^9, 3.819686278991638*^9}, {3.819686341437636*^9, 
   3.819686366039714*^9}, 3.823840957716393*^9},
 CellLabel->
  "In[143]:=",ExpressionUUID->"4925dc93-e7a5-47a4-9644-ce18d2637c36"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 1|>]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"c"},
         "RowDefault"], 
        TemplateBox[{"2"},
         "RowDefault"]],
       $CellContext`c[2]], " ", 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}], "+", 
     RowBox[{
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"c"},
         "RowDefault"], 
        TemplateBox[{"0"},
         "RowDefault"]],
       $CellContext`c[0]], " ", 
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"c"},
         "RowDefault"], 
        TemplateBox[{"0"},
         "RowDefault"]],
       $CellContext`c[0]], " ", 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}], "-", 
     RowBox[{
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"c"},
         "RowDefault"], 
        TemplateBox[{"2"},
         "RowDefault"]],
       $CellContext`c[2]], " ", 
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.8196863491544447`*^9, 3.819686374014414*^9}, 
   3.819804644517398*^9, 3.822805982189055*^9, 3.823840963308662*^9, {
   3.8257448428123293`*^9, 3.825744854601082*^9}, 3.8257449405036087`*^9, 
   3.825744977864459*^9, 3.82632668303869*^9, 3.826329717090819*^9, 
   3.8263336600240173`*^9, 3.830143482037012*^9, 3.8362110793544893`*^9, 
   3.839372930128879*^9, 3.839714370127563*^9, 3.839714477979617*^9, 
   3.8492570858634*^9, 3.851810189515974*^9, 3.8693879579661818`*^9, 
   3.88507623288373*^9},
 CellLabel->"Out[144]=",
 CellID->983567073,ExpressionUUID->"5c33c438-34aa-44c4-8491-238f58b83649"]
}, Open  ]],

Cell["\<\
When the control qubit  is in a superposition, the resulting state is an \
entangled state in general.\
\>", "Text",
 CellChangeTimes->{{3.8196864014866133`*^9, 3.81968643368189*^9}, {
   3.8238412244091473`*^9, 3.823841247997426*^9}, 
   3.823841279642276*^9},ExpressionUUID->"06bc5fd9-b738-421f-9fef-\
fe5ac09b0b15"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], "+", 
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], "\[Rule]", "1"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"vec", ",", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.819685964539612*^9, 3.819685999726454*^9}, {
   3.819686380034342*^9, 3.819686391477515*^9}, 3.823840971013805*^9},
 CellLabel->
  "In[145]:=",ExpressionUUID->"332b5ad0-5897-4d08-8551-5cef7935e2db"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]], 
         $CellContext`S[1, Q3`$]]], 
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]], 
         $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
    "Ket"],
   Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], "+", 
  
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{
       SubscriptBox["1", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]], 
         $CellContext`S[1, Q3`$]]], 
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]], 
         $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
    "Ket"],
   Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
     0|>]]}]], "Output",
 CellChangeTimes->{3.8238409722354927`*^9, 3.825744948204419*^9, 
  3.825744982840343*^9, 3.826326684902014*^9, 3.826329717099327*^9, 
  3.82633366003327*^9, 3.830143483267438*^9, 3.836211080879525*^9, 
  3.839372931326344*^9, 3.839714371948717*^9, 3.839714481087964*^9, 
  3.8492570870806513`*^9, 3.851810189521819*^9, 3.8693879592383738`*^9, 
  3.885076234199337*^9},
 CellLabel->"Out[146]=",
 CellID->1263014060,ExpressionUUID->"c611e751-f8ae-4ad8-a1f7-590386b2dcc2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"op", "**", "vec"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{"new", ",", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.819685964539612*^9, 3.819685999726454*^9}, {
   3.819686380034342*^9, 3.819686391477515*^9}, 3.823840971013805*^9},
 CellLabel->
  "In[147]:=",ExpressionUUID->"4ae5b871-9dd2-4f67-93ec-97aac51c803e"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]], 
         $CellContext`S[1, Q3`$]]], 
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]], 
         $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
    "Ket"],
   Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], "+", 
  
  RowBox[{
   RowBox[{"Cos", "[", 
    FractionBox["\[Phi]", "2"], "]"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]]}], 
  "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 1|>]], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.819685971534192*^9, 3.81968600185812*^9}, 
   3.819686155339982*^9, {3.81968638092448*^9, 3.819686392593672*^9}, 
   3.819686434923162*^9, 3.8198046462056704`*^9, 3.822805983611433*^9, {
   3.823840973267241*^9, 3.823840976068223*^9}, 3.825744983845606*^9, 
   3.8263266858045483`*^9, 3.826329717132237*^9, 3.826333660065692*^9, 
   3.830143484310894*^9, 3.836211081815125*^9, 3.839372932414774*^9, 
   3.839714373478971*^9, 3.839714482032749*^9, 3.849257087826687*^9, 
   3.85181018953443*^9, 3.869387960180769*^9, 3.88507623520172*^9},
 CellLabel->"Out[148]=",
 CellID->1559502523,ExpressionUUID->"9541118f-c59f-4029-9bce-1bca4d87ae09"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
When the target qubit is set to an eigenstate of the unitary operator, it \
does not change but the control qubit acquires the phase factor given by the \
eigenvalue of the target state.\
\>", "MathCaption",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.819686469916267*^9, 
  3.819686526826673*^9}},ExpressionUUID->"481387f5-bfa4-4280-b916-\
1fae2b5f50e8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], "+", 
      RowBox[{"Ket", "[", 
       RowBox[{
        RowBox[{"S", "[", "1", "]"}], "\[Rule]", "1"}], "]"}]}], ")"}], "**", 
    
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Ket", "[", "]"}], "-", 
      RowBox[{"I", " ", 
       RowBox[{"Ket", "[", 
        RowBox[{
         RowBox[{"S", "[", "2", "]"}], "\[Rule]", "1"}], "]"}]}]}], ")"}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{
   RowBox[{"KetFactor", "@", "vec"}], ",", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.819685964539612*^9, 3.819685999726454*^9}, {
   3.819686380034342*^9, 3.819686391477515*^9}, {3.819686551104377*^9, 
   3.819686626181493*^9}, 3.823841018261426*^9, 3.8397142407748833`*^9},
 CellLabel->
  "In[149]:=",ExpressionUUID->"3fdcd847-482f-42dd-9b95-76e08359d6dc"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           SubscriptBox["0", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]], 
             $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
        "Ket"],
       Ket[<|$CellContext`S[1, Q3`$] -> 0|>]], "+", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           SubscriptBox["1", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]], 
             $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
        "Ket"],
       Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}], ")"}], "\[CircleTimes]", 
    RowBox[{"(", 
     RowBox[{
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           SubscriptBox["0", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]], 
             $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
        "Ket"],
       Ket[<|$CellContext`S[2, Q3`$] -> 0|>]], "-", 
      RowBox[{"\[ImaginaryI]", " ", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[2, Q3`$] -> 1|>]]}]}], ")"}]}],
   HoldForm],
  Q3`OTimes[
  Ket[<|$CellContext`S[1, Q3`$] -> 0|>] + 
   Ket[<|$CellContext`S[1, Q3`$] -> 1|>], 
   Ket[<|$CellContext`S[2, Q3`$] -> 0|>] + 
   Complex[0, -1] Ket[<|$CellContext`S[2, Q3`$] -> 1|>]]]], "Output",
 CellChangeTimes->{
  3.8238410193097143`*^9, 3.8257449860135403`*^9, 3.826326687273068*^9, 
   3.826329717141816*^9, 3.8263336600758467`*^9, {3.826852983433042*^9, 
   3.826852987906858*^9}, 3.830143485677826*^9, 3.8362110832622213`*^9, 
   3.839372933778996*^9, 3.839714376193812*^9, 3.839714483768676*^9, 
   3.84925708931056*^9, 3.85181018956782*^9, 3.8693879615921717`*^9, 
   3.885076236759633*^9},
 CellLabel->"Out[150]=",
 CellID->904471441,ExpressionUUID->"9950da79-f317-46b3-867b-3dea49225e77"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{"op", "**", "vec"}], "//", "TrigToExp"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogicalForm", "[", 
  RowBox[{
   RowBox[{"KetFactor", "@", "new"}], ",", 
   RowBox[{"S", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.819685964539612*^9, 3.819685999726454*^9}, {
   3.819686380034342*^9, 3.819686391477515*^9}, {3.819686551104377*^9, 
   3.819686626181493*^9}, 3.823841018261426*^9, 3.8397142407828074`*^9},
 CellLabel->
  "In[151]:=",ExpressionUUID->"f3b93758-21b9-4bc7-9e30-8860026bcc1f"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           SubscriptBox["0", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"]], 
             $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
        "Ket"],
       Ket[<|$CellContext`S[1, Q3`$] -> 0|>]], "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}], "2"]], " ", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}]}], ")"}], "\[CircleTimes]", 
    RowBox[{"(", 
     RowBox[{
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           SubscriptBox["0", 
            InterpretationBox[
             SubscriptBox[
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"]], 
             $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
        "Ket"],
       Ket[<|$CellContext`S[2, Q3`$] -> 0|>]], "-", 
      RowBox[{"\[ImaginaryI]", " ", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[2, Q3`$] -> 1|>]]}]}], ")"}]}],
   HoldForm],
  Q3`OTimes[Ket[<|$CellContext`S[1, Q3`$] -> 0|>] + E^(Complex[0, 
        Rational[1, 2]] $CellContext`\[Phi]) 
    Ket[<|$CellContext`S[1, Q3`$] -> 1|>], 
   Ket[<|$CellContext`S[2, Q3`$] -> 0|>] + 
   Complex[0, -1] Ket[<|$CellContext`S[2, Q3`$] -> 1|>]]]], "Output",
 CellChangeTimes->{{3.819686569961321*^9, 3.819686629010851*^9}, 
   3.819804647609193*^9, 3.822805984986657*^9, 3.8238410202677298`*^9, 
   3.826326688059381*^9, 3.826329717176374*^9, 3.826333660109283*^9, {
   3.826852984730812*^9, 3.82685298887993*^9}, 3.8301434866648808`*^9, 
   3.83621108460916*^9, 3.839372934597455*^9, 3.839714377692445*^9, 
   3.839714485454255*^9, 3.849257090091502*^9, 3.851810189583335*^9, 
   3.869387962425838*^9, 3.885076237612535*^9},
 CellLabel->"Out[152]=",
 CellID->2018148880,ExpressionUUID->"096337c3-45ba-4d39-abf2-4467de990d85"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
This shows  a quantum circuit model conditionally operating the logic gate U \
on the target qubit.\
\>", "MathCaption",
 CellChangeTimes->{{3.8268408551662283`*^9, 
  3.826840986434533*^9}},ExpressionUUID->"c362a021-84c0-4e78-a7fb-\
d865e5969ee1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{"S", "[", "j", "]"}], ",", 
       RowBox[{"S", "[", "$n", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"$n", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Phi]", ",", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{"$n", "+", "1"}], ",", "2"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cU", "=", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "[", "$n", "]"}], ",", "op"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Sequence", "@@", 
    RowBox[{"Flatten", "@", 
     RowBox[{"{", 
      RowBox[{"cc", ",", "cU", ",", 
       RowBox[{"Reverse", "@", "cc"}]}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.826840987721879*^9, 3.826841104291629*^9}, {
   3.8268411528335533`*^9, 3.8268412435377083`*^9}, {3.82684217097578*^9, 
   3.826842248833414*^9}, 3.829808799709873*^9},
 CellLabel->
  "In[153]:=",ExpressionUUID->"efef6c29-73a7-4d71-91a4-071ed184d62f"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}, {{
     0, -4}, {6, -4}}}], {LineBox[{{1, -1}, {1, -3}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
         1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -3}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
         2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
     LineBox[{{3, -3}, {3, -4}}], DiskBox[{3, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, 
     LineBox[{{2.6, -4.4}, {3.4, -4.4}, {3.4, -3.6}, {2.6, -3.6}, {
      2.6, -4.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{4, -2}, {4, -3}}], 
     DiskBox[{4, -2}, 0.09], {CircleBox[{4, -3}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -3}, {4.266666666666667, -3}}, {{
         4, -3.2666666666666666`}, {4, -2.7333333333333334`}}}]}}, {
     LineBox[{{5, -1}, {5, -3}}], 
     DiskBox[{5, -1}, 0.09], {CircleBox[{5, -3}, 0.26666666666666666], 
      LineBox[{{{4.733333333333333, -3}, {5.266666666666667, -3}}, {{
         5, -3.2666666666666666`}, {5, -2.7333333333333334`}}}]}}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->262.8,
   PlotRange->NCache[{Full, {
       Rational[-9, 2], 
       Rational[-1, 2]}}, {Full, {-4.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[3, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[3, Q3`$]}], 
   Q3`ControlledU[{
      $CellContext`S[3, Q3`$]} -> {1}, 
    Q3`Rotation[$CellContext`\[Phi], 
     $CellContext`S[4, 2]]], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[3, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[3, Q3`$]}]]]], "Output",
 CellChangeTimes->{
  3.8268411053570642`*^9, 3.826841147035235*^9, {3.826841188758971*^9, 
   3.826841250228869*^9}, {3.826841761820486*^9, 3.826841787773176*^9}, 
   3.8268418994326553`*^9, {3.8268422508996964`*^9, 3.826842253827441*^9}, 
   3.826842285359816*^9, 3.826860626081128*^9, 3.826860675119499*^9, 
   3.830143505022807*^9, 3.8362113480888844`*^9, 3.839372936068062*^9, 
   3.839714402673987*^9, 3.839714487771278*^9, 3.849257091406752*^9, 
   3.851810189592761*^9, 3.8693879636993856`*^9, 3.8850762390098677`*^9},
 CellLabel->"Out[157]=",
 CellID->1346868080,ExpressionUUID->"c235847b-323f-4a65-a540-d31ae9ea6948"]
}, Open  ]],

Cell[TextData[{
 "This shows how the above quantum circuit model maps the logical basis \
states. It affects the target qubit only when ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["c", "1"], "\[CirclePlus]", 
     SubscriptBox["c", "2"], "\[CirclePlus]", 
     SubscriptBox["c", "3"]}], "=", "1"}], TraditionalForm]],ExpressionUUID->
  "be8c940c-5984-4da0-ae41-2bcdbb61304b"],
 "."
}], "Text",
 CellChangeTimes->{{3.8268417933006268`*^9, 
  3.826841859174329*^9}},ExpressionUUID->"ff179d55-0027-4dc8-a7f8-\
c66f69c6b822"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ss", "=", 
   RowBox[{"S", "[", 
    RowBox[{
     RowBox[{"Range", "[", "$n", "]"}], ",", "$"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"Range", "[", 
      RowBox[{"$n", "+", "1"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"Elaborate", "[", "qc", "]"}], "**", "bs"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"KetFactor", "[", 
      RowBox[{"#", ",", "ss"}], "]"}], "&"}], "/@", "out"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tbl", "=", 
   RowBox[{
    RowBox[{"Thread", "[", 
     RowBox[{"bs", "\[Rule]", "new"}], "]"}], "//", "LogicalForm"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tbl", "[", 
   RowBox[{"[", 
    RowBox[{";;", "5"}], "]"}], "]"}], "//", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.826841252878355*^9, 3.8268413146564217`*^9}, {
   3.826841430627284*^9, 3.8268417222464733`*^9}, {3.8268606364251432`*^9, 
   3.826860657742017*^9}, {3.839372970159017*^9, 3.8393729788290043`*^9}, 
   3.839714240794196*^9, 3.885076095941103*^9},
 CellLabel->
  "In[158]:=",ExpressionUUID->"f576b64f-6c45-4bb0-8b47-651826179a18"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        RowBox[{
         TagBox[
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{
               SubscriptBox["0", 
                InterpretationBox[
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"1"}, "RowDefault"]], 
                 $CellContext`S[1, Q3`$]]], 
               SubscriptBox["0", 
                InterpretationBox[
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"2"}, "RowDefault"]], 
                 $CellContext`S[2, Q3`$]]], 
               SubscriptBox["0", 
                InterpretationBox[
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"3"}, "RowDefault"]], 
                 $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
             0, $CellContext`S[3, Q3`$] -> 0|>]],
          HoldForm], "\[CircleTimes]", 
         TagBox[
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{
               SubscriptBox["0", 
                InterpretationBox[
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"4"}, "RowDefault"]], 
                 $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
            "Ket"],
           Ket[<|$CellContext`S[4, Q3`$] -> 0|>]],
          HoldForm]}],
        Q3`OSlash[
         Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
           0, $CellContext`S[3, Q3`$] -> 0|>], 
         Ket[<|$CellContext`S[4, Q3`$] -> 0|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        RowBox[{
         TagBox[
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{
               SubscriptBox["0", 
                InterpretationBox[
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"1"}, "RowDefault"]], 
                 $CellContext`S[1, Q3`$]]], 
               SubscriptBox["0", 
                InterpretationBox[
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"2"}, "RowDefault"]], 
                 $CellContext`S[2, Q3`$]]], 
               SubscriptBox["0", 
                InterpretationBox[
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"3"}, "RowDefault"]], 
                 $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
             0, $CellContext`S[3, Q3`$] -> 0|>]],
          HoldForm], "\[CircleTimes]", 
         TagBox[
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{
               SubscriptBox["1", 
                InterpretationBox[
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"4"}, "RowDefault"]], 
                 $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
            "Ket"],
           Ket[<|$CellContext`S[4, Q3`$] -> 1|>]],
          HoldForm]}],
        Q3`OSlash[
         Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
           0, $CellContext`S[3, Q3`$] -> 0|>], 
         Ket[<|$CellContext`S[4, Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        RowBox[{
         TagBox[
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{
               SubscriptBox["0", 
                InterpretationBox[
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"1"}, "RowDefault"]], 
                 $CellContext`S[1, Q3`$]]], 
               SubscriptBox["0", 
                InterpretationBox[
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"2"}, "RowDefault"]], 
                 $CellContext`S[2, Q3`$]]], 
               SubscriptBox["1", 
                InterpretationBox[
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"3"}, "RowDefault"]], 
                 $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
             0, $CellContext`S[3, Q3`$] -> 1|>]],
          HoldForm], "\[CircleTimes]", 
         RowBox[{"(", 
          TagBox[
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", 
              FractionBox["\[Phi]", "2"], "]"}], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{
                  SubscriptBox["0", 
                   InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"4"}, "RowDefault"]], 
                    $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
               "Ket"],
              Ket[<|$CellContext`S[4, Q3`$] -> 0|>]]}], "+", 
            RowBox[{
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{
                  SubscriptBox["1", 
                   InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"4"}, "RowDefault"]], 
                    $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
               "Ket"],
              Ket[<|$CellContext`S[4, Q3`$] -> 1|>]], " ", 
             RowBox[{"Sin", "[", 
              FractionBox["\[Phi]", "2"], "]"}]}]}],
           HoldForm], ")"}]}],
        Q3`OSlash[
         Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
           0, $CellContext`S[3, Q3`$] -> 1|>], 
         Cos[Rational[1, 2] $CellContext`\[Phi]] 
          Ket[<|$CellContext`S[4, Q3`$] -> 0|>] + 
         Ket[<|$CellContext`S[4, Q3`$] -> 1|>] 
          Sin[Rational[1, 2] $CellContext`\[Phi]]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        RowBox[{
         TagBox[
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{
               SubscriptBox["0", 
                InterpretationBox[
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"1"}, "RowDefault"]], 
                 $CellContext`S[1, Q3`$]]], 
               SubscriptBox["0", 
                InterpretationBox[
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"2"}, "RowDefault"]], 
                 $CellContext`S[2, Q3`$]]], 
               SubscriptBox["1", 
                InterpretationBox[
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"3"}, "RowDefault"]], 
                 $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
             0, $CellContext`S[3, Q3`$] -> 1|>]],
          HoldForm], "\[CircleTimes]", 
         RowBox[{"(", 
          TagBox[
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", 
              FractionBox["\[Phi]", "2"], "]"}], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{
                  SubscriptBox["1", 
                   InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"4"}, "RowDefault"]], 
                    $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
               "Ket"],
              Ket[<|$CellContext`S[4, Q3`$] -> 1|>]]}], "-", 
            RowBox[{
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{
                  SubscriptBox["0", 
                   InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"4"}, "RowDefault"]], 
                    $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
               "Ket"],
              Ket[<|$CellContext`S[4, Q3`$] -> 0|>]], " ", 
             RowBox[{"Sin", "[", 
              FractionBox["\[Phi]", "2"], "]"}]}]}],
           HoldForm], ")"}]}],
        Q3`OSlash[
         Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
           0, $CellContext`S[3, Q3`$] -> 1|>], 
         Cos[Rational[1, 2] $CellContext`\[Phi]] 
          Ket[<|$CellContext`S[4, Q3`$] -> 1|>] - 
         Ket[<|$CellContext`S[4, Q3`$] -> 0|>] 
         Sin[Rational[1, 2] $CellContext`\[Phi]]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`S[3, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        RowBox[{
         TagBox[
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{
               SubscriptBox["0", 
                InterpretationBox[
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"1"}, "RowDefault"]], 
                 $CellContext`S[1, Q3`$]]], 
               SubscriptBox["1", 
                InterpretationBox[
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"2"}, "RowDefault"]], 
                 $CellContext`S[2, Q3`$]]], 
               SubscriptBox["0", 
                InterpretationBox[
                 SubscriptBox[
                  TemplateBox[{"S"}, "RowDefault"], 
                  TemplateBox[{"3"}, "RowDefault"]], 
                 $CellContext`S[3, Q3`$]]]}, "RowDefault"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
             1, $CellContext`S[3, Q3`$] -> 0|>]],
          HoldForm], "\[CircleTimes]", 
         RowBox[{"(", 
          TagBox[
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", 
              FractionBox["\[Phi]", "2"], "]"}], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{
                  SubscriptBox["0", 
                   InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"4"}, "RowDefault"]], 
                    $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
               "Ket"],
              Ket[<|$CellContext`S[4, Q3`$] -> 0|>]]}], "+", 
            RowBox[{
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{
                  SubscriptBox["1", 
                   InterpretationBox[
                    SubscriptBox[
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"4"}, "RowDefault"]], 
                    $CellContext`S[4, Q3`$]]]}, "RowDefault"]},
               "Ket"],
              Ket[<|$CellContext`S[4, Q3`$] -> 1|>]], " ", 
             RowBox[{"Sin", "[", 
              FractionBox["\[Phi]", "2"], "]"}]}]}],
           HoldForm], ")"}]}],
        Q3`OSlash[
         Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
           1, $CellContext`S[3, Q3`$] -> 0|>], 
         Cos[Rational[1, 2] $CellContext`\[Phi]] 
          Ket[<|$CellContext`S[4, Q3`$] -> 0|>] + 
         Ket[<|$CellContext`S[4, Q3`$] -> 1|>] 
          Sin[Rational[1, 2] $CellContext`\[Phi]]]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.826841513112661*^9, 3.826841524088832*^9}, {
   3.826841575839479*^9, 3.826841722839685*^9}, {3.8268417588924303`*^9, 
   3.826841763086466*^9}, 3.826841861286623*^9, 3.826841901277749*^9, 
   3.826842298169677*^9, {3.826860658179975*^9, 3.826860686376932*^9}, 
   3.830143508805464*^9, 3.836211349584519*^9, 3.839372937724182*^9, {
   3.839372979455276*^9, 3.8393729818478193`*^9}, 3.839714406060253*^9, 
   3.8397144903799*^9, 3.849257093309164*^9, 3.851810189745491*^9, 
   3.869387965506381*^9, 3.885076241439023*^9},
 CellLabel->"Out[163]//TableForm=",
 CellID->1685298418,ExpressionUUID->"e085a453-fec8-435d-9ccc-8b01bac3526d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Consider a controlled-unitary gate.", "MathCaption",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.822362718029551*^9, 3.822362733565091*^9}, {
  3.822365160937088*^9, 3.8223651683205833`*^9}, {3.846642429501412*^9, 
  3.846642430772275*^9}},ExpressionUUID->"35bb3dee-2c1d-46bb-bd1b-\
b7b7634ab11c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"matU", "=", 
   RowBox[{"RandomUnitary", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"matU", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8223629606711807`*^9, 3.8223630117542343`*^9}, {
   3.822363263775792*^9, 3.822363271898095*^9}, {3.822363577997953*^9, 
   3.822363603400749*^9}, 3.8223638155196657`*^9, 3.822365298686076*^9, 
   3.8238421913272343`*^9},
 CellLabel->
  "In[164]:=",ExpressionUUID->"821935eb-7c47-4517-b0f6-561730b37c4b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "0.35345293329994576`"}], "-", 
       RowBox[{"0.09249501002414132`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.5747058877552363`"}], "-", 
       RowBox[{"0.7322764775969279`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.5716615383334597`"}], "+", 
       RowBox[{"0.734655553747823`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.35306597737521783`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.09396126094185867`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8238421925311127`*^9, 3.823842200435399*^9}, 
   3.826326712378974*^9, 3.8263297178682833`*^9, 3.826333660849297*^9, 
   3.8263337845767107`*^9, 3.8268606787249813`*^9, 3.830143510907897*^9, 
   3.836211351644993*^9, 3.839372940278144*^9, 3.83937298360539*^9, 
   3.839714409696569*^9, 3.839714495642475*^9, 3.8492570965766897`*^9, 
   3.851810189777418*^9, 3.86938796687539*^9, 3.885076243211219*^9},
 CellLabel->"Out[165]//MatrixForm=",
 CellID->235210588,ExpressionUUID->"e722f9cb-0320-4af5-a04d-e8d6c7dc85f7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"opU", "=", 
   RowBox[{"ExpressionFor", "[", 
    RowBox[{"matU", ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", "opU", ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "]"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8223629606711807`*^9, 3.8223630117542343`*^9}, {
   3.822363263775792*^9, 3.822363271898095*^9}, {3.822363577997953*^9, 
   3.822363603400749*^9}, 3.8223638155196657`*^9, 3.822365298686076*^9, 
   3.8238421913272343`*^9, 3.826326719528225*^9, 3.8298087997576647`*^9, 
   3.830143411111491*^9},
 CellLabel->
  "In[166]:=",ExpressionUUID->"3549e6be-0b07-4d3c-abd6-202a9712c3a4"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`ControlledU[{
      $CellContext`S[1, Q3`$]} -> {1}, 
    Complex[-0.00019347796236396375`, -0.09322813548299999] + 
    Complex[-0.3532594553375818, 0.0007331254588586744] $CellContext`S[2, 3] + 
    Complex[-0.5747058877552363, -0.7322764775969279] $CellContext`S[2, 4] + 
    Complex[-0.5716615383334597, 0.734655553747823] $CellContext`S[2, 5], 
    "Label" -> "U"]]]], "Output",
 CellChangeTimes->{{3.822362991967246*^9, 3.822363012164209*^9}, 
   3.8223632726856728`*^9, 3.822363465187922*^9, {3.8223635894807987`*^9, 
   3.822363606190958*^9}, 3.822363764807948*^9, {3.822363808626041*^9, 
   3.822363818074554*^9}, 3.82236529942689*^9, 3.822806018105776*^9, {
   3.8238421946218967`*^9, 3.823842201426117*^9}, {3.8263267136517487`*^9, 
   3.826326719880548*^9}, 3.8263297178754883`*^9, 3.826333660883976*^9, 
   3.826333785813744*^9, 3.8301435126255417`*^9, 3.836211352825336*^9, 
   3.839372948541539*^9, 3.8393729846985483`*^9, 3.839714496941139*^9, 
   3.849257097704506*^9, 3.8518101897822933`*^9, 3.869387968279644*^9, 
   3.8850762444463797`*^9},
 CellLabel->"Out[167]=",
 CellID->384081575,ExpressionUUID->"fb816d26-352a-44ea-8919-a699f4e11717"]
}, Open  ]],

Cell["\<\
For the decomposition, first find the Euler angles of the unitary operator.\
\>", "Text",
 CellChangeTimes->{{3.822363832730496*^9, 
  3.8223638495261297`*^9}},ExpressionUUID->"0350c74e-1d9e-4fab-997d-\
23bbaf569e0d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"detU", "=", 
   RowBox[{"Det", "[", "matU", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vphi", "=", 
   RowBox[{
    RowBox[{"Arg", "[", "detU", "]"}], "/", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", 
  RowBox[{"TheEulerAngles", "[", 
   RowBox[{"matU", "/", 
    RowBox[{"Sqrt", "[", "detU", "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.822363013758445*^9, 3.8223630913135023`*^9}, {
  3.822363140251796*^9, 3.822363141803712*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"397e4dc8-2900-4e45-a8d9-fe5be97cd6e3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.1654804947263422`"}], ",", "2.3935642965989707`", ",", 
   RowBox[{"-", "2.4921631127142625`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.822363020673107*^9, 3.822363023432887*^9}, {
   3.822363076759039*^9, 3.822363102729035*^9}, 3.822363142408297*^9, 
   3.822363466096518*^9, 3.822363607934821*^9, 3.8223637665487347`*^9, 
   3.822363819309134*^9, 3.822363851304463*^9, 3.822365303028857*^9, 
   3.8228060196878443`*^9, 3.823842209355219*^9, 3.8263267216329603`*^9, 
   3.826329717915742*^9, 3.8263336608913*^9, 3.826333787455834*^9, 
   3.8301435140964737`*^9, 3.836211354425901*^9, 3.839372986056649*^9, 
   3.839714498673286*^9, 3.849257099142684*^9, 3.85181018978617*^9, 
   3.86938797019363*^9, 3.8850762459646187`*^9},
 CellLabel->"Out[170]=",
 CellID->2014505593,ExpressionUUID->"405fd83a-f8a9-450d-b161-0eaa4b18b771"]
}, Open  ]],

Cell["From the Euler angles, choose the component operators.", "Text",
 CellChangeTimes->{{3.822363853891197*^9, 
  3.8223638814435587`*^9}},ExpressionUUID->"76f3ffa7-eddf-4476-8949-\
f31fb5836821"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"opA", "=", 
   RowBox[{"EulerRotation", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"b", "/", "2"}], ",", "0"}], "}"}], ",", 
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<A\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opB", "=", 
   RowBox[{"EulerRotation", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"-", "b"}], "/", "2"}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "+", "c"}], ")"}]}], "/", "2"}]}], "}"}], ",", 
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<B\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opC", "=", 
   RowBox[{"EulerRotation", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "-", "c"}], ")"}]}], "/", "2"}]}], "}"}], ",", 
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<C\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opD", "=", 
   RowBox[{"Phase", "[", 
    RowBox[{"vphi", ",", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "3"}], "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "->", "\[Phi]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.822363633272999*^9, 3.822363698900997*^9}, {
  3.82236394151866*^9, 3.8223639584487886`*^9}, {3.822363995596942*^9, 
  3.822364007386593*^9}, {3.885076267357808*^9, 3.885076287727975*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"7468a672-6d94-416a-aa0a-cb58a12e7813"],

Cell["Finally, construct the equivalent quantum circuit model.", "Text",
 CellChangeTimes->{{3.822364017556203*^9, 
  3.8223640316517487`*^9}},ExpressionUUID->"5dc901f5-de25-4fad-8d11-\
2c928700511a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"opC", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "opB", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "opA", ",", "opD"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.822363708972704*^9, 3.822363751292541*^9}, {
   3.822363886933374*^9, 3.8223639231247463`*^9}, {3.822363964040452*^9, 
   3.822363985797476*^9}, 3.829808799761827*^9},
 CellLabel->
  "In[185]:=",ExpressionUUID->"9a61e5ab-8d0f-438a-b10a-136d38176ee4"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {7, -2}}}], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox["\<\"C\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, 
     LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -1.6}, {2.6, -1.6}, {
      2.6, -2.4}}], InsetBox[
      StyleBox["\<\"B\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{4, -1}, {4, -2}}], 
     DiskBox[{4, -1}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
         4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, 
     LineBox[{{4.6, -2.4}, {5.4, -2.4}, {5.4, -1.6}, {4.6, -1.6}, {
      4.6, -2.4}}], InsetBox[
      StyleBox["\<\"A\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {5, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{5.6, -1.4}, {6.4, -0.6}]}, 
     LineBox[{{5.6, -1.4}, {6.4, -1.4}, {6.4, -0.6}, {5.6, -0.6}, {
      5.6, -1.4}}], InsetBox[
      StyleBox["\[Phi]",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {6, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->298.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`EulerRotation[{0, 0, -0.6633413089939602}, 
    $CellContext`S[2, Q3`$], "Label" -> "C"], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`EulerRotation[{0, -1.1967821482994854`, 1.8288218037203023`}, 
    $CellContext`S[2, Q3`$], "Label" -> "B"], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`EulerRotation[{-1.1654804947263422`, 1.1967821482994854`, 0}, 
    $CellContext`S[2, Q3`$], "Label" -> "A"], 
   Q3`Phase[1.568721012474856, 
    $CellContext`S[1, 3], "Label" -> $CellContext`\[Phi]]]]], "Output",
 CellChangeTimes->{{3.8223637518441353`*^9, 3.8223637704147387`*^9}, 
   3.822363820786264*^9, {3.822363923614994*^9, 3.822363926052693*^9}, 
   3.8223639862941732`*^9, 3.822364034410405*^9, 3.8223653056225853`*^9, 
   3.822806022682035*^9, 3.823842224568321*^9, 3.826326726253981*^9, 
   3.82632971796146*^9, 3.826333660965016*^9, 3.8263337907205563`*^9, 
   3.8301435170156507`*^9, 3.836211357414003*^9, 3.839372989790513*^9, 
   3.839714502258507*^9, 3.8492571020739317`*^9, 3.8518101898026648`*^9, 
   3.869387973253031*^9, {3.885076272061037*^9, 3.885076289887087*^9}},
 CellLabel->"Out[185]=",
 CellID->219823090,ExpressionUUID->"1c98c898-971c-4925-ab30-472eb278ac6d"]
}, Open  ]],

Cell["Check the result.", "Text",
 CellChangeTimes->{{3.822364039437107*^9, 
  3.8223640430028477`*^9}},ExpressionUUID->"a53ebdcd-5fd2-4321-a3c9-\
f72fadd4e239"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Elaborate", "[", 
   RowBox[{"qc1", "-", "qc2"}], "]"}], "//", "Chop"}]], "Input",
 CellChangeTimes->{{3.8301435237724457`*^9, 3.830143534501116*^9}},
 CellLabel->"In[186]:=",
 CellID->1395051790,ExpressionUUID->"125cf67c-eff7-473c-af1a-3a9b30fc2631"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.8301435317282743`*^9, 3.830143539153141*^9}, 
   3.836211359559889*^9, 3.839372991292601*^9, 3.8397145041464043`*^9, 
   3.849257103680987*^9, 3.851810189827902*^9, 3.869387974912837*^9, 
   3.8850762917498302`*^9},
 CellLabel->"Out[186]=",
 CellID->2054923072,ExpressionUUID->"5456f3b7-fc6d-4ff4-a2ca-c61a9259336b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["General Unitary Gates", "Subsection",
 CellChangeTimes->{{3.8190783065101852`*^9, 3.8190783131586237`*^9}},
 CellTags->"Section34",
 CellID->1510815334,ExpressionUUID->"f333539f-4ca4-443d-8e3a-3c5226fa3e22"],

Cell[CellGroupData[{

Cell["\<\
Consider a Hermitian operator on a two-qubit system. Physically, it \
corresponds to a transverse-field Ising model.\
\>", "MathCaption",
 CellChangeTimes->{{3.82574680782373*^9, 
  3.825746859308683*^9}},ExpressionUUID->"dc7b920a-b5c6-48c5-88bc-\
9069675bb175"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"H", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}]}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matH", "=", 
   RowBox[{"Matrix", "[", "H", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"matH", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.825745785140683*^9, 3.825745853624226*^9}, {
  3.8257460693985167`*^9, 3.8257461559392653`*^9}, {3.825746186797338*^9, 
  3.8257462292965937`*^9}, {3.825746374786569*^9, 3.825746415351322*^9}, {
  3.8257464456581097`*^9, 3.825746446770846*^9}, {3.8257464949332952`*^9, 
  3.825746524909337*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"4554c789-7854-4252-a865-cefc4edb0552"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", SyntaxForm -> 
         SubsuperscriptBox], 
        $CellContext`S[1, 1]], 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", SyntaxForm -> 
         SubsuperscriptBox], 
        $CellContext`S[2, 1]]}, "RowDefault"]},
    "RowDefault"],
   Q3`Multiply[
    $CellContext`S[1, 1], 
    $CellContext`S[2, 1]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"],
   $CellContext`S[1, 2]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"],
   $CellContext`S[1, 3]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"],
   $CellContext`S[2, 2]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"],
   $CellContext`S[2, 3]]}]], "Output",
 CellChangeTimes->{{3.825745810052423*^9, 3.825745854311878*^9}, {
   3.825746047299778*^9, 3.8257460774980297`*^9}, {3.8257461120044003`*^9, 
   3.825746156243587*^9}, {3.8257461976648083`*^9, 3.825746229636919*^9}, 
   3.825746377015771*^9, 3.825746415757009*^9, {3.825746447175304*^9, 
   3.8257465252803717`*^9}, {3.825746861069104*^9, 3.825746865896688*^9}, 
   3.825748643009836*^9, 3.825748771274084*^9, 3.826225420635057*^9, 
   3.8263297180181427`*^9, 3.826333661055253*^9, 3.826338094852137*^9, 
   3.8301435407341957`*^9, 3.836211361588382*^9, 3.8393729931734247`*^9, 
   3.839714505849752*^9, 3.84925710544149*^9, 3.851810189831882*^9, 
   3.869387977262162*^9, 3.8850762959702*^9},
 CellLabel->"Out[187]=",
 CellID->686848155,ExpressionUUID->"f051eb5f-5367-4117-b936-9e390e76e359"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"2", 
      RowBox[{"-", "\[ImaginaryI]"}], 
      RowBox[{"-", "\[ImaginaryI]"}], "1"},
     {"\[ImaginaryI]", "0", "1", 
      RowBox[{"-", "\[ImaginaryI]"}]},
     {"\[ImaginaryI]", "1", "0", 
      RowBox[{"-", "\[ImaginaryI]"}]},
     {"1", "\[ImaginaryI]", "\[ImaginaryI]", 
      RowBox[{"-", "2"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 4, 8, 12, 16}, {{1}, {2}, {3}, {4}, {2}, {1}, {4}, {3}, {3}, {
       4}, {1}, {2}, {4}, {3}, {2}, {1}}}, {
      2, Complex[0, -1], Complex[0, -1], 1, 0, Complex[0, 1], Complex[0, -1], 
       1, 0, Complex[0, -1], Complex[0, 1], 1, -2, Complex[0, 1], Complex[
       0, 1], 1}}]]]]], "Output",
 CellChangeTimes->{{3.825745810052423*^9, 3.825745854311878*^9}, {
   3.825746047299778*^9, 3.8257460774980297`*^9}, {3.8257461120044003`*^9, 
   3.825746156243587*^9}, {3.8257461976648083`*^9, 3.825746229636919*^9}, 
   3.825746377015771*^9, 3.825746415757009*^9, {3.825746447175304*^9, 
   3.8257465252803717`*^9}, {3.825746861069104*^9, 3.825746865896688*^9}, 
   3.825748643009836*^9, 3.825748771274084*^9, 3.826225420635057*^9, 
   3.8263297180181427`*^9, 3.826333661055253*^9, 3.826338094852137*^9, 
   3.8301435407341957`*^9, 3.836211361588382*^9, 3.8393729931734247`*^9, 
   3.839714505849752*^9, 3.84925710544149*^9, 3.851810189831882*^9, 
   3.869387977262162*^9, 3.885076295977209*^9},
 CellLabel->"Out[189]//MatrixForm=",
 CellID->1132338460,ExpressionUUID->"b4c434f6-9a02-44ba-87fb-2a10462b6492"]
}, Open  ]],

Cell["\<\
This is the unitary operator generated by the above Hermitian operator.\
\>", "Text",
 CellChangeTimes->{{3.825746879422639*^9, 
  3.825746904801694*^9}},ExpressionUUID->"478bcb87-e014-45dc-8d24-\
55ebb8a2c205"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U", "=", 
  RowBox[{"MultiplyExp", "[", 
   RowBox[{
    RowBox[{"-", "I"}], "  ", "H", " ", 
    RowBox[{"Pi", "/", "4"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.825745857998559*^9, 3.8257460226450243`*^9}, {
  3.825746117669445*^9, 3.8257461177702007`*^9}, {3.825746207788409*^9, 
  3.825746211534068*^9}, {3.825746295657905*^9, 3.825746347067532*^9}, {
  3.825746454837264*^9, 3.825746471328614*^9}, {3.825746512142303*^9, 
  3.825746529791831*^9}, {3.8257469471236362`*^9, 3.825746949283082*^9}, {
  3.8257486459795837`*^9, 3.825748719190055*^9}, {3.825748785618828*^9, 
  3.825748796102779*^9}},
 CellLabel->
  "In[190]:=",ExpressionUUID->"059015e2-561f-4f7e-8385-2c3e93b5d8ff"],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
    RowBox[{"(", 
     RowBox[{
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           InterpretationBox[
            TemplateBox[{
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"], 
              TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
             SyntaxForm -> SubsuperscriptBox], 
            $CellContext`S[1, 1]], 
           InterpretationBox[
            TemplateBox[{
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"], 
              TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
             SyntaxForm -> SubsuperscriptBox], 
            $CellContext`S[2, 1]]}, "RowDefault"]},
        "RowDefault"],
       Q3`Multiply[
        $CellContext`S[1, 1], 
        $CellContext`S[2, 1]]], "+", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       $CellContext`S[1, 2]], "+", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       $CellContext`S[1, 3]], "+", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       $CellContext`S[2, 2]], "+", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       $CellContext`S[2, 3]]}], ")"}]}]],
  Q3`MultiplyExp[Complex[0, 
     Rational[-1, 4]] Pi (Q3`Multiply[
      $CellContext`S[1, 1], 
      $CellContext`S[2, 1]] + $CellContext`S[1, 2] + $CellContext`S[
     1, 3] + $CellContext`S[2, 2] + $CellContext`S[2, 3])]]], "Output",
 CellChangeTimes->{{3.82574694957581*^9, 3.825746951278034*^9}, {
   3.825748646402684*^9, 3.825748719630045*^9}, {3.82574877591192*^9, 
   3.8257487965814257`*^9}, 3.826225422081636*^9, 3.826329718061911*^9, 
   3.826333661092963*^9, 3.8263380963449*^9, 3.830143542399664*^9, 
   3.836211362984589*^9, 3.839372994841238*^9, 3.8397145074554768`*^9, 
   3.849257106873571*^9, 3.8518101898472958`*^9, 3.8693879786227703`*^9, 
   3.885076297493278*^9},
 CellLabel->"Out[190]=",
 CellID->147241018,ExpressionUUID->"07f4c816-fc54-43a0-8865-457ee1af9678"]
}, Open  ]],

Cell[TextData[{
 "This shows the matrix representation of ",
 StyleBox["U", "Input"],
 " in the logical basis."
}], "Text",
 CellChangeTimes->{{3.825746953613326*^9, 
  3.825746977574038*^9}},ExpressionUUID->"8b881b48-487f-415b-9e7c-\
c66f22aea752"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"matU", "=", 
   RowBox[{
    RowBox[{"Matrix", "[", "U", "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"matU", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.825745857998559*^9, 3.8257460226450243`*^9}, {
   3.825746117669445*^9, 3.8257461177702007`*^9}, {3.825746207788409*^9, 
   3.825746211534068*^9}, {3.825746295657905*^9, 3.825746347067532*^9}, {
   3.825746454837264*^9, 3.825746471328614*^9}, {3.825746512142303*^9, 
   3.825746529791831*^9}, 3.8257469471236362`*^9, {3.825748663922715*^9, 
   3.8257486656654663`*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"9fc4c3d7-3782-4bd8-838d-9b8c9d109b4e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.825745865667531*^9, 3.8257460784460697`*^9}, {
   3.825746113569147*^9, 3.825746157720942*^9}, {3.8257461987377253`*^9, 
   3.82574623152573*^9}, {3.825746296711462*^9, 3.825746378439662*^9}, 
   3.8257464169432783`*^9, {3.825746451280964*^9, 3.8257464716949863`*^9}, {
   3.825746506952736*^9, 3.825746554794978*^9}, 3.8257468729477577`*^9, 
   3.825746907524428*^9, 3.825746985198106*^9, {3.8257486477443237`*^9, 
   3.8257487215960703`*^9}, {3.82574878888295*^9, 3.8257487980801487`*^9}, 
   3.826225423465539*^9, 3.8263297181112013`*^9, 3.8263336611370583`*^9, 
   3.826338097433136*^9, 3.830143543763843*^9, 3.8362113653116083`*^9, 
   3.839372996360124*^9, 3.8397145089908237`*^9, 3.849257108422038*^9, 
   3.8518101898789463`*^9, 3.8693879798840437`*^9, 3.885076298844805*^9},
 CellLabel->"Out[192]//MatrixForm=",
 CellID->685313396,ExpressionUUID->"ad617059-776e-41d4-9493-0fe6fc8453f1"]
}, Open  ]],

Cell[TextData[{
 "This shows the decomposition of the unitary matrix into two-level matrices \
(displaying the first three elements). For the purpose of efficiency, the \
resulting list is given in terms of ",
 StyleBox["TwoLevelU", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.825746917931465*^9, 3.8257469445792637`*^9}, {
  3.8257469913210773`*^9, 3.825747064216855*^9}, {3.826225461111587*^9, 
  3.826225480992959*^9}},ExpressionUUID->"e63f0239-5499-4844-8f0b-\
589257e37cd9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"twl", "=", 
   RowBox[{
    RowBox[{"TwoLevelDecomposition", "[", "matU", "]"}], "//", "Simplify"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"twl", "[", 
  RowBox[{"[", 
   RowBox[{";;", "3"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.825746609259522*^9, 3.825746661982821*^9}, {
  3.8262254843474817`*^9, 3.826225490806238*^9}},
 CellLabel->
  "In[193]:=",ExpressionUUID->"ec9a089a-cdf8-4e25-8f72-5e8bf0d9a6f2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           FractionBox["1", "2"], "-", 
           FractionBox[
            RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
          SqrtBox["7"]], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            FractionBox["3", "2"], "+", 
            FractionBox[
             RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
           SqrtBox["7"]]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           FractionBox["3", "2"], "-", 
           FractionBox[
            RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
          SqrtBox["7"]], ",", 
         FractionBox[
          RowBox[{
           FractionBox["1", "2"], "+", 
           FractionBox[
            RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
          SqrtBox["7"]]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}], ",", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"1", "-", 
            RowBox[{"3", " ", "\[ImaginaryI]"}]}], 
           SqrtBox["38"]]}], ",", 
         SqrtBox[
          FractionBox["14", "19"]]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          SqrtBox[
           FractionBox["14", "19"]]}], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"1", "+", 
            RowBox[{"3", " ", "\[ImaginaryI]"}]}], 
           SqrtBox["38"]]}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", "4"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8257466429230127`*^9, 3.825746664341507*^9}, 
   3.825746910193886*^9, 3.825747000567658*^9, 3.825747161659006*^9, {
   3.8257486955388727`*^9, 3.825748723835164*^9}, 3.825748799974234*^9, {
   3.8262254918136253`*^9, 3.8262254954273367`*^9}, 3.826329718272139*^9, 
   3.826333661287776*^9, 3.826338099217266*^9, 3.8301435454143333`*^9, 
   3.836211367489853*^9, 3.8393729979490013`*^9, 3.8397145107789516`*^9, 
   3.849257109928215*^9, 3.851810189959714*^9, 3.869387981607871*^9, 
   3.885076300512773*^9},
 CellLabel->"Out[194]=",
 CellID->209660423,ExpressionUUID->"5b1f6ce3-8399-4758-ad4f-9927efffbbcd"]
}, Open  ]],

Cell[TextData[{
 "For a more intuitive form, you can convert ",
 StyleBox["TwoLevelU", "Input"],
 " into the normal matrix form using ",
 StyleBox["Matrix", "Input"],
 ". Here the first three are shown."
}], "Text",
 CellChangeTimes->{{3.825747077536437*^9, 3.825747145077875*^9}, {
  3.826225520071632*^9, 
  3.826225541085203*^9}},ExpressionUUID->"f6fb3f00-cb3c-4283-a6f0-\
f582195ce967"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Matrix", "/@", 
   RowBox[{"twl", "[", 
    RowBox[{"[", 
     RowBox[{";;", "3"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.825746700470716*^9, 3.8257467087244473`*^9}, {
  3.826225502610517*^9, 3.826225503757389*^9}},
 CellLabel->
  "In[195]:=",ExpressionUUID->"ae2271fb-074d-4d33-9583-50ea101169c4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {1, 1, 1, 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        FractionBox[
         RowBox[{
          FractionBox["1", "2"], "-", 
          FractionBox[
           RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
         SqrtBox["7"]], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           FractionBox["3", "2"], "+", 
           FractionBox[
            RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
          SqrtBox["7"]]}]},
       {"0", "0", 
        FractionBox[
         RowBox[{
          FractionBox["3", "2"], "-", 
          FractionBox[
           RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
         SqrtBox["7"]], 
        FractionBox[
         RowBox[{
          FractionBox["1", "2"], "+", 
          FractionBox[
           RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
         SqrtBox["7"]]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[Rational[1, 2], Rational[-3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[-3, 2], Rational[-3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[1, 2], Rational[3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[3, 2], Rational[-3, 2]] 7^Rational[-1, 2]}}]]]], 
   ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"1", "-", 
           RowBox[{"3", " ", "\[ImaginaryI]"}]}], 
          SqrtBox["38"]]}], 
        SqrtBox[
         FractionBox["14", "19"]], "0"},
       {"0", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox["14", "19"]]}], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"3", " ", "\[ImaginaryI]"}]}], 
          SqrtBox["38"]]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[-1, 3] 38^Rational[-1, 2], Rational[14, 19]^Rational[1, 2],
          Complex[-1, -3] 38^Rational[-1, 2], -
         Rational[14, 19]^Rational[1, 2], 1}}]]]]}], "}"}]], "Output",
 CellChangeTimes->{{3.825746704250867*^9, 3.8257467090607357`*^9}, {
   3.825747136257801*^9, 3.825747162893362*^9}, 3.825748728342235*^9, 
   3.825748801831325*^9, 3.826225504153957*^9, 3.826225542648952*^9, 
   3.826329718280012*^9, 3.826333661296629*^9, 3.826338102162608*^9, 
   3.8301435473989763`*^9, 3.836211369380835*^9, 3.8393729995725517`*^9, 
   3.839714515407118*^9, 3.849257112420568*^9, 3.851810189964553*^9, 
   3.869387983423954*^9, 3.885076302105793*^9},
 CellLabel->"Out[195]=",
 CellID->1692008191,ExpressionUUID->"6fb486ea-f70e-4c5d-a92b-3c2e57e75e23"]
}, Open  ]],

Cell["Indeed, they reconstruct the original matrix.", "Text",
 CellChangeTimes->{{3.825747179242531*^9, 
  3.825747187825377*^9}},ExpressionUUID->"0419518a-7b40-42a8-bb90-\
a709b4a60a73"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"Dot", "@@", 
    RowBox[{"Matrix", "/@", "twl"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"matU", "-", "new"}], "//", "Simplify"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8257471890200653`*^9, 3.82574721506069*^9}, {
  3.825748754896859*^9, 3.825748756943139*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"44e32c84-7ed3-4fba-b6ba-05d594acf37f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.825747199763287*^9, 3.8257472153214693`*^9}, {
   3.825748733042242*^9, 3.825748758996829*^9}, 3.8257488037189503`*^9, 
   3.8262255098772573`*^9, 3.826329718321154*^9, 3.826333661331856*^9, 
   3.8301435486693277`*^9, 3.836211370846562*^9, 3.839373001393237*^9, 
   3.83971451741413*^9, 3.849257113839432*^9, 3.851810189976562*^9, 
   3.869387985256868*^9, 3.88507630349616*^9},
 CellLabel->"Out[197]//MatrixForm=",
 CellID->1701683239,ExpressionUUID->"cbcd1548-f9b4-4282-a18b-7dbb68b79752"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Consider a two-level matrix of the form.", "MathCaption",
 CellChangeTimes->{{3.8260541950441427`*^9, 
  3.82605421106446*^9}},ExpressionUUID->"4a451544-88b4-4e07-9ac8-\
ae17c65f7020"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"matU", "=", 
   RowBox[{"TheHadamard", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"code", "=", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{"matU", ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"full", "=", 
   RowBox[{"Matrix", "[", "code", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"full", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8260544561048517`*^9, 3.826054519888679*^9}, {
  3.826054613530467*^9, 3.826054640809328*^9}},
 CellLabel->
  "In[198]:=",ExpressionUUID->"88e897e6-5ca8-4cba-b007-a3e7a786aa5e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", 
      FractionBox["1", 
       SqrtBox["2"]], 
      FractionBox["1", 
       SqrtBox["2"]]},
     {"0", "0", 
      FractionBox["1", 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
      1, 1, 2^Rational[-1, 2], 2^Rational[-1, 2], -2^Rational[-1, 2], 2^
       Rational[-1, 2]}}]]]]], "Output",
 CellChangeTimes->{{3.826054512574505*^9, 3.826054575677123*^9}, {
   3.8260546179067097`*^9, 3.826054649563826*^9}, 3.8263297183299847`*^9, 
   3.8263297561552563`*^9, 3.826333661339849*^9, 3.8301435500716667`*^9, 
   3.8362113726370173`*^9, 3.839373002786682*^9, 3.839714518858137*^9, 
   3.849257115207611*^9, 3.85181018998088*^9, 3.8693879868234577`*^9, 
   3.885076305128069*^9},
 CellLabel->"Out[201]//MatrixForm=",
 CellID->829300281,ExpressionUUID->"03cf38e1-8ea8-463d-a89e-81c4e2cd8704"]
}, Open  ]],

Cell["It corresponds to a single controlled-unitary gate.", "Text",
 CellChangeTimes->{{3.826055023944199*^9, 3.8260550343498898`*^9}, {
  3.84664218386979*^9, 
  3.846642185310754*^9}},ExpressionUUID->"ddcb9fe7-bc17-479a-832c-\
44297dffed5b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ctrlU", "=", 
   RowBox[{"FromTwoLevelU", "[", 
    RowBox[{"matU", ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", 
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"QuantumCircuit", "[", "ctrlU", "]"}]}], "Input",
 CellChangeTimes->{{3.826054324793391*^9, 3.826054353106566*^9}, 
   3.826054428076798*^9, {3.82605456158013*^9, 3.826054587261544*^9}, {
   3.826054653668275*^9, 3.826054687247489*^9}, {3.826054875002886*^9, 
   3.8260548778585043`*^9}, {3.826054990151506*^9, 3.8260549971144257`*^9}, {
   3.826329751562418*^9, 3.8263297518431673`*^9}, 3.829808799775687*^9, 
   3.8693878142927628`*^9},
 CellLabel->
  "In[202]:=",ExpressionUUID->"be696d2e-22b3-40f5-b7a6-da4ba963d421"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[{
    Q3`ControlledU[{
       $CellContext`S[1, Q3`$]} -> {1}, 
     2^Rational[-1, 2] $CellContext`S[2, 1] + 
     2^Rational[-1, 2] $CellContext`S[2, 3], "Label" -> "U"]}]]], "Output",
 CellChangeTimes->{{3.826054345666815*^9, 3.826054353417645*^9}, 
   3.82605442835625*^9, {3.82605453396813*^9, 3.826054589332481*^9}, {
   3.826054620201408*^9, 3.826054689576792*^9}, 3.826054878159926*^9, 
   3.826054997480523*^9, 3.8263297183742933`*^9, {3.826329752260511*^9, 
   3.826329757507287*^9}, 3.8263336613761377`*^9, 3.830143551701518*^9, 
   3.8362113756789093`*^9, 3.839373004194213*^9, 3.83971452023274*^9, 
   3.849257116713439*^9, 3.8518101899853897`*^9, 3.869387990591257*^9, 
   3.885076306580162*^9},
 CellLabel->"Out[203]=",
 CellID->520963463,ExpressionUUID->"1f81c61d-3db1-4412-a498-50b7018060cd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Consider a two-level matrix of the form.", "MathCaption",
 CellChangeTimes->{{3.8260541950441427`*^9, 
  3.82605421106446*^9}},ExpressionUUID->"3beeca0a-b1aa-4dc7-a2f1-\
23c557a061c7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"matU", "=", 
   RowBox[{"TheHadamard", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"code", "=", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{"matU", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], ",", "4"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"full", "=", 
   RowBox[{"Matrix", "[", "code", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"full", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8260544561048517`*^9, 3.826054519888679*^9}, {
  3.826054613530467*^9, 3.826054640809328*^9}, {3.8260548631109962`*^9, 
  3.8260548631261473`*^9}},
 CellLabel->
  "In[204]:=",ExpressionUUID->"0a8822e7-cf34-4ad9-ab0d-127993ff6fe6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", 
      FractionBox["1", 
       SqrtBox["2"]], "0", 
      FractionBox["1", 
       SqrtBox["2"]]},
     {"0", "0", "1", "0"},
     {"0", 
      FractionBox["1", 
       SqrtBox["2"]], "0", 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 1, 3, 4, 6}, {{1}, {2}, {4}, {3}, {4}, {2}}}, {
      1, 2^Rational[-1, 2], 2^Rational[-1, 2], 1, -2^Rational[-1, 2], 2^
       Rational[-1, 2]}}]]]]], "Output",
 CellChangeTimes->{{3.826054512574505*^9, 3.826054575677123*^9}, {
   3.8260546179067097`*^9, 3.826054649563826*^9}, {3.826054865499357*^9, 
   3.82605488088517*^9}, 3.826329718383037*^9, 3.826329763049575*^9, 
   3.826333661384575*^9, 3.8301435530066767`*^9, 3.836211377313921*^9, 
   3.839373005728647*^9, 3.839714522562307*^9, 3.849257118108927*^9, 
   3.8518101899891644`*^9, 3.869387992588209*^9, 3.8850763081161413`*^9},
 CellLabel->"Out[207]//MatrixForm=",
 CellID->2121917620,ExpressionUUID->"cdb9cd0d-1b61-4ab2-a48c-67f4cee26f7e"]
}, Open  ]],

Cell["\<\
It corresponds to a single controlled-unitary gate with the control and \
target qubit exchanged.\
\>", "Text",
 CellChangeTimes->{{3.826055023944199*^9, 3.826055063856986*^9}, {
  3.846642238838913*^9, 
  3.846642240682199*^9}},ExpressionUUID->"433aecbc-0dee-412c-b2ca-\
09aca6549ae5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ctrlU", "=", 
   RowBox[{"FromTwoLevelU", "[", 
    RowBox[{"matU", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], ",", 
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"QuantumCircuit", "[", "ctrlU", "]"}]}], "Input",
 CellChangeTimes->{{3.826054324793391*^9, 3.826054353106566*^9}, 
   3.826054428076798*^9, {3.82605456158013*^9, 3.826054587261544*^9}, {
   3.826054653668275*^9, 3.826054687247489*^9}, {3.826054884631419*^9, 
   3.8260548846874247`*^9}, 3.826055002628208*^9, 3.826329769381411*^9, 
   3.829808799779345*^9, 3.8693878142960987`*^9},
 CellLabel->
  "In[208]:=",ExpressionUUID->"58de3ff9-ffa3-4f82-be06-0a6d90534ecd"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -2}, {1, -1}}], DiskBox[{1, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[{
    Q3`ControlledU[{
       $CellContext`S[2, Q3`$]} -> {1}, 
     2^Rational[-1, 2] $CellContext`S[1, 1] + 
     2^Rational[-1, 2] $CellContext`S[1, 3], "Label" -> "U"]}]]], "Output",
 CellChangeTimes->{{3.826054345666815*^9, 3.826054353417645*^9}, 
   3.82605442835625*^9, {3.82605453396813*^9, 3.826054589332481*^9}, {
   3.826054620201408*^9, 3.826054689576792*^9}, {3.826054867160961*^9, 
   3.8260548850779943`*^9}, 3.82605500317879*^9, 3.82605506517022*^9, 
   3.826329718425933*^9, {3.826329764603259*^9, 3.826329769766796*^9}, 
   3.826333661427513*^9, 3.830143554618368*^9, 3.836211378648746*^9, 
   3.8393730071264277`*^9, 3.83971452405719*^9, 3.849257119554215*^9, 
   3.851810189998982*^9, 3.869387994383236*^9, 3.885076309615671*^9},
 CellLabel->"Out[209]=",
 CellID->1604982496,ExpressionUUID->"6c389702-61d4-47ff-8229-48ed6ebff843"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Consider a two-level matrix of the form.", "MathCaption",
 CellChangeTimes->{{3.8260541950441427`*^9, 
  3.82605421106446*^9}},ExpressionUUID->"829c9dbe-b262-4ef0-b036-\
2a89d9234cdd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"matU", "=", 
   RowBox[{"TheHadamard", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"code", "=", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{"matU", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", "4"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"full", "=", 
   RowBox[{"Matrix", "[", "code", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"full", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8260544561048517`*^9, 3.826054519888679*^9}, {
  3.826054613530467*^9, 3.826054640809328*^9}, {3.8260548631109962`*^9, 
  3.8260548631261473`*^9}, {3.826054909683794*^9, 3.826054909761827*^9}},
 CellLabel->
  "In[210]:=",ExpressionUUID->"77c6ead4-c199-4495-b5a8-539fa3cf5175"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", 
      FractionBox["1", 
       SqrtBox["2"]], 
      FractionBox["1", 
       SqrtBox["2"]], "0"},
     {"0", 
      FractionBox["1", 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}], "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
      1, 2^Rational[-1, 2], 2^Rational[-1, 2], -2^Rational[-1, 2], 2^
       Rational[-1, 2], 1}}]]]]], "Output",
 CellChangeTimes->{{3.826054512574505*^9, 3.826054575677123*^9}, {
   3.8260546179067097`*^9, 3.826054649563826*^9}, {3.826054865499357*^9, 
   3.82605488088517*^9}, 3.826054911120387*^9, 3.8260550057225237`*^9, 
   3.826055766511935*^9, 3.82613135178741*^9, 3.826329718434518*^9, 
   3.8263297714595127`*^9, 3.826333661436317*^9, 3.83014355593246*^9, 
   3.8362113798509007`*^9, 3.8393730084663277`*^9, 3.839714526732156*^9, 
   3.849257121010577*^9, 3.8518101900110188`*^9, 3.869387995893949*^9, 
   3.8850763112453623`*^9},
 CellLabel->"Out[213]//MatrixForm=",
 CellID->1182962953,ExpressionUUID->"47e267a6-c13a-4249-a5d5-f92be6436d2b"]
}, Open  ]],

Cell["\<\
In this case, we need to apply the CNOT gate before and after the \
controlled-unitary gate.\
\>", "Text",
 CellChangeTimes->{{3.82605509325206*^9, 3.826055139870063*^9}, 
   3.846642349049675*^9},ExpressionUUID->"b508c97f-d0b2-44b0-8516-\
6d81b99e24be"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ctrlU", "=", 
   RowBox[{"FromTwoLevelU", "[", 
    RowBox[{"matU", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", 
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"QuantumCircuit", "@@", "ctrlU"}]}], "Input",
 CellChangeTimes->{{3.826054324793391*^9, 3.826054353106566*^9}, 
   3.826054428076798*^9, {3.82605456158013*^9, 3.826054587261544*^9}, {
   3.826054653668275*^9, 3.826054687247489*^9}, {3.826054884631419*^9, 
   3.8260548846874247`*^9}, {3.826054914746058*^9, 3.826054914847007*^9}, {
   3.82613133454174*^9, 3.826131347870913*^9}, 3.826329777064439*^9, 
   3.82980879978298*^9, {3.8492571358610973`*^9, 3.849257138786409*^9}, 
   3.8693878142989807`*^9},
 CellLabel->
  "In[214]:=",ExpressionUUID->"b8312eb3-4af7-4c72-8aaf-f09510dc4138"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
     LineBox[{{1, -2}, {1, -1}}], 
     DiskBox[{1, -2}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
         1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
     LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, 
     LineBox[{{1.6, -2.4}, {2.4, -2.4}, {2.4, -1.6}, {1.6, -1.6}, {
      1.6, -2.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{3, -2}, {3, -1}}], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -1}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -1}, {3.2666666666666666`, -1}}, {{
         3, -1.2666666666666666`}, {3, -0.7333333333333334}}}]}}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[1, Q3`$]}], 
   Q3`ControlledU[{
      $CellContext`S[1, Q3`$]} -> {1}, 2^Rational[-1, 2] $CellContext`S[2, 1] - 
    2^Rational[-1, 2] $CellContext`S[2, 3], "Label" -> "U"], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[1, Q3`$]}]]]], "Output",
 CellChangeTimes->{{3.826054345666815*^9, 3.826054353417645*^9}, 
   3.82605442835625*^9, {3.82605453396813*^9, 3.826054589332481*^9}, {
   3.826054620201408*^9, 3.826054689576792*^9}, {3.826054867160961*^9, 
   3.8260548850779943`*^9}, 3.826054915239068*^9, 3.826055006540514*^9, 
   3.826055141538521*^9, 3.826055768324479*^9, {3.826131348215242*^9, 
   3.826131353152464*^9}, 3.8263297184793587`*^9, {3.8263297774513493`*^9, 
   3.826329779743433*^9}, 3.8263336614782248`*^9, 3.8301435573826227`*^9, 
   3.836211381126975*^9, 3.839373010323812*^9, 3.839714533898561*^9, 
   3.8492571391298513`*^9, 3.851810190017601*^9, 3.869387997634623*^9, 
   3.885076312757909*^9},
 CellLabel->"Out[215]=",
 CellID->452614765,ExpressionUUID->"d1cb34d0-4070-418b-a8b5-39bac15420cb"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Consider a two-level matrix of the form.", "MathCaption",
 CellChangeTimes->{{3.8260541950441427`*^9, 
  3.82605421106446*^9}},ExpressionUUID->"d5529d34-6855-40f5-8e23-\
6b09c9388f75"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"matU", "=", 
   RowBox[{"TheHadamard", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"code", "=", 
   RowBox[{"TwoLevelU", "[", 
    RowBox[{"matU", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}], ",", "4"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"full", "=", 
   RowBox[{"Matrix", "[", "code", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"full", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8260544561048517`*^9, 3.826054519888679*^9}, {
  3.826054613530467*^9, 3.826054640809328*^9}, {3.8260548631109962`*^9, 
  3.8260548631261473`*^9}, {3.826054909683794*^9, 3.826054939021677*^9}},
 CellLabel->
  "In[216]:=",ExpressionUUID->"eba3f428-2f21-4cd5-bc0b-7ea8ef112241"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       SqrtBox["2"]], "0", "0", 
      FractionBox["1", 
       SqrtBox["2"]]},
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {
      FractionBox["1", 
       SqrtBox["2"]], "0", "0", 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 3, 4, 6}, {{1}, {4}, {2}, {3}, {4}, {1}}}, {
      2^Rational[-1, 2], 2^Rational[-1, 2], 1, 1, -2^Rational[-1, 2], 2^
       Rational[-1, 2]}}]]]]], "Output",
 CellChangeTimes->{{3.826054512574505*^9, 3.826054575677123*^9}, {
   3.8260546179067097`*^9, 3.826054649563826*^9}, {3.826054865499357*^9, 
   3.82605488088517*^9}, {3.826054911120387*^9, 3.826054951637662*^9}, 
   3.8260550083130083`*^9, 3.826329718488061*^9, 3.826333661486759*^9, 
   3.830143558950873*^9, 3.836211382294252*^9, 3.839373011825683*^9, 
   3.839714535502993*^9, 3.849257141891205*^9, 3.8518101900216103`*^9, 
   3.8693879991227617`*^9, 3.885076314183375*^9},
 CellLabel->"Out[219]//MatrixForm=",
 CellID->952252550,ExpressionUUID->"c7aceed1-810c-4468-8b43-de1321177931"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ctrlU", "=", 
   RowBox[{"FromTwoLevelU", "[", 
    RowBox[{"matU", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}], ",", 
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"QuantumCircuit", "@@", "ctrlU"}]}], "Input",
 CellChangeTimes->{{3.826054324793391*^9, 3.826054353106566*^9}, 
   3.826054428076798*^9, {3.82605456158013*^9, 3.826054587261544*^9}, {
   3.826054653668275*^9, 3.826054687247489*^9}, {3.826054884631419*^9, 
   3.8260548846874247`*^9}, {3.826054914746058*^9, 3.826054944882676*^9}, 
   3.829808799786783*^9, 3.869387814301626*^9},
 CellLabel->
  "In[222]:=",ExpressionUUID->"26239bcb-03f4-4364-9d17-67709f8d15b9"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
     LineBox[{{1, -2}, {1, -1}}], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{1, -2}, 0.09]}, {
      CircleBox[{1, -1}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
         1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
     LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, 
     LineBox[{{1.6, -2.4}, {2.4, -2.4}, {2.4, -1.6}, {1.6, -1.6}, {
      1.6, -2.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{3, -2}, {3, -1}}], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{3, -2}, 0.09]}, {
      CircleBox[{3, -1}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -1}, {3.2666666666666666`, -1}}, {{
         3, -1.2666666666666666`}, {3, -0.7333333333333334}}}]}}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {0}, {
     $CellContext`S[1, Q3`$]}], 
   Q3`ControlledU[{
      $CellContext`S[1, Q3`$]} -> {1}, 2^Rational[-1, 2] $CellContext`S[2, 1] + 
    2^Rational[-1, 2] $CellContext`S[2, 3], "Label" -> "U"], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {0}, {
     $CellContext`S[1, Q3`$]}]]]], "Output",
 CellChangeTimes->{{3.826054345666815*^9, 3.826054353417645*^9}, 
   3.82605442835625*^9, {3.82605453396813*^9, 3.826054589332481*^9}, {
   3.826054620201408*^9, 3.826054689576792*^9}, {3.826054867160961*^9, 
   3.8260548850779943`*^9}, 3.826054915239068*^9, {3.826054945283372*^9, 
   3.8260549523725243`*^9}, 3.8263297185309143`*^9, 3.826329783884294*^9, 
   3.826333661600754*^9, 3.830143560456728*^9, 3.83621138400171*^9, 
   3.83937301352584*^9, 3.8397145378297243`*^9, 3.849257144758429*^9, 
   3.851810190029942*^9, 3.869388002870997*^9, 3.885076324266066*^9},
 CellLabel->"Out[223]=",
 CellID->1322203248,ExpressionUUID->"5069565a-c9ae-499e-8b91-5afb4ad1063f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Let us consider again the two-qubit model demonstrated before.\
\>", "MathCaption",
 CellChangeTimes->{{3.82574680782373*^9, 3.825746859308683*^9}, {
  3.8257477408766727`*^9, 3.8257477728815928`*^9}, {3.8260552689130774`*^9, 
  3.826055270251631*^9}},ExpressionUUID->"4af47efe-af18-48da-945a-\
38636bdfd5cb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"H", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}]}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"U", "=", 
  RowBox[{"MultiplyExp", "[", 
   RowBox[{
    RowBox[{"-", "I"}], "  ", "H", " ", 
    RowBox[{"Pi", "/", "4"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.825745785140683*^9, 3.825745853624226*^9}, {
  3.8257460693985167`*^9, 3.8257461559392653`*^9}, {3.825746186797338*^9, 
  3.8257462292965937`*^9}, {3.825746374786569*^9, 3.825746415351322*^9}, {
  3.8257464456581097`*^9, 3.825746446770846*^9}, {3.8257464949332952`*^9, 
  3.825746524909337*^9}, {3.8257477770561333`*^9, 3.8257478214012012`*^9}, {
  3.825748831156625*^9, 3.825748850730274*^9}, {3.853723118400532*^9, 
  3.8537231189281597`*^9}},
 CellLabel->
  "In[224]:=",ExpressionUUID->"0718cfd3-6795-4fb5-a187-6a81dc9bc0f0"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", SyntaxForm -> 
         SubsuperscriptBox], 
        $CellContext`S[1, 1]], 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", SyntaxForm -> 
         SubsuperscriptBox], 
        $CellContext`S[2, 1]]}, "RowDefault"]},
    "RowDefault"],
   Q3`Multiply[
    $CellContext`S[1, 1], 
    $CellContext`S[2, 1]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"],
   $CellContext`S[1, 2]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"1"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"],
   $CellContext`S[1, 3]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"y\""}, "RowDefault"]},
    "Subsuperscript"],
   $CellContext`S[2, 2]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"S"}, "RowDefault"], 
     TemplateBox[{"2"}, "RowDefault"], 
     TemplateBox[{"\"z\""}, "RowDefault"]},
    "Subsuperscript"],
   $CellContext`S[2, 3]]}]], "Output",
 CellChangeTimes->{{3.825745810052423*^9, 3.825745854311878*^9}, {
   3.825746047299778*^9, 3.8257460774980297`*^9}, {3.8257461120044003`*^9, 
   3.825746156243587*^9}, {3.8257461976648083`*^9, 3.825746229636919*^9}, 
   3.825746377015771*^9, 3.825746415757009*^9, {3.825746447175304*^9, 
   3.8257465252803717`*^9}, {3.825746861069104*^9, 3.825746865896688*^9}, {
   3.825747774507472*^9, 3.825747827103168*^9}, {3.8257488052778397`*^9, 
   3.8257488516631403`*^9}, 3.825749347139398*^9, {3.82574943675066*^9, 
   3.825749442976117*^9}, 3.826055278133779*^9, 3.8261447745680447`*^9, 
   3.826329718541069*^9, 3.826329785619528*^9, 3.826333661609387*^9, 
   3.830143563835647*^9, 3.836211385244155*^9, 3.8393730149339237`*^9, 
   3.839714539250704*^9, 3.849257146774281*^9, 3.851810190041913*^9, 
   3.853722914161854*^9, 3.853723119579701*^9, 3.869388009043908*^9, 
   3.885076326518271*^9},
 CellLabel->"Out[224]=",
 CellID->326191546,ExpressionUUID->"db64389c-dc50-424e-8707-9dc55dfba31f"],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
    RowBox[{"(", 
     RowBox[{
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{
           InterpretationBox[
            TemplateBox[{
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"1"}, "RowDefault"], 
              TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
             SyntaxForm -> SubsuperscriptBox], 
            $CellContext`S[1, 1]], 
           InterpretationBox[
            TemplateBox[{
              TemplateBox[{"S"}, "RowDefault"], 
              TemplateBox[{"2"}, "RowDefault"], 
              TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
             SyntaxForm -> SubsuperscriptBox], 
            $CellContext`S[2, 1]]}, "RowDefault"]},
        "RowDefault"],
       Q3`Multiply[
        $CellContext`S[1, 1], 
        $CellContext`S[2, 1]]], "+", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       $CellContext`S[1, 2]], "+", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"1"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       $CellContext`S[1, 3]], "+", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"y\""}, "RowDefault"]},
        "Subsuperscript"],
       $CellContext`S[2, 2]], "+", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"S"}, "RowDefault"], 
         TemplateBox[{"2"}, "RowDefault"], 
         TemplateBox[{"\"z\""}, "RowDefault"]},
        "Subsuperscript"],
       $CellContext`S[2, 3]]}], ")"}]}]],
  Q3`MultiplyExp[Complex[0, 
     Rational[-1, 4]] Pi (Q3`Multiply[
      $CellContext`S[1, 1], 
      $CellContext`S[2, 1]] + $CellContext`S[1, 2] + $CellContext`S[
     1, 3] + $CellContext`S[2, 2] + $CellContext`S[2, 3])]]], "Output",
 CellChangeTimes->{{3.825745810052423*^9, 3.825745854311878*^9}, {
   3.825746047299778*^9, 3.8257460774980297`*^9}, {3.8257461120044003`*^9, 
   3.825746156243587*^9}, {3.8257461976648083`*^9, 3.825746229636919*^9}, 
   3.825746377015771*^9, 3.825746415757009*^9, {3.825746447175304*^9, 
   3.8257465252803717`*^9}, {3.825746861069104*^9, 3.825746865896688*^9}, {
   3.825747774507472*^9, 3.825747827103168*^9}, {3.8257488052778397`*^9, 
   3.8257488516631403`*^9}, 3.825749347139398*^9, {3.82574943675066*^9, 
   3.825749442976117*^9}, 3.826055278133779*^9, 3.8261447745680447`*^9, 
   3.826329718541069*^9, 3.826329785619528*^9, 3.826333661609387*^9, 
   3.830143563835647*^9, 3.836211385244155*^9, 3.8393730149339237`*^9, 
   3.839714539250704*^9, 3.849257146774281*^9, 3.851810190041913*^9, 
   3.853722914161854*^9, 3.853723119579701*^9, 3.869388009043908*^9, 
   3.885076326531776*^9},
 CellLabel->"Out[225]=",
 CellID->1923046478,ExpressionUUID->"ca1eec47-0d56-4a89-932e-e9c7bea225bd"]
}, Open  ]],

Cell[TextData[{
 "This is the decomposition of ",
 StyleBox["matU", "Input"],
 ", the matrix representation of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "a90343c6-a7bf-43f9-843f-f4524d27daca"],
 ", into two-level unitary matrices, just showing the first three."
}], "Text",
 CellChangeTimes->{{3.825746917931465*^9, 3.8257469445792637`*^9}, {
  3.8257469913210773`*^9, 3.825747064216855*^9}, {3.825747911418088*^9, 
  3.825747940947754*^9}, {3.826144798458065*^9, 3.8261448655271606`*^9}, {
  3.853722929316934*^9, 3.853722963263812*^9}, {3.853723136870532*^9, 
  3.8537231551450453`*^9}},ExpressionUUID->"3950a998-b0aa-413e-8da5-\
e18ca1c4a880"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"matU", "=", 
   RowBox[{"Matrix", "[", "U", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"twl", "=", 
   RowBox[{
    RowBox[{"TwoLevelDecomposition", "[", "matU", "]"}], "//", "Simplify"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Matrix", "/@", 
   RowBox[{"twl", "[", 
    RowBox[{"[", 
     RowBox[{";;", "3"}], "]"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.825746609259522*^9, 3.825746661982821*^9}, {
   3.825747946842906*^9, 3.825747967868566*^9}, {3.826144782832835*^9, 
   3.82614479071791*^9}, {3.826144942982173*^9, 3.826144943058941*^9}, 
   3.853722939087161*^9, {3.853723121080083*^9, 3.853723121645495*^9}},
 CellLabel->
  "In[226]:=",ExpressionUUID->"497b32ac-c7d6-4e8a-8941-b8d03016b322"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {1, 1, 1, 1}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        FractionBox[
         RowBox[{
          FractionBox["1", "2"], "-", 
          FractionBox[
           RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
         SqrtBox["7"]], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           FractionBox["3", "2"], "+", 
           FractionBox[
            RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
          SqrtBox["7"]]}]},
       {"0", "0", 
        FractionBox[
         RowBox[{
          FractionBox["3", "2"], "-", 
          FractionBox[
           RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
         SqrtBox["7"]], 
        FractionBox[
         RowBox[{
          FractionBox["1", "2"], "+", 
          FractionBox[
           RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], 
         SqrtBox["7"]]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[Rational[1, 2], Rational[-3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[-3, 2], Rational[-3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[1, 2], Rational[3, 2]] 7^Rational[-1, 2], 
         Complex[Rational[3, 2], Rational[-3, 2]] 7^Rational[-1, 2]}}]]]], 
   ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"1", "-", 
           RowBox[{"3", " ", "\[ImaginaryI]"}]}], 
          SqrtBox["38"]]}], 
        SqrtBox[
         FractionBox["14", "19"]], "0"},
       {"0", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox["14", "19"]]}], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"3", " ", "\[ImaginaryI]"}]}], 
          SqrtBox["38"]]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[-1, 3] 38^Rational[-1, 2], Rational[14, 19]^Rational[1, 2],
          Complex[-1, -3] 38^Rational[-1, 2], -
         Rational[14, 19]^Rational[1, 2], 1}}]]]]}], "}"}]], "Output",
 CellChangeTimes->{{3.825746704250867*^9, 3.8257467090607357`*^9}, {
   3.825747136257801*^9, 3.825747162893362*^9}, {3.8257479538514843`*^9, 
   3.825747982333927*^9}, {3.825748809671051*^9, 3.825748857103544*^9}, 
   3.8257493489907618`*^9, {3.825749438502316*^9, 3.825749444453644*^9}, 
   3.825749487151297*^9, 3.826055279806766*^9, {3.826144775956691*^9, 
   3.826144791071947*^9}, 3.826144943419928*^9, 3.8263297186301537`*^9, 
   3.826329787136766*^9, 3.826333661684312*^9, 3.830143565522559*^9, 
   3.836211386818677*^9, 3.839373016683269*^9, 3.839714540767468*^9, 
   3.849257148637162*^9, 3.851810190066758*^9, 3.853722916180266*^9, 
   3.8537231229397383`*^9, 3.869388010526971*^9, 3.885076328172718*^9},
 CellLabel->"Out[228]=",
 CellID->907434927,ExpressionUUID->"4a5f97f8-af72-4c9c-b721-04521a006cab"]
}, Open  ]],

Cell[TextData[{
 "The two-level unitary matrices are rewritten in terms of the CNOT and \
controlled-unitary gates, again showing the first three. The first element of \
list ",
 StyleBox["twl", "Input"],
 " happens to be the identity matrix in this case, and it is excluded in the \
further analysis."
}], "Text",
 CellChangeTimes->{{3.8257479847923203`*^9, 3.825748021168288*^9}, {
   3.8261448951598997`*^9, 3.8261449141250067`*^9}, {3.8261449655586348`*^9, 
   3.826144997135497*^9}, 3.84664236439286*^9, {3.853722970061996*^9, 
   3.85372299285067*^9}, {3.853723071929441*^9, 3.853723085129242*^9}, {
   3.853723195998501*^9, 
   3.853723196506205*^9}},ExpressionUUID->"c762f480-3826-4392-82d0-\
39cebcd912b0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gates", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"FromTwoLevelU", "[", 
      RowBox[{"#", ",", 
       RowBox[{"S", "@", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], "&"}], "/@", 
    RowBox[{"Rest", "[", "twl", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"gates", "[", 
  RowBox[{"[", 
   RowBox[{";;", "3"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.825748027256527*^9, 3.825748086593872*^9}, {
   3.8257483258918753`*^9, 3.825748330616753*^9}, {3.825748877043056*^9, 
   3.825748900283119*^9}, {3.825749361005823*^9, 3.825749367473579*^9}, {
   3.826144764609969*^9, 3.82614476830916*^9}, {3.82614488448398*^9, 
   3.826144884583796*^9}, {3.826144945962186*^9, 3.826144946051495*^9}, 
   3.869387814311604*^9},
 CellLabel->
  "In[229]:=",ExpressionUUID->"0e19644d-eeb5-45bc-b2bd-03ef0283c7ef"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`S[1, Q3`$]], "}"}], "\[Rule]", 
       RowBox[{"{", "1", "}"}]}], ",", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["7"]}]], "-", 
       FractionBox[
        RowBox[{"3", " ", "\[ImaginaryI]", " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"x\""}, "RowDefault"]},
           "Subsuperscript"],
          $CellContext`S[2, 1]]}], 
        RowBox[{"2", " ", 
         SqrtBox["7"]}]], "-", 
       FractionBox[
        RowBox[{"3", " ", "\[ImaginaryI]", " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"y\""}, "RowDefault"]},
           "Subsuperscript"],
          $CellContext`S[2, 2]]}], 
        RowBox[{"2", " ", 
         SqrtBox["7"]}]], "-", 
       FractionBox[
        RowBox[{"3", " ", "\[ImaginaryI]", " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Subsuperscript"],
          $CellContext`S[2, 3]]}], 
        RowBox[{"2", " ", 
         SqrtBox["7"]}]]}], ",", 
      RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"},
            "RowDefault"], 
           TemplateBox[{"2"},
            "RowDefault"]],
          $CellContext`S[2, Q3`$]], "}"}], "\[Rule]", 
        RowBox[{"{", "1", "}"}]}], ",", 
       RowBox[{"{", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`S[1, Q3`$]], "}"}]}], "]"}], ",", 
     RowBox[{"ControlledU", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"},
            "RowDefault"], 
           TemplateBox[{"1"},
            "RowDefault"]],
          $CellContext`S[1, Q3`$]], "}"}], "\[Rule]", 
        RowBox[{"{", "1", "}"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", 
          SqrtBox["38"]]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         SqrtBox[
          FractionBox["14", "19"]], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"y\""}, "RowDefault"]},
           "Subsuperscript"],
          $CellContext`S[2, 2]]}], "-", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", 
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"], 
             TemplateBox[{"\"z\""}, "RowDefault"]},
            "Subsuperscript"],
           $CellContext`S[2, 3]]}], 
         SqrtBox["38"]]}], ",", 
       RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"},
            "RowDefault"], 
           TemplateBox[{"2"},
            "RowDefault"]],
          $CellContext`S[2, Q3`$]], "}"}], "\[Rule]", 
        RowBox[{"{", "1", "}"}]}], ",", 
       RowBox[{"{", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`S[1, Q3`$]], "}"}]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"ControlledU", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`S[1, Q3`$]], "}"}], "\[Rule]", 
       RowBox[{"{", "1", "}"}]}], ",", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["5", 
         RowBox[{"14", " ", 
          SqrtBox["2"]}]]}], "+", 
       RowBox[{
        FractionBox["3", "14"], " ", "\[ImaginaryI]", " ", 
        SqrtBox["19"], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]},
          "Subsuperscript"],
         $CellContext`S[2, 2]]}], "-", 
       FractionBox[
        RowBox[{"5", " ", "\[ImaginaryI]", " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"], 
            TemplateBox[{"\"z\""}, "RowDefault"]},
           "Subsuperscript"],
          $CellContext`S[2, 3]]}], 
        RowBox[{"14", " ", 
         SqrtBox["2"]}]]}], ",", 
      RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.82574889199146*^9, 3.825748903081205*^9}, {
   3.825749367911175*^9, 3.825749371866715*^9}, 3.8257495822269363`*^9, 
   3.8257502040369663`*^9, 3.8260552817099047`*^9, {3.82614476900635*^9, 
   3.826144777345052*^9}, 3.826144884929125*^9, 3.826144946419512*^9, 
   3.8263297186747*^9, 3.826329789126072*^9, 3.826333661732266*^9, 
   3.830143567224753*^9, 3.836211388537487*^9, 3.839373018435903*^9, 
   3.839714542348432*^9, 3.849257150404717*^9, 3.851810190086494*^9, 
   3.853723008396681*^9, 3.869388012288781*^9, 3.885076330100391*^9},
 CellLabel->"Out[230]=",
 CellID->405883318,ExpressionUUID->"ab174840-c361-4c93-bdf6-c238d75ab80e"]
}, Open  ]],

Cell["\<\
This shows the overall quantum circuit model. Here the same label \
\[OpenCurlyDoubleQuote]U\[CloseCurlyDoubleQuote] has been used for different \
controlled-unitary gates just for convenience. Do not forget to reverse the \
order before plugging the gates in the quantum circuit model.\
\>", "Text",
 CellChangeTimes->{{3.825749192017633*^9, 3.825749250522294*^9}, {
   3.825750212530529*^9, 3.825750306422181*^9}, 3.826329791115192*^9, 
   3.846642370756736*^9, {3.851810122920454*^9, 
   3.85181012573288*^9}},ExpressionUUID->"a37bc400-a813-4061-8732-\
8b746194a448"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "@@", 
   RowBox[{"Reverse", "@", 
    RowBox[{"Flatten", "[", "gates", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.825748088994731*^9, 3.825748093951063*^9}, {
   3.825748340134009*^9, 3.8257483643847857`*^9}, {3.8257501672938557`*^9, 
   3.825750168744622*^9}, 3.829808799798212*^9},
 CellLabel->
  "In[231]:=",ExpressionUUID->"c7dd61fe-3679-4604-b55e-44fb7bb074c4"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {11, -1}}, {{0, -2}, {11, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
     LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
      0.6, -2.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -2}, {2, -1}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -1}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -1}, {2.2666666666666666`, -1}}, {{
         2, -1.2666666666666666`}, {2, -0.7333333333333334}}}]}}, {
     LineBox[{{3, -1}, {3, -2}}], DiskBox[{3, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, 
     LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -1.6}, {2.6, -1.6}, {
      2.6, -2.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{4, -2}, {4, -1}}], 
     DiskBox[{4, -2}, 0.09], {CircleBox[{4, -1}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -1}, {4.266666666666667, -1}}, {{
         4, -1.2666666666666666`}, {4, -0.7333333333333334}}}]}}, {
     LineBox[{{5, -1}, {5, -2}}], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5, -1}, 0.09]}, 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, 
     LineBox[{{4.6, -2.4}, {5.4, -2.4}, {5.4, -1.6}, {4.6, -1.6}, {
      4.6, -2.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {5, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{6, -1}, {6, -2}}], 
     DiskBox[{6, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, 
     LineBox[{{5.6, -2.4}, {6.4, -2.4}, {6.4, -1.6}, {5.6, -1.6}, {
      5.6, -2.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {6, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{7, -2}, {7, -1}}], 
     DiskBox[{7, -2}, 0.09], {CircleBox[{7, -1}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -1}, {7.266666666666667, -1}}, {{
         7, -1.2666666666666666`}, {7, -0.7333333333333334}}}]}}, {
     LineBox[{{8, -1}, {8, -2}}], DiskBox[{8, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{7.6, -2.4}, {8.4, -1.6}]}, 
     LineBox[{{7.6, -2.4}, {8.4, -2.4}, {8.4, -1.6}, {7.6, -1.6}, {
      7.6, -2.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {8, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{9, -2}, {9, -1}}], 
     DiskBox[{9, -2}, 0.09], {CircleBox[{9, -1}, 0.26666666666666666], 
      LineBox[{{{8.733333333333333, -1}, {9.266666666666667, -1}}, {{
         9, -1.2666666666666666`}, {9, -0.7333333333333334}}}]}}, {
     LineBox[{{10, -1}, {10, -2}}], DiskBox[{10, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{9.6, -2.4}, {10.4, -1.6}]}, 
     LineBox[{{9.6, -2.4}, {10.4, -2.4}, {10.4, -1.6}, {9.6, -1.6}, {
      9.6, -2.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {10, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->442.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`ControlledU[{
      $CellContext`S[1, Q3`$]} -> {1}, Rational[-1, 2] 7^Rational[-1, 2] + 
    Complex[0, 
       Rational[-3, 2]] 7^Rational[-1, 2] $CellContext`S[2, 1] + Complex[0, 
       Rational[3, 2]] 7^Rational[-1, 2] $CellContext`S[2, 2] + Complex[0, 
       Rational[3, 2]] 7^Rational[-1, 2] $CellContext`S[2, 3], "Label" -> 
    "U"], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[1, Q3`$]}], 
   Q3`ControlledU[{
      $CellContext`S[1, Q3`$]} -> {1}, -38^Rational[-1, 2] + 
    Complex[0, -1] Rational[14, 19]^Rational[1, 2] $CellContext`S[2, 2] + 
    Complex[0, -3] 38^Rational[-1, 2] $CellContext`S[2, 3], "Label" -> "U"], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[1, Q3`$]}], 
   Q3`ControlledU[{
      $CellContext`S[1, Q3`$]} -> {0}, Rational[-1, 2] 2^Rational[-1, 2] + 
    Complex[0, 
       Rational[1, 6]] 19^Rational[1, 2] $CellContext`S[2, 2] + Complex[0, 
       Rational[-5, 6]] 2^Rational[-1, 2] $CellContext`S[2, 3], "Label" -> 
    "U"], 
   Q3`ControlledU[{
      $CellContext`S[1, Q3`$]} -> {1}, Rational[-5, 14] 2^Rational[-1, 2] + 
    Complex[0, 
       Rational[3, 14]] 19^Rational[1, 2] $CellContext`S[2, 2] + Complex[0, 
       Rational[-5, 14]] 2^Rational[-1, 2] $CellContext`S[2, 3], "Label" -> 
    "U"], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[1, Q3`$]}], 
   Q3`ControlledU[{
      $CellContext`S[1, Q3`$]} -> {1}, -38^Rational[-1, 2] + 
    Complex[0, -1] Rational[14, 19]^Rational[1, 2] $CellContext`S[2, 2] + 
    Complex[0, -3] 38^Rational[-1, 2] $CellContext`S[2, 3], "Label" -> "U"], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[1, Q3`$]}], 
   Q3`ControlledU[{
      $CellContext`S[1, Q3`$]} -> {1}, Rational[1, 2] 7^Rational[-1, 2] + 
    Complex[0, 
       Rational[-3, 2]] 7^Rational[-1, 2] $CellContext`S[2, 1] + Complex[0, 
       Rational[-3, 2]] 7^Rational[-1, 2] $CellContext`S[2, 2] + Complex[0, 
       Rational[-3, 2]] 7^Rational[-1, 2] $CellContext`S[2, 3], "Label" -> 
    "U"]]]], "Output",
 CellChangeTimes->{{3.825748095779315*^9, 3.8257480982375097`*^9}, {
   3.825748334308405*^9, 3.825748366479651*^9}, 3.8257488601340857`*^9, 
   3.825748909430749*^9, 3.8257492519119377`*^9, 3.8257493738164186`*^9, 
   3.825750084412476*^9, {3.825750169967392*^9, 3.82575020587319*^9}, 
   3.825750315779475*^9, 3.826055284069018*^9, 3.826144949652862*^9, 
   3.8263297187163887`*^9, 3.826329792916909*^9, 3.826333661782683*^9, 
   3.830143569304783*^9, 3.836211390356324*^9, 3.839373020728981*^9, 
   3.8397145444339037`*^9, {3.849257153602627*^9, 3.849257165190259*^9}, 
   3.851810190111497*^9, 3.869388018083644*^9, 3.885076332473205*^9},
 CellLabel->"Out[231]=",
 CellID->1767605219,ExpressionUUID->"86cdc4d7-f73d-4d1b-aea3-f13d50e907c5"]
}, Open  ]],

Cell["\<\
Check the above quantum circuit by converting it into the matrix \
representation.\
\>", "Text",
 CellChangeTimes->{{3.8257503369239273`*^9, 
  3.825750362199614*^9}},ExpressionUUID->"9ad5e768-cc99-4d70-bbba-\
3dab12973a1e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", "[", "qc", "]"}], "//", "Normal"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.825749254419982*^9, 3.8257492958448477`*^9}, {
  3.8257493343548517`*^9, 3.825749338962596*^9}, {3.849257250519215*^9, 
  3.8492572628384123`*^9}},
 CellLabel->
  "In[232]:=",ExpressionUUID->"5c8cfbf7-22e5-4a08-97d5-57c06e1cea61"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.825749267248691*^9, 3.82574929629888*^9}, 
   3.825749339360044*^9, {3.825749375165617*^9, 3.8257493997653303`*^9}, 
   3.8257501712236433`*^9, 3.8257502076375837`*^9, 3.825750316882627*^9, 
   3.825750363653665*^9, 3.8260552859632196`*^9, 3.826144951196773*^9, 
   3.8263297188711348`*^9, 3.8263297945692863`*^9, 3.826333661933935*^9, 
   3.8301435710387363`*^9, 3.836211391876561*^9, 3.839373022272229*^9, 
   3.839714546136497*^9, 3.849257263273788*^9, 3.851810190180049*^9, 
   3.869388019808358*^9, 3.88507633564429*^9},
 CellLabel->"Out[233]//MatrixForm=",
 CellID->439670953,ExpressionUUID->"79c9dbe4-b8cb-4514-8dde-6128a83640bf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"new", "-", "matU"}], "//", "Simplify"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.825749378536199*^9, 3.82574942461269*^9}},
 CellLabel->
  "In[234]:=",ExpressionUUID->"d5da649f-8eaf-4db0-872b-470c4892c285"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.825749380770463*^9, 3.825749424852693*^9}, 
   3.8257501721929007`*^9, 3.825750208542255*^9, 3.825750317585885*^9, 
   3.825750365184527*^9, 3.8260552874581747`*^9, 3.826144952008738*^9, 
   3.826329718924679*^9, 3.826329796306614*^9, 3.826333661941923*^9, 
   3.830143572598605*^9, 3.8362113938990173`*^9, 3.83937302400979*^9, 
   3.839714548363134*^9, 3.8492572656397543`*^9, 3.851810190184733*^9, 
   3.869388021243827*^9, 3.885076337334395*^9},
 CellLabel->"Out[234]//MatrixForm=",
 CellID->265553613,ExpressionUUID->"0c345eec-13aa-4b78-a149-79adedf916b8"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Multi-Control Unitary Gates", "Section",
 CellChangeTimes->{{3.826964613763344*^9, 3.826964618847507*^9}, {
  3.8466432278312597`*^9, 3.846643233430623*^9}},
 CellTags->"Section35",
 CellID->882238498,ExpressionUUID->"639f1f48-d332-4fd1-9f8d-0ae85404cd50"],

Cell[CellGroupData[{

Cell["This is a three-control unitary gate.", "MathCaption",
 CellChangeTimes->{{3.826147550561845*^9, 3.826147568155792*^9}, {
  3.846642397476997*^9, 3.8466424020069017`*^9}, {3.8466433393512993`*^9, 
  3.8466433396540403`*^9}, {3.856676413834412*^9, 
  3.856676415257227*^9}},ExpressionUUID->"96411d32-1277-4d4c-9750-\
fbb4773e5e49"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"4", ",", "1"}], "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8189167115205383`*^9, 3.8189167694392633`*^9}, {
   3.8262257626106377`*^9, 3.826225774972527*^9}, {3.8262259718606453`*^9, 
   3.8262259972050257`*^9}, {3.826226034947607*^9, 3.826226042146637*^9}, {
   3.8262260948965273`*^9, 3.826226100677535*^9}, {3.8262263282424593`*^9, 
   3.8262263315490637`*^9}, 3.8263298012850437`*^9, 3.829808799804418*^9},
 CellLabel->
  "In[235]:=",ExpressionUUID->"647fe4eb-2dab-482e-9360-37659dc64fa6"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
     0, -4}, {2, -4}}}], {LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}}], 
     DiskBox[{1, -1}, 0.09], DiskBox[{1, -2}, 0.09], DiskBox[{1, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, 
     LineBox[{{0.6, -4.4}, {1.4, -4.4}, {1.4, -3.6}, {0.6, -3.6}, {
      0.6, -4.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-9, 2], 
       Rational[-1, 2]}}, {Full, {-4.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`ControlledU[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$], 
      $CellContext`S[3, Q3`$]} -> {1, 1, 1}, 
    $CellContext`S[4, 1], "Label" -> "U"]]]], "Output",
 CellChangeTimes->{{3.818916759762372*^9, 3.818916769750588*^9}, 
   3.81968573937654*^9, 3.819804670434827*^9, 3.822806032935378*^9, 
   3.826147569530287*^9, {3.826225764785495*^9, 3.826225775653277*^9}, 
   3.82622620159033*^9, {3.82622633268637*^9, 3.8262263343768167`*^9}, 
   3.8263297189688673`*^9, 3.826329802136222*^9, 3.826333661983268*^9, 
   3.826337984634652*^9, 3.826338065593441*^9, 3.83014357458286*^9, 
   3.836211395681419*^9, 3.839373025593491*^9, 3.839714550565032*^9, 
   3.8492572695049067`*^9, 3.851810190195945*^9, 3.869388023024279*^9, 
   3.885076339390559*^9},
 CellLabel->"Out[235]=",
 CellID->2014198293,ExpressionUUID->"fb352788-2279-4ade-a960-d6152ea56f16"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Gray-Code Method", "Subsection",
 CellChangeTimes->{{3.818893169096167*^9, 3.818893171593217*^9}, {
  3.852893763096629*^9, 3.8528937666607723`*^9}},
 CellTags->"Section36",
 CellID->1865203558,ExpressionUUID->"dd33b19c-8dfc-4432-9db5-b5ebbb5ab77a"],

Cell[CellGroupData[{

Cell["Consider a three-qubit register as an example.", "MathCaption",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.81889429261147*^9, 
  3.8188943119376993`*^9}},ExpressionUUID->"7cb3e065-f9ff-4e28-929d-\
b4d1c5e0ae2c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$L", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jj", "=", 
   RowBox[{"Range", "[", "$L", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"S", "[", 
    RowBox[{"jj", ",", "$"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.818893283491221*^9, 3.818893283506422*^9}, {
   3.819805575972657*^9, 3.819805595994481*^9}, {3.819805666520472*^9, 
   3.8198056666082563`*^9}, {3.8238447723311777`*^9, 3.8238447923670588`*^9}, 
   3.885076097044571*^9},
 CellLabel->"In[236]:=",
 CellID->947038696,ExpressionUUID->"0d19ce3b-6693-49d4-822f-5a1c1b5140d2"],

Cell["This is the gate to operate on the target qubit.", "Text",
 CellChangeTimes->{{3.823844785210973*^9, 
  3.823844833797674*^9}},ExpressionUUID->"a3f69057-086f-466f-8a98-\
25a52619789f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"T", "=", 
   RowBox[{"S", "[", 
    RowBox[{
     RowBox[{"$L", "+", "1"}], ",", "$"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"op", "=", 
  RowBox[{
   RowBox[{"Rotation", "[", 
    RowBox[{
     RowBox[{"Pi", "/", "3"}], ",", 
     RowBox[{"T", "[", "1", "]"}]}], "]"}], "//", "Elaborate"}]}]}], "Input",
 CellChangeTimes->{{3.819829465572304*^9, 3.8198294692161503`*^9}, {
   3.819829875827592*^9, 3.819829876097042*^9}, {3.819841779396325*^9, 
   3.819841779485509*^9}, {3.82384476237543*^9, 3.823844794469706*^9}, {
   3.836211404480187*^9, 3.836211408461618*^9}, 3.885076097778782*^9},
 CellLabel->"In[239]:=",
 CellID->1878055755,ExpressionUUID->"10dd29bc-7c3b-4e0a-a16a-ff97918cc7a0"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SqrtBox["3"], "2"], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"4"}, "RowDefault"], 
       TemplateBox[{"\"x\""}, "RowDefault"]},
      "Subsuperscript"],
     $CellContext`S[4, 1]]}], "2"]}]], "Output",
 CellChangeTimes->{
  3.818893284665743*^9, {3.818893330761344*^9, 3.818893351021337*^9}, {
   3.818893435498892*^9, 3.8188934632976913`*^9}, 3.81889376962414*^9, 
   3.8188939623543997`*^9, 3.8188943345612392`*^9, 3.819804678947275*^9, 
   3.819804785153796*^9, {3.8198055771576567`*^9, 3.819805597138835*^9}, 
   3.819805667965893*^9, 3.81980926050988*^9, 3.819810695679517*^9, 
   3.819829272571353*^9, 3.819829469554784*^9, {3.8198298479698267`*^9, 
   3.819829877167535*^9}, {3.819830722809836*^9, 3.819830730914476*^9}, 
   3.819830793498782*^9, 3.8198413284175262`*^9, {3.819841505513599*^9, 
   3.8198415188668213`*^9}, 3.819841558397957*^9, {3.819841771750594*^9, 
   3.819841779941565*^9}, 3.822806038128683*^9, 3.823844776137556*^9, 
   3.823844835176579*^9, 3.824002083199481*^9, 3.826329719012808*^9, 
   3.826329805679606*^9, 3.826333661994231*^9, 3.826337987784843*^9, 
   3.826338068738627*^9, 3.8301435778567533`*^9, {3.836211398861272*^9, 
   3.836211408846986*^9}, 3.8393730287286987`*^9, 3.839714553651155*^9, 
   3.849257273090987*^9, 3.8518101902021217`*^9, 3.869388026318191*^9, 
   3.88507634267842*^9},
 CellLabel->"Out[240]=",
 CellID->224103340,ExpressionUUID->"efc85586-fe9d-45c6-8663-684905f5c40d"]
}, Open  ]],

Cell["\<\
This decomposes the multi-control unitary gate based on the Gray code -- \
showing only a part of it. Each component is either CNOT or a \
two-qubit-control unitary gate.\
\>", "Text",
 CellChangeTimes->{{3.8188943472948027`*^9, 3.8188944328131*^9}, {
  3.824002063715601*^9, 3.824002075245676*^9}, {3.841779525483386*^9, 
  3.8417795318154907`*^9}, {3.846642412064822*^9, 3.8466424171156073`*^9}, {
  3.846643320272625*^9, 
  3.8466433205513773`*^9}},ExpressionUUID->"e6067341-e968-4420-b9b1-\
b0ff59f351ed"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gc", "=", 
   RowBox[{"GrayControlledU", "[", 
    RowBox[{"cc", ",", "op"}], "]"}]}], ";", " ", 
  RowBox[{"gc", "[", 
   RowBox[{"[", 
    RowBox[{";;", "3"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.819810620941033*^9, 3.81981062332524*^9}, {
  3.819810909968203*^9, 3.819810912171507*^9}, {3.819810979457185*^9, 
  3.819810981233572*^9}, {3.81982926383746*^9, 3.819829267672181*^9}, {
  3.819841575751299*^9, 3.819841579013205*^9}, {3.81984162951612*^9, 
  3.8198416298737793`*^9}, {3.823844842134853*^9, 3.823844844676456*^9}},
 CellLabel->"In[241]:=",
 CellID->1697248997,ExpressionUUID->"c4bfd11f-1235-4f0f-8848-85472af42874"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"S"},
          "RowDefault"], 
         TemplateBox[{"1"},
          "RowDefault"]],
        $CellContext`S[1, Q3`$]], "}"}], "\[Rule]", 
      RowBox[{"{", "1", "}"}]}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["2", 
          RowBox[{"1", "/", "4"}]], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "24"]}]]}], "+", 
        RowBox[{
         SuperscriptBox["2", 
          RowBox[{"1", "/", "4"}]], " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "24"]]}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["2", 
         RowBox[{"1", "/", "4"}]]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "4"}]], " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "24"]}]]}], "-", 
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "4"}]], " ", 
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "24"]]}]}], ")"}], " ", 
        
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"], 
           TemplateBox[{"\"+\""}, "RowDefault"]},
          "Subsuperscript"],
         $CellContext`S[4, 4]]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["2", 
         RowBox[{"1", "/", "4"}]]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "4"}]], " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "24"]}]]}], "-", 
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "4"}]], " ", 
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "24"]]}]}], ")"}], " ", 
        
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"], 
           TemplateBox[{"\"-\""}, "RowDefault"]},
          "Subsuperscript"],
         $CellContext`S[4, 5]]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["2", 
         RowBox[{"1", "/", "4"}]]}]]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"V\"\>"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"S"},
          "RowDefault"], 
         TemplateBox[{"1"},
          "RowDefault"]],
        $CellContext`S[1, Q3`$]], "}"}], "\[Rule]", 
      RowBox[{"{", "1", "}"}]}], ",", 
     RowBox[{"{", 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"2"},
         "RowDefault"]],
       $CellContext`S[2, Q3`$]], "}"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"S"},
          "RowDefault"], 
         TemplateBox[{"2"},
          "RowDefault"]],
        $CellContext`S[2, Q3`$]], "}"}], "\[Rule]", 
      RowBox[{"{", "1", "}"}]}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["2", 
          RowBox[{"1", "/", "4"}]], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "24"]}]]}], "+", 
        RowBox[{
         SuperscriptBox["2", 
          RowBox[{"1", "/", "4"}]], " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "24"]]}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["2", 
         RowBox[{"1", "/", "4"}]]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["2", 
             RowBox[{"1", "/", "4"}]]}], " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "24"]}]]}], "+", 
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "4"}]], " ", 
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "24"]]}]}], ")"}], " ", 
        
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"], 
           TemplateBox[{"\"+\""}, "RowDefault"]},
          "Subsuperscript"],
         $CellContext`S[4, 4]]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["2", 
         RowBox[{"1", "/", "4"}]]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["2", 
             RowBox[{"1", "/", "4"}]]}], " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "24"]}]]}], "+", 
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"1", "/", "4"}]], " ", 
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "24"]]}]}], ")"}], " ", 
        
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"], 
           TemplateBox[{"\"-\""}, "RowDefault"]},
          "Subsuperscript"],
         $CellContext`S[4, 5]]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["2", 
         RowBox[{"1", "/", "4"}]]}]]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", 
      TemplateBox[{"\"V\"", "\"\[Dagger]\""},
       "Superscript"]}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8188932855121202`*^9, {3.818893331545569*^9, 3.818893351751349*^9}, {
   3.8188934361801147`*^9, 3.818893464167491*^9}, 3.818893606356101*^9, 
   3.818893770498527*^9, 3.818893963000091*^9, 3.818894023716249*^9, 
   3.818894335537856*^9, 3.8188943841749487`*^9, 3.818894437840238*^9, 
   3.819804681085297*^9, 3.819804787015271*^9, {3.819805578782106*^9, 
   3.8198055986636457`*^9}, 3.81980566973525*^9, 3.819809262188201*^9, 
   3.819810627509006*^9, {3.819810690029333*^9, 3.819810701586196*^9}, 
   3.8198109125679502`*^9, 3.819810981766224*^9, {3.819829274209483*^9, 
   3.819829300052457*^9}, 3.8198294715225477`*^9, 3.8198297435230017`*^9, {
   3.819829863670824*^9, 3.819829878896983*^9}, 3.819830351160308*^9, 
   3.819830733327448*^9, 3.819830794845769*^9, 3.81983095304914*^9, 
   3.819831165547159*^9, 3.8198412493557167`*^9, 3.8198413303115873`*^9, {
   3.819841506944438*^9, 3.8198415206707373`*^9}, {3.8198415599694777`*^9, 
   3.8198415793184958`*^9}, 3.819841630413694*^9, 3.819841781959922*^9, 
   3.822806041162003*^9, {3.823844837210807*^9, 3.8238448451804323`*^9}, {
   3.824002077181522*^9, 3.824002084643756*^9}, 3.826329719116233*^9, 
   3.826329807256784*^9, 3.826333662094349*^9, 3.826337989647564*^9, 
   3.826338070281982*^9, 3.830143579368149*^9, 3.8362114108180637`*^9, 
   3.8393730303498163`*^9, 3.83971455569877*^9, 3.84925727570502*^9, 
   3.851810190273652*^9, 3.869388027840851*^9, 3.885076344231977*^9},
 CellLabel->"Out[241]=",
 CellID->993031488,ExpressionUUID->"6107d379-6835-46bf-a37a-518dcbab75ee"]
}, Open  ]],

Cell["This is a quantum circuit model of the decomposition.", "Text",
 CellChangeTimes->{{3.81889444060893*^9, 
  3.8188944526572933`*^9}},ExpressionUUID->"bf813263-6327-493f-9ca7-\
1e98201d6ba0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "@@", "gc"}]}]], "Input",
 CellChangeTimes->{{3.81889347383357*^9, 3.818893474496975*^9}, {
   3.8188939829501543`*^9, 3.818893985727943*^9}, 3.826329813782613*^9, 
   3.829808799811569*^9, {3.84925728046903*^9, 3.849257281839685*^9}},
 CellLabel->"In[242]:=",
 CellID->2133712687,ExpressionUUID->"811cc859-6537-44a2-a792-7dce5126894c"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {14, -1}}, {{0, -2}, {14, -2}}, {{0, -3}, {14, -3}}, {{
     0, -4}, {14, -4}}}], {LineBox[{{1, -1}, {1, -4}}], 
     DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, 
     LineBox[{{0.6, -4.4}, {1.4, -4.4}, {1.4, -3.6}, {0.6, -3.6}, {
      0.6, -4.4}}], InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {1, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     LineBox[{{3, -2}, {3, -4}}], DiskBox[{3, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, 
     LineBox[{{2.6, -4.4}, {3.4, -4.4}, {3.4, -3.6}, {2.6, -3.6}, {
      2.6, -4.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"V\"", "\"\[Dagger]\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {3, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{4, -1}, {4, -2}}], 
     DiskBox[{4, -1}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
         4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {
     LineBox[{{5, -2}, {5, -4}}], DiskBox[{5, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, 
     LineBox[{{4.6, -4.4}, {5.4, -4.4}, {5.4, -3.6}, {4.6, -3.6}, {
      4.6, -4.4}}], InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {5, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{6, -2}, {6, -3}}], 
     DiskBox[{6, -2}, 0.09], {CircleBox[{6, -3}, 0.26666666666666666], 
      LineBox[{{{5.733333333333333, -3}, {6.266666666666667, -3}}, {{
         6, -3.2666666666666666`}, {6, -2.7333333333333334`}}}]}}, {
     LineBox[{{7, -3}, {7, -4}}], DiskBox[{7, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, 
     LineBox[{{6.6, -4.4}, {7.4, -4.4}, {7.4, -3.6}, {6.6, -3.6}, {
      6.6, -4.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"V\"", "\"\[Dagger]\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {7, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{8, -1}, {8, -3}}], 
     DiskBox[{8, -1}, 0.09], {CircleBox[{8, -3}, 0.26666666666666666], 
      LineBox[{{{7.733333333333333, -3}, {8.266666666666667, -3}}, {{
         8, -3.2666666666666666`}, {8, -2.7333333333333334`}}}]}}, {
     LineBox[{{9, -3}, {9, -4}}], DiskBox[{9, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{8.6, -4.4}, {9.4, -3.6}]}, 
     LineBox[{{8.6, -4.4}, {9.4, -4.4}, {9.4, -3.6}, {8.6, -3.6}, {
      8.6, -4.4}}], InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {9, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{10, -2}, {10, -3}}], 
     DiskBox[{10, -2}, 0.09], {CircleBox[{10, -3}, 0.26666666666666666], 
      LineBox[{{{9.733333333333333, -3}, {10.266666666666667`, -3}}, {{
         10, -3.2666666666666666`}, {10, -2.7333333333333334`}}}]}}, {
     LineBox[{{11, -3}, {11, -4}}], DiskBox[{11, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{10.6, -4.4}, {11.4, -3.6}]},
      LineBox[{{10.6, -4.4}, {11.4, -4.4}, {11.4, -3.6}, {10.6, -3.6}, {
      10.6, -4.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"V\"", "\"\[Dagger]\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {11, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{12, -1}, {12, -3}}], 
     DiskBox[{12, -1}, 0.09], {CircleBox[{12, -3}, 0.26666666666666666], 
      LineBox[{{{11.733333333333333`, -3}, {12.266666666666667`, -3}}, {{
         12, -3.2666666666666666`}, {12, -2.7333333333333334`}}}]}}, {
     LineBox[{{13, -3}, {13, -4}}], DiskBox[{13, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{12.6, -4.4}, {13.4, -3.6}]},
      LineBox[{{12.6, -4.4}, {13.4, -4.4}, {13.4, -3.6}, {12.6, -3.6}, {
      12.6, -4.4}}], InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {13, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->550.8000000000001,
   PlotRange->NCache[{Full, {
       Rational[-9, 2], 
       Rational[-1, 2]}}, {Full, {-4.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`ControlledU[{
      $CellContext`S[1, Q3`$]} -> {1}, 
    Rational[1, 2] 2^Rational[-1, 4] (2^Rational[1, 4] E^(Complex[0, 
           Rational[-1, 24]] Pi) + 2^Rational[1, 4] E^(Complex[0, 
           Rational[1, 24]] Pi)) + 
    Rational[1, 2] 2^Rational[-1, 4] (2^Rational[1, 4] E^(Complex[0, 
           Rational[-1, 24]] Pi) - 2^Rational[1, 4] E^(Complex[0, 
          Rational[1, 24]] Pi)) $CellContext`S[4, 4] + 
    Rational[1, 2] 2^Rational[-1, 4] (2^Rational[1, 4] E^(Complex[0, 
           Rational[-1, 24]] Pi) - 2^Rational[1, 4] E^(Complex[0, 
          Rational[1, 24]] Pi)) $CellContext`S[4, 5], "Label" -> "V"], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`ControlledU[{
      $CellContext`S[2, Q3`$]} -> {1}, 
    Rational[1, 2] 2^Rational[-1, 4] (2^Rational[1, 4] E^(Complex[0, 
           Rational[-1, 24]] Pi) + 2^Rational[1, 4] E^(Complex[0, 
           Rational[1, 24]] Pi)) + 
    Rational[1, 2] 2^Rational[-1, 4] (-2^Rational[1, 4] E^(Complex[0, 
           Rational[-1, 24]] Pi) + 2^Rational[1, 4] E^(Complex[0, 
           Rational[1, 24]] Pi)) $CellContext`S[4, 4] + 
    Rational[1, 2] 2^Rational[-1, 4] (-2^Rational[1, 4] E^(Complex[0, 
           Rational[-1, 24]] Pi) + 2^Rational[1, 4] E^(Complex[0, 
           Rational[1, 24]] Pi)) $CellContext`S[4, 5], "Label" -> 
    Superscript["V", "\[Dagger]"]], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`ControlledU[{
      $CellContext`S[2, Q3`$]} -> {1}, 
    Rational[1, 2] 2^Rational[-1, 4] (2^Rational[1, 4] E^(Complex[0, 
           Rational[-1, 24]] Pi) + 2^Rational[1, 4] E^(Complex[0, 
           Rational[1, 24]] Pi)) + 
    Rational[1, 2] 2^Rational[-1, 4] (2^Rational[1, 4] E^(Complex[0, 
           Rational[-1, 24]] Pi) - 2^Rational[1, 4] E^(Complex[0, 
          Rational[1, 24]] Pi)) $CellContext`S[4, 4] + 
    Rational[1, 2] 2^Rational[-1, 4] (2^Rational[1, 4] E^(Complex[0, 
           Rational[-1, 24]] Pi) - 2^Rational[1, 4] E^(Complex[0, 
          Rational[1, 24]] Pi)) $CellContext`S[4, 5], "Label" -> "V"], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[3, Q3`$]}], 
   Q3`ControlledU[{
      $CellContext`S[3, Q3`$]} -> {1}, 
    Rational[1, 2] 2^Rational[-1, 4] (2^Rational[1, 4] E^(Complex[0, 
           Rational[-1, 24]] Pi) + 2^Rational[1, 4] E^(Complex[0, 
           Rational[1, 24]] Pi)) + 
    Rational[1, 2] 2^Rational[-1, 4] (-2^Rational[1, 4] E^(Complex[0, 
           Rational[-1, 24]] Pi) + 2^Rational[1, 4] E^(Complex[0, 
           Rational[1, 24]] Pi)) $CellContext`S[4, 4] + 
    Rational[1, 2] 2^Rational[-1, 4] (-2^Rational[1, 4] E^(Complex[0, 
           Rational[-1, 24]] Pi) + 2^Rational[1, 4] E^(Complex[0, 
           Rational[1, 24]] Pi)) $CellContext`S[4, 5], "Label" -> 
    Superscript["V", "\[Dagger]"]], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[3, Q3`$]}], 
   Q3`ControlledU[{
      $CellContext`S[3, Q3`$]} -> {1}, 
    Rational[1, 2] 2^Rational[-1, 4] (2^Rational[1, 4] E^(Complex[0, 
           Rational[-1, 24]] Pi) + 2^Rational[1, 4] E^(Complex[0, 
           Rational[1, 24]] Pi)) + 
    Rational[1, 2] 2^Rational[-1, 4] (2^Rational[1, 4] E^(Complex[0, 
           Rational[-1, 24]] Pi) - 2^Rational[1, 4] E^(Complex[0, 
          Rational[1, 24]] Pi)) $CellContext`S[4, 4] + 
    Rational[1, 2] 2^Rational[-1, 4] (2^Rational[1, 4] E^(Complex[0, 
           Rational[-1, 24]] Pi) - 2^Rational[1, 4] E^(Complex[0, 
          Rational[1, 24]] Pi)) $CellContext`S[4, 5], "Label" -> "V"], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$]} -> {1}, {
     $CellContext`S[3, Q3`$]}], 
   Q3`ControlledU[{
      $CellContext`S[3, Q3`$]} -> {1}, 
    Rational[1, 2] 2^Rational[-1, 4] (2^Rational[1, 4] E^(Complex[0, 
           Rational[-1, 24]] Pi) + 2^Rational[1, 4] E^(Complex[0, 
           Rational[1, 24]] Pi)) + 
    Rational[1, 2] 2^Rational[-1, 4] (-2^Rational[1, 4] E^(Complex[0, 
           Rational[-1, 24]] Pi) + 2^Rational[1, 4] E^(Complex[0, 
           Rational[1, 24]] Pi)) $CellContext`S[4, 4] + 
    Rational[1, 2] 2^Rational[-1, 4] (-2^Rational[1, 4] E^(Complex[0, 
           Rational[-1, 24]] Pi) + 2^Rational[1, 4] E^(Complex[0, 
           Rational[1, 24]] Pi)) $CellContext`S[4, 5], "Label" -> 
    Superscript["V", "\[Dagger]"]], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[3, Q3`$]}], 
   Q3`ControlledU[{
      $CellContext`S[3, Q3`$]} -> {1}, 
    Rational[1, 2] 2^Rational[-1, 4] (2^Rational[1, 4] E^(Complex[0, 
           Rational[-1, 24]] Pi) + 2^Rational[1, 4] E^(Complex[0, 
           Rational[1, 24]] Pi)) + 
    Rational[1, 2] 2^Rational[-1, 4] (2^Rational[1, 4] E^(Complex[0, 
           Rational[-1, 24]] Pi) - 2^Rational[1, 4] E^(Complex[0, 
          Rational[1, 24]] Pi)) $CellContext`S[4, 4] + 
    Rational[1, 2] 2^Rational[-1, 4] (2^Rational[1, 4] E^(Complex[0, 
           Rational[-1, 24]] Pi) - 2^Rational[1, 4] E^(Complex[0, 
          Rational[1, 24]] Pi)) $CellContext`S[4, 5], "Label" -> 
    "V"]]]], "Output",
 CellChangeTimes->{
  3.818893286699377*^9, {3.8188933322832117`*^9, 3.818893354175539*^9}, {
   3.8188934369079123`*^9, 3.8188934751510487`*^9}, {3.818893891793996*^9, 
   3.818893906079411*^9}, {3.8188939669659767`*^9, 3.818893987755803*^9}, 
   3.818894024702594*^9, 3.818894336388372*^9, 3.819804686997624*^9, 
   3.81980478887497*^9, {3.8198055805950737`*^9, 3.8198056020894833`*^9}, 
   3.819805677140562*^9, 3.819809269755013*^9, 3.819810703369684*^9, 
   3.819810916961071*^9, 3.819810985980136*^9, 3.8198294799137707`*^9, {
   3.8198298671734743`*^9, 3.819829883941502*^9}, {3.819830821742236*^9, 
   3.819830830959455*^9}, 3.819830954943733*^9, 3.8198311690817738`*^9, 
   3.819841256629427*^9, 3.819841337435464*^9, 3.8198415244560328`*^9, {
   3.8198415618172693`*^9, 3.819841583361848*^9}, 3.819841632013712*^9, 
   3.8198417837466373`*^9, 3.822806043254528*^9, 3.8238448624699707`*^9, 
   3.824002086620577*^9, 3.8263297191640387`*^9, {3.82632980899685*^9, 
   3.82632981421809*^9}, 3.8263336621386757`*^9, 3.8263380733732224`*^9, 
   3.830143580905821*^9, 3.836211412285386*^9, 3.839373031681066*^9, 
   3.839714557858185*^9, {3.849257277798991*^9, 3.84925728235804*^9}, 
   3.851810190323721*^9, 3.869388029671118*^9, 3.8850763460329313`*^9},
 CellLabel->"Out[242]=",
 CellID->1462399584,ExpressionUUID->"9bfd08ec-56b3-483e-9d20-7180c4b63931"]
}, Open  ]],

Cell["Finally check the result.", "Text",
 CellChangeTimes->{{3.818894461825387*^9, 
  3.818894467236657*^9}},ExpressionUUID->"35d7666c-b5ee-4ad7-9186-\
e86da9e2e488"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"expr", "=", 
   RowBox[{"ExpressionFor", "[", "qc", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expr2", "=", 
   RowBox[{
    RowBox[{"ControlledU", "[", 
     RowBox[{"cc", ",", "op"}], "]"}], "//", "Elaborate"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expr", "-", "expr2"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.819805622386992*^9, 3.819805638923142*^9}, {
   3.819805682566461*^9, 3.819805702630868*^9}, {3.8198107410659237`*^9, 
   3.8198107632935247`*^9}, 3.819829488880768*^9, {3.8198416402805643`*^9, 
   3.819841643115018*^9}, {3.8238448754447937`*^9, 3.82384487679424*^9}, 
   3.83014341116459*^9, {3.836211421096149*^9, 3.8362114416809473`*^9}},
 CellLabel->"In[243]:=",
 CellID->818174054,ExpressionUUID->"d982bf28-e442-4a62-9e5f-f17c0c83722d"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.8188933624626226`*^9, {3.818893438339155*^9, 3.818893466608199*^9}, {
   3.8188939759181767`*^9, 3.818893989267692*^9}, 3.8188940263355513`*^9, 
   3.818894338721209*^9, 3.8188944704103203`*^9, 3.8198047971629457`*^9, {
   3.819805606305785*^9, 3.819805639283317*^9}, {3.819805685565786*^9, 
   3.8198057041616364`*^9}, 3.8198106434063263`*^9, 3.819810706092255*^9, {
   3.819810748398739*^9, 3.819810766783964*^9}, 3.8198109912429113`*^9, {
   3.819829485263402*^9, 3.819829489745191*^9}, {3.819829869489457*^9, 
   3.819829893112516*^9}, 3.819830864511333*^9, 3.819831179763674*^9, 
   3.8198412792016907`*^9, 3.819841354448694*^9, {3.81984153981325*^9, 
   3.819841585855583*^9}, {3.819841633832597*^9, 3.81984164416969*^9}, 
   3.81984178567155*^9, 3.822806046708206*^9, 3.82384487895321*^9, 
   3.8240020897090178`*^9, 3.826329720587729*^9, 3.826329816758874*^9, 
   3.82633366351337*^9, 3.826338076615706*^9, 3.8301435838833857`*^9, {
   3.836211415137368*^9, 3.8362114426291533`*^9}, 3.839373034444008*^9, 
   3.839714560821535*^9, 3.849257285006935*^9, 3.851810191047764*^9, 
   3.86938803175854*^9, 3.885076348772059*^9},
 CellLabel->"Out[245]=",
 CellID->661761725,ExpressionUUID->"3214eb20-4f5e-482d-9e4c-f7d76b8f23aa"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Multi-Control NOT Gate", "Subsection",
 CellChangeTimes->{{3.81889314380728*^9, 3.8188931636621227`*^9}, {
  3.841779625172986*^9, 3.841779636249631*^9}, {3.846643889671829*^9, 
  3.846643889962195*^9}},
 CellTags->"Section37",
 CellID->2106499675,ExpressionUUID->"fbf69b18-c702-4427-836a-9dd06010c9dc"],

Cell[CellGroupData[{

Cell["\<\
This shows a generalized CNOT gate, controlled by three qubits rather than a \
single qubit.\
\>", "MathCaption",
 CellChangeTimes->{{3.818918732690956*^9, 3.818918799163156*^9}, {
  3.822450581939344*^9, 3.822450595775689*^9}, {3.8261450927791233`*^9, 
  3.826145158138626*^9}, {3.8417795846583967`*^9, 
  3.8417796181490173`*^9}},ExpressionUUID->"f1224d59-0d80-4db0-a22e-\
0a681a9db365"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ",", 
     RowBox[{"S", "[", "4", "]"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8189167115205383`*^9, 3.8189167694392633`*^9}, {
   3.818917062283753*^9, 3.818917190965084*^9}, {3.818917228088965*^9, 
   3.818917229426874*^9}, {3.81891731446873*^9, 3.8189173446930017`*^9}, {
   3.8189179622625837`*^9, 3.81891796309404*^9}, {3.8189185624957237`*^9, 
   3.818918678390057*^9}, {3.81980361250066*^9, 3.819803614513054*^9}, {
   3.822450607993363*^9, 3.822450618229458*^9}, {3.824001879894444*^9, 
   3.824001890887953*^9}, {3.824002017594308*^9, 3.824002017795327*^9}, {
   3.826145056275401*^9, 3.8261450626760387`*^9}, 3.826329821376112*^9, 
   3.829808799819642*^9},
 CellLabel->
  "In[246]:=",ExpressionUUID->"837e328e-6e89-4936-b84c-50e6d66b7125"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
     0, -4}, {2, -4}}}], {LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}}], 
     DiskBox[{1, -1}, 0.09], DiskBox[{1, -2}, 0.09], 
     DiskBox[{1, -3}, 0.09], {CircleBox[{1, -4}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -4}, {1.2666666666666666`, -4}}, {{
         1, -4.266666666666667}, {1, -3.7333333333333334`}}}]}}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-9, 2], 
       Rational[-1, 2]}}, {Full, {-4.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$], 
      $CellContext`S[3, Q3`$]} -> {1, 1, 1}, {
     $CellContext`S[4, Q3`$]}]]]], "Output",
 CellChangeTimes->{{3.818918659250866*^9, 3.8189187152026663`*^9}, {
   3.818918790763978*^9, 3.8189188027530117`*^9}, 3.818921210897138*^9, 
   3.819804673637415*^9, {3.8224506232048683`*^9, 3.822450634015456*^9}, 
   3.8228060343507032`*^9, 3.8240018924751673`*^9, 3.8240019466574287`*^9, 
   3.8240020200161343`*^9, {3.826145063365099*^9, 3.82614506495258*^9}, {
   3.826145160009324*^9, 3.826145165569203*^9}, 3.826329720709202*^9, 
   3.826329821772766*^9, 3.826333663624393*^9, 3.830143586119748*^9, 
   3.836211444930305*^9, 3.839373035113638*^9, 3.839714561670189*^9, 
   3.849257292564108*^9, 3.851810191094769*^9, 3.869388033505383*^9, 
   3.8850763507843523`*^9},
 CellLabel->"Out[246]=",
 CellID->1843702880,ExpressionUUID->"ae1a94e4-933f-419b-83e6-e74a95dabe21"]
}, Open  ]],

Cell["\<\
Here is the explicit expression of the multi-control NOT gate in terms of the \
Pauli operators.\
\>", "Text",
 CellChangeTimes->{{3.826145201010715*^9, 3.82614524072114*^9}, {
  3.8417795485799313`*^9, 3.841779553022399*^9}, {3.8477814659416924`*^9, 
  3.847781466073205*^9}},ExpressionUUID->"9ef47557-2912-47bd-bd01-\
9a885bb44186"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}]], "Input",
 CellChangeTimes->{{3.81891820973888*^9, 3.818918294860776*^9}, {
   3.818918363608721*^9, 3.818918390493059*^9}, {3.8189188817573233`*^9, 
   3.81891891249025*^9}, 3.824001900384553*^9, {3.826145255572693*^9, 
   3.826145255694799*^9}, 3.8301434111685953`*^9},
 CellLabel->
  "In[247]:=",ExpressionUUID->"652335da-6553-413c-bdc2-88af6fbb8d7b"],

Cell[BoxData[
 RowBox[{
  FractionBox["7", "8"], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3]]]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[3, 3]]]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[4, 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[4, 1]]]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[4, 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 3], 
     $CellContext`S[4, 1]]]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[4, 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[3, 3], 
     $CellContext`S[4, 1]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[4, 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3], 
     $CellContext`S[4, 1]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[4, 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[3, 3], 
     $CellContext`S[4, 1]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[4, 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3], 
     $CellContext`S[4, 1]]]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[4, 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3], 
     $CellContext`S[4, 1]]]}], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[1, 3]], "8"], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"2"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[2, 3]], "8"], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[3, 3]], "8"], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"4"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[4, 1]], "8"]}]], "Output",
 CellChangeTimes->{
  3.8240019014059563`*^9, 3.824001948706102*^9, 3.824002024498931*^9, {
   3.826145242140149*^9, 3.826145256052638*^9}, 3.826329720754607*^9, 
   3.826329823896707*^9, 3.826333663655777*^9, 3.830143587512005*^9, 
   3.836211447047986*^9, 3.8393730371191807`*^9, 3.839714563104476*^9, 
   3.8492572949564457`*^9, 3.851810191116048*^9, 3.869388034874236*^9, 
   3.885076352149317*^9},
 CellLabel->"Out[247]=",
 CellID->1749363107,ExpressionUUID->"317c4297-b371-4827-9d5b-041833160278"]
}, Open  ]],

Cell["\<\
Here we compare it with the expression explicitly constructed in terms of a \
projection operator.\
\>", "Text",
 CellChangeTimes->{{3.8189188284339943`*^9, 3.8189188767731543`*^9}, {
  3.826145287058618*^9, 3.826145288026266*^9}, {3.8261453272421427`*^9, 
  3.8261453403252363`*^9}},ExpressionUUID->"cca3c7c0-fc0c-4173-88fd-\
17b637c58d14"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"prj", "=", 
   RowBox[{"Multiply", "@@", 
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "11"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "prj"}], ")"}], "+", 
   RowBox[{"prj", "**", 
    RowBox[{"S", "[", 
     RowBox[{"4", ",", "1"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"op", "-", "new"}], "//", "Elaborate"}]}], "Input",
 CellChangeTimes->{{3.81891820973888*^9, 3.818918294860776*^9}, {
  3.818918363608721*^9, 3.818918390493059*^9}, {3.8189188817573233`*^9, 
  3.81891891249025*^9}, {3.824001900384553*^9, 3.824001912061225*^9}, {
  3.826145271781987*^9, 3.826145302482169*^9}},
 CellLabel->
  "In[248]:=",ExpressionUUID->"bb47bb06-d1c1-40c7-ab9b-aaf34f0a3fd5"],

Cell[BoxData[
 RowBox[{"1", "-", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"\"(\"", 
           TemplateBox[{"1"}, "Ket"], 
           TemplateBox[{"1"}, "Bra"], "\")\""}, "RowDefault"], 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        $CellContext`S[1, 11]], 
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"\"(\"", 
           TemplateBox[{"1"}, "Ket"], 
           TemplateBox[{"1"}, "Bra"], "\")\""}, "RowDefault"], 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        $CellContext`S[2, 11]], 
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"\"(\"", 
           TemplateBox[{"1"}, "Ket"], 
           TemplateBox[{"1"}, "Bra"], "\")\""}, "RowDefault"], 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]], 
        $CellContext`S[3, 11]]}, "RowDefault"]},
    "RowDefault"],
   Q3`Multiply[
    $CellContext`S[1, 11], 
    $CellContext`S[2, 11], 
    $CellContext`S[3, 11]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"\"(\"", 
           TemplateBox[{"1"}, "Ket"], 
           TemplateBox[{"1"}, "Bra"], "\")\""}, "RowDefault"], 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        $CellContext`S[1, 11]], 
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"\"(\"", 
           TemplateBox[{"1"}, "Ket"], 
           TemplateBox[{"1"}, "Bra"], "\")\""}, "RowDefault"], 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]], 
        $CellContext`S[2, 11]], 
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"\"(\"", 
           TemplateBox[{"1"}, "Ket"], 
           TemplateBox[{"1"}, "Bra"], "\")\""}, "RowDefault"], 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`S[3, Q3`$]]], 
        $CellContext`S[3, 11]], 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"4"}, "RowDefault"], 
          TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", SyntaxForm -> 
         SubsuperscriptBox], 
        $CellContext`S[4, 1]]}, "RowDefault"]},
    "RowDefault"],
   Q3`Multiply[
    $CellContext`S[1, 11], 
    $CellContext`S[2, 11], 
    $CellContext`S[3, 11], 
    $CellContext`S[4, 1]]]}]], "Output",
 CellChangeTimes->{{3.818918219137451*^9, 3.818918233198244*^9}, {
   3.818918263911606*^9, 3.818918295233986*^9}, {3.818918384936501*^9, 
   3.818918396936674*^9}, {3.818918485541746*^9, 3.818918523052661*^9}, {
   3.818918885331209*^9, 3.8189189161724367`*^9}, 3.818921212245525*^9, 
   3.819804675563073*^9, 3.8224506362817163`*^9, 3.8228060355910177`*^9, {
   3.824001902556982*^9, 3.82400191242992*^9}, {3.8240019500533257`*^9, 
   3.8240019614618998`*^9}, 3.824002026125411*^9, {3.826145302930238*^9, 
   3.82614530555649*^9}, 3.826145342341897*^9, 3.826329720767714*^9, 
   3.826329825488207*^9, 3.826333663667557*^9, 3.830143589362397*^9, 
   3.8362114483767767`*^9, 3.839373038370721*^9, 3.839714564311152*^9, 
   3.849257296549827*^9, 3.8518101911377897`*^9, 3.8693880361775703`*^9, 
   3.885076353544414*^9},
 CellLabel->"Out[249]=",
 CellID->1146485467,ExpressionUUID->"57767aa8-83ab-4fda-b78f-65974124bb97"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.818918219137451*^9, 3.818918233198244*^9}, {
   3.818918263911606*^9, 3.818918295233986*^9}, {3.818918384936501*^9, 
   3.818918396936674*^9}, {3.818918485541746*^9, 3.818918523052661*^9}, {
   3.818918885331209*^9, 3.8189189161724367`*^9}, 3.818921212245525*^9, 
   3.819804675563073*^9, 3.8224506362817163`*^9, 3.8228060355910177`*^9, {
   3.824001902556982*^9, 3.82400191242992*^9}, {3.8240019500533257`*^9, 
   3.8240019614618998`*^9}, 3.824002026125411*^9, {3.826145302930238*^9, 
   3.82614530555649*^9}, 3.826145342341897*^9, 3.826329720767714*^9, 
   3.826329825488207*^9, 3.826333663667557*^9, 3.830143589362397*^9, 
   3.8362114483767767`*^9, 3.839373038370721*^9, 3.839714564311152*^9, 
   3.849257296549827*^9, 3.8518101911377897`*^9, 3.8693880361775703`*^9, 
   3.885076353555604*^9},
 CellLabel->"Out[250]=",
 CellID->1757962985,ExpressionUUID->"a06cbf42-bd2b-4141-9d4f-da3da7696e51"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Here we demonstrate a multi-control NOT gate.", "MathCaption",
 CellChangeTimes->{{3.826830747116589*^9, 3.8268307795482483`*^9}, {
  3.84177956661574*^9, 3.8417795692985077`*^9}, {3.846643939732589*^9, 
  3.8466439398204327`*^9}},ExpressionUUID->"465a4919-44b8-44cd-ad53-\
afc5beccc8f9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$m", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"Range", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"$n", "+", "1"}], ",", 
     RowBox[{"$n", "+", "$m"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"$n", "+", "$m", "+", "1"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.826830781126573*^9, 3.82683079277813*^9}, {
  3.826830831420362*^9, 3.8268309254763613`*^9}, {3.8268310165531883`*^9, 
  3.8268310166648808`*^9}, {3.8268313691336327`*^9, 3.826831369211228*^9}, {
  3.826831434527021*^9, 3.8268314580482073`*^9}, {3.826831496197071*^9, 
  3.826831518660447*^9}, {3.826831949004436*^9, 3.826831950004134*^9}, {
  3.82683249166298*^9, 3.826832493100218*^9}},
 CellLabel->
  "In[251]:=",ExpressionUUID->"22f16e28-15e0-4696-955c-e40c60302333"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "cc", "]"}], ",", 
      RowBox[{"S", "[", "tt", "]"}]}], "]"}], ",", 
    RowBox[{"\"\<Visible\>\"", "\[Rule]", 
     RowBox[{"S", "[", "aa", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.826830851211342*^9, 3.8268308571910143`*^9}, {
   3.826830899524446*^9, 3.826831022503096*^9}, 3.829808799832349*^9},
 CellLabel->
  "In[256]:=",ExpressionUUID->"eacf345e-953b-4138-a6c9-7bf00bbff273"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
     0, -4}, {2, -4}}, {{0, -5}, {2, -5}}, {{0, -6}, {2, -6}}, {{0, -7}, {
     2, -7}}}], {LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}, {1, -7}}], 
     DiskBox[{1, -1}, 0.09], DiskBox[{1, -2}, 0.09], DiskBox[{1, -3}, 0.09], 
     DiskBox[{1, -4}, 0.09], {CircleBox[{1, -7}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -7}, {1.2666666666666666`, -7}}, {{
         1, -7.266666666666667}, {1, -6.733333333333333}}}]}}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-15, 2], 
       Rational[-1, 2]}}, {Full, {-7.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$], 
      $CellContext`S[3, Q3`$], 
      $CellContext`S[4, Q3`$]} -> {1, 1, 1, 1}, {
     $CellContext`S[7, Q3`$]}], "Visible" -> {
     $CellContext`S[5], 
     $CellContext`S[6]}]]], "Output",
 CellChangeTimes->{{3.826830944301811*^9, 3.826831025915656*^9}, 
   3.82683137075638*^9, {3.826831435903166*^9, 3.826831460841921*^9}, {
   3.826831500348907*^9, 3.8268315201830482`*^9}, 3.826831571750744*^9, {
   3.8268319379257708`*^9, 3.82683195146319*^9}, 3.8268320453357162`*^9, 
   3.826832494466755*^9, 3.826832567440221*^9, 3.826861235024926*^9, 
   3.830143592082646*^9, 3.8362114512687597`*^9, 3.83937304112022*^9, 
   3.839714567445188*^9, 3.849257300892445*^9, 3.85181019116418*^9, 
   3.869388039473858*^9, 3.885076356833148*^9},
 CellLabel->"Out[256]=",
 CellID->1317138317,ExpressionUUID->"34bb50a1-aefc-4c38-bfad-bfd5f182a9a6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"tofa", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Toffoli", "[", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"$n", "-", "j", "+", "1"}], "]"}], ",", 
       RowBox[{"S", "[", 
        RowBox[{"$n", "+", "$m", "-", "j", "+", "1"}], "]"}], ",", 
       RowBox[{"S", "[", 
        RowBox[{"tt", "-", "j", "+", "1"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "$m"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tofb", "=", 
   RowBox[{"Toffoli", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"$n", "+", "1"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tofc", "=", 
   RowBox[{"Rest", "@", "tofa"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Sequence", "@@", 
    RowBox[{"Flatten", "@", 
     RowBox[{"{", 
      RowBox[{"tofa", ",", "tofb", ",", 
       RowBox[{"Reverse", "@", "tofa"}], ",", "tofc", ",", "tofb", ",", 
       RowBox[{"Reverse", "@", "tofc"}]}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.826831049088729*^9, 3.826831315326623*^9}, {
   3.8268314847328997`*^9, 3.826831485103613*^9}, {3.826831582766026*^9, 
   3.826831654920327*^9}, {3.826831734881762*^9, 3.826831757233824*^9}, {
   3.826831835384283*^9, 3.82683189868399*^9}, {3.826831991481146*^9, 
   3.826831993055386*^9}, {3.826832306241476*^9, 3.826832306555686*^9}, {
   3.826832455983082*^9, 3.826832457433158*^9}, 3.8298087998355083`*^9},
 CellLabel->
  "In[257]:=",ExpressionUUID->"b97fe6b6-ab90-43e9-97bd-bf1e41fb53d9"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {9, -1}}, {{0, -2}, {9, -2}}, {{0, -3}, {9, -3}}, {{
     0, -4}, {9, -4}}, {{0, -5}, {9, -5}}, {{0, -6}, {9, -6}}, {{0, -7}, {
     9, -7}}}], {LineBox[{{1, -4}, {1, -6}, {1, -7}}], DiskBox[{1, -4}, 0.09],
      DiskBox[{1, -6}, 0.09], {CircleBox[{1, -7}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -7}, {1.2666666666666666`, -7}}, {{
         1, -7.266666666666667}, {1, -6.733333333333333}}}]}}, {
     LineBox[{{2, -3}, {2, -5}, {2, -6}}], DiskBox[{2, -3}, 0.09], 
     DiskBox[{2, -5}, 0.09], {CircleBox[{2, -6}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -6}, {2.2666666666666666`, -6}}, {{
         2, -6.266666666666667}, {2, -5.733333333333333}}}]}}, {
     LineBox[{{3, -1}, {3, -2}, {3, -5}}], DiskBox[{3, -1}, 0.09], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -5}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -5}, {3.2666666666666666`, -5}}, {{
         3, -5.266666666666667}, {3, -4.733333333333333}}}]}}, {
     LineBox[{{4, -3}, {4, -5}, {4, -6}}], DiskBox[{4, -3}, 0.09], 
     DiskBox[{4, -5}, 0.09], {CircleBox[{4, -6}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -6}, {4.266666666666667, -6}}, {{
         4, -6.266666666666667}, {4, -5.733333333333333}}}]}}, {
     LineBox[{{5, -4}, {5, -6}, {5, -7}}], DiskBox[{5, -4}, 0.09], 
     DiskBox[{5, -6}, 0.09], {CircleBox[{5, -7}, 0.26666666666666666], 
      LineBox[{{{4.733333333333333, -7}, {5.266666666666667, -7}}, {{
         5, -7.266666666666667}, {5, -6.733333333333333}}}]}}, {
     LineBox[{{6, -3}, {6, -5}, {6, -6}}], DiskBox[{6, -3}, 0.09], 
     DiskBox[{6, -5}, 0.09], {CircleBox[{6, -6}, 0.26666666666666666], 
      LineBox[{{{5.733333333333333, -6}, {6.266666666666667, -6}}, {{
         6, -6.266666666666667}, {6, -5.733333333333333}}}]}}, {
     LineBox[{{7, -1}, {7, -2}, {7, -5}}], DiskBox[{7, -1}, 0.09], 
     DiskBox[{7, -2}, 0.09], {CircleBox[{7, -5}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -5}, {7.266666666666667, -5}}, {{
         7, -5.266666666666667}, {7, -4.733333333333333}}}]}}, {
     LineBox[{{8, -3}, {8, -5}, {8, -6}}], DiskBox[{8, -3}, 0.09], 
     DiskBox[{8, -5}, 0.09], {CircleBox[{8, -6}, 0.26666666666666666], 
      LineBox[{{{7.733333333333333, -6}, {8.266666666666667, -6}}, {{
         8, -6.266666666666667}, {8, -5.733333333333333}}}]}}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->370.8,
   PlotRange->NCache[{Full, {
       Rational[-15, 2], 
       Rational[-1, 2]}}, {Full, {-7.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`Toffoli[
    $CellContext`S[4, Q3`$], 
    $CellContext`S[6, Q3`$], 
    $CellContext`S[7, Q3`$]], 
   Q3`Toffoli[
    $CellContext`S[3, Q3`$], 
    $CellContext`S[5, Q3`$], 
    $CellContext`S[6, Q3`$]], 
   Q3`Toffoli[
    $CellContext`S[1, Q3`$], 
    $CellContext`S[2, Q3`$], 
    $CellContext`S[5, Q3`$]], 
   Q3`Toffoli[
    $CellContext`S[3, Q3`$], 
    $CellContext`S[5, Q3`$], 
    $CellContext`S[6, Q3`$]], 
   Q3`Toffoli[
    $CellContext`S[4, Q3`$], 
    $CellContext`S[6, Q3`$], 
    $CellContext`S[7, Q3`$]], 
   Q3`Toffoli[
    $CellContext`S[3, Q3`$], 
    $CellContext`S[5, Q3`$], 
    $CellContext`S[6, Q3`$]], 
   Q3`Toffoli[
    $CellContext`S[1, Q3`$], 
    $CellContext`S[2, Q3`$], 
    $CellContext`S[5, Q3`$]], 
   Q3`Toffoli[
    $CellContext`S[3, Q3`$], 
    $CellContext`S[5, Q3`$], 
    $CellContext`S[6, Q3`$]]]]], "Output",
 CellChangeTimes->{{3.8268311257543583`*^9, 3.826831191686452*^9}, 
   3.826831222736705*^9, {3.8268312949455843`*^9, 3.826831315947777*^9}, 
   3.8268313716464767`*^9, {3.82683143665658*^9, 3.826831521085062*^9}, 
   3.826831572472424*^9, 3.826831839007882*^9, {3.826831899496696*^9, 
   3.826831904119522*^9}, 3.826831952388197*^9, {3.82683205988664*^9, 
   3.826832085468253*^9}, 3.826832310229649*^9, {3.82683248550093*^9, 
   3.826832495302135*^9}, 3.826832568423223*^9, 3.8268326020005503`*^9, 
   3.826861235924865*^9, 3.8301435937467403`*^9, 3.836211452594282*^9, 
   3.839373042496072*^9, 3.8397145690144653`*^9, 3.8492573044620953`*^9, 
   3.851810191173238*^9, 3.869388040906739*^9, 3.8850763584640493`*^9},
 CellLabel->"Out[260]=",
 CellID->940176936,ExpressionUUID->"6b813d03-9333-471e-b0f2-23756fc63d8f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Elaborate", "[", 
   RowBox[{"qc", "-", "new"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.826832605328438*^9, 3.826832610319395*^9}, {
  3.826861239797401*^9, 3.8268612427892036`*^9}, {3.836211472505137*^9, 
  3.836211475148464*^9}},
 CellLabel->
  "In[261]:=",ExpressionUUID->"348825b8-e5e4-4e5c-817c-ca1967e0ed86"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6.269045`", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.826832622156597*^9, 3.8268612546886997`*^9, 3.830143607356999*^9, {
   3.836211466272108*^9, 3.83621148759157*^9}, 3.839373057293185*^9, 
   3.839714584368746*^9, 3.849257312998928*^9, 3.85181019778975*^9, 
   3.869388049436563*^9, 3.885076366421081*^9},
 CellLabel->"Out[261]=",
 CellID->352296064,ExpressionUUID->"240a0ec2-dd82-4619-ad28-c696bf554750"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["This is a quantum circuit model of the Toffoli gate.", "MathCaption",
 CellChangeTimes->{{3.820579463310761*^9, 3.8205794756736727`*^9}},
 CellID->1169838411,ExpressionUUID->"314dc767-5a4a-4337-8bc8-cf0eea77acb0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Toffoli", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "3", "]"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8205794209969883`*^9, 3.82057945504263*^9}, 
   3.8298087998392677`*^9, 3.830143411182967*^9, 3.856170865969481*^9},
 CellLabel->"In[262]:=",
 CellID->1205134369,ExpressionUUID->"24336e17-5502-47ca-92ae-d1afe52bffe1"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {
     LineBox[{{1, -1}, {1, -2}, {1, -3}}], DiskBox[{1, -1}, 0.09], 
     DiskBox[{1, -2}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
         1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-7, 2], 
       Rational[-1, 2]}}, {Full, {-3.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`Toffoli[
    $CellContext`S[1, Q3`$], 
    $CellContext`S[2, Q3`$], 
    $CellContext`S[3, Q3`$]]]]], "Output",
 CellChangeTimes->{{3.85617086691774*^9, 3.8561708917371273`*^9}, 
   3.856170926206245*^9, 3.869388051272497*^9, 3.885076369112433*^9},
 CellLabel->"Out[262]=",
 CellID->267907265,ExpressionUUID->"db5ba714-81a6-420b-8807-cd3e3df381ec"]
}, Open  ]],

Cell["It can be implemented by a combination of two-qubit gates.", "Text",
 CellChangeTimes->{{3.820579481528133*^9, 3.82057950288626*^9}},
 CellID->1178353731,ExpressionUUID->"6231dc87-45db-47a5-a8bf-c67d74f1be82"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gray", "=", 
   RowBox[{"GrayControlledU", "[", 
    RowBox[{
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"3", ",", "1"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Sequence", "@@", "gray"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8205795050499363`*^9, 3.8205795098045883`*^9}, {
   3.820579581361656*^9, 3.820579586368064*^9}, {3.820579831576614*^9, 
   3.820579848202629*^9}, 3.82980879984451*^9, 3.830143411188003*^9, {
   3.856170830814641*^9, 3.856170844826606*^9}, {3.8561708883721247`*^9, 
   3.8561708890596333`*^9}},
 CellLabel->"In[263]:=",
 CellID->1463439166,ExpressionUUID->"9c3e2c3a-f4e4-4c79-a8b2-2393ee428bef"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}}], {
     LineBox[{{1, -1}, {1, -3}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, 
     LineBox[{{0.6, -3.4}, {1.4, -3.4}, {1.4, -2.6}, {0.6, -2.6}, {
      0.6, -3.4}}], InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     LineBox[{{3, -2}, {3, -3}}], DiskBox[{3, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, 
     LineBox[{{2.6, -3.4}, {3.4, -3.4}, {3.4, -2.6}, {2.6, -2.6}, {
      2.6, -3.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"V\"", "\"\[Dagger]\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{4, -1}, {4, -2}}], 
     DiskBox[{4, -1}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
         4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {
     LineBox[{{5, -2}, {5, -3}}], DiskBox[{5, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, 
     LineBox[{{4.6, -3.4}, {5.4, -3.4}, {5.4, -2.6}, {4.6, -2.6}, {
      4.6, -3.4}}], InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {5, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->262.8,
   PlotRange->NCache[{Full, {
       Rational[-7, 2], 
       Rational[-1, 2]}}, {Full, {-3.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`ControlledU[{
      $CellContext`S[1, Q3`$]} -> {1}, Complex[
      Rational[1, 2], 
      Rational[1, 2]] + Complex[
       Rational[1, 2], 
       Rational[-1, 2]] $CellContext`S[3, 4] + Complex[
       Rational[1, 2], 
       Rational[-1, 2]] $CellContext`S[3, 5], "Label" -> "V"], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`ControlledU[{
      $CellContext`S[2, Q3`$]} -> {1}, Complex[
      Rational[1, 2], 
      Rational[-1, 2]] + Complex[
       Rational[1, 2], 
       Rational[1, 2]] $CellContext`S[3, 4] + Complex[
       Rational[1, 2], 
       Rational[1, 2]] $CellContext`S[3, 5], "Label" -> 
    Superscript["V", "\[Dagger]"]], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`ControlledU[{
      $CellContext`S[2, Q3`$]} -> {1}, Complex[
      Rational[1, 2], 
      Rational[1, 2]] + Complex[
       Rational[1, 2], 
       Rational[-1, 2]] $CellContext`S[3, 4] + Complex[
       Rational[1, 2], 
       Rational[-1, 2]] $CellContext`S[3, 5], "Label" -> "V"]]]], "Output",
 CellChangeTimes->{
  3.856170846312952*^9, {3.856170878024852*^9, 3.856170893044945*^9}, 
   3.856170927573436*^9, 3.86938805290942*^9, 3.885076370703569*^9},
 CellLabel->"Out[264]=",
 CellID->455302621,ExpressionUUID->"fb9528f9-ff82-4842-a4b6-a9370e00aaa3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"qc", "-", "new"}], "//", "Elaborate"}]], "Input",
 CellChangeTimes->{{3.8561708960058317`*^9, 3.8561709004638977`*^9}},
 CellLabel->"In[265]:=",
 CellID->1366415392,ExpressionUUID->"6927ae5c-c34d-4cd6-8d8a-9a322a56ddb1"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.856170900820168*^9, 3.856170928574087*^9}, 
   3.869388082667367*^9, 3.885076372805415*^9},
 CellLabel->"Out[265]=",
 CellID->96920632,ExpressionUUID->"9c3cf3a4-80ef-4a5d-9c72-3498d3f07e80"]
}, Open  ]],

Cell[TextData[{
 "Here ",
 Cell[BoxData[
  StyleBox[
   RowBox[{"V", "=", 
    SqrtBox["X"]}],
   FontSlant->"Italic"]], "InlineFormula",ExpressionUUID->
  "9bbb77d7-686c-4d32-b7f5-27d8131b683d"],
 ", and its matrix representation looks like this."
}], "Text",
 CellChangeTimes->{{3.820579602443269*^9, 3.820579613349983*^9}, {
  3.820579657168229*^9, 3.8205797031329517`*^9}},
 CellID->507963631,ExpressionUUID->"06529a47-042a-48c9-86b9-d6f169ff83ae"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"matV", "=", 
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"ThePauli", "[", "1", "]"}], ",", 
     RowBox[{"1", "/", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matV", "*", 
   RowBox[{"2", "/", 
    RowBox[{"(", 
     RowBox[{"1", "+", "I"}], ")"}]}]}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"opV", "=", 
  RowBox[{"Elaborate", "@", 
   RowBox[{"ExpressionFor", "[", 
    RowBox[{"matV", ",", 
     RowBox[{"S", "[", "3", "]"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.820579715598968*^9, 3.82057981553547*^9}, 
   3.8301434111977167`*^9, {3.830143623215166*^9, 3.8301436244407187`*^9}},
 CellLabel->"In[266]:=",
 CellID->1527310069,ExpressionUUID->"3bdb435f-d573-4afd-a5f2-c96f1388ae3c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", 
      RowBox[{"-", "\[ImaginaryI]"}]},
     {
      RowBox[{"-", "\[ImaginaryI]"}], "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.820579750598075*^9, 3.82057981909744*^9}, 
   3.8207617077904167`*^9, 3.822812965559774*^9, 3.826833543838314*^9, 
   3.826833718291025*^9, {3.8301436136323643`*^9, 3.83014362583641*^9}, 
   3.8362114878804607`*^9, 3.839373062226726*^9, 3.839714588074256*^9, 
   3.849257320046158*^9, 3.851810197879898*^9, 3.8561709077521544`*^9, 
   3.8693880842391644`*^9, 3.885076374240856*^9},
 CellLabel->"Out[267]//MatrixForm=",
 CellID->2080939444,ExpressionUUID->"3f11821d-6d99-4072-871d-855c1abf6354"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    FractionBox["1", "2"], "+", 
    FractionBox["\[ImaginaryI]", "2"]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "2"], "-", 
     FractionBox["\[ImaginaryI]", "2"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[3, 1]]}]}]], "Output",
 CellChangeTimes->{{3.820579750598075*^9, 3.82057981909744*^9}, 
   3.8207617077904167`*^9, 3.822812965559774*^9, 3.826833543838314*^9, 
   3.826833718291025*^9, {3.8301436136323643`*^9, 3.83014362583641*^9}, 
   3.8362114878804607`*^9, 3.839373062226726*^9, 3.839714588074256*^9, 
   3.849257320046158*^9, 3.851810197879898*^9, 3.8561709077521544`*^9, 
   3.8693880842391644`*^9, 3.885076374244185*^9},
 CellLabel->"Out[268]=",
 CellID->430560266,ExpressionUUID->"a7ba9df3-8afc-42f9-81c1-5bb49dc2c562"]
}, Open  ]],

Cell["Reversing the above circuit gives the identical result.", "Text",
 CellChangeTimes->{{3.820579481528133*^9, 3.82057950288626*^9}, {
  3.820579886529335*^9, 3.8205799063390827`*^9}},
 CellID->1796721321,ExpressionUUID->"10388739-29c7-40dd-ac70-26f0c6e68049"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "@@", 
   RowBox[{"Reverse", "@", "gray"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"expr", "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"toff", "-", "expr"}]}], "Input",
 CellChangeTimes->{{3.8205795050499363`*^9, 3.8205795098045883`*^9}, {
   3.820579581361656*^9, 3.820579586368064*^9}, {3.820579831576614*^9, 
   3.820579875043436*^9}, 3.820579978448278*^9, 3.829808799855678*^9, 
   3.830143411201209*^9, {3.849257333930043*^9, 3.849257335523884*^9}},
 CellLabel->"In[269]:=",
 CellID->1727681580,ExpressionUUID->"abea7d87-8b17-4f80-996a-d3594bfc56b1"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}}], {
     LineBox[{{1, -2}, {1, -3}}], DiskBox[{1, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, 
     LineBox[{{0.6, -3.4}, {1.4, -3.4}, {1.4, -2.6}, {0.6, -2.6}, {
      0.6, -3.4}}], InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     LineBox[{{3, -2}, {3, -3}}], DiskBox[{3, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, 
     LineBox[{{2.6, -3.4}, {3.4, -3.4}, {3.4, -2.6}, {2.6, -2.6}, {
      2.6, -3.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"V\"", "\"\[Dagger]\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{4, -1}, {4, -2}}], 
     DiskBox[{4, -1}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
         4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {
     LineBox[{{5, -1}, {5, -3}}], DiskBox[{5, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, 
     LineBox[{{4.6, -3.4}, {5.4, -3.4}, {5.4, -2.6}, {4.6, -2.6}, {
      4.6, -3.4}}], InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {5, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->262.8,
   PlotRange->NCache[{Full, {
       Rational[-7, 2], 
       Rational[-1, 2]}}, {Full, {-3.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`ControlledU[{
      $CellContext`S[2, Q3`$]} -> {1}, Complex[
      Rational[1, 2], 
      Rational[1, 2]] + Complex[
       Rational[1, 2], 
       Rational[-1, 2]] $CellContext`S[3, 4] + Complex[
       Rational[1, 2], 
       Rational[-1, 2]] $CellContext`S[3, 5], "Label" -> "V"], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`ControlledU[{
      $CellContext`S[2, Q3`$]} -> {1}, Complex[
      Rational[1, 2], 
      Rational[-1, 2]] + Complex[
       Rational[1, 2], 
       Rational[1, 2]] $CellContext`S[3, 4] + Complex[
       Rational[1, 2], 
       Rational[1, 2]] $CellContext`S[3, 5], "Label" -> 
    Superscript["V", "\[Dagger]"]], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`ControlledU[{
      $CellContext`S[1, Q3`$]} -> {1}, Complex[
      Rational[1, 2], 
      Rational[1, 2]] + Complex[
       Rational[1, 2], 
       Rational[-1, 2]] $CellContext`S[3, 4] + Complex[
       Rational[1, 2], 
       Rational[-1, 2]] $CellContext`S[3, 5], "Label" -> "V"]]]], "Output",
 CellChangeTimes->{{3.820579875421257*^9, 3.820579907679394*^9}, 
   3.8205799793336153`*^9, 3.8207617096897507`*^9, 3.8228129671714582`*^9, 
   3.826833545304031*^9, 3.826833721593713*^9, {3.83014361563757*^9, 
   3.830143631268662*^9}, 3.836211492811078*^9, 3.839373063796114*^9, 
   3.839714589703133*^9, {3.849257321531952*^9, 3.849257335845366*^9}, 
   3.851810197899194*^9, 3.8693880954751797`*^9, 3.885076375886279*^9},
 CellLabel->"Out[269]=",
 CellID->407711991,ExpressionUUID->"100a228a-7c59-434d-8506-2d30acb2044f"],

Cell[BoxData[
 RowBox[{
  FractionBox["3", "4"], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3]]]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[3, 1]]]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 3], 
     $CellContext`S[3, 1]]]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 1]]]}], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[1, 3]], "4"], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"2"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[2, 3]], "4"], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[3, 1]], "4"]}]], "Output",
 CellChangeTimes->{{3.820579875421257*^9, 3.820579907679394*^9}, 
   3.8205799793336153`*^9, 3.8207617096897507`*^9, 3.8228129671714582`*^9, 
   3.826833545304031*^9, 3.826833721593713*^9, {3.83014361563757*^9, 
   3.830143631268662*^9}, 3.836211492811078*^9, 3.839373063796114*^9, 
   3.839714589703133*^9, {3.849257321531952*^9, 3.849257335845366*^9}, 
   3.851810197899194*^9, 3.8693880954751797`*^9, 3.885076375933742*^9},
 CellLabel->"Out[270]=",
 CellID->1942598807,ExpressionUUID->"b59b714c-d746-49cb-9109-f62c1e610d08"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["3", "4"]}], "+", "toff", "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3]]]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[3, 1]]]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 3], 
     $CellContext`S[3, 1]]]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 1]]]}], "-", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[1, 3]], "4"], "-", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"2"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[2, 3]], "4"], "-", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[3, 1]], "4"]}]], "Output",
 CellChangeTimes->{{3.820579875421257*^9, 3.820579907679394*^9}, 
   3.8205799793336153`*^9, 3.8207617096897507`*^9, 3.8228129671714582`*^9, 
   3.826833545304031*^9, 3.826833721593713*^9, {3.83014361563757*^9, 
   3.830143631268662*^9}, 3.836211492811078*^9, 3.839373063796114*^9, 
   3.839714589703133*^9, {3.849257321531952*^9, 3.849257335845366*^9}, 
   3.851810197899194*^9, 3.8693880954751797`*^9, 3.885076375940089*^9},
 CellLabel->"Out[271]=",
 CellID->1064263908,ExpressionUUID->"912430ee-9d7d-4db2-b22c-98c2915f0905"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
This shows another slightly different implementation of the Toffoli gate.\
\>", "MathCaption",
 CellChangeTimes->{{3.826833747868857*^9, 
  3.826833776720831*^9}},ExpressionUUID->"4552b2e6-7e0f-4bce-b7af-\
5c53bd33b461"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "@@", 
   RowBox[{"Permute", "[", 
    RowBox[{"gray", ",", 
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"4", ",", "3", ",", "2", ",", "1"}], "}"}], "}"}], "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"expr", "=", 
  RowBox[{"ExpressionFor", "[", "qc", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"toff", "-", "expr"}]}], "Input",
 CellChangeTimes->{{3.8205795050499363`*^9, 3.8205795098045883`*^9}, {
   3.820579581361656*^9, 3.820579586368064*^9}, {3.820579831576614*^9, 
   3.820579875043436*^9}, {3.820579978448278*^9, 3.820580062942021*^9}, {
   3.8205801067263193`*^9, 3.820580141327775*^9}, {3.8205802060231333`*^9, 
   3.820580209015559*^9}, {3.8205802769741983`*^9, 3.8205803087298717`*^9}, {
   3.820580360331369*^9, 3.8205804370287237`*^9}, {3.820580496111239*^9, 
   3.8205805217770367`*^9}, {3.8205806701115513`*^9, 3.820580691564076*^9}, 
   3.829808799862279*^9, 3.8301434112080708`*^9, {3.849257345199798*^9, 
   3.8492573466840067`*^9}},
 CellLabel->"In[272]:=",
 CellID->485964845,ExpressionUUID->"672a5c52-bfa3-437c-89d6-28e3b45f0786"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -3}}], DiskBox[{2, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -3.4}, {2.4, -2.6}]}, 
     LineBox[{{1.6, -3.4}, {2.4, -3.4}, {2.4, -2.6}, {1.6, -2.6}, {
      1.6, -3.4}}], InsetBox[
      StyleBox[
       TemplateBox[{"\"V\"", "\"\[Dagger]\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {2, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{3, -1}, {3, -2}}], 
     DiskBox[{3, -1}, 0.09], {CircleBox[{3, -2}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -2}, {3.2666666666666666`, -2}}, {{
         3, -2.2666666666666666`}, {3, -1.7333333333333334`}}}]}}, {
     LineBox[{{4, -1}, {4, -3}}], DiskBox[{4, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, 
     LineBox[{{3.6, -3.4}, {4.4, -3.4}, {4.4, -2.6}, {3.6, -2.6}, {
      3.6, -3.4}}], InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {4, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{5, -2}, {5, -3}}], 
     DiskBox[{5, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, 
     LineBox[{{4.6, -3.4}, {5.4, -3.4}, {5.4, -2.6}, {4.6, -2.6}, {
      4.6, -3.4}}], InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {5, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->262.8,
   PlotRange->NCache[{Full, {
       Rational[-7, 2], 
       Rational[-1, 2]}}, {Full, {-3.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`ControlledU[{
      $CellContext`S[2, Q3`$]} -> {1}, Complex[
      Rational[1, 2], 
      Rational[-1, 2]] + Complex[
       Rational[1, 2], 
       Rational[1, 2]] $CellContext`S[3, 4] + Complex[
       Rational[1, 2], 
       Rational[1, 2]] $CellContext`S[3, 5], "Label" -> 
    Superscript["V", "\[Dagger]"]], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`ControlledU[{
      $CellContext`S[1, Q3`$]} -> {1}, Complex[
      Rational[1, 2], 
      Rational[1, 2]] + Complex[
       Rational[1, 2], 
       Rational[-1, 2]] $CellContext`S[3, 4] + Complex[
       Rational[1, 2], 
       Rational[-1, 2]] $CellContext`S[3, 5], "Label" -> "V"], 
   Q3`ControlledU[{
      $CellContext`S[2, Q3`$]} -> {1}, Complex[
      Rational[1, 2], 
      Rational[1, 2]] + Complex[
       Rational[1, 2], 
       Rational[-1, 2]] $CellContext`S[3, 4] + Complex[
       Rational[1, 2], 
       Rational[-1, 2]] $CellContext`S[3, 5], "Label" -> "V"]]]], "Output",
 CellChangeTimes->{
  3.8205800272922153`*^9, 3.820580063293131*^9, 3.820580141980854*^9, 
   3.820580209397953*^9, {3.820580284172859*^9, 3.8205803285983467`*^9}, {
   3.8205803609605017`*^9, 3.820580376386986*^9}, {3.820580411470592*^9, 
   3.8205804374330587`*^9}, {3.8205804984406757`*^9, 
   3.8205805220497637`*^9}, {3.820580673117797*^9, 3.820580695043478*^9}, 
   3.820761719639483*^9, 3.8228129694276037`*^9, 3.826833547259894*^9, 
   3.826833778587944*^9, 3.830143634452827*^9, 3.836211494431901*^9, 
   3.839373065295577*^9, 3.839714591135622*^9, {3.849257339396113*^9, 
   3.849257347051497*^9}, 3.8518101979476233`*^9, 3.86938809714041*^9, 
   3.885076377778309*^9},
 CellLabel->"Out[272]=",
 CellID->1215533475,ExpressionUUID->"1b43e23c-433c-4802-978b-24af3d5b7eb6"],

Cell[BoxData[
 RowBox[{
  FractionBox["3", "4"], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3]]]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[3, 1]]]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 3], 
     $CellContext`S[3, 1]]]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 1]]]}], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[1, 3]], "4"], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"2"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[2, 3]], "4"], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[3, 1]], "4"]}]], "Output",
 CellChangeTimes->{
  3.8205800272922153`*^9, 3.820580063293131*^9, 3.820580141980854*^9, 
   3.820580209397953*^9, {3.820580284172859*^9, 3.8205803285983467`*^9}, {
   3.8205803609605017`*^9, 3.820580376386986*^9}, {3.820580411470592*^9, 
   3.8205804374330587`*^9}, {3.8205804984406757`*^9, 
   3.8205805220497637`*^9}, {3.820580673117797*^9, 3.820580695043478*^9}, 
   3.820761719639483*^9, 3.8228129694276037`*^9, 3.826833547259894*^9, 
   3.826833778587944*^9, 3.830143634452827*^9, 3.836211494431901*^9, 
   3.839373065295577*^9, 3.839714591135622*^9, {3.849257339396113*^9, 
   3.849257347051497*^9}, 3.8518101979476233`*^9, 3.86938809714041*^9, 
   3.88507637781269*^9},
 CellLabel->"Out[273]=",
 CellID->459180414,ExpressionUUID->"723fa9e9-181a-482a-a08c-3cc60a00170a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["3", "4"]}], "+", "toff", "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3]]]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[3, 1]]]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 3], 
     $CellContext`S[3, 1]]]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 1]]]}], "-", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[1, 3]], "4"], "-", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"2"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[2, 3]], "4"], "-", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"3"}, "RowDefault"], 
      TemplateBox[{"\"x\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[3, 1]], "4"]}]], "Output",
 CellChangeTimes->{
  3.8205800272922153`*^9, 3.820580063293131*^9, 3.820580141980854*^9, 
   3.820580209397953*^9, {3.820580284172859*^9, 3.8205803285983467`*^9}, {
   3.8205803609605017`*^9, 3.820580376386986*^9}, {3.820580411470592*^9, 
   3.8205804374330587`*^9}, {3.8205804984406757`*^9, 
   3.8205805220497637`*^9}, {3.820580673117797*^9, 3.820580695043478*^9}, 
   3.820761719639483*^9, 3.8228129694276037`*^9, 3.826833547259894*^9, 
   3.826833778587944*^9, 3.830143634452827*^9, 3.836211494431901*^9, 
   3.839373065295577*^9, 3.839714591135622*^9, {3.849257339396113*^9, 
   3.849257347051497*^9}, 3.8518101979476233`*^9, 3.86938809714041*^9, 
   3.8850763778194313`*^9},
 CellLabel->"Out[274]=",
 CellID->1536474427,ExpressionUUID->"18e3cdca-c93a-455c-bcc7-aecc862d0e20"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
This shows the quantum circuit model of the quantum Fredkin gate.\
\>", "MathCaption",
 CellChangeTimes->{{3.827260209281004*^9, 3.827260263855678*^9}},
 CellID->1198916797,ExpressionUUID->"89a1f56e-bb19-47a8-978e-0beb07393e09"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Fredkin", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "3", "]"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.827260304503125*^9, 3.827260304973489*^9}, 
   3.829808799868814*^9},
 CellLabel->"In[275]:=",
 CellID->612928653,ExpressionUUID->"41f5c150-a75b-4c7e-8127-8c69448179d7"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {
     LineBox[{{1, -1}, {1, -2}, {1, -3}}], DiskBox[{1, -1}, 0.09], 
     LineBox[{{{0.91, -2.09}, {1.09, -1.91}}, {{0.91, -1.91}, {
      1.09, -2.09}}}], 
     LineBox[{{{0.91, -3.09}, {1.09, -2.91}}, {{0.91, -2.91}, {
      1.09, -3.09}}}]}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-7, 2], 
       Rational[-1, 2]}}, {Full, {-3.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`Fredkin[
    $CellContext`S[1, Q3`$], 
    $CellContext`S[2, Q3`$], 
    $CellContext`S[3, Q3`$]]]]], "Output",
 CellChangeTimes->{{3.8272602964487667`*^9, 3.82726030546165*^9}, 
   3.827260520953433*^9, 3.830143636629414*^9, 3.836211495939139*^9, 
   3.8393730669736443`*^9, 3.8397145924379053`*^9, 3.849257350352809*^9, 
   3.8518101979775867`*^9, 3.869388098769513*^9, 3.885076379479287*^9},
 CellLabel->"Out[275]=",
 CellID->1977764036,ExpressionUUID->"c29da3d6-2974-4c78-8cf7-d55dc0c8a2b0"]
}, Open  ]],

Cell["\<\
This is an explicit operator expression of the Fredkin gate in terms of the \
Pauli operators.\
\>", "Text",
 CellChangeTimes->{{3.82726032359134*^9, 3.827260342039706*^9}},
 CellID->797791790,ExpressionUUID->"0f2cc52c-6cf3-46c8-98a1-8461c27d0d99"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"Elaborate", "[", "qc", "]"}]}]], "Input",
 CellChangeTimes->{{3.827260315258832*^9, 3.8272603185968437`*^9}},
 CellLabel->"In[276]:=",
 CellID->1255670038,ExpressionUUID->"20da7542-f5ba-4854-97df-ba9a478b1a09"],

Cell[BoxData[
 RowBox[{
  FractionBox["3", "4"], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 1], 
     $CellContext`S[3, 1]]]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 2]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 2]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 2], 
     $CellContext`S[3, 2]]]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 1], 
     $CellContext`S[3, 1]]]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 2]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 2]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 2], 
     $CellContext`S[3, 2]]]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]]}], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[1, 3]], "4"]}]], "Output",
 CellChangeTimes->{{3.827260319035989*^9, 3.827260343302862*^9}, 
   3.830143637950135*^9, 3.836211497260343*^9, 3.839373068217266*^9, 
   3.839714593842778*^9, 3.849257352341464*^9, 3.851810197993782*^9, 
   3.869388100241968*^9, 3.885076381069388*^9},
 CellLabel->"Out[276]=",
 CellID->531957581,ExpressionUUID->"00fcf980-6ea8-4917-8554-de10ba9c740f"]
}, Open  ]],

Cell["\<\
This is the matrix representation of the Fredkin gate in the logical basis.\
\>", "Text",
 CellChangeTimes->{{3.827260369353612*^9, 3.8272603805919037`*^9}},
 CellID->373754822,ExpressionUUID->"9e045b59-2009-4c45-851e-5c0602ca5287"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "[", "qc", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8272603450704737`*^9, 3.8272603525020514`*^9}},
 CellLabel->"In[277]:=",
 CellID->182681389,ExpressionUUID->"7d39e820-5dbf-4614-a6bd-df1b3cc0ff95"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 2, 4, 6, 8, 10, 12, 14, 16}, {{1}, {4}, {2}, {3}, {2}, {3}, {
       1}, {4}, {5}, {8}, {6}, {7}, {6}, {7}, {5}, {8}}}, {1, 0, 1, 0, 0, 1, 
      0, 1, 1, 0, 0, 1, 1, 0, 0, 1}}]]]]], "Output",
 CellChangeTimes->{{3.8272603527523117`*^9, 3.82726038238696*^9}, 
   3.8301436394989843`*^9, 3.836211498727783*^9, 3.839373069626924*^9, 
   3.839714595452361*^9, 3.8492573538478394`*^9, 3.851810198006357*^9, 
   3.869388101684766*^9, 3.8850763825477047`*^9},
 CellLabel->"Out[278]//MatrixForm=",
 CellID->1784212079,ExpressionUUID->"9e21113e-da92-492b-ad5e-e86f6b7ec30f"]
}, Open  ]],

Cell["\<\
The Fredkin gate is equivalent to a combination of three Toffoli gates.\
\>", "Text",
 CellChangeTimes->{{3.827260605650069*^9, 3.827260644921582*^9}, 
   3.8272611114632587`*^9},
 CellID->683383675,ExpressionUUID->"e792de1c-6c81-4e98-b121-ede8f3a78add"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Toffoli", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Toffoli", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Toffoli", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8272605249797373`*^9, 3.827260529321547*^9}, 
   3.829808799876218*^9},
 CellLabel->"In[279]:=",
 CellID->655391084,ExpressionUUID->"75fe19d8-231f-449e-be82-94e8dbb0e19f"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
     LineBox[{{1, -1}, {1, -2}, {1, -3}}], DiskBox[{1, -1}, 0.09], 
     DiskBox[{1, -2}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
         1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, {
     LineBox[{{2, -1}, {2, -3}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
     DiskBox[{2, -3}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     LineBox[{{3, -1}, {3, -2}, {3, -3}}], DiskBox[{3, -1}, 0.09], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -3}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -3}, {3.2666666666666666`, -3}}, {{
         3, -3.2666666666666666`}, {3, -2.7333333333333334`}}}]}}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-7, 2], 
       Rational[-1, 2]}}, {Full, {-3.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`Toffoli[
    $CellContext`S[1, Q3`$], 
    $CellContext`S[2, Q3`$], 
    $CellContext`S[3, Q3`$]], 
   Q3`Toffoli[
    $CellContext`S[1, Q3`$], 
    $CellContext`S[3, Q3`$], 
    $CellContext`S[2, Q3`$]], 
   Q3`Toffoli[
    $CellContext`S[1, Q3`$], 
    $CellContext`S[2, Q3`$], 
    $CellContext`S[3, Q3`$]]]]], "Output",
 CellChangeTimes->{{3.827260516366138*^9, 3.827260532587913*^9}, 
   3.827260646499292*^9, 3.830143641147296*^9, 3.836211500030593*^9, 
   3.8393730708672123`*^9, 3.8397145969326363`*^9, 3.849257355686779*^9, 
   3.851810198022537*^9, 3.869388102989811*^9, 3.885076384023225*^9},
 CellLabel->"Out[279]=",
 CellID->1105888673,ExpressionUUID->"6ba38c99-0ffa-4b67-b8bb-443ad00d360a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op2", "=", 
  RowBox[{"Elaborate", "[", "qc2", "]"}]}]], "Input",
 CellChangeTimes->{{3.8272605517009706`*^9, 3.8272605633624163`*^9}},
 CellLabel->"In[280]:=",
 CellID->1548055864,ExpressionUUID->"17caf1ad-fa86-4441-9dd5-a78c4d6e0b69"],

Cell[BoxData[
 RowBox[{
  FractionBox["3", "4"], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 1], 
     $CellContext`S[3, 1]]]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 2]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 2]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 2], 
     $CellContext`S[3, 2]]]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"x\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 1], 
     $CellContext`S[3, 1]]]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 2]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 2]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 2], 
     $CellContext`S[3, 2]]]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]]}], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"1"}, "RowDefault"], 
      TemplateBox[{"\"z\""}, "RowDefault"]},
     "Subsuperscript"],
    $CellContext`S[1, 3]], "4"]}]], "Output",
 CellChangeTimes->{{3.8272605638461533`*^9, 3.827260570637123*^9}, 
   3.827260647427244*^9, 3.8301436426188107`*^9, 3.836211501997056*^9, 
   3.839373073045911*^9, 3.8397145986502743`*^9, 3.849257357654291*^9, 
   3.851810198125622*^9, 3.869388104934989*^9, 3.885076385544488*^9},
 CellLabel->"Out[280]=",
 CellID->428680199,ExpressionUUID->"c7c5e49d-44ef-467a-b9f2-b1094e967f8d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "-", "op2"}]], "Input",
 CellChangeTimes->{{3.82726056689839*^9, 3.827260567941052*^9}},
 CellLabel->"In[281]:=",
 CellID->1362907403,ExpressionUUID->"228009e8-bcf6-4bc6-be25-d05c83cf78c2"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.827260568298296*^9, 3.827260648139834*^9, 
  3.83014364650961*^9, 3.8362115026819353`*^9, 3.839373073765562*^9, 
  3.839714599215313*^9, 3.849257358224655*^9, 3.8518101981340523`*^9, 
  3.86938810569048*^9, 3.885076386528255*^9},
 CellLabel->"Out[281]=",
 CellID->761345115,ExpressionUUID->"db5435f8-d4fc-4417-a842-74ad3cc52bc6"]
}, Open  ]],

Cell["\<\
In fact, the relation between the SWAP gate and the CNOT gate suggests that \
there is another equivalent quantum circuit model of the Fredkin gate.\
\>", "Text",
 CellChangeTimes->{{3.827260718158922*^9, 3.827260777845449*^9}, {
   3.827260823139009*^9, 3.8272608673354607`*^9}, {3.8272611148481207`*^9, 
   3.827261141249642*^9}, 3.827261678470331*^9},
 CellID->118826222,ExpressionUUID->"587ffdcf-9dce-433f-8038-5e2689daf43b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "3", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Toffoli", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "3", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.827260667758957*^9, 3.827260668635544*^9}, {
   3.827260782841218*^9, 3.8272607831441383`*^9}, 3.8298087998825808`*^9},
 CellLabel->"In[282]:=",
 CellID->343808826,ExpressionUUID->"8e0bf685-349d-4d24-b8f3-5fa7ac0df2ba"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
     LineBox[{{1, -3}, {1, -2}}], 
     DiskBox[{1, -3}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     LineBox[{{2, -1}, {2, -2}, {2, -3}}], DiskBox[{2, -1}, 0.09], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
         2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
     LineBox[{{3, -3}, {3, -2}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -2}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -2}, {3.2666666666666666`, -2}}, {{
         3, -2.2666666666666666`}, {3, -1.7333333333333334`}}}]}}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->190.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-7, 2], 
       Rational[-1, 2]}}, {Full, {-3.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[3, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`Toffoli[
    $CellContext`S[1, Q3`$], 
    $CellContext`S[2, Q3`$], 
    $CellContext`S[3, Q3`$]], 
   Q3`CNOT[{
      $CellContext`S[3, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}]]]], "Output",
 CellChangeTimes->{{3.827260779026272*^9, 3.827260783667193*^9}, 
   3.827260868697988*^9, 3.827261681165621*^9, 3.83014364845784*^9, 
   3.836211504107431*^9, 3.839373075190686*^9, 3.839714600568359*^9, 
   3.8492573596025467`*^9, 3.851810198149315*^9, 3.869388107066226*^9, 
   3.885076388198777*^9},
 CellLabel->"Out[282]=",
 CellID->621172449,ExpressionUUID->"a084cb12-d758-46fe-b8a5-b91b6689c69e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"qc", "-", "new"}], "//", "Elaborate"}]], "Input",
 CellChangeTimes->{{3.8272607856454897`*^9, 3.82726078849856*^9}},
 CellLabel->"In[283]:=",
 CellID->677889826,ExpressionUUID->"d57ffd1c-55c0-4767-a805-f62e697895bd"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.827260789061537*^9, 3.8272607912693853`*^9}, 
   3.827260869990197*^9, 3.830143650792816*^9, 3.836211506967154*^9, 
   3.8393730771437807`*^9, 3.839714602241704*^9, 3.851810198199617*^9, 
   3.869388108897113*^9, 3.885076390628501*^9},
 CellLabel->"Out[283]=",
 CellID->169115895,ExpressionUUID->"74412988-8bf5-4f5d-acc9-50f9b99d8293"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Universal Quantum Computation", "Section",
 CellChangeTimes->{{3.818666927272718*^9, 3.818666931761381*^9}},
 CellTags->"Section38",
 CellID->1817331573,ExpressionUUID->"8dafbef9-55ec-4670-9d5d-9b65c47a47f5"],

Cell[CellGroupData[{

Cell["\<\
Consider a three-qubit system, and an arbitrary unitary operation on it.\
\>", "MathCaption",
 CellChangeTimes->{{3.8272633551395483`*^9, 3.827263392813552*^9}},
 CellID->1917505328,ExpressionUUID->"814a2ca8-a450-4ddf-adc8-035198ba66c3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SS", "=", 
   RowBox[{"S", "[", 
    RowBox[{
     RowBox[{"Range", "[", "$n", "]"}], ",", "$"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"RandomUnitary", "[", 
    RowBox[{"2", "^", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{";;", "3"}], ",", 
     RowBox[{";;", "3"}]}], "]"}], "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.82726339518081*^9, 3.82726348113404*^9}, 
   3.885076098663371*^9},
 CellLabel->"In[284]:=",
 CellID->86358426,ExpressionUUID->"092f0cad-8af7-4e12-9ecc-86c0a88c58fb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "0.4180725484402119`"}], "+", 
       RowBox[{"0.1430895589622641`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.08497399588278175`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.25249137413946426`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.2359742229561063`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.2612712958159696`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.22421838991761645`"}], "-", 
       RowBox[{"0.041640335318109886`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.029933257873322655`"}], "+", 
       RowBox[{"0.179646939746528`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.3156510096341343`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.18065067691006031`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.27709344399726843`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.08241652706485904`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.01968156487556815`"}], "+", 
       RowBox[{"0.10231656632221087`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.47752755887857695`"}], "-", 
       RowBox[{"0.1289045718883463`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.827263413920362*^9, 3.827263447194714*^9}, 
   3.827263481650529*^9, 3.8272643265763083`*^9, 3.8301436534312687`*^9, 
   3.836211508796686*^9, 3.839373078981658*^9, 3.839382221446266*^9, 
   3.8397146039578657`*^9, 3.84925736457331*^9, 3.8518101982158823`*^9, 
   3.8527746439753237`*^9, 3.8693881113397093`*^9, 3.8850763923019*^9},
 CellLabel->"Out[287]//MatrixForm=",
 CellID->476263484,ExpressionUUID->"f14ff865-97ee-467c-a949-a8a35902e0fd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ExpressionFor", "[", 
    RowBox[{"mat", ",", "SS"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"{", 
    RowBox[{"op", ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "}"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.827263486695372*^9, 3.827263515231835*^9}, 
   3.829808799886819*^9, 3.830143411226892*^9},
 CellLabel->"In[288]:=",
 CellID->1264688223,ExpressionUUID->"a4270d2a-2683-4295-a71d-7ca38ecc70bd"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -3.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -3.4}, {1.4, -3.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -3.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-7, 2], 
       Rational[-1, 2]}}, {Full, {-3.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[{
   Complex[-0.1578622038414903, 0.24127696029604312`] + 
    Complex[0.16805076684580447`, 0.04403461176463121] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3]] + 
    Complex[0.02069925791228764, -0.193660117564106] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 4]] + 
    Complex[-0.07988480621264371, 0.057194521179967955`] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 5]] + 
    Complex[-0.09141944816058806, -0.0962719167681033] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[3, 3]] + 
    Complex[-0.0299839438257761, -0.1397652362531481] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[3, 4]] + 
    Complex[-0.046793221524772166`, -0.10089613730627806`] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[3, 5]] + 
    Complex[-0.08552395184881455, 0.26733887700141606`] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 3]] + 
    Complex[-0.06401309965506771, -0.13748313857671257`] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 4]] + 
    Complex[0.04482099222444759, 0.24493650985760596`] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 5]] + 
    Complex[-0.05946265390122123, -0.11105681849275711`] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[3, 3]] + 
    Complex[-0.07065931020901753, 0.056533000785212936`] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[3, 4]] + 
    Complex[0.06014296578208868, -0.245199085865395] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[3, 5]] + 
    Complex[0.004431274539636043, 0.16513154368059427`] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[2, 3]] + 
    Complex[-0.02308104645009844, 0.16238961345395994`] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[2, 4]] + 
    Complex[-0.12925796528125344`, 0.021977096279983607`] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[2, 5]] + 
    Complex[-0.3515105436613909, -0.13146903489528664`] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[3, 3]] + 
    Complex[-0.10605677512940768`, -0.15371544777357754`] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[3, 4]] + 
    Complex[0.20376041379648685`, 0.2615970150785426] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[3, 5]] + 
    Complex[-0.02725222123231503, 0.04655963975902515] Q3`Multiply[
       $CellContext`S[2, 3], 
       $CellContext`S[3, 3]] + 
    Complex[-0.11044707416209301`, -0.017463785335130044`] Q3`Multiply[
       $CellContext`S[2, 3], 
       $CellContext`S[3, 4]] + 
    Complex[-0.12813258880186468`, -0.025126659549138057`] Q3`Multiply[
       $CellContext`S[2, 3], 
       $CellContext`S[3, 5]] + 
    Complex[-0.04807656006582014, 0.010204242867824051`] Q3`Multiply[
       $CellContext`S[2, 4], 
       $CellContext`S[3, 3]] + 
    Complex[0.15742185575948645`, 0.18496235194909258`] Q3`Multiply[
       $CellContext`S[2, 4], 
       $CellContext`S[3, 4]] + 
    Complex[0.11696468532397576`, 0.040869012701190956`] Q3`Multiply[
       $CellContext`S[2, 4], 
       $CellContext`S[3, 5]] + 
    Complex[0.1622398272175615, -0.026743773032055707`] Q3`Multiply[
       $CellContext`S[2, 5], 
       $CellContext`S[3, 3]] + 
    Complex[0.20592149089605025`, 0.031086538884161352`] Q3`Multiply[
       $CellContext`S[2, 5], 
       $CellContext`S[3, 4]] + 
    Complex[-0.09534559296590768, -0.19710605460465958`] Q3`Multiply[
       $CellContext`S[2, 5], 
       $CellContext`S[3, 5]] + 
    Complex[0.040983363231250396`, 0.0983971781154011] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3], 
       $CellContext`S[3, 3]] + 
    Complex[-0.017757611997355344`, -0.0864390817893598] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3], 
       $CellContext`S[3, 4]] + 
    Complex[0.0037269613423723466`, -0.0908076241344601] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3], 
       $CellContext`S[3, 5]] + 
    Complex[0.12834373960391937`, -0.010473420025498573`] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 3]] + 
    Complex[0.2644104660589589, 0.0938746970053149] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 4]] + 
    Complex[0.19868632431015854`, 0.13978166420886937`] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 5]] + 
    Complex[0.18076451181002087`, -0.034044413039025334`] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 3]] + 
    Complex[-0.2256030557716184, 0.07123002743804951] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 4]] + 
    Complex[0.07529710705954236, 0.13675341018334658`] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 5]] + 
    Complex[0.15698825734944555`, -0.03538209757408224] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 3], 
       $CellContext`S[3, 3]] + 
    Complex[-0.04905994141045317, -0.21885886370044438`] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 3], 
       $CellContext`S[3, 4]] + 
    Complex[0.25447678818501357`, -0.047267555174279025`] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 3], 
       $CellContext`S[3, 5]] + 
    Complex[-0.08752241504128669, -0.05982369447568249] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 3]] + 
    Complex[0.08986869528670013, 0.36009696665901714`] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 4]] + 
    Complex[0.35074244550065076`, -0.4336780376077288] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 5]] + 
    Complex[-0.04955352809640999, 0.03990601242763253] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 3]] + 
    Complex[0.50338185050737, 0.08170688740315216] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 4]] + 
    Complex[-0.20187594366270445`, 0.06922972161894488] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 5]] + 
    Complex[-0.11202497669140377`, 0.01019248436016226] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[2, 3], 
       $CellContext`S[3, 3]] + 
    Complex[0.05131567858665183, -0.20360545751746723`] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[2, 3], 
       $CellContext`S[3, 4]] + 
    Complex[-0.21704781387512473`, 0.027520437889457877`] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[2, 3], 
       $CellContext`S[3, 5]] + 
    Complex[0.07050688514340127, 0.24926877923599358`] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 3]] + 
    Complex[0.22040863372956498`, -0.3112095014719982] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 4]] + 
    Complex[-0.05503498404279311, 0.06254536499875547] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 5]] + 
    Complex[-0.3214674071675071, -0.05662523564200643] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 3]] + 
    Complex[0.17277476955622714`, 0.12545777905270977`] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 4]] + 
    Complex[0.4665355979565975, 0.03418102885600702] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 5]] + 
    Complex[-0.08213706253552419, -0.07094895849252601] $CellContext`S[1, 3] + 
    Complex[0.29076505956953913`, 0.027894676413533166`] $CellContext`S[1, 4] + 
    Complex[0.10115767788041802`, 0.12948401114229297`] $CellContext`S[1, 5] + 
    Complex[-0.1520544036255573, -0.05299436421375226] $CellContext`S[2, 3] + 
    Complex[0.1350077855057194, -0.06734200109418904] $CellContext`S[2, 4] + 
    Complex[0.013973911182329768`, -0.07882286217374594] $CellContext`S[2, 5] + 
    Complex[-0.11638133912179191`, -0.0669635914984549] $CellContext`S[3, 3] + 
    Complex[0.24316262586800622`, -0.00882327076182634] $CellContext`S[3, 4] + 
    Complex[-0.05301954093335196, 0.1751900856717663] $CellContext`S[3, 5], 
    "Label" -> "U"}]]], "Output",
 CellChangeTimes->{{3.82726349520049*^9, 3.827263517924198*^9}, 
   3.827264329107321*^9, 3.830143655064399*^9, 3.836211510941594*^9, 
   3.8393730803178377`*^9, 3.8393822228316927`*^9, 3.8397146055336103`*^9, 
   3.8492573663880987`*^9, 3.8518101982631683`*^9, 3.85277464597344*^9, 
   3.86938811342982*^9, 3.885076393903754*^9},
 CellLabel->"Out[289]=",
 CellID->1737404177,ExpressionUUID->"49acb68f-a473-45f6-b5d3-eef6badd1e19"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"twl", "=", 
   RowBox[{"TwoLevelDecomposition", "[", "mat", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"twl", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "//", "Matrix"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.827263528095949*^9, 3.827263610728404*^9}, {
  3.839382230087502*^9, 3.839382248513557*^9}},
 CellLabel->"In[290]:=",
 CellID->104214177,ExpressionUUID->"be5e49d6-3f1f-4da0-99c3-895f1b192489"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{"0.018662094988612144`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.40606419150641737`", " ", "\[ImaginaryI]"}]}], 
      "0.9136539818699833`", "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", "0.9136539818699833`"}], 
      RowBox[{"0.018662094988612144`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.40606419150641737`", " ", "\[ImaginaryI]"}]}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 1, 2, 3, 4, 5, 7, 9, 10}, {{1}, {2}, {3}, {4}, {5}, {6}, {7}, {
       7}, {6}, {8}}}, {
      1, 1, 1, 1, 1, Complex[0.018662094988612144`, -0.40606419150641737`], 
       0.9136539818699833, Complex[
       0.018662094988612144`, 0.40606419150641737`], -0.9136539818699833, 
       1}}]]]]], "Output",
 CellChangeTimes->{{3.827263546638648*^9, 3.827263568453103*^9}, {
   3.827263601825254*^9, 3.82726361096214*^9}, 3.827264330100102*^9, 
   3.8301436562503977`*^9, 3.8362115120303926`*^9, 3.839373082279935*^9, {
   3.839382233796842*^9, 3.8393822511394567`*^9}, 3.839714606691094*^9, 
   3.849257367702986*^9, 3.851810198273005*^9, 3.852774647229265*^9, 
   3.8693881157841663`*^9, 3.885076395361003*^9},
 CellLabel->"Out[291]//MatrixForm=",
 CellID->1513846488,ExpressionUUID->"80390991-dbbe-4268-b15a-4772eb97d2ad"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Let us consider a particular two-level unitary matrix on a three-qubit \
system. We want to implement it in terms of elementary quantum logic gates.\
\>", "MathCaption",
 CellChangeTimes->{{3.827263749632634*^9, 3.827263765476532*^9}, {
   3.8272638254592123`*^9, 3.82726385484282*^9}, 3.8272639086518183`*^9},
 CellID->274114911,ExpressionUUID->"b2b22951-8bdc-4bef-b79a-a84e7a2dda5c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"TheRotation", "[", 
    RowBox[{
     RowBox[{"Pi", "/", "3"}], ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"U", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8272637758384*^9, 3.827263801307291*^9}, {
  3.852774618672758*^9, 3.852774626112858*^9}},
 CellLabel->"In[292]:=",
 CellID->408162463,ExpressionUUID->"0a6cc07a-3bb3-4379-adfe-ded860964b92"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}]},
     {
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {2}, {1}}}, {
      Rational[1, 2] 3^Rational[1, 2], Rational[-1, 2], Rational[1, 2] 
       3^Rational[1, 2], Rational[1, 2]}}]]]]], "Output",
 CellChangeTimes->{{3.8527746264104767`*^9, 3.852774650507546*^9}, 
   3.86938811745604*^9, 3.8850763973403788`*^9},
 CellLabel->"Out[293]//MatrixForm=",
 CellID->342986568,ExpressionUUID->"db838a40-7ff4-4069-8f54-0a25fef51a36"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "@", 
    RowBox[{"TwoLevelU", "[", 
     RowBox[{"U", ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "5"}], "}"}], ",", 
      RowBox[{"2", "^", "$n"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8272637758384*^9, 3.827263801307291*^9}, {
  3.852774618672758*^9, 3.8527746319881897`*^9}},
 CellLabel->"In[294]:=",
 CellID->140937410,ExpressionUUID->"2834a68e-758d-4296-9889-b85d83fb2e9d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 1, 2, 3, 5, 7, 8, 9, 10}, {{1}, {2}, {3}, {4}, {5}, {5}, {4}, {
       6}, {7}, {8}}}, {
      1, 1, 1, Rational[1, 2] 3^Rational[1, 2], Rational[-1, 2], 
       Rational[1, 2] 3^Rational[1, 2], Rational[1, 2], 1, 1, 
       1}}]]]]], "Output",
 CellChangeTimes->{{3.8272637763974047`*^9, 3.8272638089002447`*^9}, 
   3.827263856349411*^9, 3.827264023489647*^9, 3.827264331938211*^9, 
   3.8301436582700577`*^9, 3.836211513514092*^9, 3.839373083904009*^9, 
   3.8397146084361353`*^9, 3.849257369522613*^9, 3.851810198277923*^9, {
   3.852774632447543*^9, 3.8527746529091473`*^9}, 3.869388118938943*^9, 
   3.885076398728812*^9},
 CellLabel->"Out[295]//MatrixForm=",
 CellID->814147453,ExpressionUUID->"7016f3ad-27ad-47ea-b670-23af759260aa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"ExpressionFor", "[", 
   RowBox[{"mat", ",", "SS"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8272642397321243`*^9, 3.827264255969267*^9}, 
   3.8301434112329197`*^9},
 CellLabel->"In[296]:=",
 CellID->1202374181,ExpressionUUID->"e3b2ed0c-7476-4af7-8423-e46830f987ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"6", "+", 
     SqrtBox["3"]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"2", "-", 
     SqrtBox["3"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"2", "-", 
     SqrtBox["3"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[3, 3]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", 
     SqrtBox["3"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"z\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"+\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 4]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"-\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 5]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"-\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 5]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 4], 
     $CellContext`S[2, 5], 
     $CellContext`S[3, 5]]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"], 
           TemplateBox[{"\"-\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 5]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"], 
           TemplateBox[{"\"+\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 4]], 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"+\""}, "RowDefault"]}, "Subsuperscript", 
          SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 4]]}, "RowDefault"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 5], 
     $CellContext`S[2, 4], 
     $CellContext`S[3, 4]]]}]}]], "Output",
 CellChangeTimes->{3.827264340522285*^9, 3.8301436629777718`*^9, 
  3.836211515337695*^9, 3.839373085943448*^9, 3.83971461001626*^9, 
  3.849257371386654*^9, 3.851810198325761*^9, 3.852774655815424*^9, 
  3.8693881208936987`*^9, 3.885076400135479*^9},
 CellLabel->"Out[296]=",
 CellID->818113707,ExpressionUUID->"1dd55fab-fb0f-4719-9bcd-aa6e8cd7b452"]
}, Open  ]],

Cell[TextData[{
 "Our implementation is based on the Gray code sequence. Notice the function ",
 StyleBox["Reverse", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.827263913655551*^9, 3.827263922227687*^9}, {
  3.827264167760322*^9, 3.827264176580071*^9}},
 CellID->671324729,ExpressionUUID->"c0705371-9794-47b0-bbbc-e9409c9d1444"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gates", "=", 
  RowBox[{"Flatten", "@", 
   RowBox[{"FromTwoLevelU", "[", 
    RowBox[{"U", ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}], ",", "SS"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.827263889042903*^9, 3.827263890234305*^9}, {
   3.827263940689322*^9, 3.827263942139718*^9}, {3.8272641607636337`*^9, 
   3.827264162923113*^9}, 3.827264226910832*^9, {3.8527746703090277`*^9, 
   3.8527746714108467`*^9}, 3.869387814419146*^9},
 CellLabel->"In[297]:=",
 CellID->779608136,ExpressionUUID->"b6156167-b191-4603-a9c4-cae57f9ad8f5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"2"},
           "RowDefault"]],
         $CellContext`S[2, Q3`$]], ",", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"3"},
           "RowDefault"]],
         $CellContext`S[3, Q3`$]]}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], ",", 
     RowBox[{"{", 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]],
       $CellContext`S[1, Q3`$]], "}"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`S[1, Q3`$]], ",", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"3"},
           "RowDefault"]],
         $CellContext`S[3, Q3`$]]}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], ",", 
     RowBox[{"{", 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"2"},
         "RowDefault"]],
       $CellContext`S[2, Q3`$]], "}"}]}], "]"}], ",", 
   RowBox[{"ControlledU", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`S[1, Q3`$]], ",", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"2"},
           "RowDefault"]],
         $CellContext`S[2, Q3`$]]}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}]}], ",", 
     RowBox[{
      FractionBox[
       SqrtBox["3"], "2"], "+", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"], 
           TemplateBox[{"\"y\""}, "RowDefault"]},
          "Subsuperscript"],
         $CellContext`S[3, 2]]}], "2"]}], ",", 
     RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"1"},
           "RowDefault"]],
         $CellContext`S[1, Q3`$]], ",", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"3"},
           "RowDefault"]],
         $CellContext`S[3, Q3`$]]}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], ",", 
     RowBox[{"{", 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"2"},
         "RowDefault"]],
       $CellContext`S[2, Q3`$]], "}"}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"2"},
           "RowDefault"]],
         $CellContext`S[2, Q3`$]], ",", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"},
           "RowDefault"], 
          TemplateBox[{"3"},
           "RowDefault"]],
         $CellContext`S[3, Q3`$]]}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], ",", 
     RowBox[{"{", 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"S"},
         "RowDefault"], 
        TemplateBox[{"1"},
         "RowDefault"]],
       $CellContext`S[1, Q3`$]], "}"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.827263886054426*^9, 3.8272638905687237`*^9}, {
   3.827263925895279*^9, 3.8272639559038982`*^9}, 3.827264024999324*^9, 
   3.827264163621056*^9, 3.827264227683448*^9, 3.827264348037591*^9, 
   3.830143669427642*^9, 3.8362115168390923`*^9, 3.839373087192493*^9, 
   3.8397146113812723`*^9, 3.849257373444941*^9, 3.851810198344805*^9, {
   3.852774657936043*^9, 3.852774685012198*^9}, 3.869388122363542*^9, 
   3.885076402452363*^9},
 CellLabel->"Out[297]=",
 CellID->1569310661,ExpressionUUID->"67a0b81b-cd63-4d5a-a69f-1a9415846cc3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Apply", "[", 
      RowBox[{"Dot", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Matrix", "[", 
          RowBox[{"#", ",", "SS"}], "]"}], "&"}], "/@", 
        RowBox[{"Elaborate", "/@", "gates"}]}]}], "]"}], "//", "Normal"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.82726435708182*^9, 3.827264410097612*^9}, {
  3.827264460924122*^9, 3.827264522263781*^9}, {3.8492573836745453`*^9, 
  3.8492573850911293`*^9}},
 CellLabel->"In[298]:=",
 CellID->1607904042,ExpressionUUID->"44284cfc-a886-4e7d-9a64-777792613501"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.827264522544463*^9, 3.8272645247467537`*^9}, 
   3.83014367157798*^9, 3.836211519206126*^9, 3.839373089088255*^9, 
   3.839714612765976*^9, {3.849257375425097*^9, 3.849257385415551*^9}, 
   3.851810198390622*^9, 3.852774686189542*^9, 3.869388127506238*^9, 
   3.8850764040794086`*^9},
 CellLabel->"Out[299]//MatrixForm=",
 CellID->1649367385,ExpressionUUID->"70d2870e-ca7c-4c19-acba-db757d0ba86a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "@@", "gates"}]}]], "Input",
 CellChangeTimes->{{3.827263987916854*^9, 3.827264072510194*^9}, {
  3.8272641423374987`*^9, 3.827264155216963*^9}, {3.829808799900929*^9, 
  3.8298087999014683`*^9}, {3.8492573928563747`*^9, 3.849257399445115*^9}, {
  3.885076409201377*^9, 3.885076418452499*^9}},
 CellLabel->"In[304]:=",
 CellID->1663700242,ExpressionUUID->"8f6ea602-0854-488a-8d0e-423aeefb1d94"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}}], {
     LineBox[{{1, -2}, {1, -3}, {1, -1}}], DiskBox[{1, -2}, 0.09], 
     DiskBox[{1, -3}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
         1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
     LineBox[{{2, -1}, {2, -3}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
     DiskBox[{2, -3}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     LineBox[{{3, -1}, {3, -2}, {3, -3}}], DiskBox[{3, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{3, -2}, 0.09]}, 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, 
     LineBox[{{2.6, -3.4}, {3.4, -3.4}, {3.4, -2.6}, {2.6, -2.6}, {
      2.6, -3.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{4, -1}, {4, -3}, {4, -2}}], 
     DiskBox[{4, -1}, 0.09], 
     DiskBox[{4, -3}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
         4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {
     LineBox[{{5, -2}, {5, -3}, {5, -1}}], DiskBox[{5, -2}, 0.09], 
     DiskBox[{5, -3}, 0.09], {CircleBox[{5, -1}, 0.26666666666666666], 
      LineBox[{{{4.733333333333333, -1}, {5.266666666666667, -1}}, {{
         5, -1.2666666666666666`}, {5, -0.7333333333333334}}}]}}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->262.8,
   PlotRange->NCache[{Full, {
       Rational[-7, 2], 
       Rational[-1, 2]}}, {Full, {-3.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[2, Q3`$], 
      $CellContext`S[3, Q3`$]} -> {1, 1}, {
     $CellContext`S[1, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[3, Q3`$]} -> {1, 1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`ControlledU[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$]} -> {1, 0}, Rational[1, 2] 3^Rational[1, 2] + 
    Complex[0, 
       Rational[1, 2]] $CellContext`S[3, 2], "Label" -> "U"], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[3, Q3`$]} -> {1, 1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`CNOT[{
      $CellContext`S[2, Q3`$], 
      $CellContext`S[3, Q3`$]} -> {1, 1}, {
     $CellContext`S[1, Q3`$]}]]]], "Output",
 CellChangeTimes->{{3.82726399512745*^9, 3.8272640751267977`*^9}, 
   3.827264182742879*^9, 3.827264530372422*^9, 3.830143673059223*^9, 
   3.8362115210472097`*^9, 3.839373090351389*^9, 3.839714614068491*^9, {
   3.849257389315559*^9, 3.849257399823398*^9}, 3.8518101984071007`*^9, 
   3.8527746878661757`*^9, 3.869388129425477*^9, {3.885076413668419*^9, 
   3.88507641884162*^9}},
 CellLabel->"Out[304]=",
 CellID->1550777223,ExpressionUUID->"4dc764af-c3ba-4a13-9a62-6340f4c89492"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", "[", "qc", "]"}], "//", "Normal"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.827264189014928*^9, 3.827264212454912*^9}, {
  3.8272645356062202`*^9, 3.827264536933043*^9}, {3.849257405881515*^9, 
  3.849257406903307*^9}, {3.885076422361334*^9, 3.8850764252662077`*^9}},
 CellLabel->"In[305]:=",
 CellID->722239880,ExpressionUUID->"a5e59113-f13e-4f4b-ac1b-0d2cf52c915d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.827264203239957*^9, 3.827264212782098*^9}, {
   3.827264533295939*^9, 3.827264543455625*^9}, 3.830143674521164*^9, 
   3.836211522853833*^9, 3.839373092127069*^9, 3.839714615346373*^9, 
   3.849257407243373*^9, 3.851810198449506*^9, 3.852774691384774*^9, 
   3.869388133302783*^9, 3.885076426342795*^9},
 CellLabel->"Out[306]//MatrixForm=",
 CellID->1938117198,ExpressionUUID->"5a2a3ef8-956f-48f5-92b6-1d2e1e00c458"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Computational Model of Measurement", "Section",
 CellChangeTimes->{{3.820447073262347*^9, 3.820447074352992*^9}, {
  3.855824210011416*^9, 3.85582421312437*^9}},
 CellTags->"Section39",
 CellID->1767938601,ExpressionUUID->"6065574e-02f6-4a40-9e06-f14c4b0db276"],

Cell[CellGroupData[{

Cell["First consider a measurement in the logical basis.", "MathCaption",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.8238450133175592`*^9, 
  3.8238450485168943`*^9}},ExpressionUUID->"1f2f73f0-4729-486e-8d90-\
c0b19240d74b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{"ProductState", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c", "[", "0", "]"}], ",", 
       RowBox[{"c", "[", "1", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"vec", ",", "\"\<Spacer\>\"", ",", 
    RowBox[{"Measurement", "@", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "3"}], "]"}]}], ",", 
    RowBox[{"\"\<PortSize\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0.2"}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.820447096291321*^9, 3.820447194676956*^9}, {
   3.820447327297188*^9, 3.820447408449109*^9}, {3.8204474886979856`*^9, 
   3.820447499974351*^9}, {3.820450865714097*^9, 3.820450872732604*^9}, {
   3.820450904343988*^9, 3.820450909247834*^9}, 3.820451804524008*^9, {
   3.8238449628418713`*^9, 3.823844975833672*^9}, 3.826981713790452*^9, 
   3.829808799907855*^9, {3.8492574139576063`*^9, 3.849257425545804*^9}},
 CellLabel->
  "In[307]:=",ExpressionUUID->"525aaa6d-aff1-45fe-9942-f14e2d0b11f9"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{{{2, -1}, {3, -1}}}]}, 
    LineBox[{{{0, -1}, {2, -1}}}], InsetBox[
     StyleBox[
      RowBox[{
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], " ", 
        FormBox[
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"c"},
            "RowDefault"], 
           TemplateBox[{"0"},
            "RowDefault"]],
          $CellContext`c[0]],
         TraditionalForm]}], "+", 
       RowBox[{
        TemplateBox[{"1"},
         "Ket"], " ", 
        FormBox[
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"c"},
            "RowDefault"], 
           TemplateBox[{"1"},
            "RowDefault"]],
          $CellContext`c[1]],
         TraditionalForm]}]}],
      StripOnInput->False,
      FontSize->Scaled[0.10666666666666667`],
      FontWeight->"Light"], {-0.1, -1}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, 
      LineBox[{{1.6, -1.4}, {2.4, -1.4}, {2.4, -0.6}, {1.6, -0.6}, {
       1.6, -1.4}}]}, 
     CircleBox[{2, -1.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{2, -1.2}, {2.24, -0.76}}]}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{72, 7.2}, {1, 1}},
   ImageSize->187.20000000000002`,
   PlotRange->NCache[{Full, {
       Rational[-3, 2], 
       Rational[-1, 2]}}, {Full, {-1.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
    Q3`ProductState[<|$CellContext`S[1, Q3`$] -> {
        $CellContext`c[0], 
        $CellContext`c[1]}|>]], "Spacer", 
   Q3`Measurement[
    $CellContext`S[1, 3]], "PortSize" -> {2, 0.2}]]], "Output",
 CellChangeTimes->{{3.820447140586274*^9, 3.8204471619219933`*^9}, {
   3.820447195943852*^9, 3.82044719824786*^9}, {3.820447329350333*^9, 
   3.820447410877399*^9}, {3.820447500308036*^9, 3.820447502514043*^9}, {
   3.820450873529148*^9, 3.820450909598802*^9}, {3.82045180510242*^9, 
   3.820451807315579*^9}, 3.822806048894188*^9, 3.823844977003832*^9, 
   3.823845050039975*^9, 3.82384510593804*^9, 3.824420681033041*^9, 
   3.826329720827373*^9, {3.826329829513109*^9, 3.826329831565793*^9}, 
   3.826333663743339*^9, 3.826981554697481*^9, {3.8269817154948387`*^9, 
   3.826981722279385*^9}, 3.830143678853574*^9, 3.8301438070628157`*^9, 
   3.836211525102015*^9, 3.8393730939165907`*^9, 3.8397146169904757`*^9, 
   3.849257426526597*^9, 3.851810154748619*^9, 3.8518101984657183`*^9, 
   3.86938813562175*^9, 3.8850764306976633`*^9},
 CellLabel->"Out[309]=",
 CellID->672149068,ExpressionUUID->"032d3520-581f-49d2-b339-62a6c0b442f8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"c", ",", "data"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "=", 
     RowBox[{"1", "/", "2"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], "=", 
     RowBox[{
      RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"data", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ExpressionFor", "[", "qc", "]"}], ";", 
        RowBox[{"Readout", "@", 
         RowBox[{"S", "[", 
          RowBox[{"1", ",", "3"}], "]"}]}]}], ",", "1000"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Histogram", "[", 
     RowBox[{"data", ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<Readout\>\"", ",", "\"\<Counts\>\""}], "}"}]}]}], 
     "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8204475203975887`*^9, 3.820447746633793*^9}, {
   3.823845067214673*^9, 3.823845068361569*^9}, {3.824420658819088*^9, 
   3.824420663825783*^9}, 3.8301434112546*^9, 3.839373101853854*^9, {
   3.849257435763609*^9, 3.849257451051952*^9}},
 CellLabel->
  "In[310]:=",ExpressionUUID->"27d10c96-b339-4ea7-9f51-e224dec993c8"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
    Opacity[0.6719999999999999], Thickness[Small]}], {}, 
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
     Opacity[0.6719999999999999], Thickness[Small]}], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{-0.5, 0}, {0.5, 270.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{43.9551282051282, 
           143.35256410256412`}, {-2.475500607587307, 44.427845862798634`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 270]& ,
        TagBoxNote->"270"],
       StyleBox["270", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[270, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{0.5, 0}, {1.5, 730.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{142.85256410256412`, 
           242.25000000000006`}, {-81.53305385343002, 44.427845862798634`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 730]& ,
        TagBoxNote->"730"],
       StyleBox["730", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[730, {}], "Tooltip"]& ]}, {}, {}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{-0.54, 0},
  AxesStyle->Automatic,
  Frame->True,
  FrameLabel->{{
     FormBox[
      TagBox["\"Counts\"", HoldForm], TraditionalForm], None}, {
     FormBox[
      TagBox["\"Readout\"", HoldForm], TraditionalForm], None}},
  FrameStyle->Automatic,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->250,
  PlotRange->{{-0.5, 1.5}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {None, 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.823845118281712*^9, 3.8244206843156424`*^9, 3.826329723393724*^9, 
   3.826333666126177*^9, 3.826981558657336*^9, {3.8301436825590487`*^9, 
   3.8301437069205723`*^9}, 3.830143810898322*^9, 3.8362115295185423`*^9, {
   3.839373098184272*^9, 3.8393731049277487`*^9}, 3.839714622457451*^9, 
   3.849257452923443*^9, 3.8518101999980297`*^9, 3.869388139599372*^9, 
   3.8850764339630136`*^9},
 CellLabel->"Out[310]=",
 CellID->187956946,ExpressionUUID->"a9e6f54b-0053-49d2-a0d9-f88136ca7e0e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Now consider a measurement in the eigen-basis of the Pauli X operator.\
\>", "MathCaption",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.823845151281322*^9, 
  3.823845199293363*^9}},ExpressionUUID->"00d628c7-cc8f-46e9-9789-\
1c7b7b12390b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{"ProductState", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c", "[", "0", "]"}], ",", 
       RowBox[{"c", "[", "1", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"vec", ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", 
    RowBox[{"Measurement", "@", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "3"}], "]"}]}], ",", 
    RowBox[{"\"\<PortSize\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0.2"}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.820447096291321*^9, 3.820447194676956*^9}, {
   3.820447327297188*^9, 3.820447408449109*^9}, {3.8204474886979856`*^9, 
   3.820447499974351*^9}, {3.820447785995998*^9, 3.820447789009748*^9}, {
   3.820450883535749*^9, 3.8204509242433987`*^9}, 3.8204518126569366`*^9, {
   3.823845142405954*^9, 3.8238451484132767`*^9}, {3.826981639384632*^9, 
   3.8269816844939203`*^9}, 3.829808799921555*^9, {3.8492574632816563`*^9, 
   3.8492574658424063`*^9}},
 CellLabel->
  "In[311]:=",ExpressionUUID->"136c2e79-cf39-4bdf-8561-dfcd73f6f73d"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{{{2, -1}, {3, -1}}}]}, 
    LineBox[{{{0, -1}, {2, -1}}}], InsetBox[
     StyleBox[
      RowBox[{
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], " ", 
        FormBox[
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"c"},
            "RowDefault"], 
           TemplateBox[{"0"},
            "RowDefault"]],
          $CellContext`c[0]],
         TraditionalForm]}], "+", 
       RowBox[{
        TemplateBox[{"1"},
         "Ket"], " ", 
        FormBox[
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"c"},
            "RowDefault"], 
           TemplateBox[{"1"},
            "RowDefault"]],
          $CellContext`c[1]],
         TraditionalForm]}]}],
      StripOnInput->False,
      FontSize->Scaled[0.10666666666666667`],
      FontWeight->"Light"], {-0.1, -1}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, 
      LineBox[{{1.6, -1.4}, {2.4, -1.4}, {2.4, -0.6}, {1.6, -0.6}, {
       1.6, -1.4}}]}, 
     CircleBox[{2, -1.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{2, -1.2}, {2.24, -0.76}}]}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{72, 7.2}, {1, 1}},
   ImageSize->187.20000000000002`,
   PlotRange->NCache[{Full, {
       Rational[-3, 2], 
       Rational[-1, 2]}}, {Full, {-1.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
    Q3`ProductState[<|$CellContext`S[1, Q3`$] -> {
        $CellContext`c[0], 
        $CellContext`c[1]}|>]], 
   $CellContext`S[1, 6], 
   Q3`Measurement[
    $CellContext`S[1, 3]], "PortSize" -> {2, 0.2}]]], "Output",
 CellChangeTimes->{{3.826981691442333*^9, 3.826981694882805*^9}, 
   3.830143683051206*^9, 3.8301437196550703`*^9, 3.830143812915167*^9, 
   3.836211529651793*^9, 3.8393731087650843`*^9, 3.839714622870294*^9, {
   3.849257466244081*^9, 3.849257494362524*^9}, 3.8492585352437487`*^9, 
   3.8492585677445517`*^9, 3.851810200047825*^9, 3.869388141885146*^9, 
   3.8850764384827967`*^9},
 CellLabel->"Out[313]=",
 CellID->1867937539,ExpressionUUID->"4fe76d9c-d937-440a-b53b-ad181617e5d0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"c", ",", "data"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "=", 
     RowBox[{"1", "/", "2"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], "=", 
     RowBox[{
      RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"data", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ExpressionFor", "[", "qc", "]"}], ";", 
        RowBox[{"Readout", "@", 
         RowBox[{"S", "[", 
          RowBox[{"1", ",", "3"}], "]"}]}]}], ",", "1000"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Histogram", "[", 
     RowBox[{"data", ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<Readout\>\"", ",", "\"\<Counts\>\""}], "}"}]}]}], 
     "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8204475203975887`*^9, 3.820447746633793*^9}, {
   3.8244206919708643`*^9, 3.8244207005893097`*^9}, 3.830143411270646*^9, 
   3.839373114745296*^9, {3.849257473676512*^9, 3.8492574827423477`*^9}},
 CellLabel->
  "In[314]:=",ExpressionUUID->"099d9590-ffe1-4201-b2aa-535d06ab54f0"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
    Opacity[0.6719999999999999], Thickness[Small]}], {}, 
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
     Opacity[0.6719999999999999], Thickness[Small]}], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{-0.5, 0}, {0.5, 952.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{43.95512820512819, 
           143.3525641025641}, {-81.53305385343003, 44.42784586279862}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 952]& ,
        TagBoxNote->"952"],
       StyleBox["952", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[952, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{0.5, 0}, {1.5, 48.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{142.8525641025641, 242.25}, {37.602086213240874`, 
           44.42784586279862}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 48]& ,
        TagBoxNote->"48"],
       StyleBox["48", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[48, {}], "Tooltip"]& ]}, {}, {}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{-0.54, 0},
  AxesStyle->Automatic,
  Frame->True,
  FrameLabel->{{
     FormBox[
      TagBox["\"Counts\"", HoldForm], TraditionalForm], None}, {
     FormBox[
      TagBox["\"Readout\"", HoldForm], TraditionalForm], None}},
  FrameStyle->Automatic,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->250,
  PlotRange->{{-0.5, 1.5}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {None, 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.820447822547071*^9, 3.820451819132718*^9, 3.823845127615779*^9, 
   3.824420706514247*^9, 3.826329729308923*^9, 3.826333670169799*^9, 
   3.826981566043977*^9, 3.830143726327292*^9, 3.83014381953277*^9, 
   3.8362115368559027`*^9, 3.8393731212327423`*^9, 3.839714630930047*^9, {
   3.849257483889359*^9, 3.849257495748708*^9}, 3.84925850755066*^9, {
   3.8492586808270493`*^9, 3.849258687485409*^9}, 3.851810206788486*^9, 
   3.8693881503670073`*^9, 3.885076443502884*^9},
 CellLabel->"Out[314]=",
 CellID->1313004327,ExpressionUUID->"92d8d24d-1934-4df0-9e93-272cff3f334c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
This is the \"disentangler\" quantum circuit, which is the inverse of the \
entangler quantum circuit .\
\>", "MathCaption",
 CellChangeTimes->{{3.823845265767459*^9, 3.823845315962512*^9}, {
  3.824002118291459*^9, 
  3.824002119796111*^9}},ExpressionUUID->"de83f5e8-7dad-430d-a994-\
5984dc50c454"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"disentangler", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.82045054349924*^9, 3.820450745051745*^9}, {
   3.8204508374332027`*^9, 3.820450840458129*^9}, {3.820451022014032*^9, 
   3.820451044893031*^9}, 3.82384532033981*^9, 3.826981734330865*^9, 
   3.829808799932132*^9},
 CellLabel->
  "In[315]:=",ExpressionUUID->"b675937d-3b75-4735-a4b2-3820ed123780"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, 
     LineBox[{{1.6, -1.4}, {2.4, -1.4}, {2.4, -0.6}, {1.6, -0.6}, {
      1.6, -1.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {2, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->154.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], 
   $CellContext`S[1, 6]]]], "Output",
 CellChangeTimes->{3.823845321888852*^9, 3.824002146221314*^9, 
  3.824420714585251*^9, 3.82632972938535*^9, 3.826981568815927*^9, 
  3.826981734735457*^9, 3.830143821420426*^9, 3.8362115374718943`*^9, 
  3.839373121811829*^9, 3.8397146310020247`*^9, 3.8492645691748343`*^9, 
  3.851810206813849*^9, 3.869388152660427*^9, 3.8850764444634867`*^9},
 CellLabel->"Out[315]=",
 CellID->1173186992,ExpressionUUID->"ed05f586-93f3-4c33-9db7-71c82f5715b5"]
}, Open  ]],

Cell["\<\
This shows that the disentangler quantum circuit maps the Bell states into \
the logical basis states.\
\>", "Text",
 CellChangeTimes->{{3.8238453349295473`*^9, 
  3.823845377486038*^9}},ExpressionUUID->"518aec85-f82e-45c9-9ce5-\
04fae8b01d4f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ExpressionFor", "[", "disentangler", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"BellState", "@", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{"bs", "\[Rule]", 
     RowBox[{"op", "**", "bs"}]}], "]"}], "//", "LogicalForm"}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.82045054349924*^9, 3.820450745051745*^9}, {
   3.8204508374332027`*^9, 3.820450840458129*^9}, {3.820451022014032*^9, 
   3.820451044893031*^9}, 3.82384532033981*^9, 3.830143411279604*^9},
 CellLabel->
  "In[316]:=",ExpressionUUID->"284736ae-09ed-48c5-a65e-e92651ed7079"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       FractionBox[
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            0|>]], "+", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            1|>]]}], 
        SqrtBox["2"]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0|>]]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            1|>]], "+", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            0|>]]}], 
        SqrtBox["2"]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          1|>]]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            1|>]], "-", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            0|>]]}], 
        SqrtBox["2"]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          1|>]]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["0", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            0|>]], "-", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"1"}, "RowDefault"]], 
                $CellContext`S[1, Q3`$]]], 
              SubscriptBox["1", 
               InterpretationBox[
                SubscriptBox[
                 TemplateBox[{"S"}, "RowDefault"], 
                 TemplateBox[{"2"}, "RowDefault"]], 
                $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            1|>]]}], 
        SqrtBox["2"]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`S[1, Q3`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"S"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.820450557245205*^9, {3.820450656469426*^9, 3.820450690107777*^9}, {
   3.820450730291581*^9, 3.820450745330915*^9}, {3.8204508407380953`*^9, 
   3.820450842918436*^9}, 3.820450932016322*^9, {3.820451029898219*^9, 
   3.820451045253353*^9}, 3.8204511292844877`*^9, 3.82045182069986*^9, 
   3.823845329650875*^9, 3.8238453794142637`*^9, 3.824002147503174*^9, 
   3.824420716004243*^9, 3.826329729459651*^9, 3.8269815712248907`*^9, 
   3.830143822828553*^9, 3.8362115392232647`*^9, 3.839373125047001*^9, 
   3.839714631077611*^9, 3.849264570454154*^9, 3.8518102068376102`*^9, 
   3.869388154150702*^9, 3.885076445889658*^9},
 CellLabel->"Out[318]//TableForm=",
 CellID->85612187,ExpressionUUID->"7abefc2b-7f39-4ff0-be83-6cda00cfa769"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["As an example, consider a two-qubit quantum state.", "MathCaption",
 CellChangeTimes->{{3.823845391606567*^9, 
  3.823845407600912*^9}},ExpressionUUID->"2dc4b1da-a102-4a8b-be27-\
3c4f649551b3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{
    RowBox[{"Ket", "[", "]"}], "+", 
    RowBox[{"I", " ", 
     RowBox[{"Ket", "[", 
      RowBox[{
       RowBox[{"S", "[", "1", "]"}], "\[Rule]", "1"}], "]"}]}], "+", 
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], "\[Rule]", "1"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"vec", "//", "LogicalForm"}]}], "Input",
 CellChangeTimes->{{3.820450980258233*^9, 3.820451076954195*^9}, {
   3.820451380609254*^9, 3.820451398078719*^9}, 3.823845389085147*^9},
 CellLabel->
  "In[319]:=",ExpressionUUID->"6a5ba9cf-57a7-4743-8a42-89690406b2ec"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]], 
         $CellContext`S[1, Q3`$]]], 
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]], 
         $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
    "Ket"],
   Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], "+", 
  
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{
       SubscriptBox["0", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"1"}, "RowDefault"]], 
         $CellContext`S[1, Q3`$]]], 
       SubscriptBox["1", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"S"}, "RowDefault"], 
          TemplateBox[{"2"}, "RowDefault"]], 
         $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
    "Ket"],
   Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 1|>]], "+", 
  
  RowBox[{"\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`S[1, Q3`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"S"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`S[2, Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0|>]]}]}]], "Output",
 CellChangeTimes->{
  3.823845408838003*^9, {3.824002138671939*^9, 3.8240021487641077`*^9}, {
   3.824420719264933*^9, 3.824420741905867*^9}, 3.8263297294760933`*^9, 
   3.8269817766175327`*^9, 3.830143824418511*^9, 3.836211540705635*^9, 
   3.8393731264919853`*^9, 3.839714631128271*^9, 3.84926457245642*^9, 
   3.85181020685321*^9, 3.8693881556659327`*^9, 3.885076447330879*^9},
 CellLabel->"Out[320]=",
 CellID->1986233251,ExpressionUUID->"0cc28f91-0184-4deb-8470-a85ddeb5577e"]
}, Open  ]],

Cell["\<\
This is a full quantum circuit model to perform the Bell measurement on the \
state specified above.\
\>", "Text",
 CellChangeTimes->{{3.823845428176402*^9, 
  3.8238455123899107`*^9}},ExpressionUUID->"ace106c4-ecdc-4351-85e3-\
7be4b8f20cad"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"vec", ",", "disentangler", ",", 
    RowBox[{"Measurement", "@", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", "3"}], "]"}]}], ",", 
    RowBox[{"\"\<PortSize\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"2.6", ",", "0.2"}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.820450980258233*^9, 3.820451076954195*^9}, {
   3.820451380609254*^9, 3.820451398078719*^9}, {3.823845389085147*^9, 
   3.823845417253483*^9}, 3.8269817473695498`*^9, {3.8269817838846197`*^9, 
   3.8269817963928947`*^9}, 3.829808799947029*^9, {3.8492645788060913`*^9, 
   3.849264581594687*^9}},
 CellLabel->
  "In[321]:=",ExpressionUUID->"d403f668-2cb6-4cb0-9777-ed394f8fc9d4"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], 
     LineBox[{{{3, -1}, {4, -1}}, {{3, -2}, {4, -2}}}]}, 
    LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {
     3, -2}}}], {{
      BSplineCurveBox[{{-0.225, -1.5}, {-0.1625, -1.46875}, {-0.1625, \
-1.4375}, {-0.1625, -1.0625}, {-0.1625, -1.03125}, {-0.1, -1.}}], 
      BSplineCurveBox[{{-0.225, -1.5}, {-0.1625, -1.53125}, {-0.1625, \
-1.5625}, {-0.1625, -1.9375}, {-0.1625, -1.96875}, {-0.1, -2.}}]}, InsetBox[
      StyleBox[
       RowBox[{
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{
             TemplateBox[{"0", "0"}, "RowDefault"]}, "RowDefault"]},
          "Ket"],
         Ket[<||>]], "+", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{
             TemplateBox[{"0", "1"}, "RowDefault"]}, "RowDefault"]},
          "Ket"],
         Ket[<|$CellContext`S[2, Q3`$] -> 1|>]], "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{
              TemplateBox[{"1", "0"}, "RowDefault"]}, "RowDefault"]},
           "Ket"],
          Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}]}],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.325, -1.5}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, 
     LineBox[{{1.6, -1.4}, {2.4, -1.4}, {2.4, -0.6}, {1.6, -0.6}, {
      1.6, -1.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {{{
       {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -1.4}, {3.4, -0.6}]},
        LineBox[{{2.6, -1.4}, {3.4, -1.4}, {3.4, -0.6}, {2.6, -0.6}, {
        2.6, -1.4}}]}, 
      CircleBox[{3, -1.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{3, -1.2}, {3.24, -0.76}}]}, {{
       {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -1.6}]},
        LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -1.6}, {2.6, -1.6}, {
        2.6, -2.4}}]}, 
      CircleBox[{3, -2.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{3, -2.2}, {3.24, -1.76}}]}}},
   AxesStyle->Automatic,
   FrameStyle->Automatic,
   ImagePadding->{{93.60000000000001, 7.2}, {1, 1}},
   ImageSize->244.8,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
   Ket[<||>] + Complex[0, 1] Ket[<|$CellContext`S[1, Q3`$] -> 1|>] + 
    Ket[<|$CellContext`S[2, Q3`$] -> 1|>]], 
   Q3`CNOT[{
      $CellContext`S[1, Q3`$]} -> {1}, {
     $CellContext`S[2, Q3`$]}], 
   $CellContext`S[1, 6], 
   Q3`Measurement[{
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3]}], "PortSize" -> {2.6, 0.2}]]], "Output",
 CellChangeTimes->{
  3.8204510008818293`*^9, {3.820451055656859*^9, 3.8204510800745573`*^9}, 
   3.820451131422929*^9, {3.820451381454278*^9, 3.820451398459756*^9}, 
   3.820451823516562*^9, 3.823845417957909*^9, 3.823845513779017*^9, {
   3.82400214003821*^9, 3.824002150003292*^9}, 3.8244207430796413`*^9, 
   3.8263297295181704`*^9, {3.826981749308433*^9, 3.8269817994837627`*^9}, 
   3.830143826072523*^9, 3.836211541994145*^9, 3.839373127913879*^9, 
   3.83971463294888*^9, {3.849264573862005*^9, 3.849264582007107*^9}, 
   3.85181020687051*^9, 3.8693881576766872`*^9, 3.885076448828355*^9},
 CellLabel->"Out[321]=",
 CellID->676798772,ExpressionUUID->"6b5bec65-885c-4ed1-903a-07577425a6a9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ExpressionFor", "[", "qc", "]"}], ";", 
      RowBox[{"FromDigits", "[", 
       RowBox[{
        RowBox[{"Readout", "@", 
         RowBox[{"S", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], ",", "3"}], "]"}]}], ",", "2"}], 
       "]"}]}], ",", "500"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", 
  RowBox[{"data", ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Readout\>\"", ",", "\"\<Counts\>\""}], "}"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8204475203975887`*^9, 3.820447746633793*^9}, {
   3.82045111698005*^9, 3.820451157083246*^9}, {3.8204513414676647`*^9, 
   3.820451357074744*^9}, {3.824420730995162*^9, 3.824420734684799*^9}, 
   3.8301434113002987`*^9, 3.8393731335314407`*^9, {3.8492645872878227`*^9, 
   3.849264601023102*^9}},
 CellLabel->
  "In[322]:=",ExpressionUUID->"35c86dd4-d3e7-4fe2-a980-e12f3782c5b0"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
    Opacity[0.6579999999999999], Thickness[Small]}], {}, 
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
     Opacity[0.6579999999999999], Thickness[Small]}], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{-0.5, 0}, {0.5, 77.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{43.987500000000004`, 
           94.24375}, {-10.502390193720657`, 45.228120643102955`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 77]& ,
        TagBoxNote->"77"],
       StyleBox["77", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[77, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{0.5, 0}, {1.5, 171.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{93.74375, 144.}, {-77.9266501763365, 
           45.228120643102955`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 171]& ,
        TagBoxNote->"171"],
       StyleBox["171", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[171, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{1.5, 0}, {2.5, 76.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{143.5, 193.75625000000002`}, {-9.785110832203465, 
           45.228120643102955`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 76]& ,
        TagBoxNote->"76"],
       StyleBox["76", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[76, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{2.5, 0}, {3.5, 176.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{193.25625000000002`, 
           243.51250000000005`}, {-81.51304698392244, 45.228120643102955`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 176]& ,
        TagBoxNote->"176"],
       StyleBox["176", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[176, {}], "Tooltip"]& ]}, {}, {}}, {{}, {}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{-0.58, 0},
  AxesStyle->Automatic,
  Frame->True,
  FrameLabel->{{
     FormBox[
      TagBox["\"Counts\"", HoldForm], TraditionalForm], None}, {
     FormBox[
      TagBox["\"Readout\"", HoldForm], TraditionalForm], None}},
  FrameStyle->Automatic,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->250,
  PlotRange->{{-0.5, 3.5}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {None, 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.820451159397303*^9, {3.820451346831991*^9, 3.8204514051695232`*^9}, 
   3.820451830509182*^9, 3.823845524359737*^9, 3.824002157870599*^9, {
   3.824420738496005*^9, 3.824420754765499*^9}, 3.826329736191433*^9, 
   3.830143833828311*^9, 3.8362115507542133`*^9, 3.8393731412549*^9, 
   3.839714641215128*^9, 3.8492646068808537`*^9, 3.851810210771072*^9, 
   3.869388163775341*^9, 3.8850764539956007`*^9},
 CellLabel->"Out[323]=",
 CellID->364805760,ExpressionUUID->"f70058c5-d99e-414a-af63-38d799265914"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
Saveable->False,
InitializationCellEvaluation->True,
InitializationCellWarning->False,
WindowSize->{748, 805},
WindowMargins->{{Automatic, 328}, {Automatic, 0}},
DockedCells->Cell[
 "Quantum Computation Workbook", "Text", Background -> GrayLevel[0.9], 
  FontSize -> 12, CellFrameMargins -> {{22, 8}, {8, 8}}],
PageFooters->{{
   Cell["Quantum Computation Workbook", "Footer", CellMargins -> 4], None, 
   None}, {None, None, 
   Cell["Quantum Computation Workbook", "Footer", CellMargins -> 4]}},
PageFooterLines->{True, True},
TaggingRules->{
 "DocuToolsSettings" -> {
   "$ApplicationName" -> "Q3", "$LinkBase" -> "Q3", "$DocumentationDirectory" -> 
    "/Users/Masso/Math/Apples/Q3App/Q3/Documentation/English/", 
    "$ApplicationDirectory" -> "/Users/Masso/Math/Apples/Q3App/Q3"}, 
  "TryRealOnly" -> False},
CreateCellID->True,
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (January 30, 2023)",
StyleDefinitions->"Playbook.nb",
ExpressionUUID->"a9b5e516-22bb-4dc2-98c0-90d5a5075e92"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "TableOfContents"->{
  Cell[2992, 81, 7448, 220, 397, "Text",ExpressionUUID->"7c968048-ded6-4305-9116-145cef563aec",
   CellTags->"TableOfContents",
   CellID->553974589]},
 "Section61"->{
  Cell[10465, 305, 202, 3, 67, "Section",ExpressionUUID->"94082665-6e64-4d6d-8a69-6ad86de08f8d",
   CellTags->"Section61",
   CellID->804948658]},
 "Section28"->{
  Cell[10692, 312, 199, 3, 54, "Subsection",ExpressionUUID->"d136d46e-6480-487d-bebd-7573dede2891",
   CellTags->"Section28",
   CellID->1537806034]},
 "Section29"->{
  Cell[57596, 1618, 202, 3, 54, "Subsection",ExpressionUUID->"476e1422-a4ae-450f-b26d-d6d62170e06c",
   CellTags->"Section29",
   CellID->1356319152]},
 "Section30"->{
  Cell[117440, 3308, 197, 3, 54, "Subsection",ExpressionUUID->"1e593bd0-1a30-4962-94f2-9b6fe4016acc",
   CellTags->"Section30",
   CellID->1968530614]},
 "Section31"->{
  Cell[142673, 4043, 202, 3, 67, "Section",ExpressionUUID->"adea6910-792e-4886-8ce4-806c410eb6aa",
   CellTags->"Section31",
   CellID->1365402155]},
 "Section32"->{
  Cell[142900, 4050, 302, 5, 54, "Subsection",ExpressionUUID->"ed5f99c6-048c-4a53-9423-e7dca2694995",
   CellTags->"Section32",
   CellID->693517034]},
 "Section33"->{
  Cell[267578, 7443, 263, 4, 54, "Subsection",ExpressionUUID->"941e53f5-576d-431a-98f9-9e5c9eae5948",
   CellTags->"Section33",
   CellID->1934269812]},
 "Section34"->{
  Cell[354726, 9818, 213, 3, 54, "Subsection",ExpressionUUID->"f333539f-4ca4-443d-8e3a-3c5226fa3e22",
   CellTags->"Section34",
   CellID->1510815334]},
 "Section35"->{
  Cell[438575, 12078, 262, 4, 67, "Section",ExpressionUUID->"639f1f48-d332-4fd1-9f8d-0ae85404cd50",
   CellTags->"Section35",
   CellID->882238498]},
 "Section36"->{
  Cell[442028, 12162, 255, 4, 54, "Subsection",ExpressionUUID->"dd33b19c-8dfc-4432-9db5-b5ebbb5ab77a",
   CellTags->"Section36",
   CellID->1865203558]},
 "Section37"->{
  Cell[470255, 12819, 309, 5, 54, "Subsection",ExpressionUUID->"fbf69b18-c702-4427-836a-9dd06010c9dc",
   CellTags->"Section37",
   CellID->2106499675]},
 "Section38"->{
  Cell[571266, 15467, 214, 3, 67, "Section",ExpressionUUID->"8dafbef9-55ec-4670-9d5d-9b65c47a47f5",
   CellTags->"Section38",
   CellID->1817331573]},
 "Section39"->{
  Cell[611682, 16551, 267, 4, 67, "Section",ExpressionUUID->"6065574e-02f6-4a40-9e06-f14c4b0db276",
   CellTags->"Section39",
   CellID->1767938601]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"TableOfContents", 658205, 17818},
 {"Section61", 658373, 17822},
 {"Section28", 658536, 17826},
 {"Section29", 658703, 17830},
 {"Section30", 658871, 17834},
 {"Section31", 659040, 17838},
 {"Section32", 659206, 17842},
 {"Section33", 659374, 17846},
 {"Section34", 659543, 17850},
 {"Section35", 659712, 17854},
 {"Section36", 659878, 17858},
 {"Section37", 660048, 17862},
 {"Section38", 660218, 17866},
 {"Section39", 660385, 17870}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 220, 4, 98, "Title",ExpressionUUID->"b9269d85-53e8-4b1a-8e3e-227531db259b",
 CellID->845773276],
Cell[803, 28, 1179, 30, 74, "Text",ExpressionUUID->"819d51fb-97b0-4eae-9610-287527d4535f",
 CellID->630101851],
Cell[1985, 60, 631, 10, 30, "Input",ExpressionUUID->"461ddb1f-d118-47e8-96bb-6e4be8172a11",
 CellID->717190239],
Cell[2619, 72, 370, 7, 52, "Input",ExpressionUUID->"d69ce98c-fbd2-4f2c-9529-43b1fbb7afb1",
 CellID->2138119909],
Cell[2992, 81, 7448, 220, 397, "Text",ExpressionUUID->"7c968048-ded6-4305-9116-145cef563aec",
 CellTags->"TableOfContents",
 CellID->553974589],
Cell[CellGroupData[{
Cell[10465, 305, 202, 3, 67, "Section",ExpressionUUID->"94082665-6e64-4d6d-8a69-6ad86de08f8d",
 CellTags->"Section61",
 CellID->804948658],
Cell[CellGroupData[{
Cell[10692, 312, 199, 3, 54, "Subsection",ExpressionUUID->"d136d46e-6480-487d-bebd-7573dede2891",
 CellTags->"Section28",
 CellID->1537806034],
Cell[CellGroupData[{
Cell[10916, 319, 471, 10, 38, "MathCaption",ExpressionUUID->"d40d797f-b56b-4c8d-b649-45cb89dd8676",
 CellID->1537445312],
Cell[CellGroupData[{
Cell[11412, 333, 297, 5, 30, "Input",ExpressionUUID->"9f04b05c-bb2d-4a40-b996-1f4295e63b61",
 CellID->1320118080],
Cell[11712, 340, 634, 14, 34, "Output",ExpressionUUID->"45c19c79-2065-4580-a6f9-828cae98c967",
 CellID->136613171]
}, Open  ]],
Cell[12361, 357, 179, 3, 35, "Text",ExpressionUUID->"80fb2058-0246-442b-b3e1-508dbf47c715",
 CellID->1571013403],
Cell[CellGroupData[{
Cell[12565, 364, 364, 7, 30, "Input",ExpressionUUID->"aa7af65a-3649-47da-8cf9-a438d55cc478",
 CellID->710824356],
Cell[12932, 373, 1362, 31, 63, "Output",ExpressionUUID->"25728273-fa53-493f-ad85-7d081509b96f",
 CellID->107894941]
}, Open  ]],
Cell[14309, 407, 286, 7, 35, "Text",ExpressionUUID->"054c6e66-8b9c-41eb-abf0-5b8eaa37e570",
 CellID->373423031],
Cell[CellGroupData[{
Cell[14620, 418, 342, 6, 30, "Input",ExpressionUUID->"a95d7495-bada-4c60-a336-2108079ab32c",
 CellID->1173665483],
Cell[14965, 426, 1494, 32, 55, "Output",ExpressionUUID->"707f8bb4-41d7-466a-ae94-3f94b5844f15",
 CellID->1351311228]
}, Open  ]],
Cell[16474, 461, 309, 6, 58, "Text",ExpressionUUID->"6ebc6fee-93f6-4100-ab1d-a3925d832171",
 CellID->1158475086],
Cell[CellGroupData[{
Cell[16808, 471, 592, 16, 73, "Input",ExpressionUUID->"ac64401f-2be2-440f-a859-7dda40e2db16",
 CellID->1404026700],
Cell[17403, 489, 2021, 58, 77, "Output",ExpressionUUID->"09da62fb-ab62-4800-8fa3-f43e73f6a338",
 CellID->587064359]
}, Open  ]],
Cell[19439, 550, 318, 7, 35, "Text",ExpressionUUID->"2461e8f2-87b4-402e-9cdb-0a444be5c840",
 CellID->926433664],
Cell[CellGroupData[{
Cell[19782, 561, 689, 19, 94, "Input",ExpressionUUID->"e9dc21d0-10de-4c40-ac88-9260c8ff2db3",
 CellID->1314150098],
Cell[20474, 582, 1266, 40, 38, "Output",ExpressionUUID->"00c09caf-c8ec-4d65-ac55-48b8ccaf876a",
 CellID->136310634],
Cell[21743, 624, 1267, 40, 38, "Output",ExpressionUUID->"9698b0a0-33c5-4a3e-bfaf-d3fd4699b0a5",
 CellID->1755257936]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23059, 670, 522, 11, 38, "MathCaption",ExpressionUUID->"a6ac5eb1-d684-4c82-8a9b-7174c87b2019",
 CellID->51387691],
Cell[CellGroupData[{
Cell[23606, 685, 373, 6, 30, "Input",ExpressionUUID->"1a85a8d3-1cb7-4325-825c-ee9b21250c1b",
 CellID->384496543],
Cell[23982, 693, 586, 13, 34, "Output",ExpressionUUID->"e7bf0233-b7e9-4361-a4f6-fe7c228d00ce",
 CellID->517522599]
}, Open  ]],
Cell[24583, 709, 227, 4, 35, "Text",ExpressionUUID->"8720ff9d-2e56-405f-a9c8-2d0b67114b55",
 CellID->455104378],
Cell[CellGroupData[{
Cell[24835, 717, 413, 7, 30, "Input",ExpressionUUID->"ce76741a-8ca8-4bc2-a88d-2561bf01c4e9",
 CellID->1750014079],
Cell[25251, 726, 1391, 32, 63, "Output",ExpressionUUID->"0d9258f1-29fb-4180-8494-f4f1cdde7946",
 CellID->944725950]
}, Open  ]],
Cell[26657, 761, 286, 7, 35, "Text",ExpressionUUID->"039859f0-c61e-4b04-afa2-cf8765ed58c1",
 CellID->550596441],
Cell[CellGroupData[{
Cell[26968, 772, 391, 6, 30, "Input",ExpressionUUID->"820ac768-ef2a-45c2-afc7-5eb82aa224f1",
 CellID->367348964],
Cell[27362, 780, 1434, 32, 55, "Output",ExpressionUUID->"d427944b-da7a-45bc-bd3b-a946ffa18b57",
 CellID->720650376]
}, Open  ]],
Cell[28811, 815, 573, 13, 62, "Text",ExpressionUUID->"976291a9-1dfc-4f2f-95f7-814fc2a4dc1d",
 CellID->18552823],
Cell[CellGroupData[{
Cell[29409, 832, 644, 17, 73, "Input",ExpressionUUID->"94f69b26-de8b-4a12-83d9-7b1159fad58b",
 CellID->432167346],
Cell[30056, 851, 2147, 60, 77, "Output",ExpressionUUID->"fef71098-edad-4065-8d67-f95187a63108",
 CellID->729818788]
}, Open  ]],
Cell[32218, 914, 220, 5, 35, "Text",ExpressionUUID->"0915300b-ea63-40a0-b571-ba028cd9d6ea",
 CellID->646890068],
Cell[CellGroupData[{
Cell[32463, 923, 738, 20, 94, "Input",ExpressionUUID->"91f59bd1-33ee-493a-869a-37d6dbd4a595",
 CellID->1719151762],
Cell[33204, 945, 1319, 41, 38, "Output",ExpressionUUID->"194a8477-4e75-4388-84c7-10940d5e0ee1",
 CellID->835653133],
Cell[34526, 988, 1319, 41, 38, "Output",ExpressionUUID->"8970c9eb-b58a-43a8-9052-aefc1b0ddbdd",
 CellID->279154951]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[35894, 1035, 572, 12, 38, "MathCaption",ExpressionUUID->"34ec3e66-ffaf-4447-963d-07cbb97eb58c",
 CellID->1538677196],
Cell[CellGroupData[{
Cell[36491, 1051, 371, 6, 30, "Input",ExpressionUUID->"ebb6e219-9b2e-4788-beb7-5d1a35d34947",
 CellID->549555998],
Cell[36865, 1059, 556, 12, 34, "Output",ExpressionUUID->"4b866561-df5c-4149-afcb-6c2ace133028",
 CellID->1902231535]
}, Open  ]],
Cell[37436, 1074, 228, 4, 35, "Text",ExpressionUUID->"7873df99-9826-4131-9179-b307bf904799",
 CellID->60492639],
Cell[CellGroupData[{
Cell[37689, 1082, 415, 7, 30, "Input",ExpressionUUID->"20673574-c5e0-413d-b784-8929a71b2f36",
 CellID->940018642],
Cell[38107, 1091, 1445, 33, 63, "Output",ExpressionUUID->"70898310-b7da-4178-9f8f-108138ea4bc9",
 CellID->1595486581]
}, Open  ]],
Cell[39567, 1127, 286, 7, 35, "Text",ExpressionUUID->"59e2dccf-2e45-42c4-a9b4-17c6b958522e",
 CellID->2003608762],
Cell[CellGroupData[{
Cell[39878, 1138, 445, 7, 30, "Input",ExpressionUUID->"8f326858-ced0-4ce4-a0ec-a8aa72348012",
 CellID->2108877974],
Cell[40326, 1147, 1486, 32, 55, "Output",ExpressionUUID->"329dbaf8-11fc-4d35-a8e1-71ac4e3800e8",
 CellID->903431194]
}, Open  ]],
Cell[41827, 1182, 288, 7, 35, "Text",ExpressionUUID->"19fa5d6e-4835-4fa4-90e5-9a2c951f7ea6",
 CellID->1841998930],
Cell[CellGroupData[{
Cell[42140, 1193, 532, 11, 52, "Input",ExpressionUUID->"c9e81ac5-8510-4af7-b766-fe5474c8677d",
 CellID->351761358],
Cell[42675, 1206, 1858, 42, 55, "Output",ExpressionUUID->"3f9dc362-4f15-40df-91bd-d921067beb77",
 CellID->6742353],
Cell[44536, 1250, 698, 15, 34, "Output",ExpressionUUID->"8887f028-b056-490d-8d71-243ea6dee8d9",
 CellID->1649577227]
}, Open  ]],
Cell[45249, 1268, 295, 6, 35, "Text",ExpressionUUID->"e07c1c22-ab65-4dd2-ab0d-2aff26f0976d",
 CellID->30663715],
Cell[CellGroupData[{
Cell[45569, 1278, 692, 17, 73, "Input",ExpressionUUID->"435c8fe5-586d-4a98-9cb0-e352c3bb0b5b",
 CellID->2116466372],
Cell[46264, 1297, 2326, 63, 77, "Output",ExpressionUUID->"020da87c-bb5e-4bbc-af89-14e34b596cd4",
 CellID->968569514]
}, Open  ]],
Cell[48605, 1363, 269, 6, 35, "Text",ExpressionUUID->"e71f598d-7326-4c0d-99bf-cd63e059da65",
 CellID->531185296],
Cell[CellGroupData[{
Cell[48899, 1373, 787, 21, 94, "Input",ExpressionUUID->"5c35afb4-3385-4510-916c-2a6ba6834367",
 CellID->541749293],
Cell[49689, 1396, 1418, 42, 38, "Output",ExpressionUUID->"5a0f79b9-30ea-4a71-92e2-39bdaa7797bb",
 CellID->1424026939],
Cell[51110, 1440, 1479, 43, 38, "Output",ExpressionUUID->"b0d60584-e897-420a-a1f5-5c7542042db1",
 CellID->2063001605]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[52638, 1489, 656, 13, 80, "MathCaption",ExpressionUUID->"e92b7fcd-10a8-4e75-b8b1-7af847a1dc0f",
 CellID->1997187818],
Cell[CellGroupData[{
Cell[53319, 1506, 510, 11, 52, "Input",ExpressionUUID->"40194263-cb82-4031-9c80-cb57644eedd4",
 CellID->1566254516],
Cell[53832, 1519, 779, 16, 37, "Output",ExpressionUUID->"80a32e78-5a39-4e88-b14f-914a69bf0fa6",
 CellID->1565924886],
Cell[54614, 1537, 764, 16, 34, "Output",ExpressionUUID->"cb81c886-eba9-4e00-8c1a-2bf919408c2e",
 CellID->1087465017]
}, Open  ]],
Cell[CellGroupData[{
Cell[55415, 1558, 346, 7, 30, "Input",ExpressionUUID->"77b6cd2e-cbee-44ad-9d20-25c06d263e23",
 CellID->185105486],
Cell[55764, 1567, 694, 15, 34, "Output",ExpressionUUID->"96a049ba-67e8-4df9-b9d6-4bad1709c269",
 CellID->507867996]
}, Open  ]],
Cell[CellGroupData[{
Cell[56495, 1587, 341, 7, 30, "Input",ExpressionUUID->"177acc05-085b-463a-bae7-2522109e4b9c",
 CellID->1511582346],
Cell[56839, 1596, 696, 15, 34, "Output",ExpressionUUID->"e177a38e-ae31-4801-8c52-55ee2412b211",
 CellID->427294717]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[57596, 1618, 202, 3, 54, "Subsection",ExpressionUUID->"476e1422-a4ae-450f-b26d-d6d62170e06c",
 CellTags->"Section29",
 CellID->1356319152],
Cell[CellGroupData[{
Cell[57823, 1625, 399, 6, 38, "MathCaption",ExpressionUUID->"f769a5e3-bf2f-4e09-92a4-b93206f50249",
 CellID->432945212],
Cell[CellGroupData[{
Cell[58247, 1635, 298, 5, 30, "Input",ExpressionUUID->"47f3a970-fafe-4050-812a-e1f285709a34",
 CellID->835582048],
Cell[58548, 1642, 812, 16, 36, "Output",ExpressionUUID->"efc48c70-0d1b-4c08-9e1e-51c4bb2aa7b6",
 CellID->867347770]
}, Open  ]],
Cell[59375, 1661, 191, 3, 35, "Text",ExpressionUUID->"e4dd0856-6164-478e-9665-3afc13159e36",
 CellID->1231913003],
Cell[CellGroupData[{
Cell[59591, 1668, 366, 8, 52, "Input",ExpressionUUID->"04b6ea28-31d2-40b7-a99d-54c71b6141d7",
 CellID->872000694],
Cell[59960, 1678, 1198, 31, 38, "Output",ExpressionUUID->"08cf0f92-c389-48f2-bfab-6a66cf8b464f",
 CellID->1656570076]
}, Open  ]],
Cell[61173, 1712, 225, 5, 35, "Text",ExpressionUUID->"739ff9df-a0e3-45d7-b955-463b615443e9",
 CellID->1287256930],
Cell[CellGroupData[{
Cell[61423, 1721, 390, 10, 52, "Input",ExpressionUUID->"1be73668-5869-47f8-af91-31634c0e24fb",
 CellID->1176962632],
Cell[61816, 1733, 2364, 66, 60, "Output",ExpressionUUID->"8719c5c5-3cfa-4d8e-baf6-7008bd149814",
 CellID->1381440742]
}, Open  ]],
Cell[64195, 1802, 230, 6, 35, "Text",ExpressionUUID->"96104f7d-8059-4047-87e8-d6b041f591b5",
 CellID->739083507],
Cell[CellGroupData[{
Cell[64450, 1812, 486, 8, 30, "Input",ExpressionUUID->"e5bf2746-cb4f-41e2-8a75-e4ee262cb69d",
 CellID->731087901],
Cell[64939, 1822, 1584, 34, 55, "Output",ExpressionUUID->"7c11486d-657d-4d47-bfde-0ff72be65571",
 CellID->1968947556]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[66572, 1862, 367, 9, 59, "MathCaption",ExpressionUUID->"225048a0-0443-4fc4-8b86-1db97d08705d",
 CellID->1640407620],
Cell[CellGroupData[{
Cell[66964, 1875, 617, 15, 73, "Input",ExpressionUUID->"26e4ef14-b02c-409c-b9a7-60883d5c07b5",
 CellID->935809154],
Cell[67584, 1892, 1033, 26, 56, "Output",ExpressionUUID->"6240bc47-877e-400d-a9b7-a7714d926544",
 CellID->417860374],
Cell[68620, 1920, 1439, 38, 83, "Output",ExpressionUUID->"a911a4fb-e832-4220-9cf2-cbd2b4ba537d",
 CellID->707780128]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[70108, 1964, 283, 5, 38, "MathCaption",ExpressionUUID->"2f4837d8-be97-403a-8c5c-173cb2279e61",
 CellID->2121704297],
Cell[CellGroupData[{
Cell[70416, 1973, 544, 13, 30, "Input",ExpressionUUID->"ca38990a-0cdc-4826-a204-9f637171dc4f",
 CellID->518161244],
Cell[70963, 1988, 1639, 40, 36, "Output",ExpressionUUID->"eb1c7374-4385-469e-8a52-d0b73948ca6f",
 CellID->156717585]
}, Open  ]],
Cell[72617, 2031, 214, 5, 35, "Text",ExpressionUUID->"9fb0127a-a410-4390-8586-f24c4d7d2157",
 CellID->689839323],
Cell[CellGroupData[{
Cell[72856, 2040, 482, 11, 30, "Input",ExpressionUUID->"b69d0e72-36c6-4e41-98b7-873a1904e2ab",
 CellID->2012775155],
Cell[73341, 2053, 2449, 55, 127, "Output",ExpressionUUID->"4dd4557e-473a-4860-988e-1f4e16a694f0",
 CellID->476513231]
}, Open  ]],
Cell[75805, 2111, 312, 7, 58, "Text",ExpressionUUID->"7e18452a-0569-4adf-a1d9-0a2b54f17598",
 CellID->1549622541],
Cell[CellGroupData[{
Cell[76142, 2122, 496, 10, 52, "Input",ExpressionUUID->"94bed628-1c51-4ad9-bafc-34b38a28a9e5",
 CellID->1971859418],
Cell[76641, 2134, 7961, 229, 112, "Output",ExpressionUUID->"8453eed1-de0a-47a4-9165-c4ad7d9327f0",
 CellID->85695982]
}, Open  ]],
Cell[84617, 2366, 196, 3, 35, "Text",ExpressionUUID->"eb4db5f6-63cf-4ad3-b807-39e17b864335",
 CellID->1073597822],
Cell[CellGroupData[{
Cell[84838, 2373, 751, 20, 52, "Input",ExpressionUUID->"ecd7fa40-6853-472e-bdae-fd0c3b6067de",
 CellID->800992260],
Cell[85592, 2395, 3293, 79, 122, "Output",ExpressionUUID->"f4674647-d3cc-41c5-a56e-e47172d51bb8",
 CellID->1218136502],
Cell[88888, 2476, 7690, 225, 112, "Output",ExpressionUUID->"7b166c67-9241-4123-9559-559b92e9e37e",
 CellID->1258582263]
}, Open  ]],
Cell[96593, 2704, 475, 9, 58, "Text",ExpressionUUID->"49a71700-0dcb-4633-aa86-3803e2291de7",
 CellID->1849414424],
Cell[CellGroupData[{
Cell[97093, 2717, 504, 13, 52, "Input",ExpressionUUID->"e62c0322-d909-4cd3-b091-d1310628f0ea",
 CellID->429917490],
Cell[97600, 2732, 1080, 26, 56, "Output",ExpressionUUID->"f730df0b-a94c-4cbf-9d75-c8383a449091",
 CellID->1186245656]
}, Open  ]],
Cell[98695, 2761, 249, 6, 35, "Text",ExpressionUUID->"04bb896f-583a-43f1-bc24-93f3c2ff4058",
 CellID->1488265922],
Cell[CellGroupData[{
Cell[98969, 2771, 610, 15, 52, "Input",ExpressionUUID->"7a389b76-cb08-43ea-8403-cbda62c14015",
 CellID->1543314445],
Cell[99582, 2788, 7274, 205, 63, "Output",ExpressionUUID->"a0ae0949-faed-4fd4-bd1c-0b7323be9843",
 CellID->1202793218]
}, Open  ]],
Cell[106871, 2996, 355, 7, 58, "Text",ExpressionUUID->"a34cdfc0-2df5-4237-8347-c3e10dab4246",
 CellID->1178388649],
Cell[CellGroupData[{
Cell[107251, 3007, 669, 19, 52, "Input",ExpressionUUID->"d2b5a4e7-ed69-4ff9-8110-c7150d0a5e80",
 CellID->1083831109],
Cell[107923, 3028, 1255, 31, 38, "Output",ExpressionUUID->"198735a1-8658-4086-87db-9ea3f9667d2c",
 CellID->1919234961]
}, Open  ]],
Cell[CellGroupData[{
Cell[109215, 3064, 377, 9, 52, "Input",ExpressionUUID->"18d52081-3866-4c2d-90be-9779731acb86",
 CellID->993155109],
Cell[109595, 3075, 7784, 226, 112, "Output",ExpressionUUID->"5c7500cb-5de6-404e-94ab-3704ca9380ff",
 CellID->355772000]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[117440, 3308, 197, 3, 54, "Subsection",ExpressionUUID->"1e593bd0-1a30-4962-94f2-9b6fe4016acc",
 CellTags->"Section30",
 CellID->1968530614],
Cell[CellGroupData[{
Cell[117662, 3315, 442, 9, 80, "MathCaption",ExpressionUUID->"f2f24e04-9fdb-403f-add0-d8e929804caa",
 CellID->1715012479],
Cell[CellGroupData[{
Cell[118129, 3328, 225, 4, 30, "Input",ExpressionUUID->"2a54fb18-00e8-4bf7-a7da-686ca3965443",
 CellID->689224519],
Cell[118357, 3334, 985, 27, 37, "Output",ExpressionUUID->"d57b1bc3-6d67-40b3-a92d-dbb6f079a444",
 CellID->1442955774]
}, Open  ]],
Cell[CellGroupData[{
Cell[119379, 3366, 645, 17, 73, "Input",ExpressionUUID->"3cd06a72-4ad6-4c15-82bf-a8c4a29647f5",
 CellID->269698915],
Cell[120027, 3385, 7559, 228, 227, "Output",ExpressionUUID->"4346332d-3f56-47af-994d-b494fb5ab891",
 CellID->127532265]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[127635, 3619, 221, 5, 38, "MathCaption",ExpressionUUID->"f2a37467-9d73-47e9-90b1-c57fcb5994a3",
 CellID->1639169235],
Cell[CellGroupData[{
Cell[127881, 3628, 875, 24, 115, "Input",ExpressionUUID->"686ac139-226e-4657-ae10-f3f6c796d108",
 CellID->1597108929],
Cell[128759, 3654, 1572, 44, 81, "Output",ExpressionUUID->"7c1307d7-b493-4f4e-adad-1513bed6883b",
 CellID->521199372]
}, Open  ]],
Cell[130346, 3701, 200, 3, 35, "Text",ExpressionUUID->"3397093a-8d5c-400b-9b10-8e804271c37d",
 CellID->1211665850],
Cell[CellGroupData[{
Cell[130571, 3708, 421, 8, 30, "Input",ExpressionUUID->"93fb0ed6-df89-44fe-9cd5-ba48c57fc637",
 CellID->2028000096],
Cell[130995, 3718, 1412, 37, 51, "Output",ExpressionUUID->"0a088b23-d6db-4360-b491-ec335f54d634",
 CellID->266071936]
}, Open  ]],
Cell[CellGroupData[{
Cell[132444, 3760, 232, 4, 30, "Input",ExpressionUUID->"66189222-96c7-43f8-83cf-2e8644a271b4",
 CellID->1884651935],
Cell[132679, 3766, 456, 7, 34, "Output",ExpressionUUID->"0225e4eb-3dc5-455c-a0ed-b107c39cfa63",
 CellID->835429486]
}, Open  ]],
Cell[133150, 3776, 193, 3, 35, "Text",ExpressionUUID->"c3344c8f-0bc2-44ed-b283-7bdcd12725d6",
 CellID->2108761942],
Cell[CellGroupData[{
Cell[133368, 3783, 242, 4, 30, "Input",ExpressionUUID->"320d0567-bffb-4dbe-872d-654258002135",
 CellID->2039332753],
Cell[133613, 3789, 566, 11, 47, "Output",ExpressionUUID->"92c25bea-1ada-4cc1-bf1a-29dbfc58a9b4",
 CellID->364488769]
}, Open  ]],
Cell[134194, 3803, 216, 5, 35, "Text",ExpressionUUID->"6acacd65-c3d7-45d4-9030-ea5863a1d74d",
 CellID->1226573551],
Cell[CellGroupData[{
Cell[134435, 3812, 405, 9, 52, "Input",ExpressionUUID->"f47f8d9d-3a73-418b-92af-38f97d7863c8",
 CellID->1326144104],
Cell[134843, 3823, 1286, 35, 51, "Output",ExpressionUUID->"95f88195-014d-4521-8259-d52140cba72f",
 CellID->74125460],
Cell[136132, 3860, 480, 7, 34, "Output",ExpressionUUID->"d8c93c07-8830-42ad-bd76-1c250bc7f204",
 CellID->286090960]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[136661, 3873, 256, 5, 38, "MathCaption",ExpressionUUID->"bdb7752e-8aef-4e86-ab08-20150eefbf82",
 CellID->103783938],
Cell[CellGroupData[{
Cell[136942, 3882, 364, 8, 52, "Input",ExpressionUUID->"194d7f2a-cdd0-49a9-9eea-c8e2837d273b",
 CellID->1626811097],
Cell[137309, 3892, 610, 13, 36, "Output",ExpressionUUID->"980712a2-f166-4e03-85b2-c4849a29b594",
 CellID->1097510781],
Cell[137922, 3907, 978, 24, 63, "Output",ExpressionUUID->"bddf400d-c8d4-4fc7-9b9d-a851172c8a72",
 CellID->1126652184]
}, Open  ]],
Cell[CellGroupData[{
Cell[138937, 3936, 220, 4, 30, "Input",ExpressionUUID->"725a4fa7-75e6-4b93-b0d8-24cb8e0b562a",
 CellID->2020351583],
Cell[139160, 3942, 561, 13, 36, "Output",ExpressionUUID->"a6e93658-d0d6-4d74-8310-7ec51cbd9284",
 CellID->55431994]
}, Open  ]],
Cell[CellGroupData[{
Cell[139758, 3960, 416, 9, 52, "Input",ExpressionUUID->"ee45a873-4863-4942-9ac2-84da084efc53",
 CellID->961031737],
Cell[140177, 3971, 612, 13, 36, "Output",ExpressionUUID->"5407d22c-607d-4708-9c80-0e0b6422595b",
 CellID->1897803664],
Cell[140792, 3986, 1104, 28, 73, "Output",ExpressionUUID->"e5972625-a9f0-4746-bb8b-64f0aa3404c9",
 CellID->1959055604]
}, Open  ]],
Cell[CellGroupData[{
Cell[141933, 4019, 221, 4, 30, "Input",ExpressionUUID->"aca25bd0-47a1-451b-b81a-cf937c774330",
 CellID->1451468907],
Cell[142157, 4025, 443, 10, 36, "Output",ExpressionUUID->"280cb43a-30c0-4284-9eb6-f7277ed2402f",
 CellID->1591240861]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[142673, 4043, 202, 3, 67, "Section",ExpressionUUID->"adea6910-792e-4886-8ce4-806c410eb6aa",
 CellTags->"Section31",
 CellID->1365402155],
Cell[CellGroupData[{
Cell[142900, 4050, 302, 5, 54, "Subsection",ExpressionUUID->"ed5f99c6-048c-4a53-9423-e7dca2694995",
 CellTags->"Section32",
 CellID->693517034],
Cell[CellGroupData[{
Cell[143227, 4059, 468, 13, 38, "MathCaption",ExpressionUUID->"3713a507-5340-45ca-a49e-2aaf835335d4",
 CellID->1918667362],
Cell[CellGroupData[{
Cell[143720, 4076, 312, 7, 30, "Input",ExpressionUUID->"73061649-43ed-4520-b6b7-d009d4ccbf88",
 CellID->427909782],
Cell[144035, 4085, 1187, 31, 34, "Output",ExpressionUUID->"36c0c3f6-3808-4af7-b610-c5b764eb1584",
 CellID->2142479741]
}, Open  ]],
Cell[145237, 4119, 251, 4, 35, "Text",ExpressionUUID->"57dd86fe-cc77-4720-923f-bc98a2758b6d",
 CellID->2104455918],
Cell[CellGroupData[{
Cell[145513, 4127, 383, 6, 30, "Input",ExpressionUUID->"edccf931-013e-4e31-8d39-49d787084bd2",
 CellID->534947736],
Cell[145899, 4135, 1529, 31, 91, "Output",ExpressionUUID->"98622c08-a5f3-49fc-83f8-ac6fb45af464",
 CellID->1372361754]
}, Open  ]],
Cell[147443, 4169, 235, 6, 35, "Text",ExpressionUUID->"15672d67-45c3-4138-a721-87abf506e789",
 CellID->1500052610],
Cell[CellGroupData[{
Cell[147703, 4179, 264, 5, 30, "Input",ExpressionUUID->"7c1e3e3f-1e75-4912-a7b9-7d54836007ed",
 CellID->2073684137],
Cell[147970, 4186, 1801, 48, 52, "Output",ExpressionUUID->"11c29e27-63b9-4bda-a8b0-1159c76b3734",
 CellID->2147116260]
}, Open  ]],
Cell[149786, 4237, 221, 5, 35, "Text",ExpressionUUID->"62136129-a8d2-4072-b6da-5df546df68f9",
 CellID->897183396],
Cell[CellGroupData[{
Cell[150032, 4246, 240, 4, 30, "Input",ExpressionUUID->"675cc0f9-bbcc-419e-880f-85ae0c71c10c",
 CellID->1478650985],
Cell[150275, 4252, 1160, 28, 97, "Output",ExpressionUUID->"6c4a04d8-ad23-4f94-ab1d-fc3dedfffb35",
 CellID->711566354]
}, Open  ]],
Cell[151450, 4283, 218, 5, 35, "Text",ExpressionUUID->"2f65ec29-3c79-44cc-bfaf-6d817b74308b",
 CellID->1006341811],
Cell[CellGroupData[{
Cell[151693, 4292, 636, 17, 73, "Input",ExpressionUUID->"5237c434-daa6-46f9-9caa-808e7c7ed4fc",
 CellID->5613705],
Cell[152332, 4311, 6392, 173, 125, "Output",ExpressionUUID->"f42b90db-8271-4350-a147-e3d51e4e8bba",
 CellID->159592634]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[158773, 4490, 298, 7, 38, "MathCaption",ExpressionUUID->"19d7f2f6-e732-4008-add4-435ef192f7c9",
 CellID->2007743114],
Cell[CellGroupData[{
Cell[159096, 4501, 598, 13, 30, "Input",ExpressionUUID->"25ac0706-c91a-476b-b4f8-d066587c6aeb",
 CellID->727971687],
Cell[159697, 4516, 1927, 40, 91, "Output",ExpressionUUID->"f6453fc3-cea9-4029-939c-2982c55fb94e",
 CellID->1447828988]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[161673, 4562, 235, 5, 38, "MathCaption",ExpressionUUID->"2e13d3e5-2de8-4d2a-8564-202c87ea586b",
 CellID->805806450],
Cell[CellGroupData[{
Cell[161933, 4571, 963, 24, 73, "Input",ExpressionUUID->"b80b94c1-159c-4adb-9084-6329740a96ef",
 CellID->1157127168],
Cell[162899, 4597, 2540, 56, 89, "Output",ExpressionUUID->"64d30914-e401-412a-8c74-441ec0e500e0",
 CellID->1749038455],
Cell[165442, 4655, 1921, 49, 60, "Output",ExpressionUUID->"16088089-3e61-48a7-b847-dfcb7b5c880c",
 CellID->1333153049]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[167412, 4710, 253, 6, 38, "MathCaption",ExpressionUUID->"3d142bbd-6d0a-42be-92a0-5d822e70e255",
 CellID->224405344],
Cell[CellGroupData[{
Cell[167690, 4720, 875, 23, 115, "Input",ExpressionUUID->"0147afec-6f57-4ae9-873a-2960749d7463",
 CellID->599332476],
Cell[168568, 4745, 9940, 275, 173, "Output",ExpressionUUID->"21f2de2b-ea83-401e-92bb-6ca0484b9db7",
 CellID->1322465349]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[178557, 5026, 581, 12, 59, "MathCaption",ExpressionUUID->"99da444a-e79b-4f22-b4cf-69f285e8ab90",
 CellID->1282619702],
Cell[CellGroupData[{
Cell[179163, 5042, 1265, 30, 52, "Input",ExpressionUUID->"162b2b9b-998c-482b-a43c-a108917fe950",
 CellID->548482928],
Cell[180431, 5074, 3903, 90, 195, "Output",ExpressionUUID->"08dc460f-1050-48e5-840e-dc559f5855da",
 CellID->1610294984]
}, Open  ]],
Cell[CellGroupData[{
Cell[184371, 5169, 374, 8, 52, "Input",ExpressionUUID->"49801697-7284-448d-9a55-8d7062c506fe",
 CellID->1352757972],
Cell[184748, 5179, 5234, 144, 49, "Output",ExpressionUUID->"760ce40f-74cf-4036-a2d0-7f785dd53412",
 CellID->1104648573]
}, Open  ]],
Cell[189997, 5326, 327, 7, 58, "Text",ExpressionUUID->"ca1a3d64-8ee3-4f65-86cc-d69c6037c98a",
 CellID->393864615],
Cell[CellGroupData[{
Cell[190349, 5337, 236, 4, 30, "Input",ExpressionUUID->"9e8ead7d-ff3b-4592-af30-b98845f5770b",
 CellID->1137984251],
Cell[190588, 5343, 3750, 97, 49, "Output",ExpressionUUID->"dae118e2-1771-416e-8afa-d5de9136add2",
 CellID->1378058886]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[194387, 5446, 332, 9, 38, "MathCaption",ExpressionUUID->"beedc2b8-0af7-48f7-934d-148ce1092bc4",
 CellID->611946375],
Cell[CellGroupData[{
Cell[194744, 5459, 1498, 36, 73, "Input",ExpressionUUID->"93d13f21-efdf-46ea-ae94-857a21d2ffcc",
 CellID->683539142],
Cell[196245, 5497, 5370, 123, 266, "Output",ExpressionUUID->"23aa6cde-69ff-4d99-8b48-313389fa1010",
 CellID->624929922]
}, Open  ]],
Cell[CellGroupData[{
Cell[201652, 5625, 355, 9, 52, "Input",ExpressionUUID->"b263c9c4-e604-4a79-8d6e-437d1139f391",
 CellID->1352331791],
Cell[202010, 5636, 13479, 377, 164, "Output",ExpressionUUID->"cf48dd5b-4cec-4890-b381-bba81a5c7de7",
 CellID->800100499]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[215538, 6019, 213, 4, 38, "MathCaption",ExpressionUUID->"86311d7b-a13f-419e-b1e8-5fe144b9fc85",
 CellID->1820975136],
Cell[CellGroupData[{
Cell[215776, 6027, 312, 8, 30, "Input",ExpressionUUID->"742e4748-dc5d-4586-a8be-384167fd6656",
 CellID->1339657355],
Cell[216091, 6037, 884, 25, 34, "Output",ExpressionUUID->"1740f5ba-cf3d-42a7-8f0c-a4c7ed34bf6d",
 CellID->598675306]
}, Open  ]],
Cell[216990, 6065, 196, 3, 35, "Text",ExpressionUUID->"111abc9c-ba2a-4839-b19a-18551ebc8ac9",
 CellID->1402610337],
Cell[CellGroupData[{
Cell[217211, 6072, 588, 17, 73, "Input",ExpressionUUID->"ef7281d7-95e0-46a1-8049-818e7886a5f0",
 CellID->743940840],
Cell[217802, 6091, 6351, 175, 125, "Output",ExpressionUUID->"048a0d30-4ad0-4fb4-b06f-d5fef1bd77fd",
 CellID->1350625437]
}, Open  ]],
Cell[224168, 6269, 190, 3, 35, "Text",ExpressionUUID->"35978355-60c6-4eea-a1cf-1bf70781a1af",
 CellID->763905046],
Cell[CellGroupData[{
Cell[224383, 6276, 352, 8, 52, "Input",ExpressionUUID->"884e58df-4e11-4a5b-bd4f-51534f9b7467",
 CellID->1294866356],
Cell[224738, 6286, 1167, 30, 97, "Output",ExpressionUUID->"6585a36a-3d68-4a98-9e24-cc7712a5b269",
 CellID->2116567763]
}, Open  ]],
Cell[225920, 6319, 191, 3, 35, "Text",ExpressionUUID->"5251ee94-36c2-4210-96d4-a9e3983ee526",
 CellID->219566594],
Cell[CellGroupData[{
Cell[226136, 6326, 385, 10, 30, "Input",ExpressionUUID->"2b2b37e3-421d-401d-9490-b52a20622e4b",
 CellID->878839812],
Cell[226524, 6338, 1040, 25, 91, "Output",ExpressionUUID->"d20aa3f8-0c56-4e86-aa9b-05f9aa657823",
 CellID->248116771]
}, Open  ]],
Cell[227579, 6366, 172, 3, 35, "Text",ExpressionUUID->"4e19c8f7-7036-4bb9-8b9b-ff86fea97932",
 CellID->268196218],
Cell[CellGroupData[{
Cell[227776, 6373, 636, 17, 52, "Input",ExpressionUUID->"954b2d20-aa32-4553-b5aa-7c62004afb2f",
 CellID->5660873],
Cell[228415, 6392, 1401, 39, 36, "Output",ExpressionUUID->"cef51b13-e529-4b54-99d5-359602530dcf",
 CellID->1649451623],
Cell[229819, 6433, 438, 7, 34, "Output",ExpressionUUID->"81e1a494-0a2a-4041-bc81-42e2818228c1",
 CellID->467028638]
}, Open  ]],
Cell[230272, 6443, 221, 5, 35, "Text",ExpressionUUID->"5042ed73-c49f-4a83-9bf8-e00d3a850ef8",
 CellID->653012043],
Cell[CellGroupData[{
Cell[230518, 6452, 416, 11, 30, "Input",ExpressionUUID->"72dfe879-0207-4672-8f64-f899d60fec73",
 CellID->1531970531],
Cell[230937, 6465, 1976, 46, 91, "Output",ExpressionUUID->"37063ecf-2fbb-466a-b7ea-672285068681",
 CellID->464217749]
}, Open  ]],
Cell[CellGroupData[{
Cell[232950, 6516, 391, 10, 30, "Input",ExpressionUUID->"8713da6b-c48a-4c57-ab1b-0698748d40d4",
 CellID->1647270634],
Cell[233344, 6528, 1211, 27, 91, "Output",ExpressionUUID->"c04074c2-3045-4b78-977e-03bd1cefd8f0",
 CellID->320331823]
}, Open  ]],
Cell[CellGroupData[{
Cell[234592, 6560, 288, 6, 30, "Input",ExpressionUUID->"a508780c-24cc-4ba5-80ae-799fcb39cb25",
 CellID->318368514],
Cell[234883, 6568, 463, 7, 34, "Output",ExpressionUUID->"b21763ac-b7a3-4e86-a86e-b81628867080",
 CellID->83729997]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[235395, 6581, 215, 2, 38, "MathCaption",ExpressionUUID->"bfb4feae-4d8a-448b-9cbe-6d324dbbe0a9",
 CellID->774086453],
Cell[CellGroupData[{
Cell[235635, 6587, 381, 9, 30, "Input",ExpressionUUID->"2662d666-5f3f-4df1-b4b4-ceae4ce6e94e",
 CellID->1456780551],
Cell[236019, 6598, 850, 23, 34, "Output",ExpressionUUID->"0124a8a0-1c4e-43d5-ac2d-b29c7aad3da1",
 CellID->48984789]
}, Open  ]],
Cell[CellGroupData[{
Cell[236906, 6626, 606, 17, 73, "Input",ExpressionUUID->"1b187ddd-1008-498d-aff2-41c4537043ce",
 CellID->2038406925],
Cell[237515, 6645, 6222, 171, 125, "Output",ExpressionUUID->"7496170e-a56c-43b9-8e3d-0ba681c679c2",
 CellID->1526319740]
}, Open  ]],
Cell[243752, 6819, 237, 4, 35, "Text",ExpressionUUID->"a8e1da40-7f05-42f6-b559-317c8e81d542",
 CellID->2139433950],
Cell[CellGroupData[{
Cell[244014, 6827, 340, 7, 30, "Input",ExpressionUUID->"0ac910d7-cfe3-48f6-a234-57b5e3d8dbf4",
 CellID->227701226],
Cell[244357, 6836, 1184, 29, 97, "Output",ExpressionUUID->"fe82a1ac-efbf-4a69-b1e2-5cb49a61f07e",
 CellID->1158508109]
}, Open  ]],
Cell[245556, 6868, 290, 5, 35, "Text",ExpressionUUID->"4bf6d41d-890d-484d-bf66-d6eed6823456",
 CellID->313606930],
Cell[CellGroupData[{
Cell[245871, 6877, 430, 10, 30, "Input",ExpressionUUID->"bd4b4c68-02dd-41cd-9d5a-73616cdbc9d5",
 CellID->2047491910],
Cell[246304, 6889, 1206, 28, 91, "Output",ExpressionUUID->"f39f8bbc-6f83-47a5-b894-a2d1c78ac4bb",
 CellID->1267763858]
}, Open  ]],
Cell[247525, 6920, 245, 3, 35, "Text",ExpressionUUID->"8d47bb6d-8a80-4859-b533-152e7858ae39",
 CellID->2132820600],
Cell[CellGroupData[{
Cell[247795, 6927, 786, 20, 30, "Input",ExpressionUUID->"f0b4ebd2-9ae2-4fb0-90c4-ff514c1cea8e",
 CellID->1679469749],
Cell[248584, 6949, 1971, 42, 91, "Output",ExpressionUUID->"35bf45e2-4ec5-4fcd-a91e-c2c33bbf580b",
 CellID->405782430]
}, Open  ]],
Cell[CellGroupData[{
Cell[250592, 6996, 304, 6, 30, "Input",ExpressionUUID->"1b4e444f-8870-4385-91ea-5f812d8cbeed",
 CellID->959973641],
Cell[250899, 7004, 417, 7, 34, "Output",ExpressionUUID->"faa37120-0d85-438f-a6d8-c9aa001f7eda",
 CellID->538259628]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[251365, 7017, 604, 15, 63, "MathCaption",ExpressionUUID->"bfe441d5-b2cd-43da-9630-5bc8fa995daa",
 CellID->1938247085],
Cell[CellGroupData[{
Cell[251994, 7036, 642, 16, 52, "Input",ExpressionUUID->"19ccf822-7ce5-490b-a6fb-49f8e60b5de6",
 CellID->1040933486],
Cell[252639, 7054, 1431, 37, 113, "Output",ExpressionUUID->"da84ab7b-4097-41e9-bad8-a8b2e2cb6170",
 CellID->1217449125]
}, Open  ]],
Cell[254085, 7094, 387, 9, 37, "Text",ExpressionUUID->"4c588bc8-aa28-4473-b7e9-bbf87a5b3cb5",
 CellID->771058470],
Cell[CellGroupData[{
Cell[254497, 7107, 648, 15, 38, "Input",ExpressionUUID->"0339f499-0c88-42b7-bb65-5eff99be5f8b",
 CellID->1895203240],
Cell[255148, 7124, 3649, 96, 49, "Output",ExpressionUUID->"a4b0a1e0-3871-4983-bdd0-fd0a35b77891",
 CellID->1935802717]
}, Open  ]],
Cell[258812, 7223, 1007, 26, 85, "Text",ExpressionUUID->"611407e5-95ef-4190-a643-0428a6363dce",
 CellID->27233292],
Cell[CellGroupData[{
Cell[259844, 7253, 904, 20, 30, "Input",ExpressionUUID->"367e64ca-807e-42d6-b279-334ee0537f88",
 CellID->1505230369],
Cell[260751, 7275, 4722, 108, 91, "Output",ExpressionUUID->"ded39a1e-9b26-4573-93c3-4645d6993e3c",
 CellID->1583044586]
}, Open  ]],
Cell[265488, 7386, 333, 6, 58, "Text",ExpressionUUID->"d587331a-e908-4850-b6f3-d78693de12df",
 CellID->535686806],
Cell[CellGroupData[{
Cell[265846, 7396, 310, 6, 30, "Input",ExpressionUUID->"951a3b0a-5f82-48be-96e4-4c6525b53251",
 CellID->851721286],
Cell[266159, 7404, 1358, 32, 97, "Output",ExpressionUUID->"971d2c5b-9997-4a10-9a8d-94411029c15d",
 CellID->680315088]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[267578, 7443, 263, 4, 54, "Subsection",ExpressionUUID->"941e53f5-576d-431a-98f9-9e5c9eae5948",
 CellTags->"Section33",
 CellID->1934269812],
Cell[CellGroupData[{
Cell[267866, 7451, 377, 8, 59, "MathCaption",ExpressionUUID->"ed065515-4cdf-4145-841b-4599eca48efe",
 CellID->1437850121],
Cell[CellGroupData[{
Cell[268268, 7463, 722, 19, 73, "Input",ExpressionUUID->"f2d04065-a079-42c4-8e45-c96527d55c67",
 CellID->313503956],
Cell[268993, 7484, 3595, 88, 95, "Output",ExpressionUUID->"599fed57-41fd-41bf-8ea6-8a0293714283",
 CellID->2039980724]
}, Open  ]],
Cell[272603, 7575, 308, 6, 35, "Text",ExpressionUUID->"31bdb47d-0746-4087-a416-776c5028e602",
 CellID->1283602401],
Cell[CellGroupData[{
Cell[272936, 7585, 485, 10, 30, "Input",ExpressionUUID->"618f59e3-3c1a-4b9b-b7d9-ad0eedfd9fbf",
 CellID->2032319492],
Cell[273424, 7597, 1767, 39, 91, "Output",ExpressionUUID->"5086567c-73e5-4d10-8835-795436bcb21c",
 CellID->1694729521]
}, Open  ]],
Cell[275206, 7639, 253, 6, 35, "Text",ExpressionUUID->"cdf8bb19-d46b-47ff-b13d-68a35c9013cf",
 CellID->1466296509],
Cell[CellGroupData[{
Cell[275484, 7649, 388, 7, 30, "Input",ExpressionUUID->"660d6695-82f7-4a57-bb33-05d6e30434e2",
 CellID->1670577438],
Cell[275875, 7658, 2500, 63, 49, "Output",ExpressionUUID->"1b3dd1ee-0706-4ec8-be07-4d62dbcdd202",
 CellID->1031873099]
}, Open  ]],
Cell[278390, 7724, 314, 6, 35, "Text",ExpressionUUID->"904720f4-31cd-498b-8988-8befba294ccb",
 CellID->1193799588],
Cell[CellGroupData[{
Cell[278729, 7734, 657, 18, 73, "Input",ExpressionUUID->"155d0ca2-5755-460d-ba24-df161d390819",
 CellID->1390317228],
Cell[279389, 7754, 8264, 227, 133, "Output",ExpressionUUID->"d05285f7-e61b-4311-9348-4f7ba062fc0d",
 CellID->923818888]
}, Open  ]],
Cell[287668, 7984, 342, 9, 58, "Text",ExpressionUUID->"187be339-214b-4b10-a40f-396c310d8b6a",
 CellID->249961595],
Cell[CellGroupData[{
Cell[288035, 7997, 850, 23, 73, "Input",ExpressionUUID->"a6d7a75a-e2d6-489c-a4d0-67f6217085f4",
 CellID->626513633],
Cell[288888, 8022, 2145, 63, 38, "Output",ExpressionUUID->"652fba08-2e3f-4aaf-b736-08fd5277ebc2",
 CellID->1658655806]
}, Open  ]],
Cell[CellGroupData[{
Cell[291070, 8090, 539, 13, 52, "Input",ExpressionUUID->"0b820882-78fc-4249-8fde-f20dd24dcf7c",
 CellID->702308590],
Cell[291612, 8105, 2281, 64, 38, "Output",ExpressionUUID->"ae33ec12-934e-4d30-921b-078f85a32a38",
 CellID->1246130843]
}, Open  ]],
Cell[293908, 8172, 524, 12, 64, "Text",ExpressionUUID->"f8067e5d-6583-436c-b66a-29dc78d3c907",
 CellID->1130348218],
Cell[CellGroupData[{
Cell[294457, 8188, 951, 27, 52, "Input",ExpressionUUID->"3a303710-2874-4579-94c7-3d7040ed3d00",
 CellID->1122158564],
Cell[295411, 8217, 2121, 62, 38, "Output",ExpressionUUID->"ae698ae3-406b-4592-9634-389307020743",
 CellID->246294671]
}, Open  ]],
Cell[CellGroupData[{
Cell[297569, 8284, 535, 13, 52, "Input",ExpressionUUID->"4925dc93-e7a5-47a4-9644-ce18d2637c36",
 CellID->917597194],
Cell[298107, 8299, 3030, 91, 49, "Output",ExpressionUUID->"5c33c438-34aa-44c4-8491-238f58b83649",
 CellID->983567073]
}, Open  ]],
Cell[301152, 8393, 328, 7, 35, "Text",ExpressionUUID->"06bc5fd9-b738-421f-9fef-fe5ac09b0b15",
 CellID->975970451],
Cell[CellGroupData[{
Cell[301505, 8404, 607, 17, 52, "Input",ExpressionUUID->"332b5ad0-5897-4d08-8551-5cef7935e2db",
 CellID->655274171],
Cell[302115, 8423, 1654, 45, 38, "Output",ExpressionUUID->"c611e751-f8ae-4ad8-a1f7-590386b2dcc2",
 CellID->1263014060]
}, Open  ]],
Cell[CellGroupData[{
Cell[303806, 8473, 485, 12, 52, "Input",ExpressionUUID->"4ae5b871-9dd2-4f67-93ec-97aac51c803e",
 CellID->896850181],
Cell[304294, 8487, 2611, 70, 49, "Output",ExpressionUUID->"9541118f-c59f-4029-9bce-1bca4d87ae09",
 CellID->1559502523]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[306954, 8563, 375, 8, 59, "MathCaption",ExpressionUUID->"481387f5-bfa4-4280-b916-1fae2b5f50e8",
 CellID->173273774],
Cell[CellGroupData[{
Cell[307354, 8575, 990, 29, 52, "Input",ExpressionUUID->"3fdcd847-482f-42dd-9b95-76e08359d6dc",
 CellID->224494286],
Cell[308347, 8606, 2456, 67, 38, "Output",ExpressionUUID->"9950da79-f317-46b3-867b-3dea49225e77",
 CellID->904471441]
}, Open  ]],
Cell[CellGroupData[{
Cell[310840, 8678, 628, 16, 52, "Input",ExpressionUUID->"f3b93758-21b9-4bc7-9e30-8860026bcc1f",
 CellID->2094180670],
Cell[311471, 8696, 2733, 71, 50, "Output",ExpressionUUID->"096337c3-45ba-4d39-abf2-4467de990d85",
 CellID->2018148880]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[314253, 8773, 258, 6, 38, "MathCaption",ExpressionUUID->"c362a021-84c0-4e78-a7fb-d865e5969ee1",
 CellID->1785030007],
Cell[CellGroupData[{
Cell[314536, 8783, 1343, 40, 115, "Input",ExpressionUUID->"efef6c29-73a7-4d71-91a4-071ed184d62f",
 CellID->652779059],
Cell[315882, 8825, 3133, 66, 163, "Output",ExpressionUUID->"c235847b-323f-4a65-a540-d31ae9ea6948",
 CellID->1346868080]
}, Open  ]],
Cell[319030, 8894, 549, 15, 58, "Text",ExpressionUUID->"ff179d55-0027-4dc8-a7f8-c66f69c6b822",
 CellID->1911175737],
Cell[CellGroupData[{
Cell[319604, 8913, 1344, 41, 136, "Input",ExpressionUUID->"f576b64f-6c45-4bb0-8b47-651826179a18",
 CellID->1217703580],
Cell[320951, 8956, 18815, 485, 163, "Output",ExpressionUUID->"e085a453-fec8-435d-9ccc-8b01bac3526d",
 CellID->1685298418]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[339815, 9447, 313, 5, 38, "MathCaption",ExpressionUUID->"35bb3dee-2c1d-46bb-bd1b-b7b7634ab11c",
 CellID->424913150],
Cell[CellGroupData[{
Cell[340153, 9456, 503, 10, 52, "Input",ExpressionUUID->"821935eb-7c47-4517-b0f6-561730b37c4b",
 CellID->1132185775],
Cell[340659, 9468, 1522, 34, 63, "Output",ExpressionUUID->"e722f9cb-0320-4af5-a04d-e8d6c7dc85f7",
 CellID->235210588]
}, Open  ]],
Cell[CellGroupData[{
Cell[342218, 9507, 826, 19, 52, "Input",ExpressionUUID->"3549e6be-0b07-4d3c-abd6-202a9712c3a4",
 CellID->1941208005],
Cell[343047, 9528, 2106, 43, 91, "Output",ExpressionUUID->"fb816d26-352a-44ea-8919-a699f4e11717",
 CellID->384081575]
}, Open  ]],
Cell[345168, 9574, 227, 5, 35, "Text",ExpressionUUID->"0350c74e-1d9e-4fab-997d-23bbaf569e0d",
 CellID->1311374811],
Cell[CellGroupData[{
Cell[345420, 9583, 650, 18, 73, "Input",ExpressionUUID->"397e4dc8-2900-4e45-a8d9-fe5be97cd6e3",
 CellID->651779316],
Cell[346073, 9603, 888, 15, 34, "Output",ExpressionUUID->"405fd83a-f8a9-450d-b161-0eaa4b18b771",
 CellID->2014505593]
}, Open  ]],
Cell[346976, 9621, 198, 3, 35, "Text",ExpressionUUID->"76f3ffa7-eddf-4476-8949-f31fb5836821",
 CellID->140880665],
Cell[347177, 9626, 1729, 50, 94, "Input",ExpressionUUID->"7468a672-6d94-416a-aa0a-cb58a12e7813",
 CellID->1254357661],
Cell[348909, 9678, 200, 3, 35, "Text",ExpressionUUID->"5dc901f5-de25-4fad-8d11-2c928700511a",
 CellID->142245828],
Cell[CellGroupData[{
Cell[349134, 9685, 687, 17, 30, "Input",ExpressionUUID->"9a61e5ab-8d0f-438a-b10a-136d38176ee4",
 CellID->576332085],
Cell[349824, 9704, 3984, 83, 91, "Output",ExpressionUUID->"1c98c898-971c-4925-ab30-472eb278ac6d",
 CellID->219823090]
}, Open  ]],
Cell[353823, 9790, 161, 3, 35, "Text",ExpressionUUID->"a53ebdcd-5fd2-4321-a3c9-f72fadd4e239",
 CellID->1262104625],
Cell[CellGroupData[{
Cell[354009, 9797, 286, 6, 30, "Input",ExpressionUUID->"125cf67c-eff7-473c-af1a-3a9b30fc2631",
 CellID->1395051790],
Cell[354298, 9805, 367, 6, 34, "Output",ExpressionUUID->"5456f3b7-fc6d-4ff4-a2ca-c61a9259336b",
 CellID->2054923072]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[354726, 9818, 213, 3, 54, "Subsection",ExpressionUUID->"f333539f-4ca4-443d-8e3a-3c5226fa3e22",
 CellTags->"Section34",
 CellID->1510815334],
Cell[CellGroupData[{
Cell[354964, 9825, 272, 6, 59, "MathCaption",ExpressionUUID->"dc7b920a-b5c6-48c5-88bc-9069675bb175",
 CellID->1496450956],
Cell[CellGroupData[{
Cell[355261, 9835, 1026, 26, 73, "Input",ExpressionUUID->"4554c789-7854-4252-a865-cefc4edb0552",
 CellID->1670227475],
Cell[356290, 9863, 2426, 62, 36, "Output",ExpressionUUID->"f051eb5f-5367-4117-b936-9e390e76e359",
 CellID->686848155],
Cell[358719, 9927, 1900, 41, 97, "Output",ExpressionUUID->"b4c434f6-9a02-44ba-87fb-2a10462b6492",
 CellID->1132338460]
}, Open  ]],
Cell[360634, 9971, 221, 5, 35, "Text",ExpressionUUID->"478bcb87-e014-45dc-8d24-55ebb8a2c205",
 CellID->1754422388],
Cell[CellGroupData[{
Cell[360880, 9980, 711, 14, 30, "Input",ExpressionUUID->"059015e2-561f-4f7e-8385-2c3e93b5d8ff",
 CellID->1626601806],
Cell[361594, 9996, 2795, 70, 42, "Output",ExpressionUUID->"07f4c816-fc54-43a0-8865-457ee1af9678",
 CellID->147241018]
}, Open  ]],
Cell[364404, 10069, 249, 7, 35, "Text",ExpressionUUID->"8b881b48-487f-415b-9e7c-c66f22aea752",
 CellID->829727132],
Cell[CellGroupData[{
Cell[364678, 10080, 680, 14, 52, "Input",ExpressionUUID->"9fc4c3d7-3782-4bd8-838d-9b8c9d109b4e",
 CellID->1612587553],
Cell[365361, 10096, 3959, 121, 181, "Output",ExpressionUUID->"ad617059-776e-41d4-9493-0fe6fc8453f1",
 CellID->685313396]
}, Open  ]],
Cell[369335, 10220, 484, 10, 58, "Text",ExpressionUUID->"e63f0239-5499-4844-8f0b-589257e37cd9",
 CellID->1515378131],
Cell[CellGroupData[{
Cell[369844, 10234, 459, 12, 52, "Input",ExpressionUUID->"ec9a089a-cdf8-4e25-8f72-5e8bf0d9a6f2",
 CellID->1951677944],
Cell[370306, 10248, 2789, 82, 146, "Output",ExpressionUUID->"5b1f6ce3-8399-4758-ad4f-9927efffbbcd",
 CellID->209660423]
}, Open  ]],
Cell[373110, 10333, 390, 10, 58, "Text",ExpressionUUID->"f6fb3f00-cb3c-4283-a6f0-f582195ce967",
 CellID->1185980530],
Cell[CellGroupData[{
Cell[373525, 10347, 366, 9, 30, "Input",ExpressionUUID->"ae2271fb-074d-4d33-9583-50ea101169c4",
 CellID->1979039903],
Cell[373894, 10358, 4272, 119, 125, "Output",ExpressionUUID->"6fb486ea-f70e-4c5d-a92b-3c2e57e75e23",
 CellID->1692008191]
}, Open  ]],
Cell[378181, 10480, 187, 3, 35, "Text",ExpressionUUID->"0419518a-7b40-42a8-bb90-a709b4a60a73",
 CellID->1496924985],
Cell[CellGroupData[{
Cell[378393, 10487, 453, 12, 52, "Input",ExpressionUUID->"44e32c84-7ed3-4fba-b6ba-05d594acf37f",
 CellID->1047298290],
Cell[378849, 10501, 1071, 25, 97, "Output",ExpressionUUID->"cbcd1548-f9b4-4282-a18b-7dbb68b79752",
 CellID->1701683239]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[379969, 10532, 190, 3, 38, "MathCaption",ExpressionUUID->"4a451544-88b4-4e07-9ac8-ae17c65f7020",
 CellID->1166389218],
Cell[CellGroupData[{
Cell[380184, 10539, 679, 18, 94, "Input",ExpressionUUID->"88e897e6-5ca8-4cba-b007-a3e7a786aa5e",
 CellID->1272857110],
Cell[380866, 10559, 1439, 39, 117, "Output",ExpressionUUID->"03cf38e1-8ea8-463d-a89e-81c4e2cd8704",
 CellID->829300281]
}, Open  ]],
Cell[382320, 10601, 243, 4, 35, "Text",ExpressionUUID->"ddcb9fe7-bc17-479a-832c-44297dffed5b",
 CellID->1824840003],
Cell[CellGroupData[{
Cell[382588, 10609, 833, 19, 52, "Input",ExpressionUUID->"be696d2e-22b3-40f5-b7a6-da4ba963d421",
 CellID->1871967614],
Cell[383424, 10630, 1748, 38, 91, "Output",ExpressionUUID->"1f81c61d-3db1-4412-a498-50b7018060cd",
 CellID->520963463]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[385221, 10674, 190, 3, 38, "MathCaption",ExpressionUUID->"3beeca0a-b1aa-4dc7-a2f1-23c557a061c7",
 CellID->1524259948],
Cell[CellGroupData[{
Cell[385436, 10681, 732, 19, 94, "Input",ExpressionUUID->"0a8822e7-cf34-4ad9-ab0d-127993ff6fe6",
 CellID->904520973],
Cell[386171, 10702, 1482, 39, 117, "Output",ExpressionUUID->"cdb9cd0d-1b61-4ab2-a48c-67f4cee26f7e",
 CellID->2121917620]
}, Open  ]],
Cell[387668, 10744, 296, 7, 35, "Text",ExpressionUUID->"433aecbc-0dee-412c-b2ca-09aca6549ae5",
 CellID->247256098],
Cell[CellGroupData[{
Cell[387989, 10755, 777, 18, 52, "Input",ExpressionUUID->"58de3ff9-ffa3-4f82-be06-0a6d90534ecd",
 CellID->252382141],
Cell[388769, 10775, 1789, 38, 91, "Output",ExpressionUUID->"6c389702-61d4-47ff-8229-48ed6ebff843",
 CellID->1604982496]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[390607, 10819, 190, 3, 38, "MathCaption",ExpressionUUID->"829c9dbe-b262-4ef0-b036-2a89d9234cdd",
 CellID->506440962],
Cell[CellGroupData[{
Cell[390822, 10826, 778, 19, 94, "Input",ExpressionUUID->"77c6ead4-c199-4495-b5a8-539fa3cf5175",
 CellID->1275555273],
Cell[391603, 10847, 1582, 41, 117, "Output",ExpressionUUID->"47e267a6-c13a-4249-a5d5-f92be6436d2b",
 CellID->1182962953]
}, Open  ]],
Cell[393200, 10891, 264, 6, 35, "Text",ExpressionUUID->"b508c97f-d0b2-44b0-8516-6d81b99e24be",
 CellID->2075708957],
Cell[CellGroupData[{
Cell[393489, 10901, 897, 20, 52, "Input",ExpressionUUID->"b8312eb3-4af7-4c72-8aaf-f09510dc4138",
 CellID->568594784],
Cell[394389, 10923, 2565, 52, 91, "Output",ExpressionUUID->"d1cb34d0-4070-418b-a8b5-39bac15420cb",
 CellID->452614765]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[397003, 10981, 190, 3, 38, "MathCaption",ExpressionUUID->"d5529d34-6855-40f5-8e23-6b09c9388f75",
 CellID->70305538],
Cell[CellGroupData[{
Cell[397218, 10988, 778, 19, 94, "Input",ExpressionUUID->"eba3f428-2f21-4cd5-bc0b-7ea8ef112241",
 CellID->509171316],
Cell[397999, 11009, 1531, 40, 117, "Output",ExpressionUUID->"c7aceed1-810c-4468-8b43-de1321177931",
 CellID->952252550]
}, Open  ]],
Cell[CellGroupData[{
Cell[399567, 11054, 773, 18, 52, "Input",ExpressionUUID->"26239bcb-03f4-4364-9d17-67709f8d15b9",
 CellID->2067458364],
Cell[400343, 11074, 2556, 52, 91, "Output",ExpressionUUID->"5069565a-c9ae-499e-8b91-5afb4ad1063f",
 CellID->1322203248]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[402948, 11132, 319, 6, 38, "MathCaption",ExpressionUUID->"4af47efe-af18-48da-945a-38636bdfd5cb",
 CellID->1487315288],
Cell[CellGroupData[{
Cell[403292, 11142, 1177, 29, 52, "Input",ExpressionUUID->"0718cfd3-6795-4fb5-a187-6a81dc9bc0f0",
 CellID->598394336],
Cell[404472, 11173, 2624, 65, 36, "Output",ExpressionUUID->"db64389c-dc50-424e-8707-9dc55dfba31f",
 CellID->326191546],
Cell[407099, 11240, 3239, 76, 42, "Output",ExpressionUUID->"ca1eec47-0d56-4a89-932e-e9c7bea225bd",
 CellID->1923046478]
}, Open  ]],
Cell[410353, 11319, 674, 14, 58, "Text",ExpressionUUID->"3950a998-b0aa-413e-8da5-e18ca1c4a880",
 CellID->547686251],
Cell[CellGroupData[{
Cell[411052, 11337, 797, 19, 73, "Input",ExpressionUUID->"497b32ac-c7d6-4e8a-8941-b8d03016b322",
 CellID->847909515],
Cell[411852, 11358, 4515, 122, 125, "Output",ExpressionUUID->"4a5f97f8-af72-4c9c-b721-04521a006cab",
 CellID->907434927]
}, Open  ]],
Cell[416382, 11483, 715, 14, 81, "Text",ExpressionUUID->"c762f480-3826-4392-82d0-39cebcd912b0",
 CellID->113737113],
Cell[CellGroupData[{
Cell[417122, 11501, 879, 21, 52, "Input",ExpressionUUID->"0e19644d-eeb5-45bc-b2bd-03ef0283c7ef",
 CellID->319212361],
Cell[418004, 11524, 6223, 184, 187, "Output",ExpressionUUID->"ab174840-c361-4c93-bdf6-c238d75ab80e",
 CellID->405883318]
}, Open  ]],
Cell[424242, 11711, 580, 10, 81, "Text",ExpressionUUID->"a37bc400-a813-4061-8732-8b746194a448",
 CellID->588001121],
Cell[CellGroupData[{
Cell[424847, 11725, 432, 9, 30, "Input",ExpressionUUID->"c7dd61fe-3679-4604-b55e-44fb7bb074c4",
 CellID->1962580800],
Cell[425282, 11736, 7302, 149, 91, "Output",ExpressionUUID->"86cdc4d7-f73d-4d1b-aea3-f13d50e907c5",
 CellID->1767605219]
}, Open  ]],
Cell[432599, 11888, 234, 6, 35, "Text",ExpressionUUID->"9ad5e768-cc99-4d70-bbba-3dab12973a1e",
 CellID->1894171327],
Cell[CellGroupData[{
Cell[432858, 11898, 491, 12, 52, "Input",ExpressionUUID->"5c8cfbf7-22e5-4a08-97d5-57c06e1cea61",
 CellID->1039909761],
Cell[433352, 11912, 3701, 118, 181, "Output",ExpressionUUID->"79c9dbe4-b8cb-4514-8dde-6128a83640bf",
 CellID->439670953]
}, Open  ]],
Cell[CellGroupData[{
Cell[437090, 12035, 270, 7, 30, "Input",ExpressionUUID->"d5da649f-8eaf-4db0-872b-470c4892c285",
 CellID->1541433841],
Cell[437363, 12044, 1139, 26, 97, "Output",ExpressionUUID->"0c345eec-13aa-4b78-a149-79adedf916b8",
 CellID->265553613]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[438575, 12078, 262, 4, 67, "Section",ExpressionUUID->"639f1f48-d332-4fd1-9f8d-0ae85404cd50",
 CellTags->"Section35",
 CellID->882238498],
Cell[CellGroupData[{
Cell[438862, 12086, 336, 5, 38, "MathCaption",ExpressionUUID->"96411d32-1277-4d4c-9750-fbb4773e5e49",
 CellID->1783331926],
Cell[CellGroupData[{
Cell[439223, 12095, 827, 18, 30, "Input",ExpressionUUID->"647fe4eb-2dab-482e-9360-37659dc64fa6",
 CellID->30419103],
Cell[440053, 12115, 1926, 41, 163, "Output",ExpressionUUID->"fb352788-2279-4ade-a960-d6152ea56f16",
 CellID->2014198293]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[442028, 12162, 255, 4, 54, "Subsection",ExpressionUUID->"dd33b19c-8dfc-4432-9db5-b5ebbb5ab77a",
 CellTags->"Section36",
 CellID->1865203558],
Cell[CellGroupData[{
Cell[442308, 12170, 228, 4, 38, "MathCaption",ExpressionUUID->"7cb3e065-f9ff-4e28-929d-b4d1c5e0ae2c",
 CellID->152756135],
Cell[442539, 12176, 641, 15, 73, "Input",ExpressionUUID->"0d19ce3b-6693-49d4-822f-5a1c1b5140d2",
 CellID->947038696],
Cell[443183, 12193, 190, 3, 35, "Text",ExpressionUUID->"a3f69057-086f-466f-8a98-25a52619789f",
 CellID->1129402780],
Cell[CellGroupData[{
Cell[443398, 12200, 741, 18, 52, "Input",ExpressionUUID->"10dd29bc-7c3b-4e0a-a16a-ff97918cc7a0",
 CellID->1878055755],
Cell[444142, 12220, 1590, 31, 53, "Output",ExpressionUUID->"efc85586-fe9d-45c6-8663-684905f5c40d",
 CellID->224103340]
}, Open  ]],
Cell[445747, 12254, 519, 10, 58, "Text",ExpressionUUID->"e6067341-e968-4420-b9b1-b0ff59f351ed",
 CellID->264567627],
Cell[CellGroupData[{
Cell[446291, 12268, 676, 14, 30, "Input",ExpressionUUID->"c4bfd11f-1235-4f0f-8848-85472af42874",
 CellID->1697248997],
Cell[446970, 12284, 8119, 225, 243, "Output",ExpressionUUID->"6107d379-6835-46bf-a37a-518dcbab75ee",
 CellID->993031488]
}, Open  ]],
Cell[455104, 12512, 196, 3, 35, "Text",ExpressionUUID->"bf813263-6327-493f-9ca7-1e98201d6ba0",
 CellID->1296957699],
Cell[CellGroupData[{
Cell[455325, 12519, 399, 7, 30, "Input",ExpressionUUID->"811cc859-6537-44a2-a792-7dce5126894c",
 CellID->2133712687],
Cell[455727, 12528, 12129, 234, 163, "Output",ExpressionUUID->"9bfd08ec-56b3-483e-9d20-7180c4b63931",
 CellID->1462399584]
}, Open  ]],
Cell[467871, 12765, 167, 3, 35, "Text",ExpressionUUID->"35d7666c-b5ee-4ad7-9186-e86da9e2e488",
 CellID->1009030043],
Cell[CellGroupData[{
Cell[468063, 12772, 845, 19, 73, "Input",ExpressionUUID->"d982bf28-e442-4a62-9e5f-f17c0c83722d",
 CellID->818174054],
Cell[468911, 12793, 1283, 19, 34, "Output",ExpressionUUID->"3214eb20-4f5e-482d-9e4c-f7d76b8f23aa",
 CellID->661761725]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[470255, 12819, 309, 5, 54, "Subsection",ExpressionUUID->"fbf69b18-c702-4427-836a-9dd06010c9dc",
 CellTags->"Section37",
 CellID->2106499675],
Cell[CellGroupData[{
Cell[470589, 12828, 399, 8, 38, "MathCaption",ExpressionUUID->"f1224d59-0d80-4db0-a22e-0a681a9db365",
 CellID->89572342],
Cell[CellGroupData[{
Cell[471013, 12840, 964, 19, 30, "Input",ExpressionUUID->"837e328e-6e89-4936-b84c-50e6d66b7125",
 CellID->56315447],
Cell[471980, 12861, 1759, 35, 163, "Output",ExpressionUUID->"ae1a94e4-933f-419b-83e6-e74a95dabe21",
 CellID->1843702880]
}, Open  ]],
Cell[473754, 12899, 344, 7, 35, "Text",ExpressionUUID->"9ef47557-2912-47bd-bd01-9a885bb44186",
 CellID->1600913049],
Cell[CellGroupData[{
Cell[474123, 12910, 436, 8, 30, "Input",ExpressionUUID->"652335da-6553-413c-bdc2-88af6fbb8d7b",
 CellID->723001280],
Cell[474562, 12920, 12236, 344, 93, "Output",ExpressionUUID->"317c4297-b371-4827-9d5b-041833160278",
 CellID->1749363107]
}, Open  ]],
Cell[486813, 13267, 351, 7, 35, "Text",ExpressionUUID->"cca3c7c0-fc0c-4173-88fd-17b637c58d14",
 CellID->1020038234],
Cell[CellGroupData[{
Cell[487189, 13278, 864, 23, 73, "Input",ExpressionUUID->"bb47bb06-d1c1-40c7-ab9b-aaf34f0a3fd5",
 CellID->420644837],
Cell[488056, 13303, 4062, 105, 39, "Output",ExpressionUUID->"57767aa8-83ab-4fda-b78f-65974124bb97",
 CellID->1146485467],
Cell[492121, 13410, 949, 14, 34, "Output",ExpressionUUID->"a06cbf42-bd2b-4141-9d4f-da3da7696e51",
 CellID->1757962985]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[493119, 13430, 294, 4, 38, "MathCaption",ExpressionUUID->"465a4919-44b8-44cd-ad53-afc5beccc8f9",
 CellID->261609535],
Cell[493416, 13436, 1023, 24, 115, "Input",ExpressionUUID->"22f16e28-15e0-4696-955c-e40c60302333",
 CellID->972429336],
Cell[CellGroupData[{
Cell[494464, 13464, 540, 13, 30, "Input",ExpressionUUID->"eacf345e-953b-4138-a6c9-7bf00bbff273",
 CellID->1269296482],
Cell[495007, 13479, 1826, 37, 271, "Output",ExpressionUUID->"34bb50a1-aefc-4c38-bfad-bfd5f182a9a6",
 CellID->1317138317]
}, Open  ]],
Cell[CellGroupData[{
Cell[496870, 13521, 1718, 43, 136, "Input",ExpressionUUID->"b97fe6b6-ab90-43e9-97bd-bf1e41fb53d9",
 CellID->2110907323],
Cell[498591, 13566, 4454, 90, 271, "Output",ExpressionUUID->"6b813d03-9333-471e-b0f2-23756fc63d8f",
 CellID->940176936]
}, Open  ]],
Cell[CellGroupData[{
Cell[503082, 13661, 371, 8, 30, "Input",ExpressionUUID->"348825b8-e5e4-4e5c-817c-ca1967e0ed86",
 CellID->1589529221],
Cell[503456, 13671, 460, 9, 34, "Output",ExpressionUUID->"240a0ec2-dd82-4619-ad28-c696bf554750",
 CellID->352296064]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[503965, 13686, 219, 2, 38, "MathCaption",ExpressionUUID->"314dc767-5a4a-4337-8bc8-cf0eea77acb0",
 CellID->1169838411],
Cell[CellGroupData[{
Cell[504209, 13692, 494, 11, 30, "Input",ExpressionUUID->"24336e17-5502-47ca-92ae-d1afe52bffe1",
 CellID->1205134369],
Cell[504706, 13705, 1112, 25, 127, "Output",ExpressionUUID->"db5ba714-81a6-420b-8807-cd3e3df381ec",
 CellID->267907265]
}, Open  ]],
Cell[505833, 13733, 215, 2, 35, "Text",ExpressionUUID->"6231dc87-45db-47a5-a8bf-c67d74f1be82",
 CellID->1178353731],
Cell[CellGroupData[{
Cell[506073, 13739, 825, 19, 52, "Input",ExpressionUUID->"9c3e2c3a-f4e4-4c79-a8b2-2393ee428bef",
 CellID->1463439166],
Cell[506901, 13760, 3872, 90, 127, "Output",ExpressionUUID->"fb9528f9-ff82-4842-a4b6-a9370e00aaa3",
 CellID->455302621]
}, Open  ]],
Cell[CellGroupData[{
Cell[510810, 13855, 255, 5, 30, "Input",ExpressionUUID->"6927ae5c-c34d-4cd6-8d8a-9a322a56ddb1",
 CellID->1366415392],
Cell[511068, 13862, 241, 4, 34, "Output",ExpressionUUID->"9c3cf3a4-80ef-4a5d-9c72-3498d3f07e80",
 CellID->96920632]
}, Open  ]],
Cell[511324, 13869, 452, 12, 37, "Text",ExpressionUUID->"06529a47-042a-48c9-86b9-d6f169ff83ae",
 CellID->507963631],
Cell[CellGroupData[{
Cell[511801, 13885, 789, 21, 73, "Input",ExpressionUUID->"3bdb435f-d573-4afd-a5f2-c96f1388ae3c",
 CellID->1527310069],
Cell[512593, 13908, 1067, 25, 63, "Output",ExpressionUUID->"3f11821d-6d99-4072-871d-855c1abf6354",
 CellID->2080939444],
Cell[513663, 13935, 1005, 25, 49, "Output",ExpressionUUID->"a7ba9df3-8afc-42f9-81c1-5bb49dc2c562",
 CellID->430560266]
}, Open  ]],
Cell[514683, 13963, 263, 3, 35, "Text",ExpressionUUID->"10388739-29c7-40dd-ac70-26f0c6e68049",
 CellID->1796721321],
Cell[CellGroupData[{
Cell[514971, 13970, 659, 12, 73, "Input",ExpressionUUID->"abea7d87-8b17-4f80-996a-d3594bfc56b1",
 CellID->1727681580],
Cell[515633, 13984, 4139, 93, 127, "Output",ExpressionUUID->"100a228a-7c59-434d-8506-2d30acb2044f",
 CellID->407711991],
Cell[519775, 14079, 4837, 134, 52, "Output",ExpressionUUID->"b59b714c-d746-49cb-9109-f62c1e610d08",
 CellID->1942598807],
Cell[524615, 14215, 4869, 135, 52, "Output",ExpressionUUID->"912430ee-9d7d-4db2-b22c-98c2915f0905",
 CellID->1064263908]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[529533, 14356, 230, 5, 38, "MathCaption",ExpressionUUID->"4552b2e6-7e0f-4bce-b7af-5c53bd33b461",
 CellID->521048667],
Cell[CellGroupData[{
Cell[529788, 14365, 1171, 23, 73, "Input",ExpressionUUID->"672a5c52-bfa3-437c-89d6-28e3b45f0786",
 CellID->485964845],
Cell[530962, 14390, 4400, 99, 127, "Output",ExpressionUUID->"1b43e23c-433c-4802-978b-24af3d5b7eb6",
 CellID->1215533475],
Cell[535365, 14491, 5088, 139, 52, "Output",ExpressionUUID->"723fa9e9-181a-482a-a08c-3cc60a00170a",
 CellID->459180414],
Cell[540456, 14632, 5124, 140, 52, "Output",ExpressionUUID->"18e3cdca-c93a-455c-bcc7-aecc862d0e20",
 CellID->1536474427]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[545629, 14778, 238, 4, 38, "MathCaption",ExpressionUUID->"89a1f56e-bb19-47a8-978e-0beb07393e09",
 CellID->1198916797],
Cell[CellGroupData[{
Cell[545892, 14786, 446, 11, 30, "Input",ExpressionUUID->"41f5c150-a75b-4c7e-8127-8c69448179d7",
 CellID->612928653],
Cell[546341, 14799, 1223, 28, 127, "Output",ExpressionUUID->"c29da3d6-2974-4c78-8cf7-d55dc0c8a2b0",
 CellID->1977764036]
}, Open  ]],
Cell[547579, 14830, 258, 5, 35, "Text",ExpressionUUID->"0f2cc52c-6cf3-46c8-98a1-8461c27d0d99",
 CellID->797791790],
Cell[CellGroupData[{
Cell[547862, 14839, 256, 5, 30, "Input",ExpressionUUID->"20da7542-f5ba-4854-97df-ba9a478b1a09",
 CellID->1255670038],
Cell[548121, 14846, 6405, 178, 52, "Output",ExpressionUUID->"00fcf980-6ea8-4917-8554-de10ba9c740f",
 CellID->531957581]
}, Open  ]],
Cell[554541, 15027, 242, 4, 35, "Text",ExpressionUUID->"9e045b59-2009-4c45-851e-5c0602ca5287",
 CellID->373754822],
Cell[CellGroupData[{
Cell[554808, 15035, 338, 7, 52, "Input",ExpressionUUID->"7d39e820-5dbf-4614-a6bd-df1b3cc0ff95",
 CellID->182681389],
Cell[555149, 15044, 1423, 32, 165, "Output",ExpressionUUID->"9e21113e-da92-492b-ad5e-e86f6b7ec30f",
 CellID->1784212079]
}, Open  ]],
Cell[556587, 15079, 264, 5, 35, "Text",ExpressionUUID->"e792de1c-6c81-4e98-b121-ede8f3a78add",
 CellID->683383675],
Cell[CellGroupData[{
Cell[556876, 15088, 893, 22, 94, "Input",ExpressionUUID->"75fe19d8-231f-449e-be82-94e8dbb0e19f",
 CellID->655391084],
Cell[557772, 15112, 2048, 43, 127, "Output",ExpressionUUID->"6ba38c99-0ffa-4b67-b8bb-443ad00d360a",
 CellID->1105888673]
}, Open  ]],
Cell[CellGroupData[{
Cell[559857, 15160, 260, 5, 30, "Input",ExpressionUUID->"17caf1ad-fa86-4441-9dd5-a78c4d6e0b69",
 CellID->1548055864],
Cell[560120, 15167, 6433, 178, 52, "Output",ExpressionUUID->"c7c5e49d-44ef-467a-b9f2-b1094e967f8d",
 CellID->428680199]
}, Open  ]],
Cell[CellGroupData[{
Cell[566590, 15350, 218, 4, 30, "Input",ExpressionUUID->"228009e8-bcf6-4bc6-be25-d05c83cf78c2",
 CellID->1362907403],
Cell[566811, 15356, 379, 6, 34, "Output",ExpressionUUID->"db5435f8-d4fc-4417-a842-74ad3cc52bc6",
 CellID->761345115]
}, Open  ]],
Cell[567205, 15365, 439, 7, 58, "Text",ExpressionUUID->"587ffdcf-9dce-433f-8038-5e2689daf43b",
 CellID->118826222],
Cell[CellGroupData[{
Cell[567669, 15376, 878, 21, 115, "Input",ExpressionUUID->"8e0bf685-349d-4d24-b8f3-5fa7ac0df2ba",
 CellID->343808826],
Cell[568550, 15399, 1966, 42, 127, "Output",ExpressionUUID->"a084cb12-d758-46fe-b8a5-b91b6689c69e",
 CellID->621172449]
}, Open  ]],
Cell[CellGroupData[{
Cell[570553, 15446, 251, 5, 30, "Input",ExpressionUUID->"d57ffd1c-55c0-4767-a805-f62e697895bd",
 CellID->677889826],
Cell[570807, 15453, 386, 6, 34, "Output",ExpressionUUID->"74412988-8bf5-4f5d-acc9-50f9b99d8293",
 CellID->169115895]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[571266, 15467, 214, 3, 67, "Section",ExpressionUUID->"8dafbef9-55ec-4670-9d5d-9b65c47a47f5",
 CellTags->"Section38",
 CellID->1817331573],
Cell[CellGroupData[{
Cell[571505, 15474, 247, 4, 38, "MathCaption",ExpressionUUID->"814a2ca8-a450-4ddf-adc8-035198ba66c3",
 CellID->1917505328],
Cell[CellGroupData[{
Cell[571777, 15482, 741, 22, 94, "Input",ExpressionUUID->"092f0cad-8af7-4e12-9ecc-86c0a88c58fb",
 CellID->86358426],
Cell[572521, 15506, 2115, 46, 79, "Output",ExpressionUUID->"f14ff865-97ee-467c-a949-a8a35902e0fd",
 CellID->476263484]
}, Open  ]],
Cell[CellGroupData[{
Cell[574673, 15557, 552, 14, 52, "Input",ExpressionUUID->"a4270d2a-2683-4295-a71d-7ca38ecc70bd",
 CellID->1264688223],
Cell[575228, 15573, 10019, 230, 127, "Output",ExpressionUUID->"49acb68f-a473-45f6-b5d3-eef6badd1e19",
 CellID->1737404177]
}, Open  ]],
Cell[CellGroupData[{
Cell[585284, 15808, 488, 13, 52, "Input",ExpressionUUID->"be5e49d6-3f1f-4da0-99c3-895f1b192489",
 CellID->104214177],
Cell[585775, 15823, 1995, 43, 165, "Output",ExpressionUUID->"80390991-dbbe-4268-b15a-4772eb97d2ad",
 CellID->1513846488]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[587819, 15872, 395, 6, 59, "MathCaption",ExpressionUUID->"b2b22951-8bdc-4bef-b79a-a84e7a2dda5c",
 CellID->274114911],
Cell[CellGroupData[{
Cell[588239, 15882, 436, 11, 52, "Input",ExpressionUUID->"0a6cc07a-3bb3-4379-adfe-ded860964b92",
 CellID->408162463],
Cell[588678, 15895, 1062, 31, 83, "Output",ExpressionUUID->"db838a40-7ff4-4069-8f54-0a25fef51a36",
 CellID->342986568]
}, Open  ]],
Cell[CellGroupData[{
Cell[589777, 15931, 534, 13, 52, "Input",ExpressionUUID->"2834a68e-758d-4296-9889-b85d83fb2e9d",
 CellID->140937410],
Cell[590314, 15946, 1754, 43, 185, "Output",ExpressionUUID->"7016f3ad-27ad-47ea-b670-23af759260aa",
 CellID->814147453]
}, Open  ]],
Cell[CellGroupData[{
Cell[592105, 15994, 314, 7, 30, "Input",ExpressionUUID->"e3b2ed0c-7476-4af7-8423-e46830f987ff",
 CellID->1202374181],
Cell[592422, 16003, 5373, 153, 50, "Output",ExpressionUUID->"1dd55fab-fb0f-4719-9bcd-aa6e8cd7b452",
 CellID->818113707]
}, Open  ]],
Cell[597810, 16159, 333, 7, 35, "Text",ExpressionUUID->"c0705371-9794-47b0-bbbc-e9409c9d1444",
 CellID->671324729],
Cell[CellGroupData[{
Cell[598168, 16170, 578, 12, 30, "Input",ExpressionUUID->"b6156167-b191-4603-a9c4-cae57f9ad8f5",
 CellID->779608136],
Cell[598749, 16184, 4854, 161, 113, "Output",ExpressionUUID->"67a0b81b-cd63-4d5a-a69f-1a9415846cc3",
 CellID->1569310661]
}, Open  ]],
Cell[CellGroupData[{
Cell[603640, 16350, 700, 18, 52, "Input",ExpressionUUID->"44284cfc-a886-4e7d-9a64-777792613501",
 CellID->1607904042],
Cell[604343, 16370, 1401, 35, 185, "Output",ExpressionUUID->"70d2870e-ca7c-4c19-acba-db757d0ba86a",
 CellID->1649367385]
}, Open  ]],
Cell[CellGroupData[{
Cell[605781, 16410, 457, 8, 30, "Input",ExpressionUUID->"8f6ea602-0854-488a-8d0e-423aeefb1d94",
 CellID->1663700242],
Cell[606241, 16420, 3368, 70, 127, "Output",ExpressionUUID->"4dc764af-c3ba-4a13-9a62-6340f4c89492",
 CellID->1550777223]
}, Open  ]],
Cell[CellGroupData[{
Cell[609646, 16495, 552, 12, 52, "Input",ExpressionUUID->"a5e59113-f13e-4f4b-ac1b-0d2cf52c915d",
 CellID->722239880],
Cell[610201, 16509, 1420, 35, 185, "Output",ExpressionUUID->"5a2a3ef8-956f-48f5-92b6-1d2e1e00c458",
 CellID->1938117198]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[611682, 16551, 267, 4, 67, "Section",ExpressionUUID->"6065574e-02f6-4a40-9e06-f14c4b0db276",
 CellTags->"Section39",
 CellID->1767938601],
Cell[CellGroupData[{
Cell[611974, 16559, 235, 4, 38, "MathCaption",ExpressionUUID->"1f2f73f0-4729-486e-8d90-c0b19240d74b",
 CellID->1974117450],
Cell[CellGroupData[{
Cell[612234, 16567, 1243, 29, 73, "Input",ExpressionUUID->"525aaa6d-aff1-45fe-9942-f14e2d0b11f9",
 CellID->369636000],
Cell[613480, 16598, 2804, 69, 54, "Output",ExpressionUUID->"032d3520-581f-49d2-b339-62a6c0b442f8",
 CellID->672149068]
}, Open  ]],
Cell[CellGroupData[{
Cell[616321, 16672, 1335, 34, 157, "Input",ExpressionUUID->"27d10c96-b339-4ea7-9f51-e224dec993c8",
 CellID->1949544876],
Cell[617659, 16708, 2960, 79, 182, "Output",ExpressionUUID->"a9e6f54b-0053-49d2-a0d9-f88136ca7e0e",
 CellID->187956946]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[620668, 16793, 259, 6, 38, "MathCaption",ExpressionUUID->"00d628c7-cc8f-46e9-9789-1c7b7b12390b",
 CellID->1842728653],
Cell[CellGroupData[{
Cell[620952, 16803, 1322, 32, 73, "Input",ExpressionUUID->"136c2e79-cf39-4bdf-8561-dfcd73f6f73d",
 CellID->1878797584],
Cell[622277, 16837, 2809, 74, 54, "Output",ExpressionUUID->"4fe76d9c-d937-440a-b53b-ad181617e5d0",
 CellID->1867937539]
}, Open  ]],
Cell[CellGroupData[{
Cell[625123, 16916, 1293, 33, 157, "Input",ExpressionUUID->"099d9590-ffe1-4201-b2aa-535d06ab54f0",
 CellID->351448800],
Cell[626419, 16951, 3021, 80, 182, "Output",ExpressionUUID->"92d8d24d-1934-4df0-9e93-272cff3f334c",
 CellID->1313004327]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[629489, 17037, 309, 7, 38, "MathCaption",ExpressionUUID->"de83f5e8-7dad-430d-a994-5984dc50c454",
 CellID->1219952350],
Cell[CellGroupData[{
Cell[629823, 17048, 623, 15, 30, "Input",ExpressionUUID->"b675937d-3b75-4735-a4b2-3820ed123780",
 CellID->1712768541],
Cell[630449, 17065, 1733, 38, 91, "Output",ExpressionUUID->"ed05f586-93f3-4c33-9db7-71c82f5715b5",
 CellID->1173186992]
}, Open  ]],
Cell[632197, 17106, 254, 6, 35, "Text",ExpressionUUID->"518aec85-f82e-45c9-9ce5-04fae8b01d4f",
 CellID->1630064199],
Cell[CellGroupData[{
Cell[632476, 17116, 788, 21, 73, "Input",ExpressionUUID->"284736ae-09ed-48c5-a65e-e92651ed7079",
 CellID->1040107814],
Cell[633267, 17139, 9920, 269, 173, "Output",ExpressionUUID->"7abefc2b-7f39-4ff0-be83-6cda00cfa769",
 CellID->85612187]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[643236, 17414, 199, 3, 38, "MathCaption",ExpressionUUID->"2dc4b1da-a102-4a8b-be27-3c4f649551b3",
 CellID->575143318],
Cell[CellGroupData[{
Cell[643460, 17421, 639, 17, 52, "Input",ExpressionUUID->"6a5ba9cf-57a7-4743-8a42-89690406b2ec",
 CellID->609850479],
Cell[644102, 17440, 2293, 64, 38, "Output",ExpressionUUID->"0cc28f91-0184-4deb-8470-a85ddeb5577e",
 CellID->1986233251]
}, Open  ]],
Cell[646410, 17507, 252, 6, 35, "Text",ExpressionUUID->"ace106c4-ecdc-4351-85e3-7be4b8f20cad",
 CellID->1965037069],
Cell[CellGroupData[{
Cell[646687, 17517, 802, 18, 52, "Input",ExpressionUUID->"d403f668-2cb6-4cb0-9777-ed394f8fc9d4",
 CellID->227011470],
Cell[647492, 17537, 4123, 91, 86, "Output",ExpressionUUID->"6b5bec65-885c-4ed1-903a-07577425a6a9",
 CellID->676798772]
}, Open  ]],
Cell[CellGroupData[{
Cell[651652, 17633, 1057, 27, 73, "Input",ExpressionUUID->"35c86dd4-d3e7-4fe2-a980-e12f3782c5b0",
 CellID->1450819218],
Cell[652712, 17662, 4327, 121, 183, "Output",ExpressionUUID->"f70058c5-d99e-414a-af63-38d799265914",
 CellID->364805760]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

